[
  {
    "control_id": "MA-1",
    "control_name": "Policy and Procedures",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": null,
    "official_text": "a. Develop, document, and disseminate to [Assignment: organization-defined personnel or roles]:\n  1. [Selection (one or more): Organization-level; Mission/business process-level; System-level] maintenance policy that:\n    (a) Addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and\n    (b) Is consistent with applicable laws, executive orders, directives, regulations, policies, standards, and guidelines; and\n  2. Procedures to facilitate the implementation of the maintenance policy and the associated maintenance controls;\nb. Designate an [Assignment: organization-defined official] to manage the development, documentation, and dissemination of the maintenance policy and procedures; and\nc. Review and update the current maintenance:\n  1. Policy [Assignment: organization-defined frequency] and following [Assignment: organization-defined events]; and\n  2. Procedures [Assignment: organization-defined frequency] and following [Assignment: organization-defined events].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "Establish a comprehensive governance framework for system maintenance activities by requiring documented policies and procedures that define how maintenance operations are authorized, controlled, monitored, and executed. This ensures maintenance activities do not introduce security vulnerabilities, are performed by authorized personnel using approved tools, and maintain system integrity throughout the maintenance lifecycle.",
    "plain_english_explanation": "Organizations must create, document, and share system maintenance policies and procedures with designated staff. This control requires establishing who can perform maintenance on systems, what procedures must be followed, how maintenance activities are authorized and documented, and ensuring all maintenance practices comply with relevant laws and regulations. A designated official must manage these policies, and the organization must review and update them regularly based on defined schedules or when significant events occur such as security incidents, audit findings, or regulatory changes.",
    "example_implementation": "Develop a comprehensive System Maintenance Policy document that outlines organizational commitment to secure maintenance practices, defines roles (Maintenance Coordinator, System Administrators, Facilities Manager), establishes maintenance authorization requirements, and documents procedures for both local and remote maintenance. Assign the Chief Information Officer (CIO) or designated official to manage policy development and updates. Establish procedures for scheduling maintenance windows, authorizing maintenance personnel, documenting maintenance activities, and reviewing policy effectiveness annually or after significant security incidents or technology changes.",
    "non_technical_guidance": "To comply with MA-1, follow these organizational steps:\n\n1. Draft a System Maintenance Policy that clearly states the organization's commitment to secure maintenance practices, defines scope (all information systems, including hardware and software), and assigns specific roles and responsibilities for maintenance oversight.\n\n2. Designate an official (CIO, Security Manager, or equivalent) responsible for developing, maintaining, and distributing the maintenance policy and procedures.\n\n3. Document procedures that support the policy, including: maintenance scheduling and authorization processes, personnel authorization requirements, tool approval and inspection procedures, documentation requirements for all maintenance activities, and escalation processes for emergency maintenance.\n\n4. Ensure the policy addresses applicable federal laws (FISMA), executive orders, regulations, and organizational standards, as well as coordination with related security domains such as access control, personnel security, and media protection.\n\n5. Establish review cycles: review and update the policy at least annually and after significant events (security breaches, regulatory changes, technology updates, audit findings).\n\n6. Distribute the policy to all relevant personnel including IT operations staff, system administrators, maintenance contractors, and facilities management through official channels and obtain acknowledgment of receipt and understanding.\n\n7. Maintain records of policy versions, distribution dates, personnel acknowledgments, maintenance authorization records, and review cycles for audit purposes.\n\n8. Integrate maintenance policy with related organizational policies for physical security, access control, and incident response to ensure comprehensive security coverage.\n\n9. Define procedures for different maintenance types including preventive, corrective, and emergency maintenance, as well as local versus remote maintenance scenarios.\n\n10. Establish requirements for vendor and contractor maintenance activities, including escort procedures, supervision requirements, and access limitations.",
    "ai_guidance": "MA-1 establishes the foundational governance for all system maintenance activities across the organization. Implementation should prioritize clear documentation of roles (who authorizes maintenance, who performs it, who supervises contractors), scope (all information systems including hardware, software, and firmware), and review frequency (minimum annual, triggered by incidents, audits, or regulatory changes). The policy must align with applicable laws and organizational mission while addressing coordination with related security controls in the Access Control, Personnel Security, and Media Protection families. Procedures should cover maintenance authorization workflows, personnel vetting requirements, tool approval and inspection processes, documentation standards, and integration with change management processes. For remote maintenance scenarios, the policy must address authentication, encryption, and session management requirements. This is purely organizational - no technical automation exists for implementing the policy itself, though the policy should reference technical controls that support maintenance security. Focus on creating accessible documentation that clearly communicates expectations, ensures accountability through designated officials, and provides comprehensive guidance for all maintenance scenarios including emergency maintenance procedures.",
    "implementation_guidance": "This is an organizational policy control that requires governance and documentation rather than technical implementation. Organizations should develop a formal Maintenance Policy document using a standard policy template that includes sections for purpose, scope, roles, responsibilities, compliance requirements, and references to related policies. The policy should be approved by senior management and integrated into the organization's overall security program. Procedures should be detailed enough to guide maintenance activities across all organizational systems while remaining flexible enough to accommodate different system types, risk levels, and maintenance scenarios. The designated official should have sufficient authority and resources to enforce policy compliance. Regular reviews should include feedback from IT operations, security personnel, compliance officers, and facilities management to ensure the policy remains relevant and effective. The policy must address both local and nonlocal maintenance scenarios, maintenance personnel authorization, tool approval, and documentation requirements.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PM-9",
      "PS-8",
      "SI-12",
      "MA-2",
      "MA-3",
      "MA-4",
      "MA-5",
      "AC-1",
      "AC-3",
      "AC-17",
      "PE-3",
      "PE-16",
      "CM-3"
    ],
    "supplemental_guidance": "Maintenance policy and procedures address the controls in the MA family that are implemented within systems and organizations. The risk management strategy is an important factor in establishing such policies and procedures. Policies and procedures contribute to security and privacy assurance. Therefore, it is important that security and privacy programs collaborate on the development of maintenance policy and procedures. Security and privacy program policies and procedures at the organization level are preferable, in general, and may obviate the need for mission- or system-specific policies and procedures. The policy can be included as part of the general security and privacy policy or be represented by multiple policies reflecting the complex nature of organizations. Procedures can be established for security and privacy programs, for mission or business processes, and for systems, if needed. Procedures describe how the policies or controls are implemented and can be directed at the individual or role that is the object of the procedure. Procedures can be documented in system security and privacy plans or in one or more separate documents. Events that may precipitate an update to maintenance policy and procedures include assessment or audit findings, security incidents or breaches, or changes in applicable laws, executive orders, directives, regulations, policies, standards, and guidelines. Simply restating controls does not constitute an organizational policy or procedure.",
    "implementation_scripts": {
      "linux": {
        "bash": null,
        "ansible": null
      },
      "windows": {
        "powershell": null,
        "ansible": null
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "implementation_type": "organizational"
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "MA-1 is an organizational policy control that requires documented policies and procedures for system maintenance programs. This control cannot be automated through technical means (SCAP, Ansible, Bash scripts) as it addresses governance, documentation, and organizational processes rather than system configurations. Organizations must manually create policy documents, assign responsible officials, establish review procedures, and maintain documentation in accordance with applicable laws and regulations. No STIG mappings exist for this control as it is purely procedural."
    },
    "nist_csf_mappings": {
      "v1.1": [
        "ID.GV-1",
        "ID.GV-3",
        "PR.MA-1",
        "DE.DP-2"
      ],
      "v2.0": [
        "GV.OC-03",
        "GV.PO-01",
        "GV.PO-02",
        "ID.IM-01",
        "ID.IM-02",
        "ID.IM-03"
      ]
    },
    "nist_sp_800_171_mapping": "03.07.01"
  },
  {
    "control_id": "MA-2",
    "control_name": "Controlled Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": null,
    "official_text": "a. Schedule, document, and review records of maintenance, repair, and replacement on system components in accordance with manufacturer or vendor specifications and/or organizational requirements; b. Approve and monitor all maintenance activities, whether performed on site or remotely and whether the system or system components are serviced on site or removed to another location; c. Require that [Assignment: organization-defined personnel or roles] explicitly approve the removal of the system or system components from organizational facilities for off-site maintenance, repair, or replacement; d. Sanitize equipment to remove the following information from associated media prior to removal from organizational facilities for off-site maintenance, repair, or replacement: [Assignment: organization-defined information]; e. Check all potentially impacted controls to verify that the controls are still functioning properly following maintenance, repair, or replacement actions; and f. Include [Assignment: organization-defined maintenance-related information] in organizational maintenance records.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "Ensure all system maintenance activities are properly authorized, documented, monitored, and verified to prevent unauthorized modifications, protect sensitive information during off-site maintenance, and confirm security controls remain operational after maintenance actions.",
    "plain_english_explanation": "Controlled Maintenance ensures that all changes to IT systems are authorized, documented, and verified. Organizations must schedule and track maintenance activities according to vendor specifications, approve all maintenance whether performed on-site or remotely, require explicit approval before removing equipment for off-site maintenance, sanitize equipment to remove sensitive data before it leaves the facility, verify that security controls still work after maintenance, and maintain comprehensive maintenance records. This protects against unauthorized modifications, data exposure during maintenance, and security gaps introduced by improper maintenance procedures.",
    "ai_guidance": "AI systems can enhance controlled maintenance through: (1) Machine learning-based predictive maintenance systems that analyze system telemetry to anticipate component failures and automatically schedule preventive maintenance; (2) Natural language processing to analyze maintenance records and identify patterns indicating recurring issues or potential security gaps; (3) Automated workflow systems that route maintenance requests for approval, track approvals electronically, and maintain audit trails; (4) Computer vision and barcode/RFID scanning for automated asset tracking during maintenance activities; (5) AI-powered compliance verification tools that automatically check security control functionality post-maintenance through automated testing; (6) Anomaly detection systems monitoring for unauthorized changes during or after maintenance windows.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "MA-2.1",
        "title": "Record Content",
        "official_text": "[Withdrawn: Incorporated into MA-2]"
      },
      {
        "id": "MA-2.2",
        "title": "Automated Maintenance Activities",
        "official_text": "a. Schedule, conduct, and document maintenance, repair, and replacement actions for the system using [Assignment: organization-defined automated mechanisms]; and b. Produce up-to date, accurate, and complete records of all maintenance, repair, and replacement actions requested, scheduled, in process, and completed."
      }
    ],
    "related_controls": [
      "AC-2",
      "AC-3",
      "AC-5",
      "AC-6",
      "AU-6",
      "CA-7",
      "CM-2",
      "CM-3",
      "CM-4",
      "CM-5",
      "CM-8",
      "IA-4",
      "MA-3",
      "MA-4",
      "MA-5",
      "MA-6",
      "MP-6",
      "PE-16",
      "SA-12",
      "SC-13",
      "SI-2",
      "SR-3",
      "SR-4",
      "SR-11"
    ],
    "supplemental_guidance": "This control addresses the information security aspects of the system maintenance program and applies to all types of maintenance to system components conducted by local or nonlocal entities. Maintenance includes peripherals such as scanners, copiers, and printers. Information necessary for creating effective maintenance records includes the date and time of maintenance, a description of the maintenance performed, names of the individuals or group performing the maintenance, name of the escort (if necessary), a list of equipment removed or replaced (including identification numbers, if applicable), and the maintenance contract number (if applicable). Organizations consider supply chain-related risks associated with replacement components for systems.",
    "implementation_guidance": "MA-2 is primarily an organizational control requiring policy documentation, maintenance procedures, and workflow management. Technical implementation opportunities include: (1) IT Service Management (ITSM) platforms (ServiceNow, BMC Remedy) for maintenance request tracking and approval workflows; (2) Configuration Management Database (CMDB) integration for asset tracking during maintenance; (3) Electronic signature systems for maintenance approvals; (4) Automated media sanitization verification tools before off-site removal; (5) Post-maintenance security control verification through automated compliance scanning; (6) Audit logging systems capturing maintenance activities for record-keeping; (7) Calendar and scheduling systems for maintenance window management.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires organizational policy documentation and procedures. Technical automation available for maintenance scheduling, approval workflows, and record management through ITSM platforms."
    }
  },
  {
    "control_id": "MA-2.1",
    "control_name": "Record Content",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-2",
    "stig_id": null,
    "official_text": "[Withdrawn: Incorporated into MA-2]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This enhancement has been withdrawn and incorporated into the base MA-2 control requirement (f) regarding maintenance record content.",
    "plain_english_explanation": "MA-2.1 Record Content has been withdrawn in NIST SP 800-53 Rev 5 and incorporated directly into the base MA-2 control. The requirement for specifying maintenance record content (dates, descriptions, personnel names, equipment details, contract information) is now part of MA-2 requirement (f). Organizations should refer to MA-2 for maintenance record content requirements.",
    "ai_guidance": "MA-2.1 Record Content requires organizations to document specific maintenance activities performed on systems. Implementation involves creating standardized maintenance logs that capture: (1) Date/time of maintenance, (2) Personnel performing maintenance, (3) Systems/components affected, (4) Description of work performed, (5) Parts replaced or modified, (6) Configuration changes made, (7) Test results post-maintenance. Organizations should implement a centralized maintenance tracking system (CMMS/EAM) that automatically captures this information. For IT systems, integrate with change management tools (ServiceNow, Jira) to create audit trails. Ensure maintenance records are retained per organizational retention policies and are available for security audits. Link maintenance records to asset management systems for comprehensive lifecycle tracking.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-2"
    ],
    "supplemental_guidance": "This control enhancement was withdrawn in NIST SP 800-53 Revision 5. The requirements for maintenance record content have been consolidated into the base MA-2 control to reduce redundancy and clarify that record content requirements are integral to controlled maintenance activities.",
    "implementation_guidance": "As this enhancement is withdrawn, organizations should implement maintenance record content requirements through the base MA-2 control. Technical implementations for record management include: (1) ITSM platforms with mandatory fields for maintenance dates, descriptions, personnel, and equipment details; (2) Automated timestamping and user attribution in maintenance ticketing systems; (3) Integration with asset management systems to auto-populate equipment identifiers; (4) Template-based maintenance record forms ensuring completeness; (5) Audit logging capturing all record modifications.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "withdrawal_note": "Incorporated into MA-2 base control in NIST SP 800-53 Rev 5"
    },
    "cac_metadata": {
      "implementation_type": "withdrawn",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control enhancement has been withdrawn. Implement through MA-2 base control."
    }
  },
  {
    "control_id": "MA-2.2",
    "control_name": "Automated Maintenance Activities",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-2",
    "stig_id": null,
    "official_text": "a. Schedule, conduct, and document maintenance, repair, and replacement actions for the system using [Assignment: organization-defined automated mechanisms]; and b. Produce up-to date, accurate, and complete records of all maintenance, repair, and replacement actions requested, scheduled, in process, and completed.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "intent": "Leverage automated mechanisms to ensure maintenance activities are consistently scheduled, executed, documented, and tracked without reliance on manual processes that may introduce errors, delays, or incomplete records.",
    "plain_english_explanation": "Organizations with high-impact systems must use automated tools to schedule, perform, and document all maintenance activities. This means implementing IT service management platforms, configuration management tools, and automated patching systems that track every maintenance request from submission through completion. The automated systems must maintain accurate, up-to-date records showing what maintenance was requested, when it was scheduled, its current status (in progress or completed), and complete documentation of work performed. This automation reduces human error, ensures consistent documentation, enables faster response to maintenance needs, and provides auditable trails for compliance verification.",
    "ai_guidance": "AI systems provide significant value for automated maintenance activities: (1) Predictive maintenance algorithms analyzing system logs, performance metrics, and historical failure data to proactively schedule maintenance before failures occur; (2) Machine learning models identifying optimal maintenance windows based on system utilization patterns and business impact analysis; (3) Automated patch management systems using AI to assess patch criticality, compatibility risks, and deployment prioritization; (4) Natural language processing for automated generation of maintenance records from technician notes and system logs; (5) Robotic process automation (RPA) for routine maintenance tasks like certificate renewals, log rotations, and disk cleanup; (6) AI-powered configuration drift detection that automatically triggers remediation or maintenance tickets; (7) Anomaly detection identifying systems requiring unscheduled maintenance.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "MA-2",
      "CA-7",
      "CM-2",
      "CM-3",
      "CM-6",
      "SI-2",
      "SI-7"
    ],
    "supplemental_guidance": "The use of automated mechanisms to schedule, conduct, and document maintenance activities helps ensure that maintenance is conducted on time and in a consistent manner. Automated mechanisms can include configuration management tools that track system component configurations and alert when components require maintenance, as well as automated patching systems that apply software updates. Complete records of maintenance activities include requests, scheduling, in-process activities, and completed maintenance with all relevant details.",
    "implementation_guidance": "MA-2.2 requires deployment of automated maintenance management systems. Technical implementations include: (1) Enterprise ITSM platforms (ServiceNow, BMC Helix) configured for automated maintenance scheduling and tracking; (2) Automated patch management systems (WSUS, SCCM, Red Hat Satellite, Ansible) for software updates; (3) Configuration management tools (Ansible, Puppet, Chef) for automated remediation and configuration maintenance; (4) Monitoring and alerting systems (Nagios, Zabbix, Prometheus) triggering automated maintenance tickets; (5) CMDB integration for automated asset status updates during maintenance; (6) Workflow automation for maintenance approval routing; (7) Automated reporting dashboards showing maintenance status across all systems.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-2.2: Automated Maintenance Activities - Linux Implementation\n# This script configures automated maintenance logging and scheduling\n\n# Variables\nMAINT_LOG_DIR=\"/var/log/maintenance\"\nMAINT_RECORD_FILE=\"${MAINT_LOG_DIR}/maintenance_records.log\"\nCRON_FILE=\"/etc/cron.d/automated-maintenance\"\n\n# Create maintenance logging directory\nmkdir -p \"${MAINT_LOG_DIR}\"\nchmod 750 \"${MAINT_LOG_DIR}\"\n\n# Initialize maintenance records file with proper headers\nif [ ! -f \"${MAINT_RECORD_FILE}\" ]; then\n    echo \"TIMESTAMP|ACTION_TYPE|COMPONENT|STATUS|REQUESTOR|DESCRIPTION|TICKET_ID\" > \"${MAINT_RECORD_FILE}\"\n    chmod 640 \"${MAINT_RECORD_FILE}\"\nfi\n\n# Function to log maintenance activities\nlog_maintenance() {\n    local action_type=\"$1\"\n    local component=\"$2\"\n    local status=\"$3\"\n    local description=\"$4\"\n    local ticket_id=\"${5:-AUTO}\"\n    local timestamp=$(date -u +\"%Y-%m-%dT%H:%M:%SZ\")\n    local requestor=$(whoami)\n    echo \"${timestamp}|${action_type}|${component}|${status}|${requestor}|${description}|${ticket_id}\" >> \"${MAINT_RECORD_FILE}\"\n}\n\n# Configure automated package update logging\nif [ -f /etc/apt/apt.conf.d/50unattended-upgrades ]; then\n    # Debian/Ubuntu: Configure unattended-upgrades logging\n    cat > /etc/apt/apt.conf.d/20auto-upgrades-logging << 'EOF'\nAPT::Periodic::Update-Package-Lists \"1\";\nAPT::Periodic::Unattended-Upgrade \"1\";\nUnattended-Upgrade::SyslogEnable \"true\";\nUnattended-Upgrade::SyslogFacility \"daemon\";\nEOF\n    log_maintenance \"CONFIG\" \"unattended-upgrades\" \"COMPLETED\" \"Configured automated update logging\" \"\"\nfi\n\nif [ -f /etc/dnf/automatic.conf ] || [ -f /etc/yum/yum-cron.conf ]; then\n    # RHEL/CentOS: Configure dnf-automatic or yum-cron\n    if [ -f /etc/dnf/automatic.conf ]; then\n        sed -i 's/^apply_updates.*/apply_updates = yes/' /etc/dnf/automatic.conf\n        systemctl enable --now dnf-automatic.timer\n        log_maintenance \"CONFIG\" \"dnf-automatic\" \"COMPLETED\" \"Enabled automated package updates\" \"\"\n    fi\nfi\n\n# Configure audit logging for maintenance activities\nif command -v auditctl &> /dev/null; then\n    # Monitor system configuration changes\n    auditctl -w /etc -p wa -k maintenance_config\n    auditctl -w /var/log/maintenance -p wa -k maintenance_records\n    log_maintenance \"CONFIG\" \"auditd\" \"COMPLETED\" \"Configured maintenance activity auditing\" \"\"\nfi\n\n# Create automated maintenance reporting script\ncat > /usr/local/bin/maintenance-report.sh << 'SCRIPT'\n#!/bin/bash\n# Generate maintenance status report\nMAINT_LOG=\"/var/log/maintenance/maintenance_records.log\"\nREPORT_DATE=$(date +\"%Y-%m-%d\")\nREPORT_FILE=\"/var/log/maintenance/report_${REPORT_DATE}.txt\"\n\necho \"=== Maintenance Status Report ===\"  > \"${REPORT_FILE}\"\necho \"Generated: $(date)\"                 >> \"${REPORT_FILE}\"\necho \"\"                                    >> \"${REPORT_FILE}\"\necho \"=== Pending Maintenance ===\"        >> \"${REPORT_FILE}\"\ngrep \"|SCHEDULED|\" \"${MAINT_LOG}\" 2>/dev/null | tail -20 >> \"${REPORT_FILE}\"\necho \"\"                                    >> \"${REPORT_FILE}\"\necho \"=== In-Progress Maintenance ===\"    >> \"${REPORT_FILE}\"\ngrep \"|IN_PROGRESS|\" \"${MAINT_LOG}\" 2>/dev/null | tail -20 >> \"${REPORT_FILE}\"\necho \"\"                                    >> \"${REPORT_FILE}\"\necho \"=== Completed Today ===\"            >> \"${REPORT_FILE}\"\ngrep \"${REPORT_DATE}\" \"${MAINT_LOG}\" 2>/dev/null | grep \"|COMPLETED|\" >> \"${REPORT_FILE}\"\nSCRIPT\nchmod 755 /usr/local/bin/maintenance-report.sh\n\n# Schedule daily maintenance report generation\necho \"0 6 * * * root /usr/local/bin/maintenance-report.sh\" > \"${CRON_FILE}\"\n\nlog_maintenance \"CONFIG\" \"maintenance-system\" \"COMPLETED\" \"Automated maintenance logging system configured\" \"\"\n\necho \"MA-2.2 Automated Maintenance Activities configuration complete.\"\necho \"Maintenance records: ${MAINT_RECORD_FILE}\"\necho \"Daily reports: /var/log/maintenance/report_*.txt\"",
        "ansible": "---\n# MA-2.2: Automated Maintenance Activities - Ansible Playbook\n# This playbook configures automated maintenance logging and scheduling\n\n- name: MA-2.2 Automated Maintenance Activities\n  hosts: all\n  become: yes\n  vars:\n    maint_log_dir: /var/log/maintenance\n    maint_record_file: \"{{ maint_log_dir }}/maintenance_records.log\"\n    notification_email: \"security-team@organization.com\"\n\n  tasks:\n    - name: Create maintenance logging directory\n      file:\n        path: \"{{ maint_log_dir }}\"\n        state: directory\n        mode: '0750'\n        owner: root\n        group: adm\n\n    - name: Initialize maintenance records file\n      copy:\n        dest: \"{{ maint_record_file }}\"\n        content: \"TIMESTAMP|ACTION_TYPE|COMPONENT|STATUS|REQUESTOR|DESCRIPTION|TICKET_ID\\n\"\n        mode: '0640'\n        owner: root\n        group: adm\n        force: no\n\n    - name: Configure automated updates (RHEL/CentOS)\n      when: ansible_os_family == 'RedHat'\n      block:\n        - name: Install dnf-automatic\n          dnf:\n            name: dnf-automatic\n            state: present\n\n        - name: Configure dnf-automatic\n          lineinfile:\n            path: /etc/dnf/automatic.conf\n            regexp: \"^{{ item.key }}\"\n            line: \"{{ item.key }} = {{ item.value }}\"\n          loop:\n            - { key: 'apply_updates', value: 'yes' }\n            - { key: 'emit_via', value: 'stdio' }\n\n        - name: Enable dnf-automatic timer\n          systemd:\n            name: dnf-automatic.timer\n            enabled: yes\n            state: started\n\n    - name: Configure automated updates (Debian/Ubuntu)\n      when: ansible_os_family == 'Debian'\n      block:\n        - name: Install unattended-upgrades\n          apt:\n            name: unattended-upgrades\n            state: present\n\n        - name: Configure unattended-upgrades logging\n          copy:\n            dest: /etc/apt/apt.conf.d/20auto-upgrades-logging\n            content: |\n              APT::Periodic::Update-Package-Lists \"1\";\n              APT::Periodic::Unattended-Upgrade \"1\";\n              Unattended-Upgrade::SyslogEnable \"true\";\n              Unattended-Upgrade::SyslogFacility \"daemon\";\n            mode: '0644'\n\n    - name: Deploy maintenance reporting script\n      copy:\n        dest: /usr/local/bin/maintenance-report.sh\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          MAINT_LOG=\"{{ maint_record_file }}\"\n          REPORT_DATE=$(date +\"%Y-%m-%d\")\n          REPORT_FILE=\"{{ maint_log_dir }}/report_${REPORT_DATE}.txt\"\n\n          echo \"=== Maintenance Status Report ===\"  > \"${REPORT_FILE}\"\n          echo \"Generated: $(date)\"                 >> \"${REPORT_FILE}\"\n          echo \"\"                                    >> \"${REPORT_FILE}\"\n          echo \"=== Pending Maintenance ===\"        >> \"${REPORT_FILE}\"\n          grep \"|SCHEDULED|\" \"${MAINT_LOG}\" 2>/dev/null | tail -20 >> \"${REPORT_FILE}\"\n          echo \"\"                                    >> \"${REPORT_FILE}\"\n          echo \"=== In-Progress Maintenance ===\"    >> \"${REPORT_FILE}\"\n          grep \"|IN_PROGRESS|\" \"${MAINT_LOG}\" 2>/dev/null | tail -20 >> \"${REPORT_FILE}\"\n          echo \"\"                                    >> \"${REPORT_FILE}\"\n          echo \"=== Completed Today ===\"            >> \"${REPORT_FILE}\"\n          grep \"${REPORT_DATE}\" \"${MAINT_LOG}\" 2>/dev/null | grep \"|COMPLETED|\" >> \"${REPORT_FILE}\"\n\n    - name: Schedule daily maintenance report\n      cron:\n        name: \"Generate daily maintenance report\"\n        minute: \"0\"\n        hour: \"6\"\n        job: \"/usr/local/bin/maintenance-report.sh\"\n        user: root\n\n    - name: Configure audit rules for maintenance tracking\n      lineinfile:\n        path: /etc/audit/rules.d/maintenance.rules\n        line: \"{{ item }}\"\n        create: yes\n      loop:\n        - \"-w /etc -p wa -k maintenance_config\"\n        - \"-w {{ maint_log_dir }} -p wa -k maintenance_records\"\n      notify: Reload auditd\n\n    - name: Log playbook execution to maintenance records\n      lineinfile:\n        path: \"{{ maint_record_file }}\"\n        line: \"{{ ansible_date_time.iso8601 }}|CONFIG|ansible-maintenance|COMPLETED|{{ ansible_user_id }}|MA-2.2 automated maintenance configured|ANSIBLE\"\n\n  handlers:\n    - name: Reload auditd\n      service:\n        name: auditd\n        state: restarted"
      },
      "windows": {
        "powershell": "# MA-2.2: Automated Maintenance Activities - Windows PowerShell Implementation\n# This script configures automated maintenance logging and scheduling\n\n#Requires -RunAsAdministrator\n\n# Variables\n$MaintLogDir = \"C:\\ProgramData\\MaintenanceLogs\"\n$MaintRecordFile = \"$MaintLogDir\\maintenance_records.csv\"\n$ReportDir = \"$MaintLogDir\\Reports\"\n\n# Create maintenance logging directories\nif (-not (Test-Path $MaintLogDir)) {\n    New-Item -ItemType Directory -Path $MaintLogDir -Force | Out-Null\n}\nif (-not (Test-Path $ReportDir)) {\n    New-Item -ItemType Directory -Path $ReportDir -Force | Out-Null\n}\n\n# Initialize maintenance records file with headers\nif (-not (Test-Path $MaintRecordFile)) {\n    $headers = \"Timestamp,ActionType,Component,Status,Requestor,Description,TicketID\"\n    $headers | Out-File -FilePath $MaintRecordFile -Encoding UTF8\n}\n\n# Function to log maintenance activities\nfunction Write-MaintenanceLog {\n    param(\n        [Parameter(Mandatory=$true)][string]$ActionType,\n        [Parameter(Mandatory=$true)][string]$Component,\n        [Parameter(Mandatory=$true)][string]$Status,\n        [Parameter(Mandatory=$true)][string]$Description,\n        [string]$TicketID = \"AUTO\"\n    )\n    $timestamp = Get-Date -Format \"yyyy-MM-ddTHH:mm:ssZ\"\n    $requestor = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name\n    $logEntry = \"$timestamp,$ActionType,$Component,$Status,$requestor,`\"$Description`\",$TicketID\"\n    Add-Content -Path $MaintRecordFile -Value $logEntry\n}\n\n# Configure Windows Update logging\nWrite-Host \"Configuring Windows Update logging...\"\ntry {\n    # Enable Windows Update logging\n    $WULogPath = \"$env:SystemRoot\\Logs\\WindowsUpdate\"\n    if (-not (Test-Path $WULogPath)) {\n        New-Item -ItemType Directory -Path $WULogPath -Force | Out-Null\n    }\n    \n    # Configure automatic updates with logging\n    $AUSettings = (New-Object -ComObject Microsoft.Update.AutoUpdate)\n    \n    Write-MaintenanceLog -ActionType \"CONFIG\" -Component \"WindowsUpdate\" -Status \"COMPLETED\" -Description \"Windows Update logging configured\"\n}\ncatch {\n    Write-Warning \"Failed to configure Windows Update logging: $_\"\n}\n\n# Create scheduled task for maintenance reporting\nWrite-Host \"Creating scheduled maintenance report task...\"\n\n$ReportScript = @'\n# Maintenance Report Generation Script\n$MaintLogDir = \"C:\\ProgramData\\MaintenanceLogs\"\n$MaintRecordFile = \"$MaintLogDir\\maintenance_records.csv\"\n$ReportDate = Get-Date -Format \"yyyy-MM-dd\"\n$ReportFile = \"$MaintLogDir\\Reports\\report_$ReportDate.txt\"\n\n$report = @\"\n=== Maintenance Status Report ===\nGenerated: $(Get-Date)\n\n=== Pending Maintenance ===\n\"@\n\nif (Test-Path $MaintRecordFile) {\n    $records = Import-Csv $MaintRecordFile\n    $pending = $records | Where-Object { $_.Status -eq \"SCHEDULED\" } | Select-Object -Last 20\n    $inProgress = $records | Where-Object { $_.Status -eq \"IN_PROGRESS\" } | Select-Object -Last 20\n    $completedToday = $records | Where-Object { $_.Status -eq \"COMPLETED\" -and $_.Timestamp -like \"$ReportDate*\" }\n    \n    $report += ($pending | Format-Table | Out-String)\n    $report += \"`n=== In-Progress Maintenance ===`n\"\n    $report += ($inProgress | Format-Table | Out-String)\n    $report += \"`n=== Completed Today ===`n\"\n    $report += ($completedToday | Format-Table | Out-String)\n}\n\n$report | Out-File -FilePath $ReportFile -Encoding UTF8\n'@\n\n$ReportScriptPath = \"$MaintLogDir\\Generate-MaintenanceReport.ps1\"\n$ReportScript | Out-File -FilePath $ReportScriptPath -Encoding UTF8\n\n# Create scheduled task for daily report generation\n$TaskName = \"MA-2.2 Daily Maintenance Report\"\n$TaskAction = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument \"-ExecutionPolicy Bypass -File `\"$ReportScriptPath`\"\"\n$TaskTrigger = New-ScheduledTaskTrigger -Daily -At 6:00AM\n$TaskPrincipal = New-ScheduledTaskPrincipal -UserId \"SYSTEM\" -LogonType ServiceAccount -RunLevel Highest\n$TaskSettings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable\n\ntry {\n    Unregister-ScheduledTask -TaskName $TaskName -Confirm:$false -ErrorAction SilentlyContinue\n    Register-ScheduledTask -TaskName $TaskName -Action $TaskAction -Trigger $TaskTrigger -Principal $TaskPrincipal -Settings $TaskSettings -Description \"Generates daily maintenance status report for MA-2.2 compliance\"\n    Write-MaintenanceLog -ActionType \"CONFIG\" -Component \"ScheduledTask\" -Status \"COMPLETED\" -Description \"Daily maintenance report task created\"\n}\ncatch {\n    Write-Warning \"Failed to create scheduled task: $_\"\n}\n\n# Configure Windows Event logging for maintenance activities\nWrite-Host \"Configuring maintenance event logging...\"\ntry {\n    # Create custom event log source if not exists\n    if (-not [System.Diagnostics.EventLog]::SourceExists(\"MaintenanceTracking\")) {\n        New-EventLog -LogName \"Application\" -Source \"MaintenanceTracking\"\n    }\n    \n    # Enable detailed logging for system changes\n    $auditPol = @(\n        \"auditpol /set /subcategory:`\"Security System Extension`\" /success:enable /failure:enable\",\n        \"auditpol /set /subcategory:`\"System Integrity`\" /success:enable /failure:enable\",\n        \"auditpol /set /subcategory:`\"Other System Events`\" /success:enable /failure:enable\"\n    )\n    foreach ($cmd in $auditPol) {\n        Invoke-Expression $cmd 2>&1 | Out-Null\n    }\n    \n    Write-MaintenanceLog -ActionType \"CONFIG\" -Component \"EventLogging\" -Status \"COMPLETED\" -Description \"Maintenance event logging configured\"\n}\ncatch {\n    Write-Warning \"Failed to configure event logging: $_\"\n}\n\n# Configure WSUS logging if applicable\nif (Get-Service -Name \"wuauserv\" -ErrorAction SilentlyContinue) {\n    Write-Host \"Configuring WSUS client logging...\"\n    try {\n        $WURegPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\"\n        if (-not (Test-Path $WURegPath)) {\n            New-Item -Path $WURegPath -Force | Out-Null\n        }\n        # Enable verbose logging\n        Set-ItemProperty -Path $WURegPath -Name \"Verbose\" -Value 1 -Type DWord -Force\n        \n        Write-MaintenanceLog -ActionType \"CONFIG\" -Component \"WSUS\" -Status \"COMPLETED\" -Description \"WSUS client logging enabled\"\n    }\n    catch {\n        Write-Warning \"Failed to configure WSUS logging: $_\"\n    }\n}\n\nWrite-MaintenanceLog -ActionType \"CONFIG\" -Component \"MA-2.2-System\" -Status \"COMPLETED\" -Description \"Automated maintenance activities configuration complete\"\n\nWrite-Host \"`nMA-2.2 Automated Maintenance Activities configuration complete.\"\nWrite-Host \"Maintenance records: $MaintRecordFile\"\nWrite-Host \"Daily reports: $ReportDir\"",
        "ansible": "---\n# MA-2.2: Automated Maintenance Activities - Windows Ansible Playbook\n# This playbook configures automated maintenance logging and scheduling\n\n- name: MA-2.2 Automated Maintenance Activities (Windows)\n  hosts: windows\n  gather_facts: yes\n  vars:\n    maint_log_dir: C:\\ProgramData\\MaintenanceLogs\n    maint_record_file: \"{{ maint_log_dir }}\\\\maintenance_records.csv\"\n    report_dir: \"{{ maint_log_dir }}\\\\Reports\"\n\n  tasks:\n    - name: Create maintenance logging directory\n      win_file:\n        path: \"{{ maint_log_dir }}\"\n        state: directory\n\n    - name: Create reports directory\n      win_file:\n        path: \"{{ report_dir }}\"\n        state: directory\n\n    - name: Initialize maintenance records file\n      win_copy:\n        dest: \"{{ maint_record_file }}\"\n        content: \"Timestamp,ActionType,Component,Status,Requestor,Description,TicketID\\r\\n\"\n        force: no\n\n    - name: Deploy maintenance report generation script\n      win_copy:\n        dest: \"{{ maint_log_dir }}\\\\Generate-MaintenanceReport.ps1\"\n        content: |\n          $MaintLogDir = \"{{ maint_log_dir }}\"\n          $MaintRecordFile = \"{{ maint_record_file }}\"\n          $ReportDate = Get-Date -Format \"yyyy-MM-dd\"\n          $ReportFile = \"{{ report_dir }}\\report_$ReportDate.txt\"\n          \n          $report = \"=== Maintenance Status Report ===`r`n\"\n          $report += \"Generated: $(Get-Date)`r`n`r`n\"\n          \n          if (Test-Path $MaintRecordFile) {\n              $records = Import-Csv $MaintRecordFile\n              $pending = $records | Where-Object { $_.Status -eq \"SCHEDULED\" } | Select-Object -Last 20\n              $inProgress = $records | Where-Object { $_.Status -eq \"IN_PROGRESS\" } | Select-Object -Last 20\n              $completedToday = $records | Where-Object { $_.Status -eq \"COMPLETED\" -and $_.Timestamp -like \"$ReportDate*\" }\n              \n              $report += \"=== Pending Maintenance ===`r`n\"\n              $report += ($pending | Format-Table | Out-String)\n              $report += \"`r`n=== In-Progress Maintenance ===`r`n\"\n              $report += ($inProgress | Format-Table | Out-String)\n              $report += \"`r`n=== Completed Today ===`r`n\"\n              $report += ($completedToday | Format-Table | Out-String)\n          }\n          \n          $report | Out-File -FilePath $ReportFile -Encoding UTF8\n\n    - name: Create scheduled task for daily maintenance report\n      win_scheduled_task:\n        name: \"MA-2.2 Daily Maintenance Report\"\n        description: \"Generates daily maintenance status report for MA-2.2 compliance\"\n        actions:\n          - path: PowerShell.exe\n            arguments: \"-ExecutionPolicy Bypass -File \\\"{{ maint_log_dir }}\\\\Generate-MaintenanceReport.ps1\\\"\"\n        triggers:\n          - type: daily\n            start_boundary: '2025-01-01T06:00:00'\n        username: SYSTEM\n        run_level: highest\n        state: present\n        enabled: yes\n\n    - name: Configure audit policy for system changes\n      win_shell: |\n        auditpol /set /subcategory:\"Security System Extension\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"System Integrity\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Other System Events\" /success:enable /failure:enable\n\n    - name: Enable Windows Update logging\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\n        name: Verbose\n        data: 1\n        type: dword\n        state: present\n\n    - name: Log playbook execution to maintenance records\n      win_shell: |\n        $timestamp = Get-Date -Format \"yyyy-MM-ddTHH:mm:ssZ\"\n        $logEntry = \"$timestamp,CONFIG,ansible-maintenance,COMPLETED,{{ ansible_user_id }},MA-2.2 automated maintenance configured via Ansible,ANSIBLE\"\n        Add-Content -Path \"{{ maint_record_file }}\" -Value $logEntry"
      }
    },
    "metadata": {
      "status": "pending_implementation",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Technical control requiring deployment of automated maintenance management systems. Implementation scripts configure maintenance logging, automated reporting, and audit trails for maintenance activities."
    }
  },
  {
    "control_id": "MA-3",
    "control_name": "Maintenance Tools",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": null,
    "is_technical": true,
    "official_text": "a. Approve, control, and monitor the use of system maintenance tools; and b. Review previously approved system maintenance tools [Assignment: organization-defined frequency].",
    "intent": "Ensure that maintenance tools used on organizational systems are authorized, controlled, and monitored to prevent unauthorized modifications or introduction of malicious code.",
    "plain_english_explanation": "Organizations must maintain strict control over tools used for system maintenance. This includes keeping an inventory of approved tools, controlling who can use them, and monitoring their use. Regular reviews ensure tools remain appropriate and haven't been tampered with.",
    "ai_guidance": "MA-3 Maintenance Tools establishes controls over hardware, software, and firmware tools used for system maintenance. Organizations must: (1) Approve and control all maintenance tools before use, (2) Maintain an inventory of authorized tools, (3) Check tools for improper modifications before each use, (4) Sanitize tools that contain organizational data. For implementation, create a Maintenance Tool Authorization List (MTAL) specifying approved versions and checksums. Use application whitelisting to restrict execution of unauthorized maintenance utilities. Implement secure storage for physical maintenance equipment with access controls. For software tools, use package managers with verified repositories and signature verification. Deploy endpoint detection to alert on use of unauthorized maintenance utilities. Document tool approval workflows and maintain audit trails of tool usage.",
    "implementation_guidance": "1. Create and maintain an inventory of approved maintenance tools. 2. Implement access controls limiting who can use maintenance tools. 3. Deploy monitoring to track maintenance tool usage. 4. Establish a review schedule for tool authorization. 5. Use integrity verification (hashes) for tool binaries.",
    "related_controls": [
      "MA-2",
      "MA-5",
      "MA-6",
      "MP-6",
      "PE-3",
      "PE-16",
      "SI-7"
    ],
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-3: Maintenance Tools Control\n# Verify and inventory approved maintenance tools\n\nAPPROVED_TOOLS=(\"/usr/bin/systemctl\" \"/usr/bin/journalctl\" \"/usr/sbin/fdisk\" \"/usr/bin/lsblk\")\nLOG_FILE=\"/var/log/maintenance_tools_audit.log\"\n\necho \"=== Maintenance Tools Audit $(date) ===\" >> \"$LOG_FILE\"\n\nfor tool in \"${APPROVED_TOOLS[@]}\"; do\n    if [ -f \"$tool\" ]; then\n        HASH=$(sha256sum \"$tool\" | awk '{print $1}')\n        echo \"APPROVED: $tool - SHA256: $HASH\" >> \"$LOG_FILE\"\n    else\n        echo \"MISSING: $tool\" >> \"$LOG_FILE\"\n    fi\ndone\n\n# Check for unauthorized tools in common maintenance directories\nfind /usr/local/sbin -type f -executable 2>/dev/null | while read -r tool; do\n    echo \"REVIEW: Unauthorized tool found: $tool\" >> \"$LOG_FILE\"\ndone\n\necho \"Audit complete. Review $LOG_FILE\"",
        "ansible": "---\n- name: MA-3 Maintenance Tools Control\n  hosts: all\n  become: yes\n  vars:\n    approved_tools:\n      - /usr/bin/systemctl\n      - /usr/bin/journalctl\n      - /usr/sbin/fdisk\n      - /usr/bin/lsblk\n    audit_log: /var/log/maintenance_tools_audit.log\n  tasks:\n    - name: Create audit log file\n      file:\n        path: \"{{ audit_log }}\"\n        state: touch\n        mode: '0640'\n    \n    - name: Verify approved tools exist and log hashes\n      shell: |\n        if [ -f \"{{ item }}\" ]; then\n          sha256sum \"{{ item }}\"\n        fi\n      loop: \"{{ approved_tools }}\"\n      register: tool_hashes\n      changed_when: false\n    \n    - name: Log tool verification results\n      lineinfile:\n        path: \"{{ audit_log }}\"\n        line: \"{{ ansible_date_time.iso8601 }} - {{ item.item }}: {{ item.stdout | default('NOT FOUND') }}\"\n      loop: \"{{ tool_hashes.results }}\""
      },
      "windows": {
        "powershell": "# MA-3: Maintenance Tools Control for Windows\n# Inventory and verify approved maintenance tools\n\n$ApprovedTools = @(\n    \"$env:SystemRoot\\System32\\mmc.exe\",\n    \"$env:SystemRoot\\System32\\services.msc\",\n    \"$env:SystemRoot\\System32\\devmgmt.msc\",\n    \"$env:SystemRoot\\System32\\diskmgmt.msc\"\n)\n\n$LogFile = \"C:\\Windows\\Logs\\MaintenanceToolsAudit.log\"\n\nAdd-Content -Path $LogFile -Value \"=== Maintenance Tools Audit $(Get-Date) ===\"\n\nforeach ($tool in $ApprovedTools) {\n    if (Test-Path $tool) {\n        $hash = (Get-FileHash -Path $tool -Algorithm SHA256).Hash\n        Add-Content -Path $LogFile -Value \"APPROVED: $tool - SHA256: $hash\"\n    } else {\n        Add-Content -Path $LogFile -Value \"MISSING: $tool\"\n    }\n}\n\nWrite-Host \"Audit complete. Review $LogFile\"",
        "ansible": "---\n- name: MA-3 Maintenance Tools Control (Windows)\n  hosts: windows\n  tasks:\n    - name: Define approved tools list\n      set_fact:\n        approved_tools:\n          - \"{{ ansible_env.SystemRoot }}\\\\System32\\\\mmc.exe\"\n          - \"{{ ansible_env.SystemRoot }}\\\\System32\\\\services.msc\"\n    \n    - name: Verify tools and generate hashes\n      win_shell: |\n        if (Test-Path '{{ item }}') {\n          (Get-FileHash -Path '{{ item }}' -Algorithm SHA256).Hash\n        } else { 'NOT FOUND' }\n      loop: \"{{ approved_tools }}\"\n      register: tool_verification"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-3.1",
    "control_name": "Inspect Tools",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-3",
    "stig_id": null,
    "is_technical": true,
    "official_text": "Inspect the maintenance tools used by maintenance personnel for improper or unauthorized modifications.",
    "intent": "Detect tampering or unauthorized modifications to maintenance tools before they are used on systems.",
    "plain_english_explanation": "Before allowing maintenance tools to be used, inspect them for signs of tampering or unauthorized changes. This prevents compromised tools from being used to attack systems.",
    "ai_guidance": "MA-3.1 Inspect Tools requires organizations to verify maintenance tools for improper or unauthorized modifications before allowing their use on systems. Implementation includes: (1) Establish baseline configurations and cryptographic hashes for all approved maintenance tools, (2) Verify tool integrity using checksums (SHA-256/SHA-512) before each use, (3) Implement automated scanning for malware and unauthorized modifications, (4) Use hardware security modules or secure enclaves for critical tool storage. For software tools, verify digital signatures against trusted certificate authorities. For portable media containing maintenance tools, perform malware scans using isolated scanning stations before connecting to production systems. Maintain chain-of-custody logs for all maintenance equipment. Consider using read-only boot media for maintenance operations to prevent tool tampering.",
    "implementation_guidance": "1. Establish baseline hashes for all approved tools. 2. Verify tool integrity before each use. 3. Use code signing where available. 4. Maintain chain of custody for portable maintenance media.",
    "related_controls": [
      "MA-3",
      "SI-7",
      "CM-5"
    ],
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-3(1): Inspect Maintenance Tools\n# Verify tool integrity against known-good hashes\n\nHASH_DB=\"/etc/maintenance/tool_hashes.db\"\nRESULT=0\n\nif [ ! -f \"$HASH_DB\" ]; then\n    echo \"ERROR: Hash database not found at $HASH_DB\"\n    exit 1\nfi\n\nwhile IFS='|' read -r tool expected_hash; do\n    if [ -f \"$tool\" ]; then\n        current_hash=$(sha256sum \"$tool\" | awk '{print $1}')\n        if [ \"$current_hash\" != \"$expected_hash\" ]; then\n            echo \"ALERT: Tool modified - $tool\"\n            echo \"  Expected: $expected_hash\"\n            echo \"  Current:  $current_hash\"\n            RESULT=1\n        else\n            echo \"OK: $tool\"\n        fi\n    fi\ndone < \"$HASH_DB\"\n\nexit $RESULT",
        "ansible": "---\n- name: MA-3(1) Inspect Maintenance Tools\n  hosts: all\n  become: yes\n  vars:\n    tool_hashes:\n      /usr/bin/systemctl: \"expected_sha256_hash_here\"\n  tasks:\n    - name: Verify tool integrity\n      shell: sha256sum {{ item.key }} | awk '{print $1}'\n      loop: \"{{ tool_hashes | dict2items }}\"\n      register: current_hashes\n      changed_when: false\n    \n    - name: Alert on modified tools\n      fail:\n        msg: \"Tool {{ item.item.key }} has been modified!\"\n      when: item.stdout != item.item.value\n      loop: \"{{ current_hashes.results }}\""
      },
      "windows": {
        "powershell": "# MA-3(1): Inspect Maintenance Tools\n$HashDB = \"C:\\MaintenanceTools\\approved_hashes.json\"\n$hashes = Get-Content $HashDB | ConvertFrom-Json\n\nforeach ($entry in $hashes) {\n    $currentHash = (Get-FileHash -Path $entry.Path -Algorithm SHA256).Hash\n    if ($currentHash -ne $entry.ExpectedHash) {\n        Write-Warning \"MODIFIED: $($entry.Path)\"\n    } else {\n        Write-Host \"VERIFIED: $($entry.Path)\"\n    }\n}",
        "ansible": "---\n- name: MA-3(1) Inspect Tools (Windows)\n  hosts: windows\n  tasks:\n    - name: Verify tool signatures\n      win_shell: Get-AuthenticodeSignature '{{ item }}' | Select-Object -ExpandProperty Status\n      loop:\n        - \"{{ ansible_env.SystemRoot }}\\\\System32\\\\mmc.exe\"\n      register: sig_check"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-3.2",
    "control_name": "Inspect Media",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-3",
    "stig_id": null,
    "is_technical": true,
    "official_text": "Check media containing diagnostic and test programs for malicious code before the media are used in the system.",
    "intent": "Prevent introduction of malware through maintenance media by scanning before use.",
    "plain_english_explanation": "Before using any USB drives, DVDs, or other media containing maintenance or diagnostic tools, scan them for viruses and malware. This prevents attackers from compromising systems through infected maintenance media.",
    "ai_guidance": "MA-3.2 Inspect Media requires checking all diagnostic and test media for malicious code before use on organizational systems. Implementation involves: (1) Deploy dedicated malware scanning stations isolated from production networks, (2) Scan all removable media using multiple anti-malware engines before connection to systems, (3) Implement data diodes or air-gapped scanning environments for high-security systems, (4) Use write-blocked forensic devices when media inspection requires preserving evidence. Organizations should maintain quarantine areas for suspicious media and establish procedures for handling detected threats. Consider implementing cryptographic verification of media contents against known-good baselines. For bootable maintenance media, verify boot sector integrity and compare against authorized images. Document all media inspection activities with timestamps and inspector identification.",
    "implementation_guidance": "1. Establish media scanning procedures. 2. Deploy dedicated scanning workstations. 3. Use write-protected media where possible. 4. Log all media scanning activities. 5. Quarantine suspicious media.",
    "related_controls": [
      "MA-3",
      "SI-3",
      "MP-6",
      "SC-28"
    ],
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-3(2): Scan maintenance media for malware\n# Requires ClamAV installed\n\nMEDIA_PATH=\"$1\"\nLOG_FILE=\"/var/log/media_scan.log\"\n\nif [ -z \"$MEDIA_PATH\" ]; then\n    echo \"Usage: $0 /path/to/media\"\n    exit 1\nfi\n\necho \"=== Media Scan $(date) ===\" >> \"$LOG_FILE\"\necho \"Scanning: $MEDIA_PATH\" >> \"$LOG_FILE\"\n\n# Update virus definitions\nfreshclam --quiet\n\n# Scan media\nclamscan -r --log=\"$LOG_FILE\" \"$MEDIA_PATH\"\nRESULT=$?\n\nif [ $RESULT -eq 1 ]; then\n    echo \"ALERT: Malware detected on media!\" | tee -a \"$LOG_FILE\"\n    exit 1\nelif [ $RESULT -eq 0 ]; then\n    echo \"CLEAN: No malware detected\" | tee -a \"$LOG_FILE\"\nfi",
        "ansible": "---\n- name: MA-3(2) Scan Maintenance Media\n  hosts: scanning_station\n  become: yes\n  tasks:\n    - name: Ensure ClamAV is installed\n      package:\n        name: clamav\n        state: present\n    \n    - name: Update virus definitions\n      command: freshclam\n      changed_when: false\n    \n    - name: Scan mounted media\n      command: clamscan -r /mnt/maintenance_media\n      register: scan_result\n      failed_when: scan_result.rc == 1"
      },
      "windows": {
        "powershell": "# MA-3(2): Scan maintenance media using Windows Defender\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$MediaPath\n)\n\n$LogFile = \"C:\\Windows\\Logs\\MediaScan.log\"\n\nAdd-Content -Path $LogFile -Value \"=== Media Scan $(Get-Date) ===\"\nAdd-Content -Path $LogFile -Value \"Scanning: $MediaPath\"\n\n# Update definitions\nUpdate-MpSignature\n\n# Perform scan\n$scanResult = Start-MpScan -ScanPath $MediaPath -ScanType CustomScan\n\n# Check for threats\n$threats = Get-MpThreatDetection | Where-Object { $_.InitialDetectionTime -gt (Get-Date).AddMinutes(-5) }\n\nif ($threats) {\n    Add-Content -Path $LogFile -Value \"ALERT: Threats detected!\"\n    $threats | Format-List | Out-File -Append $LogFile\n} else {\n    Add-Content -Path $LogFile -Value \"CLEAN: No threats detected\"\n}",
        "ansible": "---\n- name: MA-3(2) Scan Media (Windows)\n  hosts: windows\n  tasks:\n    - name: Update Defender signatures\n      win_shell: Update-MpSignature\n    \n    - name: Scan removable media\n      win_shell: Start-MpScan -ScanPath 'D:\\' -ScanType CustomScan"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-3.3",
    "control_name": "Prevent Unauthorized Removal",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-3",
    "stig_id": null,
    "is_technical": false,
    "official_text": "Prevent the removal of maintenance equipment containing organizational information by: (a) Verifying that there is no organizational information contained on the equipment; (b) Sanitizing or destroying the equipment; (c) Retaining the equipment within the facility; or (d) Obtaining an exemption from [Assignment: organization-defined personnel or roles] explicitly authorizing removal of the equipment from the facility.",
    "intent": "Protect organizational information from being exfiltrated through maintenance equipment leaving the facility.",
    "plain_english_explanation": "When maintenance personnel need to remove equipment (laptops, drives, diagnostic tools), ensure no sensitive data leaves with it. Either verify the equipment is clean, wipe it, keep it on-site, or get explicit approval for removal.",
    "ai_guidance": "MA-3.3 Prevent Unauthorized Removal restricts the removal of maintenance equipment containing organizational information without proper authorization. Implementation includes: (1) Implement data-at-rest encryption on all maintenance devices, (2) Deploy endpoint DLP solutions to prevent data exfiltration, (3) Require formal checkout/check-in procedures for all maintenance equipment, (4) Use tamper-evident seals on equipment that should not leave secure areas. For removable storage, implement USB device control policies that log all data transfers. Establish sanitization procedures that must be completed before equipment leaves the facility. Deploy physical security controls including RFID asset tracking for maintenance tools. Create authorization workflows requiring management approval before equipment removal. Maintain chain-of-custody logs and conduct periodic inventory audits of maintenance equipment.",
    "implementation_guidance": "1. Establish equipment removal authorization procedures. 2. Verify equipment is sanitized before removal. 3. Maintain equipment checkout logs. 4. Use tamper-evident seals on sensitive equipment. 5. Consider keeping dedicated maintenance equipment on-site.",
    "related_controls": [
      "MA-3",
      "MP-6",
      "PE-16",
      "SC-28"
    ],
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-3.4",
    "control_name": "Restricted Tool Use",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-3",
    "stig_id": null,
    "is_technical": true,
    "official_text": "Restrict the use of maintenance tools to authorized personnel only.",
    "intent": "Ensure only authorized personnel can access and use maintenance tools to prevent misuse.",
    "plain_english_explanation": "Limit who can use maintenance tools through access controls. Only personnel with proper authorization should be able to execute diagnostic or maintenance utilities.",
    "ai_guidance": "MA-3.4 Restricted Tool Use limits maintenance tool usage to authorized personnel and approved maintenance activities. Implementation involves: (1) Implement role-based access controls for maintenance tool access, (2) Deploy Privileged Access Management (PAM) solutions for administrative tool access, (3) Use just-in-time access provisioning requiring approval for each maintenance session, (4) Implement session recording for all maintenance activities using privileged tools. Create an authorized maintainer registry with background verification requirements. Deploy application control policies preventing unauthorized users from executing maintenance utilities. Implement multi-factor authentication for access to maintenance tools. Use time-limited credentials that automatically expire after maintenance windows. Audit tool usage against authorized maintenance tickets to detect unauthorized access.",
    "implementation_guidance": "1. Define authorized maintenance roles. 2. Implement RBAC for tool access. 3. Use sudo/UAC to control privileged tool execution. 4. Maintain access control lists for maintenance utilities. 5. Audit tool usage regularly.",
    "related_controls": [
      "MA-3",
      "MA-5",
      "AC-3",
      "AC-6"
    ],
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-3(4): Restrict maintenance tool access\n# Configure sudo to limit tool execution\n\ncat >> /etc/sudoers.d/maintenance_tools << 'EOF'\n# Maintenance tools restricted to maintenance group\n%maintenance ALL=(root) /usr/bin/systemctl, /usr/bin/journalctl\n%maintenance ALL=(root) NOPASSWD: /usr/local/bin/maintenance_audit.sh\nEOF\n\nchmod 440 /etc/sudoers.d/maintenance_tools\nvisudo -c && echo \"Sudoers configuration valid\"",
        "ansible": "---\n- name: MA-3(4) Restrict Tool Use\n  hosts: all\n  become: yes\n  tasks:\n    - name: Create maintenance group\n      group:\n        name: maintenance\n        state: present\n    \n    - name: Configure sudoers for maintenance tools\n      copy:\n        dest: /etc/sudoers.d/maintenance_tools\n        content: |\n          %maintenance ALL=(root) /usr/bin/systemctl, /usr/bin/journalctl\n        mode: '0440'\n        validate: visudo -cf %s"
      },
      "windows": {
        "powershell": "# MA-3(4): Restrict maintenance tool access via Group Policy\n# Create a restricted group for maintenance tool access\n\n$MaintenanceGroup = \"Maintenance_Tool_Users\"\n\n# Create local group if not exists\nif (-not (Get-LocalGroup -Name $MaintenanceGroup -ErrorAction SilentlyContinue)) {\n    New-LocalGroup -Name $MaintenanceGroup -Description \"Users authorized to use maintenance tools\"\n}\n\n# Set NTFS permissions on maintenance tools folder\n$ToolsPath = \"C:\\MaintenanceTools\"\n$acl = Get-Acl $ToolsPath\n$acl.SetAccessRuleProtection($true, $false)\n$rule = New-Object System.Security.AccessControl.FileSystemAccessRule($MaintenanceGroup, \"ReadAndExecute\", \"ContainerInherit,ObjectInherit\", \"None\", \"Allow\")\n$acl.AddAccessRule($rule)\nSet-Acl -Path $ToolsPath -AclObject $acl",
        "ansible": "---\n- name: MA-3(4) Restrict Tool Use (Windows)\n  hosts: windows\n  tasks:\n    - name: Create maintenance tools group\n      win_group:\n        name: Maintenance_Tool_Users\n        state: present"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-3.5",
    "control_name": "Execution with Privilege",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-3",
    "stig_id": null,
    "is_technical": true,
    "official_text": "Monitor the use of maintenance tools that execute with increased privilege.",
    "intent": "Detect potential misuse of privileged maintenance tools through monitoring and logging.",
    "plain_english_explanation": "When maintenance tools run with elevated privileges (root/admin), monitor and log their execution. This helps detect unauthorized or malicious use of powerful maintenance utilities.",
    "ai_guidance": "MA-3.5 Execution with Privilege requires monitoring the use of maintenance tools with elevated privileges. Implementation includes: (1) Deploy Privileged Access Management (PAM) with session recording for all privileged maintenance activities, (2) Implement just-in-time privilege elevation requiring approval and time limits, (3) Use separate privileged accounts for maintenance distinct from regular administrative accounts, (4) Enable comprehensive logging of all commands executed with elevated privileges. Configure SIEM rules to alert on unusual privileged maintenance activities. Implement dual-control requirements for high-risk maintenance operations. Use privilege bracketing to minimize time spent with elevated access. Deploy endpoint detection and response (EDR) to monitor privileged process execution. Conduct regular reviews of privileged maintenance activities against authorized change tickets.",
    "implementation_guidance": "1. Enable auditing for privileged commands. 2. Configure SIEM alerts for unusual activity. 3. Implement session recording for maintenance. 4. Review privileged tool logs regularly. 5. Correlate with authorized change requests.",
    "related_controls": [
      "MA-3",
      "AU-2",
      "AU-12",
      "AC-6"
    ],
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-3(5): Monitor privileged maintenance tool execution\n# Configure auditd rules\n\ncat >> /etc/audit/rules.d/maintenance.rules << 'EOF'\n# Monitor sudo usage\n-w /var/log/sudo.log -p wa -k maintenance_privileged\n-w /etc/sudoers -p wa -k sudoers_changes\n-w /etc/sudoers.d/ -p wa -k sudoers_changes\n\n# Monitor privileged maintenance commands\n-a always,exit -F path=/usr/bin/systemctl -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged_maintenance\n-a always,exit -F path=/usr/sbin/fdisk -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged_maintenance\nEOF\n\naugenrules --load\nservice auditd restart",
        "ansible": "---\n- name: MA-3(5) Monitor Privileged Tool Execution\n  hosts: all\n  become: yes\n  tasks:\n    - name: Deploy audit rules for privileged maintenance\n      copy:\n        dest: /etc/audit/rules.d/maintenance.rules\n        content: |\n          -a always,exit -F path=/usr/bin/systemctl -F perm=x -F auid>=1000 -k privileged_maintenance\n          -a always,exit -F path=/usr/sbin/fdisk -F perm=x -F auid>=1000 -k privileged_maintenance\n        mode: '0640'\n      notify: reload auditd\n  \n  handlers:\n    - name: reload auditd\n      command: augenrules --load"
      },
      "windows": {
        "powershell": "# MA-3(5): Monitor privileged tool execution on Windows\n# Enable advanced audit policies\n\n# Enable process creation auditing\nauditpol /set /subcategory:\"Process Creation\" /success:enable /failure:enable\n\n# Enable command line in process creation events\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\" /v ProcessCreationIncludeCmdLine_Enabled /t REG_DWORD /d 1 /f\n\n# Enable PowerShell script block logging\nreg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\" /v EnableScriptBlockLogging /t REG_DWORD /d 1 /f\n\nWrite-Host \"Privileged execution monitoring enabled\"",
        "ansible": "---\n- name: MA-3(5) Monitor Privileged Execution (Windows)\n  hosts: windows\n  tasks:\n    - name: Enable process creation auditing\n      win_shell: auditpol /set /subcategory:\"Process Creation\" /success:enable /failure:enable\n    \n    - name: Enable command line logging\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\n        name: ProcessCreationIncludeCmdLine_Enabled\n        data: 1\n        type: dword"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-3.6",
    "control_name": "Software Updates and Patches",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-3",
    "stig_id": null,
    "is_technical": true,
    "official_text": "Inspect maintenance tools to ensure the latest software updates and patches are installed.",
    "intent": "Ensure maintenance tools are kept current to prevent exploitation of known vulnerabilities.",
    "plain_english_explanation": "Keep maintenance tools updated with the latest patches. Outdated tools may have security vulnerabilities that could be exploited during maintenance activities.",
    "ai_guidance": "MA-3.6 Software Updates and Patches requires inspecting maintenance software updates for authenticity before installation. Implementation involves: (1) Verify digital signatures on all maintenance software packages against trusted vendor certificates, (2) Compare package checksums against vendor-published values, (3) Test updates in isolated environments before production deployment, (4) Implement automated verification through package managers with signature checking enabled. Use secure, verified repositories for maintenance tool distribution. Deploy vulnerability scanning to verify patches address intended issues. Maintain rollback capabilities for failed or problematic updates. Implement change management processes requiring security review of maintenance tool updates. Consider using vendor-managed update services with integrity verification for critical maintenance applications.",
    "implementation_guidance": "1. Include maintenance tools in patch management. 2. Verify tool versions before each use. 3. Subscribe to vendor security advisories. 4. Automate tool updates where feasible. 5. Document tool version requirements.",
    "related_controls": [
      "MA-3",
      "SI-2",
      "CM-3",
      "RA-5"
    ],
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "source": "NIST SP 800-53 Rev 5",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-3(6): Verify maintenance tools are updated\n\nMAINTENANCE_PACKAGES=(\"util-linux\" \"systemd\" \"lvm2\" \"e2fsprogs\")\n\necho \"=== Maintenance Tool Update Check ===\"\n\nfor pkg in \"${MAINTENANCE_PACKAGES[@]}\"; do\n    # Check if updates available (RHEL/CentOS)\n    if command -v yum &> /dev/null; then\n        UPDATE=$(yum check-update \"$pkg\" 2>/dev/null | grep \"$pkg\")\n    # Debian/Ubuntu\n    elif command -v apt &> /dev/null; then\n        apt update -qq\n        UPDATE=$(apt list --upgradable 2>/dev/null | grep \"$pkg\")\n    fi\n    \n    if [ -n \"$UPDATE\" ]; then\n        echo \"UPDATE AVAILABLE: $pkg\"\n        echo \"  $UPDATE\"\n    else\n        echo \"CURRENT: $pkg\"\n    fi\ndone",
        "ansible": "---\n- name: MA-3(6) Check Tool Updates\n  hosts: all\n  become: yes\n  tasks:\n    - name: Check for maintenance tool updates (RHEL)\n      yum:\n        list: updates\n        update_cache: yes\n      register: updates\n      when: ansible_os_family == 'RedHat'\n    \n    - name: Update maintenance tools if needed\n      yum:\n        name:\n          - util-linux\n          - systemd\n        state: latest\n      when: ansible_os_family == 'RedHat'"
      },
      "windows": {
        "powershell": "# MA-3(6): Check maintenance tool updates on Windows\n# Verify Windows components and tools are current\n\n$results = @()\n\n# Check Windows version and updates\n$os = Get-WmiObject Win32_OperatingSystem\n$lastUpdate = (Get-HotFix | Sort-Object InstalledOn -Descending | Select-Object -First 1).InstalledOn\n\n$results += [PSCustomObject]@{\n    Component = \"Windows OS\"\n    Version = $os.Version\n    LastPatched = $lastUpdate\n}\n\n# Check if updates are pending\n$UpdateSession = New-Object -ComObject Microsoft.Update.Session\n$UpdateSearcher = $UpdateSession.CreateUpdateSearcher()\n$PendingUpdates = $UpdateSearcher.Search(\"IsInstalled=0\").Updates.Count\n\nWrite-Host \"=== Maintenance Tool Update Status ===\"\n$results | Format-Table -AutoSize\nWrite-Host \"Pending Windows Updates: $PendingUpdates\"",
        "ansible": "---\n- name: MA-3(6) Check Tool Updates (Windows)\n  hosts: windows\n  tasks:\n    - name: Check for pending updates\n      win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: searched\n      register: update_check\n    \n    - name: Report pending updates\n      debug:\n        msg: \"{{ update_check.found_update_count }} updates available\""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z"
    }
  },
  {
    "control_id": "MA-4",
    "control_name": "Nonlocal Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "RHEL-08-010020",
    "official_text": "Authorize, monitor, and control nonlocal maintenance and diagnostic activities; Allow the use of nonlocal maintenance and diagnostic tools only as consistent with organizational policy and documented in the security plan for the system; Employ strong authentication in the establishment of nonlocal maintenance and diagnostic sessions; Maintain records for nonlocal maintenance and diagnostic activities; and Terminate session and network connections when nonlocal maintenance is completed.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "Ensure remote system maintenance activities are properly controlled, authenticated, monitored, and terminated to prevent unauthorized access, data exfiltration, or malicious modifications through maintenance channels.",
    "ai_guidance": "MA-4 Nonlocal Maintenance controls remote maintenance sessions to protect organizational systems. Implementation requires: (1) Strong authentication using MFA for all remote maintenance access, (2) Encrypted communications using TLS 1.3 or IPsec VPN tunnels, (3) Session recording and audit logging of all remote maintenance activities, (4) Network segmentation isolating maintenance access paths from general traffic. Deploy jump servers/bastion hosts as controlled access points for remote maintenance. Implement session timeouts and automatic disconnection after inactivity. Use out-of-band management networks for critical system maintenance. Require explicit authorization and scheduling for remote maintenance windows. Deploy endpoint validation ensuring only authorized and compliant devices connect for maintenance. Monitor for unauthorized remote access tool installation.",
    "plain_english_explanation": "Nonlocal Maintenance requires organizations to securely manage remote system maintenance. This means only authorized personnel using approved, encrypted tools can perform remote maintenance. All sessions must be authenticated with strong credentials (preferably MFA), logged for audit purposes, and properly terminated when complete. Think of it as ensuring the digital equivalent of a locked service entrance with visitor logs and security escorts.",
    "example_implementation": "Configure SSH with key-based authentication and disable password authentication. Implement jump hosts/bastion servers for all remote maintenance access. Deploy session recording tools like ttyrec or Teleport. Configure automatic session termination after 15 minutes of inactivity. Maintain centralized logs of all remote access sessions.",
    "non_technical_guidance": "1. Develop a formal nonlocal maintenance policy defining approved tools, authentication requirements, and logging standards. 2. Maintain a list of authorized maintenance personnel and their access levels. 3. Require written authorization before any remote maintenance session. 4. Review remote maintenance logs weekly for anomalies. 5. Conduct quarterly audits of remote maintenance capabilities and access records. 6. Train maintenance personnel on secure remote access procedures.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "MA-4.1",
        "title": "Logging and Review",
        "official_text": "Log nonlocal maintenance and diagnostic sessions; and Review the records of the maintenance and diagnostic sessions."
      },
      {
        "id": "MA-4.2",
        "title": "Document Nonlocal Maintenance",
        "official_text": "[WITHDRAWN: Incorporated into MA-1 and MA-4]"
      },
      {
        "id": "MA-4.3",
        "title": "Comparable Security and Sanitization",
        "official_text": "Require that nonlocal maintenance and diagnostic services be performed from a system that implements a security capability comparable to the capability implemented on the system being serviced; or Remove the component to be serviced from the system prior to nonlocal maintenance or diagnostic services; sanitize the component (for organizational information); and after the service is performed, inspect and sanitize the component (for potentially malicious software) before reconnecting the component to the system."
      },
      {
        "id": "MA-4.4",
        "title": "Authentication and Separation of Maintenance Sessions",
        "official_text": "Protect nonlocal maintenance sessions by: (a) Employing [organization-defined authenticators that are replay resistant]; and (b) Separating the maintenance sessions from other network sessions with the system by either physically separated communications paths or logically separated communications paths."
      },
      {
        "id": "MA-4.5",
        "title": "Approvals and Notifications",
        "official_text": "Require the approval of each nonlocal maintenance session by [organization-defined personnel or roles]; and Notify [organization-defined personnel or roles] when nonlocal maintenance is planned."
      },
      {
        "id": "MA-4.6",
        "title": "Cryptographic Protection",
        "official_text": "Implement the following cryptographic mechanisms to protect the integrity and confidentiality of nonlocal maintenance and diagnostic communications: [organization-defined cryptographic mechanisms]."
      },
      {
        "id": "MA-4.7",
        "title": "Disconnect Verification",
        "official_text": "Verify session and network connection termination after the completion of nonlocal maintenance and diagnostic sessions."
      }
    ],
    "related_controls": [
      "AC-2",
      "AC-3",
      "AC-6",
      "AC-17",
      "AU-2",
      "AU-3",
      "IA-2",
      "IA-4",
      "IA-5",
      "IA-8",
      "MA-2",
      "MA-5",
      "PL-2",
      "SC-7",
      "SC-8",
      "SC-10",
      "SC-12",
      "SC-13"
    ],
    "supplemental_guidance": "Nonlocal maintenance is conducted by individuals communicating through an external network. Local maintenance is maintenance conducted by individuals who are physically present at the system location and not communicating across an external network. Authentication techniques used in the establishment of nonlocal maintenance and diagnostic sessions reflect the network access requirements in IA-2. Strong authentication requires authenticators that are resistant to replay attacks and employ multifactor authentication. Strong authenticators include PKI where certificates are stored on a token protected by a password, passphrase, or biometric.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4: Configure secure remote maintenance\necho '[MA-4] Configuring secure SSH for remote maintenance...'\n\n# Ensure SSH uses strong ciphers only\ngrep -q '^Ciphers' /etc/ssh/sshd_config || echo 'Ciphers aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr' >> /etc/ssh/sshd_config\n\n# Require key-based authentication\nsed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config\nsed -i 's/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/' /etc/ssh/sshd_config\n\n# Set session timeout (15 minutes)\nsed -i 's/^#*ClientAliveInterval.*/ClientAliveInterval 300/' /etc/ssh/sshd_config\nsed -i 's/^#*ClientAliveCountMax.*/ClientAliveCountMax 3/' /etc/ssh/sshd_config\n\n# Enable verbose logging\nsed -i 's/^#*LogLevel.*/LogLevel VERBOSE/' /etc/ssh/sshd_config\n\n# Restart SSH service\nsystemctl restart sshd\n\necho '[MA-4] SSH configuration complete. Verify /etc/ssh/sshd_config settings.'",
        "ansible": "---\n# MA-4: Nonlocal Maintenance - Ansible Playbook\n- name: Configure secure remote maintenance\n  hosts: all\n  become: yes\n  tasks:\n    - name: Configure SSH strong ciphers\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?Ciphers'\n        line: 'Ciphers aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr'\n        state: present\n\n    - name: Disable password authentication\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?PasswordAuthentication'\n        line: 'PasswordAuthentication no'\n        state: present\n\n    - name: Enable public key authentication\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?PubkeyAuthentication'\n        line: 'PubkeyAuthentication yes'\n        state: present\n\n    - name: Set client alive interval\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?ClientAliveInterval'\n        line: 'ClientAliveInterval 300'\n        state: present\n\n    - name: Set client alive count max\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?ClientAliveCountMax'\n        line: 'ClientAliveCountMax 3'\n        state: present\n\n    - name: Enable verbose SSH logging\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?LogLevel'\n        line: 'LogLevel VERBOSE'\n        state: present\n\n    - name: Restart sshd\n      service:\n        name: sshd\n        state: restarted"
      },
      "windows": {
        "powershell": "# MA-4: Configure Windows Remote Management Security\nWrite-Host '[MA-4] Configuring secure remote management...'\n\n# Enable WinRM with HTTPS only\nwinrm quickconfig -transport:https -force\n\n# Configure TLS 1.2 minimum\nNew-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server' -Name 'Enabled' -Value 1 -PropertyType 'DWord' -Force\nNew-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.0\\Server' -Name 'Enabled' -Value 0 -PropertyType 'DWord' -Force\nNew-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\Server' -Name 'Enabled' -Value 0 -PropertyType 'DWord' -Force\n\n# Configure Remote Desktop to require NLA\nSet-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -Name 'UserAuthentication' -Value 1\n\n# Enable auditing for remote connections\nauditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\nauditpol /set /subcategory:\"Special Logon\" /success:enable /failure:enable\n\nWrite-Host '[MA-4] Remote management security configured.'",
        "ansible": "---\n# MA-4: Nonlocal Maintenance - Windows Ansible Playbook\n- name: Configure secure remote maintenance for Windows\n  hosts: windows\n  tasks:\n    - name: Enable WinRM over HTTPS\n      win_shell: |\n        winrm quickconfig -transport:https -force\n\n    - name: Enable TLS 1.2\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server\n        name: Enabled\n        data: 1\n        type: dword\n\n    - name: Disable TLS 1.0\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.0\\Server\n        name: Enabled\n        data: 0\n        type: dword\n\n    - name: Require NLA for RDP\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\n        name: UserAuthentication\n        data: 1\n        type: dword\n\n    - name: Enable remote connection auditing\n      win_shell: |\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Special Logon\" /success:enable /failure:enable"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Implement secure remote access controls including SSH hardening, session management, and comprehensive logging."
    }
  },
  {
    "control_id": "MA-4.1",
    "control_name": "Logging and Review",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "stig_id": "RHEL-08-030010",
    "official_text": "Log nonlocal maintenance and diagnostic sessions; and Review the records of the maintenance and diagnostic sessions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Ensure all remote maintenance activities are logged with sufficient detail to reconstruct events, detect anomalies, and support forensic investigations, with regular review to identify unauthorized or suspicious maintenance activities.",
    "ai_guidance": "MA-4.1 Logging and Review requires comprehensive audit logging and security review of nonlocal maintenance sessions. Implementation includes: (1) Enable detailed session logging capturing commands, file transfers, and system changes, (2) Implement video/keystroke recording for privileged maintenance sessions, (3) Correlate maintenance logs with change tickets for authorization verification, (4) Deploy SIEM rules to detect anomalous maintenance activities. Configure centralized log aggregation with tamper-evident storage. Establish periodic review schedules for maintenance logs (daily for critical systems). Create automated alerts for maintenance outside approved windows or by unauthorized personnel. Retain maintenance logs per compliance requirements (typically 1-7 years). Implement log integrity verification using cryptographic hashing. Document review procedures and maintain evidence of completed reviews.",
    "plain_english_explanation": "This enhancement requires organizations to keep detailed records of all remote maintenance activities and regularly review them. Every remote session should be logged including who connected, when, what they did, and when they disconnected. These logs must be reviewed periodically to catch unauthorized activities or policy violations.",
    "example_implementation": "Deploy session recording tools like Teleport or ttyrec. Configure auditd to capture SSH session commands. Forward all maintenance logs to a SIEM. Create weekly review reports of remote access activities. Set up alerts for off-hours maintenance access.",
    "non_technical_guidance": "1. Define log retention requirements (minimum 1 year recommended). 2. Assign responsibility for weekly log reviews. 3. Create a checklist for log review including: unusual access times, failed authentication attempts, unauthorized commands, and extended session durations. 4. Document all findings and escalate anomalies to security team. 5. Retain review documentation for audit purposes.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-2",
      "AU-3",
      "AU-6",
      "AU-9",
      "AU-12",
      "MA-4",
      "SI-4"
    ],
    "supplemental_guidance": "Audit log content can include session date, time, duration, user identity, commands executed, and files accessed. This information can be used to understand maintenance activities performed and detect unauthorized actions.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4.1: Configure maintenance session logging\necho '[MA-4.1] Configuring comprehensive maintenance logging...'\n\n# Enable PAM session logging\necho 'session required pam_exec.so /usr/local/bin/log_session.sh' >> /etc/pam.d/sshd\n\n# Configure auditd for SSH logging\ncat >> /etc/audit/rules.d/maintenance.rules << 'EOF'\n# Log all SSH session activities\n-w /var/log/secure -p wa -k maintenance_log\n-w /var/log/auth.log -p wa -k maintenance_log\n-a always,exit -F arch=b64 -S execve -F euid=0 -k maintenance_commands\n-w /etc/ssh/sshd_config -p wa -k sshd_config_changes\nEOF\n\n# Reload audit rules\nauditctl -R /etc/audit/rules.d/maintenance.rules\n\n# Enable script session recording\nmkdir -p /var/log/session_recordings\nchmod 700 /var/log/session_recordings\n\necho '[MA-4.1] Maintenance logging configured. Review logs in /var/log/secure and /var/log/session_recordings'",
        "ansible": "---\n# MA-4.1: Logging and Review - Ansible Playbook\n- name: Configure maintenance session logging\n  hosts: all\n  become: yes\n  tasks:\n    - name: Create session recordings directory\n      file:\n        path: /var/log/session_recordings\n        state: directory\n        mode: '0700'\n        owner: root\n        group: root\n\n    - name: Configure auditd rules for maintenance logging\n      copy:\n        dest: /etc/audit/rules.d/maintenance.rules\n        content: |\n          # Log all SSH session activities\n          -w /var/log/secure -p wa -k maintenance_log\n          -w /var/log/auth.log -p wa -k maintenance_log\n          -a always,exit -F arch=b64 -S execve -F euid=0 -k maintenance_commands\n          -w /etc/ssh/sshd_config -p wa -k sshd_config_changes\n        mode: '0640'\n      notify: reload auditd\n\n    - name: Ensure auditd is running\n      service:\n        name: auditd\n        state: started\n        enabled: yes\n\n  handlers:\n    - name: reload auditd\n      command: auditctl -R /etc/audit/rules.d/maintenance.rules"
      },
      "windows": {
        "powershell": "# MA-4.1: Configure Windows maintenance session logging\nWrite-Host '[MA-4.1] Configuring maintenance session logging...'\n\n# Enable PowerShell script block logging\nNew-ItemProperty -Path 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging' -Name 'EnableScriptBlockLogging' -Value 1 -PropertyType 'DWord' -Force\n\n# Enable PowerShell transcription\n$transcriptPath = 'C:\\Logs\\PSTranscripts'\nNew-Item -Path $transcriptPath -ItemType Directory -Force\nNew-ItemProperty -Path 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription' -Name 'EnableTranscripting' -Value 1 -PropertyType 'DWord' -Force\nNew-ItemProperty -Path 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription' -Name 'OutputDirectory' -Value $transcriptPath -PropertyType 'String' -Force\n\n# Enable Windows Remote Management logging\nwevtutil sl Microsoft-Windows-WinRM/Operational /e:true\nwevtutil sl Microsoft-Windows-RemoteDesktopServices-RdpCoreTS/Operational /e:true\n\n# Enable advanced auditing for remote sessions\nauditpol /set /subcategory:\"Other Logon/Logoff Events\" /success:enable /failure:enable\nauditpol /set /subcategory:\"Process Creation\" /success:enable\n\nWrite-Host '[MA-4.1] Maintenance session logging configured. Review logs in Event Viewer and' $transcriptPath",
        "ansible": "---\n# MA-4.1: Logging and Review - Windows Ansible Playbook\n- name: Configure Windows maintenance session logging\n  hosts: windows\n  tasks:\n    - name: Create transcript log directory\n      win_file:\n        path: C:\\Logs\\PSTranscripts\n        state: directory\n\n    - name: Enable PowerShell script block logging\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n\n    - name: Enable PowerShell transcription\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\n        name: EnableTranscripting\n        data: 1\n        type: dword\n\n    - name: Set transcription output directory\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\n        name: OutputDirectory\n        data: C:\\Logs\\PSTranscripts\n        type: string\n\n    - name: Enable WinRM logging\n      win_shell: |\n        wevtutil sl Microsoft-Windows-WinRM/Operational /e:true\n        wevtutil sl Microsoft-Windows-RemoteDesktopServices-RdpCoreTS/Operational /e:true"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Configure comprehensive logging for remote maintenance sessions including command capture, session recording, and centralized log aggregation."
    }
  },
  {
    "control_id": "MA-4.2",
    "control_name": "Document Nonlocal Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "official_text": "[WITHDRAWN: Incorporated into MA-1 and MA-4]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control enhancement has been withdrawn and its requirements incorporated into the base MA-4 control and MA-1 (Policy and Procedures).",
    "ai_guidance": "MA-4.2 Document Nonlocal Maintenance requires maintaining records of all remote maintenance activities. Implementation involves: (1) Create standardized templates capturing maintenance personnel, systems accessed, activities performed, and duration, (2) Integrate maintenance documentation with IT service management platforms, (3) Require post-maintenance reports within 24 hours of session completion, (4) Link maintenance records to authorization tickets and system configuration changes. Document all tools used during remote sessions. Capture before/after configuration states for change verification. Include contact information for maintenance personnel and their organizations. Maintain documentation of security controls active during maintenance (encryption, authentication methods). Store maintenance records in centralized repositories with appropriate access controls and retention policies. Enable searchability for compliance audits and incident investigations.",
    "plain_english_explanation": "This enhancement has been withdrawn from NIST SP 800-53 Rev 5. The documentation requirements it previously addressed are now incorporated into the main MA-4 control (Nonlocal Maintenance) and MA-1 (Policy and Procedures). No separate implementation is required.",
    "example_implementation": "N/A - Control withdrawn. See MA-1 and MA-4 base control for documentation requirements.",
    "non_technical_guidance": "Review MA-1 and MA-4 controls for current documentation requirements related to nonlocal maintenance.",
    "is_technical": false,
    "withdrawn": true,
    "withdrawal_note": "Incorporated into MA-1 and MA-4",
    "enhancements": [],
    "related_controls": [
      "MA-1",
      "MA-4"
    ],
    "supplemental_guidance": "This control enhancement was withdrawn in NIST SP 800-53 Rev 5. Organizations implementing this control family should refer to MA-1 for policy documentation requirements and MA-4 for operational documentation requirements.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "withdrawn",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "NIST SP 800-53 Rev 5",
      "implementation_guidance": "This enhancement is withdrawn. Requirements incorporated into MA-1 and MA-4."
    }
  },
  {
    "control_id": "MA-4.3",
    "control_name": "Comparable Security and Sanitization",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "stig_id": "RHEL-08-010020",
    "official_text": "Require that nonlocal maintenance and diagnostic services be performed from a system that implements a security capability comparable to the capability implemented on the system being serviced; or Remove the component to be serviced from the system prior to nonlocal maintenance or diagnostic services; sanitize the component (for organizational information); and after the service is performed, inspect and sanitize the component (for potentially malicious software) before reconnecting the component to the system.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "intent": "Ensure that systems used for remote maintenance have equivalent security controls to prevent introducing vulnerabilities or malware, or alternatively require physical isolation and sanitization of components during maintenance.",
    "ai_guidance": "Implement comparable security requirements by: (1) maintaining a hardened jump host/bastion server for all maintenance activities with equivalent security controls to production systems, (2) requiring FIPS 140-2/3 validated cryptographic modules on maintenance systems, (3) enforcing endpoint security (EDR, antimalware) on maintenance workstations, (4) implementing network segmentation for maintenance traffic, (5) for component removal option: establish documented sanitization procedures including data wiping and malware scanning before/after maintenance.",
    "plain_english_explanation": "When performing remote maintenance, the computer used to connect must be just as secure as the system being maintained. If your production servers are hardened with specific security controls, the maintenance workstation needs equivalent protections. Alternatively, you can physically remove components for maintenance, wipe sensitive data first, and scan for malware before reinstalling.",
    "example_implementation": "Deploy dedicated maintenance workstations with full disk encryption, EDR agents, and FIPS-validated crypto. Use CIS-hardened bastion hosts for all remote access. For component maintenance: use NIST 800-88 sanitization procedures before removal and ClamAV/Malwarebytes scanning after return.",
    "non_technical_guidance": "1. Document security requirements for maintenance systems (encryption, antivirus, patching). 2. Maintain inventory of approved maintenance workstations. 3. For component removal: create chain of custody forms, document sanitization steps, require malware scanning before reconnection. 4. Audit maintenance workstation compliance quarterly. 5. Train maintenance personnel on security requirements.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "MA-4",
      "MP-6",
      "SC-3",
      "SC-7",
      "SI-3",
      "SI-7"
    ],
    "supplemental_guidance": "Comparable security capability on systems performing maintenance means the security controls on the system performing the maintenance are comparable to or exceed the controls on the system being maintained. This can include verification of the maintenance system configuration, vulnerability scanning, and ensuring current security patches.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4.3: Verify maintenance system security posture\necho '[MA-4.3] Verifying comparable security on maintenance system...'\n\n# Check FIPS mode\nif [ -f /proc/sys/crypto/fips_enabled ]; then\n    FIPS=$(cat /proc/sys/crypto/fips_enabled)\n    if [ \"$FIPS\" == \"1\" ]; then\n        echo '[PASS] FIPS mode enabled'\n    else\n        echo '[FAIL] FIPS mode not enabled - run: fips-mode-setup --enable'\n    fi\nelse\n    echo '[WARN] Cannot verify FIPS status'\nfi\n\n# Check for antivirus\nif command -v clamscan &> /dev/null; then\n    echo '[PASS] ClamAV installed'\n    freshclam --quiet\nelse\n    echo '[FAIL] ClamAV not installed - install for malware scanning'\nfi\n\n# Verify encryption\nif lsblk -o NAME,FSTYPE | grep -q 'crypto_LUKS\\|crypt'; then\n    echo '[PASS] Disk encryption detected'\nelse\n    echo '[FAIL] No disk encryption detected'\nfi\n\n# Check for recent security updates\nif [ -f /var/log/dnf.log ] || [ -f /var/log/yum.log ]; then\n    LAST_UPDATE=$(stat -c %Y /var/cache/dnf/*/repodata/* 2>/dev/null | sort -rn | head -1)\n    DAYS_AGO=$(( ($(date +%s) - $LAST_UPDATE) / 86400 ))\n    if [ $DAYS_AGO -lt 7 ]; then\n        echo \"[PASS] System updated within last 7 days\"\n    else\n        echo \"[WARN] Last update was $DAYS_AGO days ago\"\n    fi\nfi\n\necho '[MA-4.3] Security posture verification complete.'",
        "ansible": "---\n# MA-4.3: Comparable Security Verification Playbook\n- name: Verify maintenance system security posture\n  hosts: maintenance_systems\n  become: yes\n  tasks:\n    - name: Check FIPS mode status\n      command: cat /proc/sys/crypto/fips_enabled\n      register: fips_status\n      changed_when: false\n      failed_when: false\n\n    - name: Report FIPS status\n      debug:\n        msg: \"FIPS mode {{ 'ENABLED' if fips_status.stdout == '1' else 'DISABLED - Enable with fips-mode-setup --enable' }}\"\n\n    - name: Ensure ClamAV is installed\n      package:\n        name:\n          - clamav\n          - clamav-update\n        state: present\n\n    - name: Update ClamAV signatures\n      command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Check for disk encryption\n      shell: lsblk -o NAME,FSTYPE | grep -E 'crypto_LUKS|crypt'\n      register: encryption_check\n      changed_when: false\n      failed_when: false\n\n    - name: Report encryption status\n      debug:\n        msg: \"Disk encryption {{ 'DETECTED' if encryption_check.rc == 0 else 'NOT DETECTED - Configure LUKS encryption' }}\""
      },
      "windows": {
        "powershell": "# MA-4.3: Verify Windows maintenance system security posture\nWrite-Host '[MA-4.3] Verifying comparable security on maintenance system...'\n\n# Check BitLocker encryption status\n$bitlocker = Get-BitLockerVolume -MountPoint 'C:' -ErrorAction SilentlyContinue\nif ($bitlocker.ProtectionStatus -eq 'On') {\n    Write-Host '[PASS] BitLocker encryption enabled'\n} else {\n    Write-Host '[FAIL] BitLocker not enabled - Enable via: Enable-BitLocker -MountPoint C:'\n}\n\n# Check Windows Defender status\n$defender = Get-MpComputerStatus\nif ($defender.AntivirusEnabled) {\n    Write-Host '[PASS] Windows Defender enabled'\n    if ($defender.AntivirusSignatureAge -lt 7) {\n        Write-Host '[PASS] Antivirus signatures up to date'\n    } else {\n        Write-Host \"[WARN] Antivirus signatures are $($defender.AntivirusSignatureAge) days old\"\n    }\n} else {\n    Write-Host '[FAIL] Windows Defender not enabled'\n}\n\n# Check for pending updates\n$updates = (New-Object -ComObject Microsoft.Update.Session).CreateUpdateSearcher().Search('IsInstalled=0').Updates.Count\nif ($updates -eq 0) {\n    Write-Host '[PASS] No pending security updates'\n} else {\n    Write-Host \"[WARN] $updates pending updates - Install via Windows Update\"\n}\n\n# Check FIPS compliance\n$fips = (Get-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy' -Name Enabled -ErrorAction SilentlyContinue).Enabled\nif ($fips -eq 1) {\n    Write-Host '[PASS] FIPS mode enabled'\n} else {\n    Write-Host '[INFO] FIPS mode not enabled - Enable via Group Policy if required'\n}\n\nWrite-Host '[MA-4.3] Security posture verification complete.'",
        "ansible": "---\n# MA-4.3: Comparable Security - Windows Ansible Playbook\n- name: Verify Windows maintenance system security\n  hosts: windows_maintenance\n  tasks:\n    - name: Check BitLocker status\n      win_shell: |\n        $bl = Get-BitLockerVolume -MountPoint 'C:'\n        if ($bl.ProtectionStatus -eq 'On') { 'ENABLED' } else { 'DISABLED' }\n      register: bitlocker_status\n\n    - name: Report BitLocker status\n      debug:\n        msg: \"BitLocker: {{ bitlocker_status.stdout_lines[0] }}\"\n\n    - name: Check Windows Defender status\n      win_shell: |\n        $def = Get-MpComputerStatus\n        \"AV Enabled: $($def.AntivirusEnabled), Signatures Age: $($def.AntivirusSignatureAge) days\"\n      register: defender_status\n\n    - name: Report Defender status\n      debug:\n        msg: \"{{ defender_status.stdout_lines[0] }}\"\n\n    - name: Update Windows Defender signatures\n      win_shell: Update-MpSignature\n      changed_when: false"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Ensure maintenance systems have equivalent security controls including FIPS cryptography, disk encryption, up-to-date antivirus, and current security patches."
    }
  },
  {
    "control_id": "MA-4.4",
    "control_name": "Authentication and Separation of Maintenance Sessions",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "stig_id": "RHEL-08-020250",
    "official_text": "Protect nonlocal maintenance sessions by: (a) Employing authenticators that are replay resistant; and (b) Separating the maintenance sessions from other network sessions with the system by either physically separated communications paths or logically separated communications paths.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Ensure remote maintenance sessions use replay-resistant authentication (preventing credential reuse attacks) and are isolated from regular network traffic to prevent unauthorized access or lateral movement.",
    "ai_guidance": "MA-4.4 Authentication and Separation of Maintenance Sessions requires strong authentication and session isolation for nonlocal maintenance. Implementation includes: (1) Implement multi-factor authentication combining something you know, have, and are, (2) Use separate network segments (VLANs) for maintenance traffic, (3) Deploy unique session identifiers preventing session hijacking, (4) Implement mutual authentication between maintenance endpoints and target systems. Configure session binding to prevent man-in-the-middle attacks. Use certificate-based authentication for automated maintenance tools. Implement network access control (NAC) verifying device health before allowing maintenance connections. Deploy protocol inspection to ensure only authorized maintenance protocols traverse maintenance networks. Time-limit maintenance sessions with automatic disconnection. Monitor for session anomalies indicating compromise.",
    "plain_english_explanation": "Remote maintenance sessions need two key protections: First, authentication that cannot be replayed (intercepted credentials cannot be reused by attackers). Second, network separation so maintenance traffic is isolated from regular business traffic. This is like having a separate service entrance with special keys that expire immediately after use.",
    "example_implementation": "Deploy SSH with certificate authentication via Teleport or HashiCorp Vault. Implement dedicated management VLAN (e.g., 10.99.0.0/24) for all administrative access. Route maintenance traffic through dedicated VPN tunnels. Use out-of-band management for hardware (iLO/iDRAC on isolated network).",
    "non_technical_guidance": "1. Document network architecture showing maintenance traffic separation. 2. Define authentication requirements (certificate-based, hardware tokens). 3. Create network diagrams showing maintenance VLANs/segments. 4. Test authentication replay resistance during penetration tests. 5. Audit network segmentation quarterly.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AC-17",
      "IA-2",
      "IA-5",
      "MA-4",
      "SC-7",
      "SC-8",
      "SC-13"
    ],
    "supplemental_guidance": "Replay resistant authenticators include cryptographic protocols with ephemeral keys, time-based tokens, and challenge-response mechanisms. Network separation can be achieved through VLANs, VPNs, or physically separate networks dedicated to maintenance activities.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4.4: Configure replay-resistant auth and session separation\necho '[MA-4.4] Configuring replay-resistant authentication...'\n\n# Configure SSH for certificate authentication\nif [ ! -d /etc/ssh/ca ]; then\n    mkdir -p /etc/ssh/ca\n    echo '[INFO] SSH CA directory created - configure certificate authority'\nfi\n\n# Enable SSH certificate authentication\ngrep -q '^TrustedUserCAKeys' /etc/ssh/sshd_config || echo 'TrustedUserCAKeys /etc/ssh/ca/user_ca.pub' >> /etc/ssh/sshd_config\n\n# Disable password authentication (require keys/certs)\nsed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config\nsed -i 's/^#*ChallengeResponseAuthentication.*/ChallengeResponseAuthentication no/' /etc/ssh/sshd_config\n\n# Enable strict host key checking\nsed -i 's/^#*StrictHostKeyChecking.*/StrictHostKeyChecking yes/' /etc/ssh/ssh_config\n\n# Configure GSSAPI for Kerberos (replay-resistant)\nsed -i 's/^#*GSSAPIAuthentication.*/GSSAPIAuthentication yes/' /etc/ssh/sshd_config\nsed -i 's/^#*GSSAPICleanupCredentials.*/GSSAPICleanupCredentials yes/' /etc/ssh/sshd_config\n\n# Network separation - tag maintenance traffic (example)\necho '[INFO] For network separation, configure:'\necho '  - Dedicated management VLAN (e.g., VLAN 999)'\necho '  - Firewall rules restricting maintenance access'\necho '  - VPN tunnel for remote maintenance'\n\nsystemctl restart sshd\necho '[MA-4.4] Replay-resistant authentication configured.'",
        "ansible": "---\n# MA-4.4: Authentication and Separation - Ansible Playbook\n- name: Configure replay-resistant authentication\n  hosts: all\n  become: yes\n  tasks:\n    - name: Create SSH CA directory\n      file:\n        path: /etc/ssh/ca\n        state: directory\n        mode: '0755'\n\n    - name: Configure SSH certificate authentication\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?TrustedUserCAKeys'\n        line: 'TrustedUserCAKeys /etc/ssh/ca/user_ca.pub'\n        state: present\n\n    - name: Disable password authentication\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?PasswordAuthentication'\n        line: 'PasswordAuthentication no'\n        state: present\n\n    - name: Enable GSSAPI authentication\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?GSSAPIAuthentication'\n        line: 'GSSAPIAuthentication yes'\n        state: present\n\n    - name: Enable GSSAPI credential cleanup\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?GSSAPICleanupCredentials'\n        line: 'GSSAPICleanupCredentials yes'\n        state: present\n\n    - name: Restart SSH service\n      service:\n        name: sshd\n        state: restarted"
      },
      "windows": {
        "powershell": "# MA-4.4: Configure replay-resistant auth and session separation\nWrite-Host '[MA-4.4] Configuring replay-resistant authentication...'\n\n# Enable Kerberos authentication for WinRM\nSet-Item WSMan:\\localhost\\Service\\Auth\\Kerberos -Value $true\n\n# Disable Basic authentication (replay vulnerable)\nSet-Item WSMan:\\localhost\\Service\\Auth\\Basic -Value $false\n\n# Enable CredSSP with latest protocol\nEnable-WSManCredSSP -Role Server -Force\n\n# Configure NLA requirement for RDP (replay resistant)\nSet-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -Name 'UserAuthentication' -Value 1\nSet-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -Name 'SecurityLayer' -Value 2\n\n# Enable Windows Firewall rules for management VLAN\n# Example: Restrict RDP to management subnet only\n$mgmtSubnet = '10.99.0.0/24'  # Customize for your environment\nNew-NetFirewallRule -DisplayName 'RDP - Management VLAN Only' -Direction Inbound -Protocol TCP -LocalPort 3389 -RemoteAddress $mgmtSubnet -Action Allow -Profile Domain\nSet-NetFirewallRule -DisplayName 'Remote Desktop - User Mode (TCP-In)' -Enabled False\n\nWrite-Host '[MA-4.4] Replay-resistant authentication configured.'\nWrite-Host '[INFO] Configure dedicated management VLAN and update firewall rules.'",
        "ansible": "---\n# MA-4.4: Authentication and Separation - Windows Playbook\n- name: Configure Windows replay-resistant authentication\n  hosts: windows\n  tasks:\n    - name: Enable Kerberos authentication for WinRM\n      win_shell: Set-Item WSMan:\\localhost\\Service\\Auth\\Kerberos -Value $true\n\n    - name: Disable Basic authentication\n      win_shell: Set-Item WSMan:\\localhost\\Service\\Auth\\Basic -Value $false\n\n    - name: Require NLA for RDP\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\n        name: UserAuthentication\n        data: 1\n        type: dword\n\n    - name: Set RDP security layer to TLS\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\n        name: SecurityLayer\n        data: 2\n        type: dword"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Implement certificate-based or Kerberos authentication for replay resistance. Configure dedicated VLANs or VPN tunnels for maintenance session separation."
    }
  },
  {
    "control_id": "MA-4.5",
    "control_name": "Approvals and Notifications",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "official_text": "Require the approval of each nonlocal maintenance session by [organization-defined personnel or roles]; and Notify [organization-defined personnel or roles] when nonlocal maintenance is planned.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Establish formal approval processes and notification mechanisms for remote maintenance to ensure authorized personnel are aware of and have approved all maintenance activities before they occur.",
    "ai_guidance": "Implement approval and notification workflows by: (1) integrating maintenance requests with ticketing systems (ServiceNow, Jira), (2) requiring manager/security approval before maintenance access is granted, (3) implementing just-in-time (JIT) access with approval workflows (Azure PIM, HashiCorp Boundary), (4) configuring automated notifications to security operations and system owners, (5) maintaining audit trail of all approvals and notifications, and (6) implementing emergency access procedures with post-hoc approval.",
    "plain_english_explanation": "Before anyone can perform remote maintenance, they must get formal approval from designated personnel (typically system owner and security). Additionally, relevant stakeholders must be notified when maintenance is planned. This is like requiring a work order and notifying building security before any contractor work.",
    "example_implementation": "Integrate SSH access with Teleport or HashiCorp Boundary requiring manager approval. Configure email/Slack notifications to security team for all approved maintenance windows. Use ServiceNow for maintenance request tracking with mandatory approval workflow.",
    "non_technical_guidance": "1. Define approval authority (who can approve maintenance). 2. Create maintenance request forms capturing: purpose, systems affected, personnel, timeframe. 3. Establish notification list (security team, system owners, change management). 4. Document approval process in maintenance policy. 5. Retain all approval records for audit. 6. Define emergency maintenance procedures with expedited approval.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "CM-3",
      "CM-4",
      "MA-4",
      "MA-5",
      "PE-3"
    ],
    "supplemental_guidance": "Approval may be required from system owners, information security personnel, or organizational management depending on the sensitivity of the system and nature of the maintenance. Notifications should include security operations, system administrators, and relevant management.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4.5: Maintenance approval notification script\necho '[MA-4.5] Maintenance Approval and Notification System'\n\n# Example: Create maintenance request log\nMAINT_LOG='/var/log/maintenance_requests.log'\n\nlog_maintenance_request() {\n    local REQUESTER=\"$1\"\n    local SYSTEM=\"$2\"\n    local PURPOSE=\"$3\"\n    local APPROVER=\"$4\"\n    \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') | Request: $REQUESTER | System: $SYSTEM | Purpose: $PURPOSE | Approver: $APPROVER\" >> $MAINT_LOG\n    \n    # Send notification (example with mail)\n    echo \"Maintenance Request Submitted:\\nRequester: $REQUESTER\\nSystem: $SYSTEM\\nPurpose: $PURPOSE\\nAwaiting approval from: $APPROVER\" | \\\n        mail -s \"[MAINTENANCE REQUEST] $SYSTEM\" security-team@example.com\n}\n\n# Example usage\n# log_maintenance_request \"jsmith\" \"webserver01\" \"Patch security vulnerability\" \"manager@example.com\"\n\necho '[INFO] Configure mail relay and notification recipients'\necho '[INFO] Integrate with ticketing system (ServiceNow API, Jira webhooks)'",
        "ansible": "---\n# MA-4.5: Approvals and Notifications - Ansible Playbook\n- name: Configure maintenance approval system\n  hosts: management\n  become: yes\n  tasks:\n    - name: Create maintenance request log directory\n      file:\n        path: /var/log/maintenance\n        state: directory\n        mode: '0750'\n        owner: root\n        group: security\n\n    - name: Deploy maintenance request script\n      copy:\n        dest: /usr/local/bin/request_maintenance.sh\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          # Maintenance Request Submission\n          MAINT_LOG='/var/log/maintenance/requests.log'\n          NOTIFY_EMAIL='security-team@example.com'\n          \n          echo \"$(date '+%Y-%m-%d %H:%M:%S') | Requester: $1 | System: $2 | Purpose: $3\" >> $MAINT_LOG\n          echo \"Maintenance request logged. Awaiting approval.\"\n\n    - name: Configure cron job for pending request reminders\n      cron:\n        name: 'Maintenance request reminder'\n        hour: '9'\n        minute: '0'\n        job: '/usr/local/bin/check_pending_requests.sh'\n        user: root"
      },
      "windows": {
        "powershell": "# MA-4.5: Maintenance approval and notification system\nWrite-Host '[MA-4.5] Configuring maintenance approval notifications...'\n\n# Create maintenance request function\nfunction Request-Maintenance {\n    param(\n        [string]$Requester,\n        [string]$TargetSystem,\n        [string]$Purpose,\n        [string]$ApproverEmail\n    )\n    \n    $logPath = 'C:\\Logs\\MaintenanceRequests.csv'\n    $timestamp = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'\n    \n    # Log the request\n    $entry = [PSCustomObject]@{\n        Timestamp = $timestamp\n        Requester = $Requester\n        System = $TargetSystem\n        Purpose = $Purpose\n        Approver = $ApproverEmail\n        Status = 'Pending'\n    }\n    $entry | Export-Csv -Path $logPath -Append -NoTypeInformation\n    \n    # Send notification email\n    $smtpServer = 'smtp.example.com'  # Configure for your environment\n    $subject = \"[MAINTENANCE REQUEST] $TargetSystem\"\n    $body = @\"\nMaintenance Request Submitted\n\nRequester: $Requester\nTarget System: $TargetSystem\nPurpose: $Purpose\nTimestamp: $timestamp\n\nPlease approve or deny this request.\n\"@\n    \n    # Uncomment when SMTP is configured\n    # Send-MailMessage -From 'maintenance@example.com' -To $ApproverEmail -Subject $subject -Body $body -SmtpServer $smtpServer\n    \n    Write-Host \"Request logged. Notification sent to $ApproverEmail\"\n}\n\n# Create log directory\nNew-Item -Path 'C:\\Logs' -ItemType Directory -Force\n\nWrite-Host '[MA-4.5] Maintenance approval system configured.'\nWrite-Host '[INFO] Configure SMTP server and approval workflow integration.'",
        "ansible": "---\n# MA-4.5: Approvals and Notifications - Windows Playbook\n- name: Configure Windows maintenance approval system\n  hosts: windows\n  tasks:\n    - name: Create maintenance logs directory\n      win_file:\n        path: C:\\Logs\\Maintenance\n        state: directory\n\n    - name: Deploy maintenance request PowerShell module\n      win_copy:\n        dest: C:\\Scripts\\MaintenanceRequest.psm1\n        content: |\n          function Request-Maintenance {\n              param(\n                  [string]$Requester,\n                  [string]$TargetSystem,\n                  [string]$Purpose,\n                  [string]$ApproverEmail\n              )\n              $logPath = 'C:\\Logs\\Maintenance\\Requests.csv'\n              $entry = [PSCustomObject]@{\n                  Timestamp = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'\n                  Requester = $Requester\n                  System = $TargetSystem\n                  Purpose = $Purpose\n                  Approver = $ApproverEmail\n                  Status = 'Pending'\n              }\n              $entry | Export-Csv -Path $logPath -Append -NoTypeInformation\n          }"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Implement ticketing/workflow system integration for maintenance approvals. Configure automated notifications to security team and system owners."
    }
  },
  {
    "control_id": "MA-4.6",
    "control_name": "Cryptographic Protection",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "stig_id": "RHEL-08-010020",
    "official_text": "Implement the following cryptographic mechanisms to protect the integrity and confidentiality of nonlocal maintenance and diagnostic communications: [organization-defined cryptographic mechanisms].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Protect remote maintenance communications from eavesdropping and tampering by implementing strong, validated cryptographic mechanisms for all maintenance traffic.",
    "ai_guidance": "MA-4.6 Cryptographic Protection requires strong encryption for all nonlocal maintenance communications. Implementation involves: (1) Require TLS 1.3 or IPsec VPN for all remote maintenance connections, (2) Use FIPS 140-2/3 validated cryptographic modules for federal systems, (3) Implement certificate-based mutual authentication, (4) Configure cipher suites to use AES-256-GCM or ChaCha20-Poly1305. Deploy network monitoring to detect unencrypted maintenance traffic. Disable legacy protocols (SSLv3, TLS 1.0/1.1) that have known vulnerabilities. Implement perfect forward secrecy (PFS) using ECDHE key exchange. Manage cryptographic keys using HSMs or secure key management systems. Regularly rotate encryption keys per organizational crypto policy. Monitor certificate expiration and automate renewal processes. Document cryptographic configurations and maintain compliance evidence.",
    "plain_english_explanation": "All remote maintenance communications must be encrypted using strong, government-approved cryptography. This means using protocols like SSH with modern ciphers, TLS 1.2+, or VPNs with strong encryption. The goal is to ensure that if someone intercepts maintenance traffic, they cannot read or modify it.",
    "example_implementation": "Enable FIPS mode on RHEL/CentOS systems. Configure SSH with only FIPS-approved algorithms. Implement TLS 1.3 for all HTTPS management interfaces. Deploy IPsec VPN for site-to-site maintenance access. Disable all legacy protocols.",
    "non_technical_guidance": "1. Document approved cryptographic algorithms for your environment. 2. Require FIPS 140-2/3 validation for high-impact systems. 3. Audit cryptographic configurations quarterly. 4. Monitor for use of deprecated protocols. 5. Update cryptographic standards as vulnerabilities are discovered.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "MA-4",
      "SC-8",
      "SC-12",
      "SC-13",
      "SC-23"
    ],
    "supplemental_guidance": "Cryptographic mechanisms include FIPS-validated encryption modules for SSH, TLS/HTTPS, IPsec VPNs, and other secure transport protocols. Organizations should select algorithms consistent with organizational security policies and federal guidelines.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4.6: Configure FIPS-compliant cryptography for maintenance\necho '[MA-4.6] Configuring cryptographic protection...'\n\n# Enable FIPS mode (requires reboot)\nif [ ! -f /proc/sys/crypto/fips_enabled ] || [ \"$(cat /proc/sys/crypto/fips_enabled)\" != \"1\" ]; then\n    echo '[INFO] Enabling FIPS mode...'\n    fips-mode-setup --enable\n    echo '[WARN] Reboot required to activate FIPS mode'\nelse\n    echo '[PASS] FIPS mode already enabled'\nfi\n\n# Configure SSH with FIPS-approved ciphers only\ncat > /etc/ssh/sshd_config.d/fips-crypto.conf << 'EOF'\n# MA-4.6 FIPS-compliant SSH cryptography\nCiphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\nKexAlgorithms ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\nHostKeyAlgorithms ecdsa-sha2-nistp521,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256,rsa-sha2-512,rsa-sha2-256\nEOF\n\n# Configure system-wide crypto policy\nif command -v update-crypto-policies &> /dev/null; then\n    update-crypto-policies --set FIPS\n    echo '[PASS] Crypto policy set to FIPS'\nfi\n\n# Disable weak SSH ciphers in client config\ncat > /etc/ssh/ssh_config.d/fips-crypto.conf << 'EOF'\nHost *\n    Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr\n    MACs hmac-sha2-512,hmac-sha2-256\nEOF\n\nsystemctl restart sshd\necho '[MA-4.6] Cryptographic protection configured.'",
        "ansible": "---\n# MA-4.6: Cryptographic Protection - Ansible Playbook\n- name: Configure FIPS-compliant cryptography\n  hosts: all\n  become: yes\n  tasks:\n    - name: Check if FIPS mode is enabled\n      command: cat /proc/sys/crypto/fips_enabled\n      register: fips_status\n      changed_when: false\n      failed_when: false\n\n    - name: Enable FIPS mode if not enabled\n      command: fips-mode-setup --enable\n      when: fips_status.stdout != '1'\n      notify: reboot required\n\n    - name: Configure SSH FIPS-compliant ciphers\n      copy:\n        dest: /etc/ssh/sshd_config.d/fips-crypto.conf\n        content: |\n          # MA-4.6 FIPS-compliant SSH cryptography\n          Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n          MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n          KexAlgorithms ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\n          HostKeyAlgorithms ecdsa-sha2-nistp521,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256,rsa-sha2-512,rsa-sha2-256\n        mode: '0644'\n      notify: restart sshd\n\n    - name: Set crypto policy to FIPS\n      command: update-crypto-policies --set FIPS\n      when: ansible_os_family == 'RedHat'\n\n  handlers:\n    - name: restart sshd\n      service:\n        name: sshd\n        state: restarted\n\n    - name: reboot required\n      debug:\n        msg: 'REBOOT REQUIRED to activate FIPS mode'"
      },
      "windows": {
        "powershell": "# MA-4.6: Configure Windows cryptographic protection\nWrite-Host '[MA-4.6] Configuring cryptographic protection...'\n\n# Enable FIPS Algorithm Policy\nNew-Item -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy' -Force | Out-Null\nSet-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy' -Name 'Enabled' -Value 1 -Type DWord\nWrite-Host '[INFO] FIPS Algorithm Policy enabled (reboot required)'\n\n# Configure TLS settings - Enable TLS 1.2/1.3, Disable older versions\n$protocols = @('SSL 2.0', 'SSL 3.0', 'TLS 1.0', 'TLS 1.1')\nforeach ($proto in $protocols) {\n    $serverPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\$proto\\Server\"\n    $clientPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\$proto\\Client\"\n    \n    New-Item -Path $serverPath -Force | Out-Null\n    New-Item -Path $clientPath -Force | Out-Null\n    \n    Set-ItemProperty -Path $serverPath -Name 'Enabled' -Value 0 -Type DWord\n    Set-ItemProperty -Path $serverPath -Name 'DisabledByDefault' -Value 1 -Type DWord\n    Set-ItemProperty -Path $clientPath -Name 'Enabled' -Value 0 -Type DWord\n    Set-ItemProperty -Path $clientPath -Name 'DisabledByDefault' -Value 1 -Type DWord\n}\nWrite-Host '[PASS] Disabled legacy protocols (SSL 2.0, 3.0, TLS 1.0, 1.1)'\n\n# Enable TLS 1.2\n$tls12Server = 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server'\n$tls12Client = 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client'\nNew-Item -Path $tls12Server -Force | Out-Null\nNew-Item -Path $tls12Client -Force | Out-Null\nSet-ItemProperty -Path $tls12Server -Name 'Enabled' -Value 1 -Type DWord\nSet-ItemProperty -Path $tls12Client -Name 'Enabled' -Value 1 -Type DWord\nWrite-Host '[PASS] TLS 1.2 enabled'\n\n# Disable weak ciphers\n$weakCiphers = @('DES 56/56', 'RC2 40/128', 'RC2 56/128', 'RC4 40/128', 'RC4 56/128', 'RC4 64/128', 'RC4 128/128', 'Triple DES 168')\nforeach ($cipher in $weakCiphers) {\n    $cipherPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Ciphers\\$cipher\"\n    New-Item -Path $cipherPath -Force | Out-Null\n    Set-ItemProperty -Path $cipherPath -Name 'Enabled' -Value 0 -Type DWord\n}\nWrite-Host '[PASS] Weak ciphers disabled'\n\nWrite-Host '[MA-4.6] Cryptographic protection configured. REBOOT REQUIRED.'",
        "ansible": "---\n# MA-4.6: Cryptographic Protection - Windows Playbook\n- name: Configure Windows cryptographic protection\n  hosts: windows\n  tasks:\n    - name: Enable FIPS Algorithm Policy\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy\n        name: Enabled\n        data: 1\n        type: dword\n\n    - name: Disable TLS 1.0 Server\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.0\\Server\n        name: Enabled\n        data: 0\n        type: dword\n\n    - name: Disable TLS 1.1 Server\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\Server\n        name: Enabled\n        data: 0\n        type: dword\n\n    - name: Enable TLS 1.2 Server\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server\n        name: Enabled\n        data: 1\n        type: dword\n\n    - name: Enable TLS 1.2 Client\n      win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\n        name: Enabled\n        data: 1\n        type: dword"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "stig_references": [
        "RHEL-08-010020",
        "RHEL-08-040159",
        "RHEL-08-040160"
      ],
      "implementation_guidance": "Enable FIPS mode and configure SSH/TLS with only approved ciphers. Disable all deprecated protocols and weak cryptographic algorithms."
    }
  },
  {
    "control_id": "MA-4.7",
    "control_name": "Disconnect Verification",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-4",
    "stig_id": "RHEL-08-010200",
    "official_text": "Verify session and network connection termination after the completion of nonlocal maintenance and diagnostic sessions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Ensure that remote maintenance sessions are properly terminated to prevent unauthorized residual access, session hijacking, or abandoned connections that could be exploited.",
    "ai_guidance": "MA-4.7 Disconnect Verification requires personnel performing nonlocal maintenance to verify session termination. Implementation includes: (1) Implement automated session verification scripts that confirm complete disconnection, (2) Use out-of-band confirmation (phone call, separate communication channel) for critical system maintenance, (3) Configure systems to display active sessions allowing verification of termination, (4) Deploy network monitoring to confirm session teardown. Implement automatic session termination after maintenance window expiration. Configure systems to kill orphaned sessions after timeout periods. Use session management tools that provide clear indication of connection status. Require maintenance personnel to document session termination in maintenance logs. Deploy intrusion detection to alert on maintenance sessions exceeding authorized durations. Test disconnect verification procedures periodically.",
    "plain_english_explanation": "After remote maintenance is complete, you must verify that the session actually ended - no lingering connections that could be exploited. This means checking that SSH sessions are closed, VPN tunnels are terminated, and no zombie processes remain. It is like ensuring a contractor has actually left the building and did not leave any doors propped open.",
    "example_implementation": "Configure SSH ClientAliveInterval/ClientAliveCountMax for automatic timeout. Deploy monitoring scripts to detect orphaned sessions. Use Teleport or similar tools with automatic session termination. Alert on sessions exceeding maintenance window.",
    "non_technical_guidance": "1. Define maximum session duration for maintenance activities. 2. Require maintenance personnel to confirm session closure. 3. Implement post-maintenance checklist including session verification. 4. Review session logs after each maintenance window. 5. Alert security team for sessions exceeding time limits.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AC-12",
      "MA-4",
      "SC-10",
      "SC-23"
    ],
    "supplemental_guidance": "Disconnect verification helps prevent attackers from maintaining persistent access through forgotten or abandoned maintenance sessions. Automated tools can assist in detecting sessions that have not been properly terminated.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-4.7: Verify and enforce maintenance session termination\necho '[MA-4.7] Configuring disconnect verification...'\n\n# Configure SSH session timeout\nsed -i 's/^#*ClientAliveInterval.*/ClientAliveInterval 300/' /etc/ssh/sshd_config\nsed -i 's/^#*ClientAliveCountMax.*/ClientAliveCountMax 3/' /etc/ssh/sshd_config\necho '[PASS] SSH session timeout configured (15 minutes)'\n\n# Configure shell timeout\ncat >> /etc/profile.d/session-timeout.sh << 'EOF'\n# MA-4.7 Session timeout for maintenance\nexport TMOUT=900  # 15 minute timeout\nreadonly TMOUT\nEOF\necho '[PASS] Shell TMOUT configured'\n\n# Create session monitoring script\ncat > /usr/local/bin/verify_disconnections.sh << 'SCRIPT'\n#!/bin/bash\n# Check for orphaned SSH sessions\necho \"[$(date)] Checking for orphaned maintenance sessions...\"\n\n# List all SSH sessions\nSESSIONS=$(who | grep pts | awk '{print $1, $2, $3, $4}')\n\nif [ -n \"$SESSIONS\" ]; then\n    echo \"Active sessions:\"\n    echo \"$SESSIONS\"\n    \n    # Check for idle sessions over 30 minutes\n    for TTY in $(who | grep pts | awk '{print $2}'); do\n        IDLE=$(stat --format=%Y /dev/$TTY 2>/dev/null || echo 0)\n        NOW=$(date +%s)\n        IDLE_MINS=$(( ($NOW - $IDLE) / 60 ))\n        \n        if [ $IDLE_MINS -gt 30 ]; then\n            echo \"[WARN] Session on $TTY idle for $IDLE_MINS minutes\"\n            # Optionally kill: pkill -9 -t $TTY\n        fi\n    done\nelse\n    echo \"No active remote sessions\"\nfi\nSCRIPT\nchmod +x /usr/local/bin/verify_disconnections.sh\n\n# Add to cron for periodic checking\necho '*/5 * * * * root /usr/local/bin/verify_disconnections.sh >> /var/log/session_verify.log 2>&1' > /etc/cron.d/session-verify\n\nsystemctl restart sshd\necho '[MA-4.7] Disconnect verification configured.'",
        "ansible": "---\n# MA-4.7: Disconnect Verification - Ansible Playbook\n- name: Configure disconnect verification\n  hosts: all\n  become: yes\n  tasks:\n    - name: Configure SSH client alive interval\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?ClientAliveInterval'\n        line: 'ClientAliveInterval 300'\n        state: present\n\n    - name: Configure SSH client alive count max\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: '^#?ClientAliveCountMax'\n        line: 'ClientAliveCountMax 3'\n        state: present\n\n    - name: Configure shell session timeout\n      copy:\n        dest: /etc/profile.d/session-timeout.sh\n        content: |\n          # MA-4.7 Session timeout for maintenance\n          export TMOUT=900\n          readonly TMOUT\n        mode: '0644'\n\n    - name: Deploy session verification script\n      copy:\n        dest: /usr/local/bin/verify_disconnections.sh\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          echo \"[$(date)] Checking for orphaned sessions...\"\n          who | grep pts\n          # Add alerting logic here\n\n    - name: Configure session verification cron job\n      cron:\n        name: 'Verify session disconnections'\n        minute: '*/5'\n        job: '/usr/local/bin/verify_disconnections.sh >> /var/log/session_verify.log 2>&1'\n\n    - name: Restart sshd\n      service:\n        name: sshd\n        state: restarted"
      },
      "windows": {
        "powershell": "# MA-4.7: Verify and enforce maintenance session termination\nWrite-Host '[MA-4.7] Configuring disconnect verification...'\n\n# Configure RDP session timeout (15 minutes idle)\n$rdpPath = 'HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services'\nNew-Item -Path $rdpPath -Force | Out-Null\nSet-ItemProperty -Path $rdpPath -Name 'MaxIdleTime' -Value 900000 -Type DWord  # 15 min in ms\nSet-ItemProperty -Path $rdpPath -Name 'MaxDisconnectionTime' -Value 60000 -Type DWord  # 1 min disconnect\nSet-ItemProperty -Path $rdpPath -Name 'fResetBroken' -Value 1 -Type DWord  # Reset broken connections\nWrite-Host '[PASS] RDP session timeouts configured'\n\n# Configure WinRM session timeout\nSet-Item WSMan:\\localhost\\Shell\\IdleTimeout -Value 900000  # 15 minutes\nWrite-Host '[PASS] WinRM idle timeout configured'\n\n# Create session monitoring script\n$monitorScript = @'\nParam([int]$MaxIdleMinutes = 30)\n\n# Get all RDP sessions\n$sessions = quser 2>$null | Select-Object -Skip 1 | ForEach-Object {\n    $parts = $_ -split '\\s{2,}'\n    [PSCustomObject]@{\n        Username = $parts[0].TrimStart('>')\n        SessionName = $parts[1]\n        ID = $parts[2]\n        State = $parts[3]\n        IdleTime = $parts[4]\n    }\n}\n\nforeach ($session in $sessions) {\n    if ($session.State -eq 'Disc') {\n        Write-Host \"[WARN] Disconnected session found: $($session.Username) (ID: $($session.ID))\"\n        # logoff $session.ID  # Uncomment to force logoff\n    }\n}\n\n# Log active sessions\n$sessions | Where-Object { $_.State -eq 'Active' } | ForEach-Object {\n    Write-Host \"Active: $($_.Username) on $($_.SessionName)\"\n}\n'@\n\n$monitorScript | Out-File -FilePath 'C:\\Scripts\\Verify-Disconnections.ps1' -Force\n\n# Create scheduled task for session monitoring\n$action = New-ScheduledTaskAction -Execute 'PowerShell.exe' -Argument '-ExecutionPolicy Bypass -File C:\\Scripts\\Verify-Disconnections.ps1'\n$trigger = New-ScheduledTaskTrigger -RepetitionInterval (New-TimeSpan -Minutes 5) -At (Get-Date) -Once\nRegister-ScheduledTask -TaskName 'MA-4.7 Session Verification' -Action $action -Trigger $trigger -User 'SYSTEM' -Force\n\nWrite-Host '[MA-4.7] Disconnect verification configured.'",
        "ansible": "---\n# MA-4.7: Disconnect Verification - Windows Playbook\n- name: Configure Windows disconnect verification\n  hosts: windows\n  tasks:\n    - name: Set RDP max idle time\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\n        name: MaxIdleTime\n        data: 900000\n        type: dword\n\n    - name: Set RDP max disconnection time\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\n        name: MaxDisconnectionTime\n        data: 60000\n        type: dword\n\n    - name: Enable reset broken connections\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\n        name: fResetBroken\n        data: 1\n        type: dword\n\n    - name: Set WinRM idle timeout\n      win_shell: Set-Item WSMan:\\localhost\\Shell\\IdleTimeout -Value 900000\n\n    - name: Create scripts directory\n      win_file:\n        path: C:\\Scripts\n        state: directory\n\n    - name: Deploy session verification script\n      win_copy:\n        dest: C:\\Scripts\\Verify-Disconnections.ps1\n        content: |\n          # Get disconnected sessions\n          quser 2>$null | Select-Object -Skip 1 | Where-Object { $_ -match 'Disc' } | ForEach-Object {\n              Write-Host \"Disconnected session detected: $_\"\n          }"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00Z",
      "source": "ComplianceAsCode",
      "stig_references": [
        "RHEL-08-010200",
        "RHEL-08-010290"
      ],
      "implementation_guidance": "Configure automatic session timeouts for SSH/RDP. Deploy monitoring scripts to detect orphaned sessions. Alert on sessions exceeding maintenance windows."
    }
  },
  {
    "control_id": "MA-5",
    "control_name": "Maintenance Personnel",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "N/A - Organizational Control",
    "official_text": "a. Establish a process for maintenance personnel authorization and maintain a list of authorized maintenance organizations or personnel; b. Verify that non-escorted personnel performing maintenance on the system possess the required access authorizations; and c. Designate organizational personnel with required access authorizations and technical competence to supervise the maintenance activities of personnel who do not possess the required access authorizations.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "To ensure that only authorized personnel can access and perform maintenance on organizational systems, protecting against insider threats and unauthorized modifications. This control establishes accountability for maintenance activities by requiring proper vetting, supervision, and documentation of all personnel who physically or logically access systems for maintenance purposes.",
    "plain_english_explanation": "This control requires organizations to carefully manage who can perform maintenance on their IT systems. Maintenance personnel refers to individuals who perform hardware or software maintenance, including repairs, updates, diagnostics, and modifications. Organizations must: (1) Create a formal authorization process and maintain an up-to-date list of approved maintenance personnel and organizations (such as third-party vendors or contractors); (2) Verify that anyone performing maintenance without an escort has the proper security clearances, background checks, and access approvals before allowing them to work on systems; (3) When maintenance personnel lack required authorizations, assign qualified organizational staff with both the technical knowledge and proper clearances to supervise all maintenance activities. This control is critical because maintenance personnel often require privileged access to systems, creating opportunities for malicious actors to compromise systems, install backdoors, or steal sensitive data if proper oversight is not maintained.",
    "example_implementation": "Implement a comprehensive maintenance personnel authorization program: (1) Develop formal authorization procedures requiring background investigations, security training, and signed access agreements before any maintenance personnel can access systems; (2) Maintain a centralized database of all authorized maintenance personnel including their organization, clearance level, access permissions, and authorization expiration dates; (3) Implement check-in/check-out procedures requiring maintenance personnel to present identification and sign access logs before entering controlled areas; (4) Assign security-cleared supervisors with relevant technical expertise to escort and monitor all maintenance activities performed by uncleared personnel; (5) Conduct quarterly reviews of the authorized personnel list to remove personnel who no longer require access.",
    "non_technical_guidance": "Organizations should implement the following administrative controls for MA-5 compliance:\n\n1. **Authorization Process**: Establish a formal, documented process for authorizing maintenance personnel. This should include:\n   - Background investigation requirements appropriate to system sensitivity\n   - Required security awareness training completion\n   - Signed non-disclosure and acceptable use agreements\n   - Verification of technical competency/certifications\n   - Formal approval from system owner or information security officer\n\n2. **Authorized Personnel List**: Maintain a current list containing:\n   - Individual names and organization affiliations\n   - Security clearance levels (if applicable)\n   - Specific systems authorized to access\n   - Types of maintenance authorized to perform\n   - Authorization effective dates and expiration dates\n   - Supervisor/sponsor for contractor personnel\n\n3. **Verification Procedures**: Before allowing maintenance access:\n   - Verify identity through government-issued photo ID\n   - Confirm current authorization status against the approved list\n   - Verify maintenance request through proper work order system\n   - Document arrival time, purpose, and expected duration\n\n4. **Supervision Requirements**: For personnel without required authorizations:\n   - Assign supervisors with appropriate clearances and technical expertise\n   - Maintain continuous visual observation during all maintenance\n   - Supervisor must understand activities being performed\n   - Document all actions taken during supervised maintenance\n\n5. **Review and Audit**: Conduct periodic reviews to ensure:\n   - Authorized list is current and accurate\n   - All maintenance activities are properly documented\n   - Supervision requirements are consistently enforced\n   - Terminated or transferred personnel are promptly removed",
    "is_technical": false,
    "enhancements": [
      {
        "id": "MA-5.1",
        "title": "Individuals Without Appropriate Access",
        "official_text": "(a) Implement procedures for the use of maintenance personnel that lack appropriate security clearances or are not U.S. citizens, that include the following requirements: (1) Maintenance personnel who do not have needed access authorizations, clearances, or formal access approvals are escorted and supervised during the performance of maintenance and diagnostic activities on the system by approved organizational personnel who are fully cleared, have appropriate access authorizations, and are technically qualified; (2) Prior to initiating maintenance or diagnostic activities by personnel who do not have needed access authorizations, clearances or formal access approvals, all volatile information storage components within the system are sanitized and all nonvolatile storage media are removed or physically disconnected from the system and secured; and (b) Develop and implement [Assignment: organization-defined alternate security safeguards] in the event a system component cannot be sanitized, removed, or disconnected from the system."
      },
      {
        "id": "MA-5.2",
        "title": "Security Clearances for Classified Systems",
        "official_text": "Verify that personnel performing maintenance and diagnostic activities on a system processing, storing, or transmitting classified information possess security clearances and formal access approvals for at least the highest classification level and for compartments of information on the system."
      },
      {
        "id": "MA-5.3",
        "title": "Citizenship Requirements for Classified Systems",
        "official_text": "Verify that personnel performing maintenance and diagnostic activities on a system processing, storing, or transmitting classified information are U.S. citizens."
      },
      {
        "id": "MA-5.4",
        "title": "Foreign Nationals",
        "official_text": "Ensure that: (a) Foreign nationals with appropriate security clearances are used to conduct maintenance and diagnostic activities on classified systems only when the systems are jointly owned and operated by the United States and foreign allied governments, or owned and operated solely by foreign allied governments; and (b) Approvals, consents, and detailed operational conditions regarding the use of foreign nationals to conduct maintenance and diagnostic activities on classified systems are fully documented within Memoranda of Agreements."
      },
      {
        "id": "MA-5.5",
        "title": "Non-system Maintenance",
        "official_text": "Ensure that non-escorted personnel performing maintenance activities not directly associated with the system but in the physical proximity of the system, have required access authorizations."
      }
    ],
    "related_controls": [
      "AC-2",
      "AC-3",
      "AC-6",
      "IA-2",
      "IA-8",
      "MA-4",
      "MP-2",
      "PE-2",
      "PE-3",
      "PS-3",
      "PS-7",
      "RA-3"
    ],
    "supplemental_guidance": "Maintenance personnel refers to individuals who perform hardware or software maintenance on organizational systems, while PE-2 addresses physical access for individuals whose maintenance duties place them within the physical protection perimeter of the systems. Technical competence of supervising individuals relates to the maintenance performed on the systems, while having required access authorizations refers to maintenance on and near the systems. Individuals not previously identified as authorized maintenance personnel (such as information technology manufacturers, vendors, systems integrators, and consultants) may require privileged access to organizational systems, e.g., during system upgrades or for troubleshooting. Based on organizational assessment of risk, organizations may issue temporary credentials to these individuals. Temporary credentials may be for one-time use or for a limited time period.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control is organizational/procedural in nature and cannot be fully automated. Technical controls can support verification of personnel lists and access logging, but authorization processes require manual administrative procedures."
    },
    "ai_guidance": "MA-5 is primarily an organizational control requiring administrative procedures rather than technical automation. However, AI-assisted compliance monitoring can support this control by: (1) Maintaining and querying authorized maintenance personnel databases to verify current authorization status before granting access; (2) Cross-referencing maintenance work orders against authorized personnel lists; (3) Alerting when maintenance activities are scheduled with personnel not on approved lists; (4) Tracking expiration dates for clearances, background investigations, and access authorizations with automated renewal reminders; (5) Auditing maintenance activity logs to identify unauthorized access attempts or supervision violations; (6) Correlating badge access/physical security logs with maintenance authorization records; (7) Generating compliance reports showing maintenance personnel authorization status, supervision records, and audit findings. Integration with HR systems and physical access control systems enables automated verification of personnel authorization status and continuous monitoring for compliance.",
    "implementation_guidance": "Organizations should implement these key administrative and technical measures:\n\n1. **Personnel Authorization Database**: Establish a centralized database tracking all authorized maintenance personnel with fields for: name, organization, clearance level, systems authorized, maintenance types permitted, effective date, expiration date, and supervisor.\n\n2. **Work Order Integration**: Connect maintenance authorization verification to work order/ticketing systems so authorization is verified before any maintenance is scheduled.\n\n3. **Physical Access Integration**: Link maintenance authorization data to physical access control systems so only currently authorized maintenance personnel can badge into restricted areas.\n\n4. **Audit Logging**: Implement comprehensive logging of all maintenance access including personnel identity, timestamp, systems accessed, activities performed, and supervisor (if escorted).\n\n5. **Regular Review Process**: Establish quarterly reviews of authorized personnel lists with formal sign-off by security personnel.\n\n6. **Contractor Management**: Implement formal processes for vetting, authorizing, and managing contractor maintenance personnel with clear accountability from sponsoring organizational personnel.\n\n7. **Emergency Procedures**: Document procedures for granting emergency temporary access with appropriate compensating controls and post-event review requirements."
  },
  {
    "control_id": "MA-5.1",
    "control_name": "Individuals Without Appropriate Access",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "N/A - Organizational Control",
    "parent_control": "MA-5",
    "official_text": "(a) Implement procedures for the use of maintenance personnel that lack appropriate security clearances or are not U.S. citizens, that include the following requirements: (1) Maintenance personnel who do not have needed access authorizations, clearances, or formal access approvals are escorted and supervised during the performance of maintenance and diagnostic activities on the system by approved organizational personnel who are fully cleared, have appropriate access authorizations, and are technically qualified; (2) Prior to initiating maintenance or diagnostic activities by personnel who do not have needed access authorizations, clearances or formal access approvals, all volatile information storage components within the system are sanitized and all nonvolatile storage media are removed or physically disconnected from the system and secured; and (b) Develop and implement [Assignment: organization-defined alternate security safeguards] in the event a system component cannot be sanitized, removed, or disconnected from the system.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "intent": "To protect sensitive information on systems when maintenance must be performed by personnel who lack required security clearances or citizenship status. This enhancement ensures that classified or sensitive data is either removed/sanitized before uncleared maintenance or that compensating controls (continuous supervision by cleared personnel) are in place to prevent unauthorized disclosure.",
    "plain_english_explanation": "When your organization must use maintenance personnel who do not have the required security clearances or who are not U.S. citizens, this control enhancement requires specific protective measures. There are two main requirements: First, uncleared maintenance personnel must be continuously escorted and supervised by organizational staff who have full clearances, proper access authorizations, AND understand the technical work being performed (so they can detect inappropriate actions). Second, before any uncleared maintenance begins, you must sanitize all volatile storage (RAM, caches) and either remove or physically disconnect all non-volatile storage (hard drives, SSDs, removable media) to prevent access to sensitive data. If a component cannot be sanitized or disconnected (such as firmware with embedded keys), the organization must implement alternate safeguards such as additional monitoring, restricting maintenance to specific non-sensitive functions, or requiring dual supervision. This control recognizes that organizations sometimes need specialized vendors or contractors for maintenance but ensures sensitive information remains protected.",
    "example_implementation": "Develop a comprehensive procedure for uncleared maintenance personnel: (1) Require 48-hour advance notice for any maintenance requiring uncleared personnel; (2) Before maintenance begins, have cleared system administrators power down the system and remove/secure all hard drives, SSDs, and removable media in a locked cabinet; (3) For systems with embedded storage that cannot be removed, perform secure erasure of sensitive data using NIST-approved methods and disable network connectivity; (4) Assign two cleared personnel as escorts - one technical supervisor who understands the maintenance being performed, and one security monitor who maintains continuous observation; (5) Require maintenance personnel to surrender all electronic devices (phones, USB drives) before entering the controlled area; (6) Document all activities in a maintenance log signed by both escorts; (7) After maintenance completion, conduct security review before reconnecting storage and returning system to operation.",
    "non_technical_guidance": "Organizations should implement these administrative procedures for MA-5(1) compliance:\n\n1. **Pre-Maintenance Preparation**:\n   - Create detailed checklists for system preparation before uncleared maintenance\n   - Document which storage components must be removed vs. sanitized\n   - Establish secure storage locations for removed media\n   - Define sanitization procedures for components that cannot be removed\n   - Identify alternate safeguards for components that cannot be sanitized\n\n2. **Escort and Supervision Requirements**:\n   - Designate specific personnel authorized to serve as escorts\n   - Require escorts to have both security clearances AND technical competency\n   - Mandate continuous visual observation throughout maintenance\n   - Prohibit escorts from performing other duties during supervision\n   - Define escort-to-maintenance-personnel ratios (typically 1:1)\n\n3. **Documentation Requirements**:\n   - Log all uncleared maintenance activities with:\n     - Date, time, and duration\n     - Maintenance personnel identification\n     - Escort personnel identification\n     - Systems accessed and work performed\n     - Storage media disposition (removed/sanitized/alternate controls)\n     - Any security anomalies or concerns observed\n\n4. **Alternate Safeguards**:\n   - Document organization-defined alternate controls for situations where sanitization is not possible\n   - Examples: additional escorts, restricted access to specific functions, video recording of maintenance, real-time security monitoring\n\n5. **Post-Maintenance Verification**:\n   - Conduct security review before returning system to operation\n   - Verify no unauthorized modifications or device connections\n   - Re-secure storage media and verify data integrity",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-5",
      "MP-2",
      "MP-6",
      "PE-3",
      "PS-3",
      "PS-6",
      "SC-28"
    ],
    "supplemental_guidance": "This enhancement applies to individuals who require access to organizational systems during maintenance activities but do not possess the appropriate security clearances, citizenship, or formal access approvals. Volatile storage includes memory (RAM) and caches that lose their contents when power is removed. Non-volatile storage includes hard disk drives, solid state drives, removable media, and any other storage that persists when power is removed. Situations may arise where sanitization or disconnection is not possible, such as embedded systems with integrated storage, firmware containing cryptographic keys, or components that will be damaged by disconnection. In these cases, organizations implement alternate safeguards appropriate to the sensitivity of information and the threat environment.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This enhancement requires primarily administrative procedures. Technical controls support storage sanitization and access monitoring, but escort/supervision requirements are inherently manual."
    },
    "ai_guidance": "MA-5(1) compliance monitoring can leverage automation for: (1) Pre-maintenance system preparation checklists that verify all storage sanitization/removal steps are completed and documented; (2) Automated alerts when maintenance is scheduled with personnel flagged as lacking required clearances; (3) Integration with physical access systems to log escort presence during maintenance windows; (4) Verification that network connectivity is disabled during sensitive maintenance; (5) Post-maintenance integrity checking to detect unauthorized system modifications; (6) Compliance dashboards showing adherence to escort requirements and storage handling procedures. However, the core supervision requirements remain manual processes requiring organizational discipline and trained personnel.",
    "implementation_guidance": "Key implementation steps:\n\n1. **Categorize Systems**: Identify which systems contain classified/sensitive information requiring these enhanced controls.\n\n2. **Storage Inventory**: Document all storage components for each system, categorizing as volatile, removable non-volatile, or non-removable non-volatile.\n\n3. **Sanitization Procedures**: Develop system-specific sanitization procedures for volatile storage and any non-removable components. Consider:\n   - Secure power-off sequences for memory sanitization\n   - BIOS/firmware clearing procedures\n   - Cryptographic key zeroization\n\n4. **Secure Storage**: Establish secure, access-controlled locations for removed storage media during maintenance.\n\n5. **Alternate Safeguards**: For components that cannot be sanitized/removed, define compensating controls such as:\n   - Dual escort requirement\n   - Video surveillance of maintenance\n   - Restricted maintenance scope to specific non-sensitive functions\n   - Real-time security monitoring by cleared personnel\n\n6. **Escort Training**: Train designated escort personnel on:\n   - Their responsibilities during uncleared maintenance\n   - Technical aspects of systems they supervise\n   - How to identify suspicious activities\n   - Documentation requirements"
  },
  {
    "control_id": "MA-5.2",
    "control_name": "Security Clearances for Classified Systems",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "N/A - Classified Systems Control",
    "parent_control": "MA-5",
    "official_text": "Verify that personnel performing maintenance and diagnostic activities on a system processing, storing, or transmitting classified information possess security clearances and formal access approvals for at least the highest classification level and for compartments of information on the system.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "To ensure that only personnel with appropriate security clearances and formal access approvals can perform maintenance on classified systems. This prevents unauthorized access to classified information during maintenance activities when systems may be in vulnerable states or security controls may be reduced.",
    "plain_english_explanation": "For systems that process, store, or transmit classified information (such as SECRET, TOP SECRET, or compartmented/special access programs), this control requires verification that all maintenance personnel have security clearances at least equal to the highest classification level of information on the system AND have formal access approvals for any compartmented programs (SCI, SAP) whose data resides on the system. For example, if a server contains TOP SECRET//SCI information, maintenance personnel must hold a TOP SECRET clearance with appropriate SCI access before performing any maintenance. This verification must occur before maintenance begins, not after. Organizations cannot use uncleared personnel with escorts for classified systems under this enhancement - the personnel must actually hold the required clearances. This ensures that even during system maintenance when normal access controls might be bypassed, only appropriately vetted personnel can access the system.",
    "example_implementation": "Implement a clearance verification process for classified system maintenance: (1) Maintain a database linking authorized maintenance personnel to their verified clearance levels and access approvals; (2) Before scheduling any maintenance on classified systems, query the Security Office to confirm current clearance status and any recent changes; (3) Require maintenance personnel to present their security credential (badge, CAC) upon arrival for verification against the authorized list; (4) Document the clearance verification in the maintenance log including verifier name and verification method; (5) For systems with multiple classification levels or compartments, verify access approval for each applicable compartment; (6) Implement a 'two-person integrity' policy requiring two cleared individuals for maintenance on the most sensitive systems.",
    "non_technical_guidance": "Organizations should implement these administrative procedures for MA-5(2) compliance:\n\n1. **Clearance Verification Process**:\n   - Establish formal procedures for verifying clearances before maintenance authorization\n   - Designate security personnel responsible for clearance verification\n   - Define acceptable verification methods (Security Office query, credential verification, access list check)\n   - Document verification for each maintenance event\n\n2. **Classified System Inventory**:\n   - Maintain current list of all classified systems with:\n     - System identification and location\n     - Classification level (SECRET, TOP SECRET)\n     - Compartmented program access requirements (SCI, SAP)\n     - Authorized maintenance personnel\n\n3. **Maintenance Personnel Management**:\n   - Maintain roster of maintenance personnel with verified clearances\n   - Track clearance levels and compartmented access approvals\n   - Monitor for clearance changes, suspensions, or revocations\n   - Promptly remove personnel whose clearances are downgraded or revoked\n\n4. **Documentation Requirements**:\n   - Record clearance verification for each maintenance event\n   - Include verifier identity and verification method\n   - Maintain records per classified information handling requirements\n\n5. **Contractor Management**:\n   - Verify contractor clearances through appropriate channels (JPAS, DISS)\n   - Ensure contractor facility clearances (FCL) cover required classification level\n   - Verify DD Form 254 authorizations for specific work",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-5",
      "PS-3",
      "PS-6",
      "SC-35"
    ],
    "supplemental_guidance": "Personnel clearances apply to systems processing, storing, or transmitting classified information. Formal access approvals apply to compartmented programs. Classification levels and compartments of systems may vary significantly. A system processing TOP SECRET and SCI information would require maintenance personnel with at least a TOP SECRET clearance and formal SCI access approval. Organizations ensure that maintenance personnel have formal access approvals for all compartments of information on systems being maintained.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This is an organizational control for classified environments. Clearance verification is performed through security personnel and government systems (DISS/JPAS), not automated technical controls."
    },
    "ai_guidance": "For classified environments, AI-assisted compliance can support MA-5(2) by: (1) Maintaining local databases of authorized maintenance personnel with their verified clearance levels for rapid lookup; (2) Alerting when maintenance is scheduled for a classified system and personnel clearance verification is not documented; (3) Tracking clearance expiration dates and sending renewal reminders; (4) Cross-referencing maintenance requests against personnel clearance records to flag mismatches; (5) Generating compliance reports showing maintenance events on classified systems with corresponding clearance verification documentation. Note that actual clearance verification must be performed through official government security channels.",
    "implementation_guidance": "Key implementation considerations for classified environments:\n\n1. **Security Office Coordination**: Work closely with the Facility Security Officer (FSO) or Security Control Officer (SCO) to establish clearance verification procedures.\n\n2. **Verification Methods**:\n   - Query Defense Information System for Security (DISS) for contractor personnel\n   - Verify government personnel through personnel security offices\n   - Check agency-specific access control databases for compartmented programs\n\n3. **Multi-Level Systems**: For systems processing multiple classification levels:\n   - Verify clearance at the highest level\n   - Verify all required compartmented access approvals\n   - Document complete verification for each maintenance event\n\n4. **Foreign National Restrictions**: Reference MA-5(3) and MA-5(4) for additional citizenship requirements on classified systems.\n\n5. **Two-Person Integrity**: Consider implementing two-person rules for maintenance on the most sensitive systems."
  },
  {
    "control_id": "MA-5.3",
    "control_name": "Citizenship Requirements for Classified Systems",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "N/A - Classified Systems Control",
    "parent_control": "MA-5",
    "official_text": "Verify that personnel performing maintenance and diagnostic activities on a system processing, storing, or transmitting classified information are U.S. citizens.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "To restrict maintenance access on classified U.S. government systems to U.S. citizens only, protecting national security information from potential foreign intelligence threats. This requirement recognizes the elevated risk of foreign intelligence targeting through maintenance personnel who would have privileged access to sensitive systems.",
    "plain_english_explanation": "This control requires that all personnel performing maintenance or diagnostic work on systems containing classified information must be verified U.S. citizens. This is an absolute requirement with limited exceptions (see MA-5.4 for joint/allied system exceptions). The citizenship requirement exists because: (1) Only U.S. citizens can typically hold U.S. security clearances above a certain level; (2) Foreign nationals may be subject to foreign intelligence service pressure or recruitment; (3) Maintenance personnel have privileged access that could be exploited for espionage. Organizations must verify citizenship through reliable documentation (birth certificate, naturalization certificate, passport) as part of the personnel authorization process. This verification should be performed before any maintenance access is granted, not simply assumed based on clearance status.",
    "example_implementation": "Implement citizenship verification as part of the maintenance personnel authorization process: (1) Require presentation of acceptable citizenship documentation (U.S. passport, naturalization certificate, or certified birth certificate) as part of initial authorization; (2) Record verified citizenship status in the maintenance personnel database; (3) Include citizenship verification as a mandatory checklist item before authorizing maintenance access to classified systems; (4) Train security personnel on acceptable citizenship documentation and verification procedures; (5) For contractor personnel, verify that the contractor has confirmed citizenship as part of their employment eligibility verification; (6) Periodically audit maintenance records to ensure citizenship verification is documented for all classified system maintenance events.",
    "non_technical_guidance": "Organizations should implement these administrative procedures for MA-5(3) compliance:\n\n1. **Citizenship Documentation**:\n   - Define acceptable documents for citizenship verification:\n     - U.S. passport (current or expired)\n     - Certificate of Naturalization (N-550 or N-570)\n     - Certificate of Citizenship (N-560 or N-561)\n     - Certified U.S. birth certificate\n   - Maintain copies of citizenship documentation in personnel files\n\n2. **Verification Process**:\n   - Integrate citizenship verification into maintenance personnel authorization\n   - Require verification before first maintenance access to classified systems\n   - Record verification date, document type, and verifier in personnel records\n\n3. **Contractor Requirements**:\n   - Include citizenship requirements in contracts involving classified system maintenance\n   - Require contractors to certify U.S. citizenship of maintenance personnel\n   - Verify contractor compliance during security audits\n\n4. **Exception Handling**:\n   - Reference MA-5(4) for limited foreign national exceptions on joint/allied systems\n   - Document any exceptions with appropriate approvals and justification\n   - Standard classified systems should have NO citizenship exceptions\n\n5. **Audit and Compliance**:\n   - Periodically audit maintenance records to verify citizenship documentation\n   - Include citizenship verification in security compliance reviews\n   - Report any violations through appropriate security channels",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-5",
      "MA-5.2",
      "MA-5.4",
      "PS-3"
    ],
    "supplemental_guidance": "The citizenship requirement for maintenance personnel on classified systems is common in national security environments. Organizations verify U.S. citizenship through acceptable documentation. This requirement works in conjunction with clearance requirements (MA-5.2) since U.S. citizens are generally required to hold security clearances for classified information access. MA-5.4 provides specific guidance for the limited circumstances under which foreign nationals may perform maintenance on certain jointly operated or foreign-owned classified systems.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This is an organizational control for classified environments requiring manual citizenship verification through acceptable documentation. No technical automation applies."
    },
    "ai_guidance": "MA-5(3) is entirely an administrative control requiring manual citizenship verification. AI-assisted systems can support compliance by: (1) Tracking citizenship verification status in personnel databases; (2) Alerting when maintenance is scheduled on classified systems and personnel citizenship verification is not on record; (3) Flagging personnel records that lack citizenship documentation; (4) Generating compliance reports showing citizenship verification status for all classified system maintenance personnel. Actual citizenship verification must be performed manually through review of acceptable documentation.",
    "implementation_guidance": "Key implementation considerations:\n\n1. **Documentation Standards**: Establish clear standards for acceptable citizenship documentation aligned with USCIS and DHS guidance.\n\n2. **Personnel Files**: Maintain copies of citizenship verification in personnel security files, protected per Privacy Act requirements.\n\n3. **Database Tracking**: Include citizenship verification status as a mandatory field in maintenance authorization databases.\n\n4. **Contractor Flow-Down**: Ensure contracts require contractors to verify and certify U.S. citizenship of personnel assigned to classified system maintenance.\n\n5. **Integration with Clearance Process**: Citizenship verification typically occurs during security clearance processing; ensure maintenance authorization processes verify this was completed.\n\n6. **Exception Documentation**: Any exceptions (per MA-5.4 for joint systems) must be formally documented with appropriate authority approval."
  },
  {
    "control_id": "MA-5.4",
    "control_name": "Foreign Nationals",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "N/A - Classified Systems Control",
    "parent_control": "MA-5",
    "official_text": "Ensure that: (a) Foreign nationals with appropriate security clearances are used to conduct maintenance and diagnostic activities on classified systems only when the systems are jointly owned and operated by the United States and foreign allied governments, or owned and operated solely by foreign allied governments; and (b) Approvals, consents, and detailed operational conditions regarding the use of foreign nationals to conduct maintenance and diagnostic activities on classified systems are fully documented within Memoranda of Agreements.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "To define the limited circumstances under which foreign nationals may perform maintenance on classified systems and ensure that such access is formally documented and controlled through international agreements. This control balances the operational need for allied nation participation in joint systems while maintaining strict accountability for foreign national access to classified systems.",
    "plain_english_explanation": "This control allows foreign nationals to perform maintenance on classified systems only in two specific scenarios: (1) Systems that are jointly owned and operated by the United States and foreign allied governments (such as NATO shared systems); or (2) Systems that are owned and operated solely by foreign allied governments (where the U.S. is providing support or the system resides in U.S. facilities). In all such cases, the foreign nationals must hold appropriate security clearances recognized by formal international agreements, and all details about their access must be documented in Memoranda of Agreements (MOAs) or similar international accords. The MOA must specify exactly what maintenance activities are authorized, under what conditions, and with what oversight. This control does NOT permit foreign nationals to perform maintenance on standard U.S.-only classified systems - that requires U.S. citizenship per MA-5(3).",
    "example_implementation": "For joint allied systems requiring foreign national maintenance: (1) Verify that the system is covered by an appropriate international agreement (treaty, executive agreement, MOA/MOU) that authorizes foreign national access; (2) Verify that the specific foreign national holds a valid security clearance from their government that is recognized under applicable bilateral/multilateral security agreements; (3) Obtain documented approval from the appropriate authority (typically the U.S. co-commander, Security Manager, or Designated Approval Authority) before authorizing maintenance access; (4) Document the specific maintenance activities authorized, the systems covered, and any conditions or restrictions in the maintenance authorization; (5) Maintain records of all foreign national maintenance activities including dates, systems accessed, activities performed, and supervising personnel; (6) Conduct periodic reviews of MOAs to ensure maintenance access provisions remain current and appropriate.",
    "non_technical_guidance": "Organizations should implement these administrative procedures for MA-5(4) compliance:\n\n1. **System Classification**:\n   - Identify which classified systems qualify for foreign national maintenance:\n     - Jointly owned/operated U.S.-allied systems\n     - Foreign-owned systems in U.S. facilities or with U.S. support\n   - Document the applicable international agreements for each system\n\n2. **Clearance Verification**:\n   - Verify foreign national clearances through appropriate channels:\n     - NATO: Through NATO Security Office\n     - Bilateral: Through applicable embassy security offices\n     - Coalition: Through Combined Security Coordination Center\n   - Maintain records of clearance verification\n\n3. **Memoranda of Agreement Requirements**:\n   - Ensure MOAs specifically address maintenance personnel access\n   - Include in MOAs:\n     - Specific systems covered\n     - Authorized maintenance activities\n     - Clearance and access requirements\n     - Supervision and oversight provisions\n     - Incident reporting requirements\n     - Information sharing restrictions\n\n4. **Approval Process**:\n   - Define approval authorities for foreign national maintenance\n   - Document approvals before maintenance begins\n   - Maintain audit trail of approval decisions\n\n5. **Operational Controls**:\n   - Implement appropriate supervision during maintenance\n   - Restrict access to specifically authorized systems and activities\n   - Monitor for any unauthorized access attempts\n\n6. **Records Management**:\n   - Maintain complete records of foreign national maintenance\n   - Include in records: personnel identification, nationality, clearance verification, systems accessed, activities performed\n   - Retain records per classified information handling requirements",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-5",
      "MA-5.2",
      "MA-5.3",
      "PS-3",
      "PS-7"
    ],
    "supplemental_guidance": "Foreign nationals may possess appropriate security clearances from their own governments that are recognized under bilateral or multilateral security agreements. Access by foreign nationals to classified systems is strictly limited to systems that are jointly owned and operated or solely owned by allied foreign governments. Even with appropriate foreign clearances, access is only authorized when explicitly covered by Memoranda of Agreements that document all conditions of such access. Organizations maintain careful documentation of all foreign national access to classified systems.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This is an organizational control for multinational classified environments. Implementation requires coordination with foreign government security offices and formal international agreements. No technical automation applies."
    },
    "ai_guidance": "MA-5(4) is an administrative control for multinational classified environments. AI-assisted systems can support compliance by: (1) Maintaining databases of joint/allied systems eligible for foreign national maintenance with links to applicable MOAs; (2) Tracking foreign national maintenance personnel with their clearance verification status and authorized systems; (3) Alerting when foreign national maintenance is requested on systems not covered by appropriate international agreements; (4) Generating compliance reports showing foreign national maintenance activities with associated MOA documentation; (5) Monitoring for MOA expiration dates and renewal requirements. However, clearance verification and MOA management require coordination through official international security channels.",
    "implementation_guidance": "Key implementation considerations for multinational environments:\n\n1. **MOA/MOU Review**: Carefully review international agreements to understand exactly what maintenance access is authorized for which systems.\n\n2. **Clearance Reciprocity**: Understand bilateral/multilateral clearance recognition agreements and verification procedures.\n\n3. **Compartmented Information**: Even with general clearance reciprocity, access to certain compartmented programs may be restricted to U.S. personnel only.\n\n4. **Supervision Requirements**: Many MOAs require U.S. personnel supervision even for cleared foreign nationals. Verify supervision requirements.\n\n5. **Information Sharing Restrictions**: Some maintenance activities may expose foreign nationals to information not authorized for release. Verify releasability before authorizing specific maintenance.\n\n6. **Coalition Environments**: In deployed coalition environments, establish clear procedures for maintenance personnel access that comply with theater security directives."
  },
  {
    "control_id": "MA-5.5",
    "control_name": "Non-system Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": "N/A - Physical Security Control",
    "parent_control": "MA-5",
    "official_text": "Ensure that non-escorted personnel performing maintenance activities not directly associated with the system but in the physical proximity of the system, have required access authorizations.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "To protect systems from unauthorized access or observation by personnel performing non-IT maintenance (facilities, janitorial, HVAC, electrical) within areas where systems are located. Even though these personnel are not directly working on the systems, their physical proximity creates opportunities for visual observation of sensitive information, physical tampering, or installation of eavesdropping devices.",
    "plain_english_explanation": "This control addresses personnel who are not performing maintenance ON the system itself but are performing other types of maintenance work (such as HVAC repairs, electrical work, plumbing, janitorial services, or building maintenance) in areas where the system is physically located. Even though these workers are not touching the systems, their presence in the area creates security risks - they could observe screens displaying sensitive information, plant listening devices, tamper with network cables, or otherwise compromise security. Therefore, if these personnel will be working without an escort in areas containing sensitive systems, they must have appropriate access authorizations (which might include background checks, security clearances, or facility access approvals depending on the sensitivity of the environment). If they do not have required authorizations, they must be escorted by authorized personnel. This is particularly important in server rooms, data centers, secure communications facilities, or other areas where sensitive systems are concentrated.",
    "example_implementation": "Implement non-system maintenance access controls: (1) Identify all areas containing sensitive systems (server rooms, data centers, network closets, secure facilities) and document the access authorization requirements for each area; (2) Establish coordination procedures between facilities management and IT security so that all non-IT maintenance in secure areas is pre-approved; (3) For routine maintenance contracts (janitorial, HVAC, electrical), verify that personnel have undergone appropriate background screening and hold required facility access credentials; (4) Require non-IT maintenance personnel to be logged into the area and provide identification verification; (5) When personnel lack required access authorizations, require continuous escort by authorized personnel throughout the maintenance activity; (6) Implement visible security measures (screen privacy filters, automatic screen locks) to reduce exposure from incidental observation; (7) Schedule sensitive facility maintenance during off-hours when possible and implement additional monitoring during maintenance windows.",
    "non_technical_guidance": "Organizations should implement these administrative procedures for MA-5(5) compliance:\n\n1. **Area Classification**:\n   - Identify and document all areas containing systems requiring protection\n   - Define access authorization requirements for each area based on system sensitivity\n   - Coordinate with physical security (PE controls) to ensure consistent requirements\n\n2. **Maintenance Coordination**:\n   - Establish procedures for scheduling non-IT maintenance in secure areas\n   - Require advance notification for all non-emergency facility maintenance\n   - Coordinate with IT security before authorizing access\n\n3. **Personnel Verification**:\n   - Define access authorization requirements for each category of facility maintenance:\n     - Janitorial: Background check, facility access badge\n     - HVAC/Electrical: Background check, facility access badge, technical certification\n     - Emergency repairs: Escort required unless previously authorized\n   - Verify credentials before granting access\n\n4. **Contractor Management**:\n   - Include access authorization requirements in facility maintenance contracts\n   - Require contractors to provide personnel rosters with verification of background screening\n   - Maintain list of authorized contractor personnel\n\n5. **Escort Procedures**:\n   - Define escort requirements for personnel lacking required authorizations\n   - Ensure escorts are authorized personnel who can provide continuous supervision\n   - Document escorted access including escort identity, duration, and areas accessed\n\n6. **Monitoring and Logging**:\n   - Log all non-IT maintenance access to secure areas\n   - Monitor security cameras during maintenance activities\n   - Report any security anomalies to IT security",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-5",
      "PE-2",
      "PE-3",
      "PE-6",
      "PS-2",
      "PS-3"
    ],
    "supplemental_guidance": "Personnel performing maintenance activities in other capacities not directly related to the system include physical plant personnel and janitorial personnel. These personnel are often present in facilities containing systems, and their presence creates opportunities for unauthorized observation, access, or tampering. Organizations coordinate physical access controls with system security controls to ensure consistent protection. Required access authorizations may vary based on the sensitivity of systems in the area and may include background investigations, facility access approvals, or security clearances.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control coordinates physical security with system security. Implementation requires coordination with facilities management and physical security programs. Integration with physical access control systems can support compliance verification."
    },
    "ai_guidance": "MA-5(5) bridges physical security and system security for non-IT maintenance personnel. AI-assisted compliance can support this control by: (1) Integrating with physical access control systems to track non-IT maintenance personnel access to areas containing sensitive systems; (2) Cross-referencing facilities maintenance schedules with personnel authorization databases; (3) Alerting when unauthorized personnel badge into secure areas without escort; (4) Generating reports correlating physical access logs with maintenance work orders; (5) Identifying patterns of unescorted access by personnel lacking required authorizations; (6) Monitoring badge access during off-hours when facilities maintenance is most likely. Integration with video surveillance analytics can provide additional monitoring of maintenance activities in secure areas.",
    "implementation_guidance": "Key implementation considerations:\n\n1. **Cross-Functional Coordination**: MA-5(5) requires coordination between IT security, physical security, and facilities management. Establish clear communication channels and joint procedures.\n\n2. **Access Control Integration**: Integrate non-IT maintenance authorization requirements into physical access control systems. Badge access should verify both personnel identity and authorization level.\n\n3. **Risk-Based Requirements**: Define access requirements based on area sensitivity:\n   - General office areas: Basic background check\n   - Server rooms/data centers: Enhanced background check, specific authorization\n   - Classified facilities: Security clearance, formal access approval\n\n4. **Compensating Controls**: When personnel lack required authorizations but maintenance is urgent:\n   - Require continuous escort by authorized personnel\n   - Implement additional monitoring (camera surveillance, security guard)\n   - Cover or secure sensitive information displays\n   - Disable or disconnect sensitive systems if feasible\n\n5. **Awareness Training**: Train facilities and IT personnel on coordination requirements and security risks from non-IT maintenance access."
  },
  {
    "control_id": "MA-6",
    "control_name": "Timely Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": null,
    "official_text": "Obtain maintenance support and/or spare parts for [Assignment: organization-defined system components] within [Assignment: organization-defined time period] of failure.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "intent": "Ensure system availability and operational continuity by establishing service level agreements and procurement processes that guarantee rapid access to maintenance support and replacement parts for critical system components, thereby minimizing downtime and reducing the risk of extended service interruptions that could impact mission-critical operations.",
    "plain_english_explanation": "Organizations must establish processes to quickly obtain maintenance support or spare parts when system components fail. This requires identifying which components are critical to operations, determining acceptable downtime thresholds for each component type, and establishing contracts or procurement mechanisms (such as service level agreements with vendors, on-site spare parts inventory, or expedited shipping arrangements) that ensure replacement parts and technical support can be obtained within organizationally-defined timeframes. The goal is to minimize system downtime and maintain operational continuity.",
    "example_implementation": "Establish Service Level Agreements (SLAs) with hardware vendors guaranteeing 4-hour response time for critical infrastructure components (servers, network equipment, storage systems). Maintain an on-site inventory of common replacement parts (hard drives, power supplies, memory modules, network cables) for immediate availability. Create a tiered response matrix: Tier 1 (mission-critical) requires 2-hour parts availability, Tier 2 (business-critical) requires 8-hour availability, Tier 3 (standard) requires next-business-day availability. Document vendor contact information, contract numbers, and escalation procedures in a readily accessible maintenance operations manual.",
    "non_technical_guidance": "To comply with MA-6, follow these organizational steps:\n\n1. Identify and categorize all system components based on criticality to operations, considering factors such as recovery time objectives (RTOs), impact of downtime on mission functions, and interdependencies with other systems.\n\n2. For each component category, define acceptable maximum time to obtain maintenance support or spare parts. Critical systems may require 2-4 hour response times, while less critical systems may accept 24-72 hour timeframes.\n\n3. Evaluate procurement options including vendor service contracts, maintenance agreements, spare parts inventory, and third-party maintenance providers to ensure timeframes can be met.\n\n4. Establish contracts or SLAs with vendors that guarantee the required response times for parts and support. Include penalties for non-compliance and escalation procedures.\n\n5. Maintain an inventory of commonly-needed spare parts on-site for components where external procurement cannot meet required timeframes. Include items such as hard drives, power supplies, memory modules, and network components.\n\n6. Document approved vendors, contract details, contact information, and ordering procedures in an accessible maintenance operations guide.\n\n7. Establish relationships with multiple vendors where possible to avoid single points of failure in the supply chain.\n\n8. Regularly review and test the procurement process to verify that timeframes can actually be met, including conducting periodic exercises where spare parts are ordered to validate delivery times.\n\n9. Monitor vendor performance against SLAs and address any patterns of delayed response.\n\n10. Update component inventories, vendor contracts, and criticality assessments annually or when significant changes occur to system architecture or mission requirements.",
    "ai_guidance": "MA-6 focuses on operational continuity through timely maintenance support - this is primarily an organizational and procurement control rather than a technical one. Implementation success depends on three key factors: (1) accurate identification and categorization of system components by criticality, (2) realistic assessment of required response timeframes based on mission impact analysis, and (3) establishment of enforceable contracts or SLAs that guarantee those timeframes. Organizations should map component criticality to acceptable downtime thresholds, then work backward to determine what procurement mechanisms (vendor contracts, spare parts inventory, expedited shipping accounts) are needed to meet those thresholds. Consider the full maintenance lifecycle including diagnosis time, parts ordering, shipping, and technician availability. For cloud or virtualized environments, translate physical maintenance concepts to service availability guarantees. Document everything in accessible formats and test procurement processes periodically. This control has no direct technical automation - it requires human judgment in categorizing components and negotiating contracts. Integration with asset management systems can support component tracking, but the core requirement is organizational process rather than technical implementation.",
    "implementation_guidance": "This is an organizational/operational control requiring procurement processes and vendor management rather than technical automation. Organizations should: (1) Maintain a comprehensive asset inventory categorized by criticality level, (2) Establish SLAs with hardware/software vendors specifying response times for support and parts delivery, (3) Consider on-site spare parts inventory for mission-critical components, (4) Document all vendor contacts, contract terms, and escalation procedures, (5) Integrate with incident management processes to ensure maintenance needs are quickly identified and communicated, (6) Regularly audit vendor compliance with SLA terms. No STIG mappings exist as this is a procurement/process control.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "MA-6.1",
        "title": "Preventive Maintenance",
        "official_text": "Perform preventive maintenance on [Assignment: organization-defined system components] at [Assignment: organization-defined time intervals]."
      },
      {
        "id": "MA-6.2",
        "title": "Predictive Maintenance",
        "official_text": "Perform predictive maintenance on [Assignment: organization-defined system components] at [Assignment: organization-defined time intervals]."
      },
      {
        "id": "MA-6.3",
        "title": "Automated Support for Predictive Maintenance",
        "official_text": "Transfer predictive maintenance data to a maintenance management system using [Assignment: organization-defined automated mechanisms]."
      }
    ],
    "related_controls": [
      "CM-8",
      "CP-2",
      "CP-7",
      "MA-2",
      "RA-3",
      "SA-4",
      "SA-8",
      "SI-13"
    ],
    "supplemental_guidance": "Organizations specify the system components that result in increased risk to organizational operations and assets, individuals, other organizations, or the Nation when the functionality provided by those components is not operational. Organizational actions to obtain maintenance support include having appropriate contracts in place. For mission-critical systems, some organizations may stock spare parts locally when supply chain constraints or vulnerabilities could delay expedited delivery of parts.",
    "implementation_scripts": {
      "linux": {
        "bash": null,
        "ansible": null
      },
      "windows": {
        "powershell": null,
        "ansible": null
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "implementation_type": "organizational"
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "MA-6 is an organizational control addressing maintenance support timeliness through SLAs and procurement processes. No technical automation exists - implementation requires vendor contract management, spare parts inventory planning, and documented escalation procedures."
    },
    "nist_csf_mappings": {
      "v1.1": [
        "PR.MA-1",
        "ID.AM-1",
        "ID.AM-2"
      ],
      "v2.0": [
        "PR.MA-01",
        "ID.AM-01",
        "ID.AM-02"
      ]
    },
    "nist_sp_800_171_mapping": null
  },
  {
    "control_id": "MA-6.1",
    "control_name": "Preventive Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-6",
    "stig_id": null,
    "official_text": "Perform preventive maintenance on [Assignment: organization-defined system components] at [Assignment: organization-defined time intervals].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Proactively maintain system components through scheduled preventive maintenance activities to reduce the likelihood of failures, extend component lifespans, and ensure consistent system performance, thereby avoiding unplanned downtime and costly emergency repairs.",
    "plain_english_explanation": "Organizations must establish regular preventive maintenance schedules for critical system components before they fail. This includes activities such as replacing aging components on schedule (hard drives after 3-5 years, batteries annually), cleaning dust from cooling systems, updating firmware, verifying backup battery health, inspecting cable connections, and performing routine hardware diagnostics. The frequency of preventive maintenance depends on manufacturer recommendations, environmental conditions, component criticality, and historical failure patterns.",
    "example_implementation": "Establish a preventive maintenance calendar: (1) Monthly: verify UPS battery health, clean air filters in server rooms, inspect cable management; (2) Quarterly: run hardware diagnostics on servers, verify RAID array health, test failover mechanisms; (3) Semi-annually: replace CMOS batteries, update firmware on network equipment, inspect physical security mechanisms; (4) Annually: replace UPS batteries, review and refresh thermal paste on high-performance systems, conduct comprehensive cable infrastructure inspection. Document all maintenance activities in a maintenance log with dates, personnel, components serviced, and findings.",
    "non_technical_guidance": "To comply with MA-6.1, follow these organizational steps:\n\n1. Create a comprehensive inventory of all system components requiring preventive maintenance, including servers, network equipment, storage systems, UPS units, HVAC systems for server rooms, and security devices.\n\n2. Review manufacturer documentation and warranty requirements to determine recommended maintenance intervals for each component type.\n\n3. Assess environmental factors (temperature, humidity, dust levels) that may require more frequent maintenance schedules.\n\n4. Develop a preventive maintenance schedule matrix that maps each component category to specific maintenance activities and their frequencies.\n\n5. Assign responsibility for preventive maintenance to specific personnel or teams, ensuring they have appropriate training and access.\n\n6. Establish maintenance windows that minimize operational impact while ensuring maintenance is performed on schedule.\n\n7. Create standardized checklists for each type of preventive maintenance activity to ensure consistency and completeness.\n\n8. Document all preventive maintenance activities including date, personnel, component, activities performed, and any anomalies discovered.\n\n9. Track maintenance compliance and component health trends to identify components requiring more frequent attention or replacement.\n\n10. Review and adjust maintenance schedules annually based on component age, failure history, technology changes, and operational experience.",
    "ai_guidance": "MA-6.1 shifts the maintenance paradigm from reactive to proactive. The key insight is that scheduled preventive maintenance is significantly less costly and disruptive than emergency repairs after failures. Implementation requires: (1) component inventory with manufacturer-recommended maintenance schedules, (2) environmental assessment to adjust standard schedules based on local conditions, (3) maintenance window planning to minimize operational impact, (4) documentation systems for tracking maintenance activities and component health trends. Common preventive maintenance activities include: UPS battery testing/replacement, air filter cleaning, firmware updates, hardware diagnostic runs, cable inspection, thermal management verification, and RAID array health checks. Organizations should leverage asset management systems to track maintenance schedules and send automated reminders. Consider integrating with change management to ensure maintenance windows are properly coordinated. This control has limited direct technical automation - while monitoring tools can detect when maintenance is needed, the actual preventive maintenance activities typically require human intervention.",
    "implementation_guidance": "This is primarily an organizational/operational control requiring scheduled maintenance activities. Technical monitoring tools can support implementation by tracking component health and generating maintenance alerts, but the core requirement is establishing and following maintenance schedules. Organizations should integrate preventive maintenance schedules with asset management systems and ensure maintenance windows are coordinated with operations.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "CM-8",
      "MA-2",
      "MA-6",
      "SI-13"
    ],
    "supplemental_guidance": "Preventive maintenance includes proactive care and the servicing of system components to maintain organizational equipment and facilities in satisfactory operating condition. Such maintenance provides for the systematic inspection, tests, measurements, adjustments, parts replacement, detection, and correction of incipient failures either before they occur or before they develop into major defects. The primary goal of preventive maintenance is to avoid or mitigate the consequences of equipment failures. Preventive maintenance is designed to preserve and restore equipment reliability by replacing worn components before they fail. Methods of determining what preventive maintenance should be performed include recommendations from manufacturers, statistical failure records, expert opinion, and measured values within normal ranges.",
    "implementation_scripts": {
      "linux": {
        "bash": null,
        "ansible": null
      },
      "windows": {
        "powershell": null,
        "ansible": null
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "implementation_type": "hybrid"
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "MA-6.1 requires scheduled preventive maintenance activities. While monitoring tools can track component health, the actual maintenance requires human intervention. Organizations should establish maintenance calendars and integrate with asset management systems."
    },
    "nist_csf_mappings": {
      "v1.1": [
        "PR.MA-1"
      ],
      "v2.0": [
        "PR.MA-01"
      ]
    },
    "nist_sp_800_171_mapping": null
  },
  {
    "control_id": "MA-6.2",
    "control_name": "Predictive Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-6",
    "stig_id": null,
    "official_text": "Perform predictive maintenance on [Assignment: organization-defined system components] at [Assignment: organization-defined time intervals].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Use condition monitoring and data analytics to predict component failures before they occur, enabling maintenance to be performed at optimal times that maximize component useful life while preventing unexpected failures and associated downtime.",
    "plain_english_explanation": "Organizations must implement systems to monitor the health and performance of critical components and use that data to predict when maintenance or replacement will be needed. Unlike preventive maintenance which occurs on fixed schedules regardless of condition, predictive maintenance uses actual component telemetry (SMART data for hard drives, temperature trends, error rates, performance degradation patterns) to determine when maintenance is truly needed. This approach optimizes maintenance timing - components are serviced when indicators suggest impending failure rather than on arbitrary schedules.",
    "example_implementation": "Deploy monitoring solutions that collect predictive maintenance data: (1) Configure SMART monitoring on all storage devices to track reallocated sectors, spin retry counts, and pending sector counts; (2) Monitor CPU and GPU temperatures and compare against baseline trends; (3) Track memory error rates through ECC logging; (4) Monitor network equipment for increasing error rates or packet loss patterns; (5) Collect UPS battery impedance and runtime test data; (6) Analyze logs for patterns indicating hardware degradation. Establish thresholds that trigger maintenance alerts before failures occur. Review predictive data quarterly to identify components trending toward failure.",
    "non_technical_guidance": "To comply with MA-6.2, follow these organizational steps:\n\n1. Identify system components suitable for predictive maintenance based on criticality and availability of health monitoring capabilities. Focus on components with measurable degradation indicators such as storage devices, batteries, fans, and network equipment.\n\n2. Research available monitoring technologies and data sources for each component type (SMART for drives, SNMP for network equipment, IPMI/iLO for servers).\n\n3. Establish baseline performance and health metrics for each component type under normal operating conditions.\n\n4. Define threshold values that indicate degradation requiring attention (warning level) and imminent failure (critical level).\n\n5. Implement monitoring solutions that collect and analyze predictive maintenance data continuously.\n\n6. Configure alerting to notify appropriate personnel when thresholds are approached or exceeded.\n\n7. Establish procedures for responding to predictive maintenance alerts, including verification steps and maintenance scheduling.\n\n8. Train maintenance personnel to interpret predictive data and make informed maintenance decisions.\n\n9. Document predictive maintenance activities and outcomes to refine prediction models and threshold values over time.\n\n10. Review the effectiveness of predictive maintenance quarterly, comparing actual failures against predictions to improve accuracy.",
    "ai_guidance": "MA-6.2 represents a more sophisticated approach to maintenance than either reactive or preventive methods. The key principle is using actual component condition data rather than arbitrary schedules to determine maintenance timing. Implementation requires: (1) identification of components with monitorable health indicators, (2) deployment of monitoring infrastructure (SMART, SNMP, IPMI, vendor tools), (3) establishment of baseline performance metrics, (4) definition of degradation thresholds, (5) alerting and response procedures. Common predictive indicators include: storage SMART attributes (reallocated sectors, pending sectors, spin retries), temperature trends, error rates and counts, performance degradation metrics, and battery impedance measurements. The value proposition is optimized maintenance timing - components are replaced when data indicates need rather than too early (wasting useful life) or too late (after failure). Integration with maintenance management systems enables tracking and trending. This control has significant technical automation potential through monitoring tools, but human judgment remains essential for interpreting alerts and making maintenance decisions.",
    "implementation_guidance": "This is a hybrid control requiring both technical monitoring infrastructure and organizational processes. Technical implementation includes deploying SMART monitoring, SNMP collectors, IPMI/iLO monitoring, and vendor-specific health monitoring tools. Organizational implementation includes establishing baselines, defining thresholds, creating response procedures, and training personnel. Integration with maintenance management systems supports tracking and analysis.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "CM-8",
      "MA-2",
      "MA-6",
      "MA-6.1",
      "MA-6.3",
      "SI-4",
      "SI-13"
    ],
    "supplemental_guidance": "Predictive maintenance evaluates the condition of equipment by performing periodic or continuous equipment condition monitoring. The goal of predictive maintenance is to perform maintenance at a scheduled time when the maintenance activity is most cost-effective and before the equipment loses performance within a threshold. Predictive maintenance is condition-based rather than schedule-based maintenance. The predictive component stems from the goal of predicting the future trend of the equipment's condition. The approach uses the principles of statistical process control to determine when maintenance should be performed. Predictive maintenance typically applies to assets where failure-monitoring technology is available and cost-effective.",
    "implementation_scripts": {
      "linux": {
        "bash": null,
        "ansible": null
      },
      "windows": {
        "powershell": null,
        "ansible": null
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "implementation_type": "hybrid"
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "MA-6.2 requires condition-based monitoring and analysis. Technical implementation through SMART monitoring, SNMP, and vendor health tools supports data collection. Organizational processes are needed for threshold definition, alert response, and maintenance decision-making."
    },
    "nist_csf_mappings": {
      "v1.1": [
        "PR.MA-1",
        "DE.AE-1"
      ],
      "v2.0": [
        "PR.MA-01",
        "DE.AE-02"
      ]
    },
    "nist_sp_800_171_mapping": null
  },
  {
    "control_id": "MA-6.3",
    "control_name": "Automated Support for Predictive Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "parent_control": "MA-6",
    "stig_id": null,
    "official_text": "Transfer predictive maintenance data to a maintenance management system using [Assignment: organization-defined automated mechanisms].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "Automate the collection and transfer of predictive maintenance data from monitored systems to centralized maintenance management platforms, enabling correlation, trending analysis, and proactive maintenance scheduling across the enterprise while reducing manual data handling and improving response times.",
    "plain_english_explanation": "Organizations must implement automated mechanisms to collect predictive maintenance data (component health metrics, error logs, performance trends) from monitored systems and transfer it to a centralized maintenance management system. This automation eliminates manual data collection, ensures consistent and timely data transfer, enables enterprise-wide visibility into component health, and supports correlation of data across multiple systems to identify patterns. The maintenance management system can then use this data for trend analysis, maintenance scheduling, spare parts forecasting, and compliance reporting.",
    "example_implementation": "Deploy automated data collection and transfer mechanisms: (1) Configure monitoring agents (collectd, telegraf, prometheus node exporter) on all systems to collect SMART, temperature, and performance data; (2) Establish automated data transfer to a centralized time-series database (InfluxDB, Prometheus) using secure protocols; (3) Integrate the monitoring platform with a CMMS (Computerized Maintenance Management System) or ITSM tool; (4) Configure automated ticket/work order creation when predictive thresholds are exceeded; (5) Implement dashboards showing component health trends and maintenance forecasts; (6) Set up automated reporting for maintenance compliance and component lifecycle tracking.",
    "non_technical_guidance": "To comply with MA-6.3, follow these organizational steps:\n\n1. Select or deploy a centralized maintenance management system (CMMS, ITSM, or equivalent) capable of receiving and processing predictive maintenance data.\n\n2. Identify all data sources that provide predictive maintenance information including monitoring tools, vendor management consoles, and embedded management controllers.\n\n3. Define data transfer requirements including frequency (real-time, periodic), format (structured data, logs), security (encryption, authentication), and retention.\n\n4. Evaluate available automated transfer mechanisms for each data source (APIs, SNMP, syslog, custom integrations, vendor connectors).\n\n5. Implement secure automated data transfer from all identified sources to the maintenance management system.\n\n6. Configure the maintenance management system to process incoming data, correlate across sources, and generate actionable insights.\n\n7. Establish automated alerting and work order generation based on predictive data thresholds.\n\n8. Implement dashboards and reports for visibility into component health trends and maintenance status.\n\n9. Test data transfer mechanisms to verify completeness, accuracy, and timeliness of transferred data.\n\n10. Document the automated transfer architecture, data flows, and any manual processes required for exception handling.",
    "ai_guidance": "MA-6.3 focuses on automation infrastructure for predictive maintenance data management. The key value is eliminating manual data handling, enabling enterprise-wide correlation, and improving response times through automated alerting and work order generation. Implementation requires: (1) monitoring agent deployment on managed systems, (2) centralized data aggregation platform, (3) integration with maintenance management systems, (4) automated alerting and ticket generation. Technical options include: monitoring agents (collectd, telegraf, prometheus exporters), time-series databases (InfluxDB, Prometheus, TimescaleDB), integration protocols (REST APIs, SNMP traps, syslog), and CMMS/ITSM platforms (ServiceNow, Jira Service Management, ManageEngine). Security considerations include encrypted data transfer, authentication for API connections, and access controls on maintenance data. This control has strong technical automation potential - the entire data pipeline from collection through transfer to the maintenance system can be fully automated. The provided implementation scripts demonstrate core data collection and transfer patterns that can be extended based on specific organizational requirements.",
    "implementation_guidance": "This is a technical control requiring automated data collection and transfer infrastructure. Implementation involves deploying monitoring agents, configuring data aggregation, establishing secure transfer mechanisms, and integrating with maintenance management platforms. The provided scripts demonstrate foundational patterns for SMART data collection and automated transfer that organizations can extend based on their specific monitoring stack and CMMS/ITSM tools.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-4",
      "AU-5",
      "CM-8",
      "MA-2",
      "MA-6",
      "MA-6.2",
      "SC-8",
      "SI-4"
    ],
    "supplemental_guidance": "A maintenance management system is a combination of processes, procedures, and software that provides a systematic approach to managing maintenance activities. The transfer of predictive maintenance data to such a system helps to ensure that the organization's maintenance operations are informed by current component health status and trending data.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# MA-6.3: Automated Predictive Maintenance Data Collection and Transfer\n# Collects SMART data and system health metrics, transfers to maintenance management system\n\nset -euo pipefail\n\n# Configuration\nLOG_FILE=\"/var/log/predictive_maintenance.log\"\nDATA_DIR=\"/var/lib/maintenance/predictive_data\"\nCMMS_ENDPOINT=\"${CMMS_ENDPOINT:-http://localhost:8080/api/v1/maintenance/ingest}\"\nCMMS_API_KEY=\"${CMMS_API_KEY:-}\"\nHOSTNAME=$(hostname -f)\nTIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)\n\nlog() {\n    echo \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] $1\" | tee -a \"$LOG_FILE\"\n}\n\nmkdir -p \"$DATA_DIR\"\n\n# Collect SMART data from all drives\ncollect_smart_data() {\n    log \"Collecting SMART data from storage devices\"\n    local smart_data=\"[]\"\n    \n    for device in /dev/sd[a-z] /dev/nvme[0-9]n[0-9]; do\n        if [[ -b \"$device\" ]]; then\n            if command -v smartctl &>/dev/null; then\n                local device_smart\n                device_smart=$(smartctl -a -j \"$device\" 2>/dev/null || echo '{}')\n                if [[ -n \"$device_smart\" && \"$device_smart\" != \"{}\" ]]; then\n                    smart_data=$(echo \"$smart_data\" | jq --argjson dev \"$device_smart\" '. + [$dev]')\n                fi\n            fi\n        fi\n    done\n    echo \"$smart_data\"\n}\n\n# Collect system temperature data\ncollect_temperature_data() {\n    log \"Collecting temperature data\"\n    local temp_data='{\"sensors\": []}'\n    \n    if command -v sensors &>/dev/null; then\n        local sensors_output\n        sensors_output=$(sensors -j 2>/dev/null || echo '{}')\n        temp_data=$(echo \"$sensors_output\" | jq '{sensors: .}')\n    fi\n    echo \"$temp_data\"\n}\n\n# Collect memory health (ECC errors if available)\ncollect_memory_health() {\n    log \"Collecting memory health data\"\n    local mem_data='{\"ecc_errors\": null, \"edac_status\": \"unknown\"}'\n    \n    if [[ -d /sys/devices/system/edac/mc ]]; then\n        local ce_count=0 ue_count=0\n        for mc in /sys/devices/system/edac/mc/mc*; do\n            if [[ -f \"$mc/ce_count\" ]]; then\n                ce_count=$((ce_count + $(cat \"$mc/ce_count\")))\n            fi\n            if [[ -f \"$mc/ue_count\" ]]; then\n                ue_count=$((ue_count + $(cat \"$mc/ue_count\")))\n            fi\n        done\n        mem_data=$(jq -n --argjson ce \"$ce_count\" --argjson ue \"$ue_count\" \\\n            '{\"correctable_errors\": $ce, \"uncorrectable_errors\": $ue, \"edac_status\": \"active\"}')\n    fi\n    echo \"$mem_data\"\n}\n\n# Collect UPS status if available\ncollect_ups_data() {\n    log \"Collecting UPS data\"\n    local ups_data='{\"status\": \"not_monitored\"}'\n    \n    if command -v upsc &>/dev/null; then\n        local ups_name\n        ups_name=$(upsc -l 2>/dev/null | head -1 || echo \"\")\n        if [[ -n \"$ups_name\" ]]; then\n            local battery_charge battery_runtime\n            battery_charge=$(upsc \"$ups_name\" battery.charge 2>/dev/null || echo \"unknown\")\n            battery_runtime=$(upsc \"$ups_name\" battery.runtime 2>/dev/null || echo \"unknown\")\n            ups_data=$(jq -n --arg charge \"$battery_charge\" --arg runtime \"$battery_runtime\" \\\n                '{\"battery_charge_percent\": $charge, \"battery_runtime_seconds\": $runtime, \"status\": \"monitored\"}')\n        fi\n    fi\n    echo \"$ups_data\"\n}\n\n# Build complete maintenance data payload\nbuild_payload() {\n    local smart_data=\"$1\"\n    local temp_data=\"$2\"\n    local mem_data=\"$3\"\n    local ups_data=\"$4\"\n    \n    jq -n \\\n        --arg hostname \"$HOSTNAME\" \\\n        --arg timestamp \"$TIMESTAMP\" \\\n        --argjson smart \"$smart_data\" \\\n        --argjson temperature \"$temp_data\" \\\n        --argjson memory \"$mem_data\" \\\n        --argjson ups \"$ups_data\" \\\n        '{\n            \"source_host\": $hostname,\n            \"collection_timestamp\": $timestamp,\n            \"data_type\": \"predictive_maintenance\",\n            \"smart_data\": $smart,\n            \"temperature_data\": $temperature,\n            \"memory_health\": $memory,\n            \"ups_status\": $ups\n        }'\n}\n\n# Transfer data to CMMS\ntransfer_to_cmms() {\n    local payload=\"$1\"\n    local output_file=\"$DATA_DIR/maintenance_data_${TIMESTAMP//[:-]/}.json\"\n    \n    # Save locally first\n    echo \"$payload\" > \"$output_file\"\n    log \"Saved maintenance data to $output_file\"\n    \n    # Transfer to CMMS if endpoint configured\n    if [[ -n \"$CMMS_API_KEY\" && \"$CMMS_ENDPOINT\" != \"http://localhost:8080/api/v1/maintenance/ingest\" ]]; then\n        log \"Transferring data to CMMS endpoint: $CMMS_ENDPOINT\"\n        local response\n        response=$(curl -s -w \"\\n%{http_code}\" -X POST \"$CMMS_ENDPOINT\" \\\n            -H \"Content-Type: application/json\" \\\n            -H \"Authorization: Bearer $CMMS_API_KEY\" \\\n            -d \"$payload\" 2>&1 || echo \"error 000\")\n        \n        local http_code\n        http_code=$(echo \"$response\" | tail -1)\n        \n        if [[ \"$http_code\" =~ ^2[0-9][0-9]$ ]]; then\n            log \"Successfully transferred data to CMMS (HTTP $http_code)\"\n        else\n            log \"WARNING: CMMS transfer failed (HTTP $http_code) - data saved locally\"\n        fi\n    else\n        log \"CMMS endpoint not configured - data saved locally only\"\n    fi\n}\n\n# Clean up old data files (keep 30 days)\ncleanup_old_data() {\n    find \"$DATA_DIR\" -name \"maintenance_data_*.json\" -mtime +30 -delete 2>/dev/null || true\n}\n\n# Main execution\nmain() {\n    log \"Starting predictive maintenance data collection\"\n    \n    smart_data=$(collect_smart_data)\n    temp_data=$(collect_temperature_data)\n    mem_data=$(collect_memory_health)\n    ups_data=$(collect_ups_data)\n    \n    payload=$(build_payload \"$smart_data\" \"$temp_data\" \"$mem_data\" \"$ups_data\")\n    transfer_to_cmms \"$payload\"\n    cleanup_old_data\n    \n    log \"Predictive maintenance data collection complete\"\n}\n\nmain \"$@\"",
        "ansible": "---\n# MA-6.3: Automated Support for Predictive Maintenance\n# Deploys monitoring infrastructure for predictive maintenance data collection and transfer\n\n- name: MA-6.3 Predictive Maintenance Automation Setup\n  hosts: all\n  become: true\n  vars:\n    maintenance_data_dir: /var/lib/maintenance/predictive_data\n    maintenance_log_dir: /var/log/maintenance\n    cmms_endpoint: \"{{ lookup('env', 'CMMS_ENDPOINT') | default('', true) }}\"\n    cmms_api_key: \"{{ lookup('env', 'CMMS_API_KEY') | default('', true) }}\"\n    collection_interval_minutes: 60\n    data_retention_days: 30\n\n  tasks:\n    - name: Install required monitoring packages\n      ansible.builtin.package:\n        name:\n          - smartmontools\n          - lm-sensors\n          - jq\n          - curl\n        state: present\n      tags:\n        - packages\n\n    - name: Ensure sensors modules are loaded\n      ansible.builtin.command: sensors-detect --auto\n      register: sensors_detect\n      changed_when: false\n      failed_when: false\n      tags:\n        - configuration\n\n    - name: Create maintenance data directories\n      ansible.builtin.file:\n        path: \"{{ item }}\"\n        state: directory\n        owner: root\n        group: root\n        mode: '0750'\n      loop:\n        - \"{{ maintenance_data_dir }}\"\n        - \"{{ maintenance_log_dir }}\"\n      tags:\n        - directories\n\n    - name: Deploy predictive maintenance collection script\n      ansible.builtin.copy:\n        dest: /usr/local/bin/collect-predictive-maintenance.sh\n        mode: '0750'\n        owner: root\n        group: root\n        content: |\n          #!/bin/bash\n          # MA-6.3: Automated Predictive Maintenance Data Collection\n          set -euo pipefail\n          \n          LOG_FILE=\"{{ maintenance_log_dir }}/predictive_maintenance.log\"\n          DATA_DIR=\"{{ maintenance_data_dir }}\"\n          CMMS_ENDPOINT=\"{{ cmms_endpoint }}\"\n          CMMS_API_KEY=\"{{ cmms_api_key }}\"\n          HOSTNAME=$(hostname -f)\n          TIMESTAMP=$(date -u +%Y-%m-%dT%H:%M:%SZ)\n          \n          log() { echo \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] $1\" >> \"$LOG_FILE\"; }\n          \n          collect_smart_data() {\n              local result='[]'\n              for dev in /dev/sd[a-z] /dev/nvme[0-9]n[0-9]; do\n                  [[ -b \"$dev\" ]] || continue\n                  data=$(smartctl -a -j \"$dev\" 2>/dev/null || echo '{}')\n                  [[ \"$data\" != '{}' ]] && result=$(echo \"$result\" | jq --argjson d \"$data\" '. + [$d]')\n              done\n              echo \"$result\"\n          }\n          \n          collect_sensors() {\n              sensors -j 2>/dev/null || echo '{}'\n          }\n          \n          collect_memory_health() {\n              local ce=0 ue=0\n              for mc in /sys/devices/system/edac/mc/mc*; do\n                  [[ -f \"$mc/ce_count\" ]] && ce=$((ce + $(cat \"$mc/ce_count\")))\n                  [[ -f \"$mc/ue_count\" ]] && ue=$((ue + $(cat \"$mc/ue_count\")))\n              done\n              jq -n --argjson ce \"$ce\" --argjson ue \"$ue\" '{\"correctable\": $ce, \"uncorrectable\": $ue}'\n          }\n          \n          payload=$(jq -n \\\n              --arg host \"$HOSTNAME\" \\\n              --arg ts \"$TIMESTAMP\" \\\n              --argjson smart \"$(collect_smart_data)\" \\\n              --argjson sensors \"$(collect_sensors)\" \\\n              --argjson memory \"$(collect_memory_health)\" \\\n              '{host: $host, timestamp: $ts, type: \"predictive_maintenance\", smart: $smart, sensors: $sensors, memory: $memory}')\n          \n          echo \"$payload\" > \"$DATA_DIR/data_${TIMESTAMP//[:-]/}.json\"\n          log \"Collected predictive maintenance data\"\n          \n          if [[ -n \"$CMMS_API_KEY\" && -n \"$CMMS_ENDPOINT\" ]]; then\n              code=$(curl -s -o /dev/null -w '%{http_code}' -X POST \"$CMMS_ENDPOINT\" \\\n                  -H 'Content-Type: application/json' -H \"Authorization: Bearer $CMMS_API_KEY\" -d \"$payload\")\n              log \"CMMS transfer: HTTP $code\"\n          fi\n          \n          find \"$DATA_DIR\" -name 'data_*.json' -mtime +{{ data_retention_days }} -delete 2>/dev/null || true\n      tags:\n        - scripts\n\n    - name: Create systemd service for predictive maintenance collection\n      ansible.builtin.copy:\n        dest: /etc/systemd/system/predictive-maintenance.service\n        mode: '0644'\n        content: |\n          [Unit]\n          Description=Predictive Maintenance Data Collection\n          After=network.target\n          \n          [Service]\n          Type=oneshot\n          ExecStart=/usr/local/bin/collect-predictive-maintenance.sh\n          StandardOutput=journal\n          StandardError=journal\n      tags:\n        - systemd\n\n    - name: Create systemd timer for periodic collection\n      ansible.builtin.copy:\n        dest: /etc/systemd/system/predictive-maintenance.timer\n        mode: '0644'\n        content: |\n          [Unit]\n          Description=Predictive Maintenance Collection Timer\n          \n          [Timer]\n          OnBootSec=5min\n          OnUnitActiveSec={{ collection_interval_minutes }}min\n          Persistent=true\n          \n          [Install]\n          WantedBy=timers.target\n      notify: Reload systemd\n      tags:\n        - systemd\n\n    - name: Enable and start predictive maintenance timer\n      ansible.builtin.systemd:\n        name: predictive-maintenance.timer\n        state: started\n        enabled: true\n        daemon_reload: true\n      tags:\n        - systemd\n\n    - name: Run initial data collection\n      ansible.builtin.command: /usr/local/bin/collect-predictive-maintenance.sh\n      register: initial_collection\n      changed_when: initial_collection.rc == 0\n      tags:\n        - verification\n\n    - name: Verify data collection\n      ansible.builtin.find:\n        paths: \"{{ maintenance_data_dir }}\"\n        patterns: 'data_*.json'\n        age: '-1h'\n      register: recent_data\n      failed_when: recent_data.matched == 0\n      tags:\n        - verification\n\n  handlers:\n    - name: Reload systemd\n      ansible.builtin.systemd:\n        daemon_reload: true"
      },
      "windows": {
        "powershell": "# MA-6.3: Automated Predictive Maintenance Data Collection and Transfer\n# Collects SMART data, hardware health metrics, and transfers to maintenance management system\n\n#Requires -Version 5.1\n#Requires -RunAsAdministrator\n\nparam(\n    [string]$CmmsEndpoint = $env:CMMS_ENDPOINT,\n    [string]$CmmsApiKey = $env:CMMS_API_KEY,\n    [string]$DataDirectory = \"C:\\ProgramData\\Maintenance\\PredictiveData\",\n    [string]$LogFile = \"C:\\ProgramData\\Maintenance\\Logs\\predictive_maintenance.log\",\n    [int]$RetentionDays = 30\n)\n\nSet-StrictMode -Version Latest\n$ErrorActionPreference = 'Stop'\n\n# Ensure directories exist\nforeach ($dir in @($DataDirectory, (Split-Path $LogFile -Parent))) {\n    if (-not (Test-Path $dir)) {\n        New-Item -ItemType Directory -Path $dir -Force | Out-Null\n    }\n}\n\nfunction Write-Log {\n    param([string]$Message)\n    $timestamp = Get-Date -Format 'yyyy-MM-ddTHH:mm:ssZ'\n    $entry = \"[$timestamp] $Message\"\n    Add-Content -Path $LogFile -Value $entry\n    Write-Host $entry\n}\n\nfunction Get-DiskSmartData {\n    Write-Log \"Collecting disk SMART/health data\"\n    $disks = @()\n    \n    try {\n        $physicalDisks = Get-PhysicalDisk -ErrorAction SilentlyContinue\n        foreach ($disk in $physicalDisks) {\n            $reliability = Get-StorageReliabilityCounter -PhysicalDisk $disk -ErrorAction SilentlyContinue\n            $diskInfo = @{\n                DeviceId = $disk.DeviceId\n                FriendlyName = $disk.FriendlyName\n                MediaType = $disk.MediaType\n                HealthStatus = $disk.HealthStatus\n                OperationalStatus = $disk.OperationalStatus\n                Size = $disk.Size\n                Temperature = if ($reliability) { $reliability.Temperature } else { $null }\n                ReadErrorsTotal = if ($reliability) { $reliability.ReadErrorsTotal } else { $null }\n                WriteErrorsTotal = if ($reliability) { $reliability.WriteErrorsTotal } else { $null }\n                Wear = if ($reliability) { $reliability.Wear } else { $null }\n                PowerOnHours = if ($reliability) { $reliability.PowerOnHours } else { $null }\n            }\n            $disks += $diskInfo\n        }\n    } catch {\n        Write-Log \"WARNING: Error collecting disk data: $_\"\n    }\n    \n    return $disks\n}\n\nfunction Get-SystemTemperatureData {\n    Write-Log \"Collecting system temperature data\"\n    $temperatures = @()\n    \n    try {\n        $thermalZones = Get-CimInstance -Namespace root\\wmi -ClassName MSAcpi_ThermalZoneTemperature -ErrorAction SilentlyContinue\n        foreach ($zone in $thermalZones) {\n            $tempCelsius = ($zone.CurrentTemperature - 2732) / 10\n            $temperatures += @{\n                InstanceName = $zone.InstanceName\n                TemperatureCelsius = [math]::Round($tempCelsius, 1)\n            }\n        }\n    } catch {\n        Write-Log \"WARNING: Unable to collect temperature data (may require hardware support): $_\"\n    }\n    \n    return $temperatures\n}\n\nfunction Get-MemoryHealthData {\n    Write-Log \"Collecting memory health data\"\n    $memoryInfo = @{\n        TotalPhysicalMemory = 0\n        AvailableMemory = 0\n        MemoryModules = @()\n    }\n    \n    try {\n        $os = Get-CimInstance Win32_OperatingSystem\n        $memoryInfo.TotalPhysicalMemory = $os.TotalVisibleMemorySize * 1KB\n        $memoryInfo.AvailableMemory = $os.FreePhysicalMemory * 1KB\n        \n        $modules = Get-CimInstance Win32_PhysicalMemory\n        foreach ($module in $modules) {\n            $memoryInfo.MemoryModules += @{\n                DeviceLocator = $module.DeviceLocator\n                Capacity = $module.Capacity\n                Speed = $module.Speed\n                Manufacturer = $module.Manufacturer\n                PartNumber = $module.PartNumber\n            }\n        }\n    } catch {\n        Write-Log \"WARNING: Error collecting memory data: $_\"\n    }\n    \n    return $memoryInfo\n}\n\nfunction Get-BatteryHealthData {\n    Write-Log \"Collecting battery/UPS health data\"\n    $batteryInfo = @()\n    \n    try {\n        $batteries = Get-CimInstance Win32_Battery -ErrorAction SilentlyContinue\n        foreach ($battery in $batteries) {\n            $batteryInfo += @{\n                Name = $battery.Name\n                Status = $battery.Status\n                EstimatedChargeRemaining = $battery.EstimatedChargeRemaining\n                EstimatedRunTime = $battery.EstimatedRunTime\n                BatteryStatus = $battery.BatteryStatus\n            }\n        }\n    } catch {\n        Write-Log \"INFO: No battery data available (may be desktop system)\"\n    }\n    \n    return $batteryInfo\n}\n\nfunction Get-EventLogHealthIndicators {\n    Write-Log \"Collecting system event health indicators\"\n    $healthIndicators = @{\n        CriticalErrors24h = 0\n        DiskWarnings24h = 0\n        MemoryWarnings24h = 0\n    }\n    \n    try {\n        $startTime = (Get-Date).AddHours(-24)\n        \n        $criticalEvents = Get-WinEvent -FilterHashtable @{\n            LogName = 'System'\n            Level = 1  # Critical\n            StartTime = $startTime\n        } -ErrorAction SilentlyContinue\n        $healthIndicators.CriticalErrors24h = if ($criticalEvents) { $criticalEvents.Count } else { 0 }\n        \n        $diskEvents = Get-WinEvent -FilterHashtable @{\n            LogName = 'System'\n            ProviderName = 'disk'\n            StartTime = $startTime\n        } -ErrorAction SilentlyContinue\n        $healthIndicators.DiskWarnings24h = if ($diskEvents) { $diskEvents.Count } else { 0 }\n    } catch {\n        Write-Log \"WARNING: Error collecting event log data: $_\"\n    }\n    \n    return $healthIndicators\n}\n\nfunction Build-MaintenancePayload {\n    $hostname = [System.Net.Dns]::GetHostName()\n    $timestamp = Get-Date -Format 'yyyy-MM-ddTHH:mm:ssZ'\n    \n    $payload = @{\n        source_host = $hostname\n        collection_timestamp = $timestamp\n        data_type = 'predictive_maintenance'\n        platform = 'windows'\n        disk_health = Get-DiskSmartData\n        temperature_data = Get-SystemTemperatureData\n        memory_health = Get-MemoryHealthData\n        battery_ups = Get-BatteryHealthData\n        event_indicators = Get-EventLogHealthIndicators\n    }\n    \n    return $payload\n}\n\nfunction Save-MaintenanceData {\n    param([hashtable]$Payload)\n    \n    $timestamp = Get-Date -Format 'yyyyMMddHHmmss'\n    $filename = \"maintenance_data_$timestamp.json\"\n    $filepath = Join-Path $DataDirectory $filename\n    \n    $Payload | ConvertTo-Json -Depth 10 | Out-File -FilePath $filepath -Encoding UTF8\n    Write-Log \"Saved maintenance data to $filepath\"\n    \n    return $filepath\n}\n\nfunction Send-ToCmms {\n    param(\n        [hashtable]$Payload,\n        [string]$Endpoint,\n        [string]$ApiKey\n    )\n    \n    if ([string]::IsNullOrEmpty($Endpoint) -or [string]::IsNullOrEmpty($ApiKey)) {\n        Write-Log \"CMMS endpoint not configured - data saved locally only\"\n        return\n    }\n    \n    Write-Log \"Transferring data to CMMS endpoint: $Endpoint\"\n    \n    try {\n        $headers = @{\n            'Content-Type' = 'application/json'\n            'Authorization' = \"Bearer $ApiKey\"\n        }\n        $body = $Payload | ConvertTo-Json -Depth 10\n        \n        $response = Invoke-RestMethod -Uri $Endpoint -Method Post -Headers $headers -Body $body -TimeoutSec 30\n        Write-Log \"Successfully transferred data to CMMS\"\n    } catch {\n        Write-Log \"WARNING: CMMS transfer failed: $_ - data saved locally\"\n    }\n}\n\nfunction Remove-OldDataFiles {\n    $cutoffDate = (Get-Date).AddDays(-$RetentionDays)\n    $oldFiles = Get-ChildItem -Path $DataDirectory -Filter 'maintenance_data_*.json' -ErrorAction SilentlyContinue |\n        Where-Object { $_.LastWriteTime -lt $cutoffDate }\n    \n    foreach ($file in $oldFiles) {\n        Remove-Item $file.FullName -Force\n        Write-Log \"Removed old data file: $($file.Name)\"\n    }\n}\n\n# Main execution\nWrite-Log \"Starting predictive maintenance data collection\"\n\ntry {\n    $payload = Build-MaintenancePayload\n    $savedFile = Save-MaintenanceData -Payload $payload\n    Send-ToCmms -Payload $payload -Endpoint $CmmsEndpoint -ApiKey $CmmsApiKey\n    Remove-OldDataFiles\n    \n    Write-Log \"Predictive maintenance data collection complete\"\n    \n    # Output summary for verification\n    Write-Host \"`nCollection Summary:\" -ForegroundColor Green\n    Write-Host \"  Disks monitored: $($payload.disk_health.Count)\"\n    Write-Host \"  Memory modules: $($payload.memory_health.MemoryModules.Count)\"\n    Write-Host \"  Data file: $savedFile\"\n    \n} catch {\n    Write-Log \"ERROR: Predictive maintenance collection failed: $_\"\n    throw\n}",
        "ansible": "---\n# MA-6.3: Automated Support for Predictive Maintenance (Windows)\n# Deploys monitoring infrastructure for predictive maintenance data collection and transfer\n\n- name: MA-6.3 Predictive Maintenance Automation Setup (Windows)\n  hosts: windows\n  gather_facts: true\n  vars:\n    maintenance_data_dir: C:\\ProgramData\\Maintenance\\PredictiveData\n    maintenance_log_dir: C:\\ProgramData\\Maintenance\\Logs\n    maintenance_script_dir: C:\\ProgramData\\Maintenance\\Scripts\n    cmms_endpoint: \"{{ lookup('env', 'CMMS_ENDPOINT') | default('', true) }}\"\n    cmms_api_key: \"{{ lookup('env', 'CMMS_API_KEY') | default('', true) }}\"\n    collection_interval_minutes: 60\n    data_retention_days: 30\n\n  tasks:\n    - name: Create maintenance directories\n      ansible.windows.win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ maintenance_data_dir }}\"\n        - \"{{ maintenance_log_dir }}\"\n        - \"{{ maintenance_script_dir }}\"\n      tags:\n        - directories\n\n    - name: Deploy predictive maintenance collection script\n      ansible.windows.win_copy:\n        dest: \"{{ maintenance_script_dir }}\\\\Collect-PredictiveMaintenance.ps1\"\n        content: |\n          # MA-6.3: Automated Predictive Maintenance Data Collection\n          param(\n              [string]$CmmsEndpoint = '{{ cmms_endpoint }}',\n              [string]$CmmsApiKey = '{{ cmms_api_key }}',\n              [string]$DataDirectory = '{{ maintenance_data_dir }}',\n              [string]$LogFile = '{{ maintenance_log_dir }}\\predictive_maintenance.log',\n              [int]$RetentionDays = {{ data_retention_days }}\n          )\n          \n          $ErrorActionPreference = 'Stop'\n          \n          function Write-Log { param([string]$Message)\n              $entry = \"[$(Get-Date -Format 'yyyy-MM-ddTHH:mm:ssZ')] $Message\"\n              Add-Content -Path $LogFile -Value $entry\n          }\n          \n          function Get-DiskHealth {\n              $disks = @()\n              Get-PhysicalDisk -ErrorAction SilentlyContinue | ForEach-Object {\n                  $rel = Get-StorageReliabilityCounter -PhysicalDisk $_ -ErrorAction SilentlyContinue\n                  $disks += @{\n                      DeviceId = $_.DeviceId; HealthStatus = $_.HealthStatus\n                      Temperature = if($rel){$rel.Temperature}else{$null}\n                      ReadErrors = if($rel){$rel.ReadErrorsTotal}else{$null}\n                      WriteErrors = if($rel){$rel.WriteErrorsTotal}else{$null}\n                      Wear = if($rel){$rel.Wear}else{$null}\n                  }\n              }\n              return $disks\n          }\n          \n          $payload = @{\n              source_host = [System.Net.Dns]::GetHostName()\n              timestamp = Get-Date -Format 'yyyy-MM-ddTHH:mm:ssZ'\n              type = 'predictive_maintenance'\n              disk_health = Get-DiskHealth\n          }\n          \n          $file = Join-Path $DataDirectory \"data_$(Get-Date -Format 'yyyyMMddHHmmss').json\"\n          $payload | ConvertTo-Json -Depth 10 | Out-File $file -Encoding UTF8\n          Write-Log \"Saved data to $file\"\n          \n          if ($CmmsEndpoint -and $CmmsApiKey) {\n              try {\n                  $headers = @{'Authorization'=\"Bearer $CmmsApiKey\";'Content-Type'='application/json'}\n                  Invoke-RestMethod -Uri $CmmsEndpoint -Method Post -Headers $headers -Body ($payload|ConvertTo-Json -Depth 10)\n                  Write-Log \"Transferred to CMMS\"\n              } catch { Write-Log \"CMMS transfer failed: $_\" }\n          }\n          \n          Get-ChildItem $DataDirectory -Filter 'data_*.json' | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-$RetentionDays)} | Remove-Item -Force\n      tags:\n        - scripts\n\n    - name: Create scheduled task for predictive maintenance collection\n      ansible.windows.win_scheduled_task:\n        name: PredictiveMaintenanceCollection\n        description: MA-6.3 Automated Predictive Maintenance Data Collection\n        actions:\n          - path: powershell.exe\n            arguments: -ExecutionPolicy Bypass -File \"{{ maintenance_script_dir }}\\Collect-PredictiveMaintenance.ps1\"\n        triggers:\n          - type: registration\n            delay: PT5M\n          - type: daily\n            start_boundary: '2025-01-01T00:00:00'\n            repetition:\n              interval: PT{{ collection_interval_minutes }}M\n              duration: P1D\n        username: SYSTEM\n        run_level: highest\n        state: present\n        enabled: true\n      tags:\n        - scheduled_task\n\n    - name: Run initial data collection\n      ansible.windows.win_powershell:\n        script: |\n          & '{{ maintenance_script_dir }}\\Collect-PredictiveMaintenance.ps1'\n      register: initial_collection\n      tags:\n        - verification\n\n    - name: Verify data collection\n      ansible.windows.win_find:\n        paths: \"{{ maintenance_data_dir }}\"\n        patterns: 'data_*.json'\n        age: '-1h'\n      register: recent_data\n      failed_when: recent_data.matched == 0\n      tags:\n        - verification\n\n    - name: Display collection status\n      ansible.builtin.debug:\n        msg: \"MA-6.3: Found {{ recent_data.matched }} recent data files. Initial collection {{ 'succeeded' if initial_collection.rc == 0 else 'may have issues' }}.\"\n      tags:\n        - verification"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true,
      "implementation_type": "technical"
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "MA-6.3 requires automated data transfer infrastructure. The provided scripts implement SMART data collection, system health monitoring, and secure transfer to maintenance management systems. Organizations should customize the CMMS endpoint and API configuration for their specific environment."
    },
    "nist_csf_mappings": {
      "v1.1": [
        "PR.MA-1",
        "DE.AE-1",
        "DE.CM-1"
      ],
      "v2.0": [
        "PR.MA-01",
        "DE.AE-02",
        "DE.CM-01"
      ]
    },
    "nist_sp_800_171_mapping": null
  },
  {
    "control_id": "MA-7",
    "control_name": "Field Maintenance",
    "family": "Maintenance",
    "family_id": "MA",
    "stig_id": null,
    "official_text": "Restrict or prohibit field maintenance on [Assignment: organization-defined systems or system components] to [Assignment: organization-defined trusted maintenance facilities].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false,
      "privacy": false
    },
    "intent": "To ensure that maintenance activities on critical or sensitive systems are performed only in controlled, trusted environments where proper security measures, quality controls, and oversight are available, thereby reducing the risk of unauthorized modifications, tampering, or introduction of malicious components during field-based maintenance operations.",
    "ai_guidance": "MA-7 Field Maintenance addresses security requirements for maintenance performed outside organizational facilities. Implementation involves: (1) Establish procedures for sanitizing equipment before off-site maintenance, (2) Implement tamper-evident packaging for equipment in transit, (3) Verify maintenance facility security posture and personnel clearances, (4) Require encrypted storage for any data that must accompany equipment. Document chain-of-custody from departure through return. Implement GPS tracking for high-value equipment. Require contractual security obligations from third-party maintenance providers. Verify equipment integrity upon return using configuration baselines and integrity checking. Restrict field maintenance to non-sensitive systems where possible. For classified systems, require appropriately cleared maintenance personnel and certified facilities. Establish emergency procedures for equipment compromise during field maintenance.",
    "plain_english_explanation": "Field maintenance refers to repair and servicing work performed on systems at their operational location (in the field) rather than at a centralized depot or repair facility. This control recognizes that maintenance performed on-site may not have the same level of security oversight, quality controls, or controlled environment that a dedicated maintenance facility can provide. For highly sensitive or critical systems, organizations should consider restricting or prohibiting field maintenance entirely, instead requiring that systems be transported to trusted facilities where proper security measures can be enforced. This reduces the risk of tampering, unauthorized modifications, or the introduction of malicious components during maintenance activities.",
    "implementation_guidance": "Organizations should evaluate their system inventory to identify components that warrant restricted field maintenance based on criticality, sensitivity, and the security implications of unauthorized access during maintenance. For identified systems: (1) Designate specific trusted maintenance facilities with appropriate physical security controls, personnel vetting, and quality assurance processes; (2) Establish formal procedures for transporting systems to and from these facilities, including chain-of-custody documentation; (3) Define clear criteria for any exceptions where field maintenance may be permitted, along with compensating controls and approval requirements; (4) Train maintenance personnel on the restrictions and proper procedures; (5) Maintain comprehensive maintenance logs that document where maintenance was performed and by whom.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "MA-2",
      "MA-4",
      "MA-5",
      "PE-16",
      "PE-17",
      "SC-28"
    ],
    "supplemental_guidance": "Field maintenance is maintenance conducted on a system or system component after the system or component has been deployed to a specific site (i.e., operational environment). In certain instances, field maintenance (i.e., local maintenance at the site) may not be executed with the same degree of rigor or with the same quality control checks as depot maintenance. For critical systems, field maintenance may not provide an acceptable level of confidence that the maintenance was conducted properly, and that the system is functioning correctly. Organizations define the types of systems and system components for which field maintenance is restricted or prohibited, and they identify trusted maintenance facilities that provide appropriate levels of security, oversight, and quality assurance.",
    "parameters": [
      {
        "id": "ma-07_odp.01",
        "label": "systems or system components",
        "description": "Organization-defined systems or system components for which field maintenance is restricted or prohibited"
      },
      {
        "id": "ma-07_odp.02",
        "label": "trusted maintenance facilities",
        "description": "Organization-defined trusted maintenance facilities where maintenance should be performed"
      }
    ],
    "example_implementation": "For critical infrastructure systems, cryptographic modules, and systems processing classified information: (1) Prohibit all field maintenance activities; (2) Require transport to the Organization's Certified Maintenance Center (CMC) for any repairs; (3) Implement tamper-evident seals that must be inspected before and after transport; (4) Maintain chain-of-custody logs for all systems in transit; (5) Require dual-person integrity for maintenance operations at the CMC.",
    "non_technical_guidance": "To implement this control: 1) Identify which systems are critical enough to warrant restricted field maintenance - typically those handling classified information, cryptographic functions, or critical infrastructure operations; 2) Designate specific facilities as trusted maintenance locations with proper security certifications; 3) Create documented procedures for when and how systems must be transported to these facilities; 4) Establish exception procedures for emergency situations where field maintenance may be unavoidable, including required approvals and compensating controls; 5) Train all relevant personnel on these restrictions and procedures; 6) Conduct periodic reviews to ensure compliance.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "revision": "5",
      "control_type": "organizational"
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "cac_status": "not_applicable",
      "cac_planned": false,
      "implementation_guidance": "This is an organizational/procedural control that cannot be automated through technical means. Requires policy documentation, facility designations, and personnel training."
    }
  }
]