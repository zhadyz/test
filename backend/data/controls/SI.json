[
  {
    "control_id": "SI-1",
    "control_name": "Policy and Procedures",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "This control ensures that organizations have clear policies and procedures in place to guide their information security practices.",
    "example_implementation": "This script regularly review and update your organization's policies and procedures to ensure they are current and effective in addressing potential security risks.",
    "non_technical_guidance": "This plan develop and implement policies and procedures that outline the organization's security requirements, responsibilities, and processes. These policies should address access control, data protection, incident response, and other key security areas. Regularly review and update these policies to ensure they remain current and relevant to the organization's operations. Provide training to employees on these policies and procedures to ensure compliance with security requirements. Regularly audit and assess adherence to policies and procedures to identify and address any gaps or non-compliance.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-10T10:26:00.490981+00:00",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires organizational policy documentation and procedures. No technical automation available."
    },
    "ai_guidance": "SI-1 requires establishing and maintaining formal policies and procedures for System and Information Integrity. Organizations should document flaw remediation processes, malicious code protection requirements, monitoring expectations, and alerting procedures. Review policies annually and update based on lessons learned from security incidents. Ensure all personnel understand their responsibilities for reporting suspicious activity.",
    "intent": "Ensure policy and procedures capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-1 helps protect system and information integrity by policy and procedures."
  },
  {
    "control_id": "SI-2",
    "control_name": "Flaw Remediation",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Flaw Remediation requires organizations to promptly address and fix any security vulnerabilities or weaknesses in their systems or software.",
    "example_implementation": "This script implement a regular schedule for scanning and patching systems to quickly identify and fix any security flaws before they can be exploited by attackers.",
    "non_technical_guidance": "This plan to ensure compliance with control si-2 \"Flaw Remediation\", a clear process for identifying and remediating software flaws should be established within the organization. This process should include regular vulnerability scanning of systems and applications, prioritization of identified flaws based on severity, and timely application of patches and updates. Additionally, a system for tracking and documenting remediation efforts should be implemented to ensure accountability and compliance with this control. Regular training and awareness programs for IT staff on the importance of flaw remediation should also be conducted to maintain a strong security posture.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-2.1",
        "title": "Central Management",
        "official_text": ""
      },
      {
        "id": "si-2.2",
        "title": "Automated Flaw Remediation Status",
        "official_text": "Determine if system components have applicable security-relevant software and firmware updates installed using {{ insert: param, si-02.02_odp.01 }} {{ insert: param, si-02.02_odp.02 }}."
      },
      {
        "id": "si-2.3",
        "title": "Time to Remediate Flaws and Benchmarks for Corrective Actions",
        "official_text": ""
      },
      {
        "id": "si-2.4",
        "title": "Automated Patch Management Tools",
        "official_text": "Employ automated patch management tools to facilitate flaw remediation to the following system components: {{ insert: param, si-02.04_odp }}."
      },
      {
        "id": "si-2.5",
        "title": "Automatic Software and Firmware Updates",
        "official_text": "Install {{ insert: param, si-02.05_odp.01 }} automatically to {{ insert: param, si-02.05_odp.02 }}."
      },
      {
        "id": "si-2.6",
        "title": "Removal of Previous Versions of Software and Firmware",
        "official_text": "Remove previous versions of {{ insert: param, si-02.06_odp }} after updated versions have been installed."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-2: Flaw Remediation - Automated Patch Management\n# Checks for and applies security updates\n\nset -euo pipefail\n\necho \"=== SI-2 Flaw Remediation Check ===\"\n\n# Detect package manager\nif command -v dnf &>/dev/null; then\n    PKG_MGR=\"dnf\"\nelif command -v yum &>/dev/null; then\n    PKG_MGR=\"yum\"\nelif command -v apt-get &>/dev/null; then\n    PKG_MGR=\"apt\"\nelse\n    echo \"ERROR: Unsupported package manager\"\n    exit 1\nfi\n\n# Check for security updates\necho \"Checking for security updates...\"\ncase $PKG_MGR in\n    dnf|yum)\n        $PKG_MGR check-update --security 2>/dev/null || true\n        echo \"Installing security updates...\"\n        $PKG_MGR update --security -y\n        ;;\n    apt)\n        apt-get update\n        apt-get upgrade -s | grep -i security || true\n        echo \"Installing security updates...\"\n        DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\n        ;;\nesac\n\n# Configure automatic updates\nif [ \"$PKG_MGR\" = \"dnf\" ] || [ \"$PKG_MGR\" = \"yum\" ]; then\n    dnf install -y dnf-automatic\n    systemctl enable --now dnf-automatic.timer\n    sed -i 's/apply_updates = no/apply_updates = yes/' /etc/dnf/automatic.conf\nelif [ \"$PKG_MGR\" = \"apt\" ]; then\n    apt-get install -y unattended-upgrades\n    dpkg-reconfigure -plow unattended-upgrades\nfi\n\necho \"SI-2 flaw remediation configured successfully\"\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Ansible Playbook\n- name: SI-2 Flaw Remediation\n  hosts: all\n  become: yes\n  tasks:\n    - name: Update all packages (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: \"*\"\n        state: latest\n        security: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install dnf-automatic (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: dnf-automatic\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Configure automatic security updates (RHEL)\n      ansible.builtin.lineinfile:\n        path: /etc/dnf/automatic.conf\n        regexp: '^apply_updates'\n        line: 'apply_updates = yes'\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Enable dnf-automatic timer\n      ansible.builtin.systemd:\n        name: dnf-automatic.timer\n        enabled: yes\n        state: started\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages (Debian/Ubuntu)\n      ansible.builtin.apt:\n        upgrade: safe\n        update_cache: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Install unattended-upgrades (Debian/Ubuntu)\n      ansible.builtin.apt:\n        name: unattended-upgrades\n        state: present\n      when: ansible_os_family == \"Debian\"\n"
      },
      "windows": {
        "powershell": "# SI-2: Flaw Remediation - Windows Update Management\n# Configures and runs Windows Update for security patches\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-2 Flaw Remediation - Windows ===\" -ForegroundColor Cyan\n\n# Install PSWindowsUpdate module if not present\nif (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {\n    Install-Module PSWindowsUpdate -Force -Confirm:$false\n}\nImport-Module PSWindowsUpdate\n\n# Check for updates\nWrite-Host \"Checking for security updates...\"\n$Updates = Get-WindowsUpdate -Category \"Security Updates\" -Verbose\n\nif ($Updates.Count -eq 0) {\n    Write-Host \"No security updates available\" -ForegroundColor Green\n} else {\n    Write-Host \"Found $($Updates.Count) security updates\" -ForegroundColor Yellow\n\n    # Install security updates\n    Write-Host \"Installing security updates...\"\n    Install-WindowsUpdate -Category \"Security Updates\" -AcceptAll -AutoReboot:$false\n}\n\n# Configure Windows Update settings via registry\n$WUPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\"\nif (-not (Test-Path $WUPath)) {\n    New-Item -Path $WUPath -Force | Out-Null\n}\n\n# Enable automatic updates\nSet-ItemProperty -Path $WUPath -Name \"NoAutoUpdate\" -Value 0 -Type DWord\nSet-ItemProperty -Path $WUPath -Name \"AUOptions\" -Value 4 -Type DWord  # Auto download and schedule install\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallDay\" -Value 0 -Type DWord  # Every day\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallTime\" -Value 3 -Type DWord  # 3 AM\n\nWrite-Host \"SI-2 Windows Update configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Windows Ansible\n- name: SI-2 Windows Flaw Remediation\n  hosts: windows\n  tasks:\n    - name: Install all security updates\n      ansible.windows.win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: installed\n        reboot: no\n      register: update_result\n\n    - name: Configure automatic updates\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\n        name: \"{{ item.name }}\"\n        data: \"{{ item.data }}\"\n        type: dword\n      loop:\n        - { name: 'NoAutoUpdate', data: 0 }\n        - { name: 'AUOptions', data: 4 }\n"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-10T10:27:06.778353+00:00",
      "source": "ComplianceAsCode",
      "last_updated": "2025-11-10T10:27:06.803469+00:00",
      "platform": "rhcos4",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "stig_id": "RHEL-08-010010, RHEL-08-010020",
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure flaw remediation capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2 helps protect system and information integrity by flaw remediation."
  },
  {
    "control_id": "SI-2.1",
    "control_name": "Central Management",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-2",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-2: Flaw Remediation - Automated Patch Management\n# Checks for and applies security updates\n\nset -euo pipefail\n\necho \"=== SI-2 Flaw Remediation Check ===\"\n\n# Detect package manager\nif command -v dnf &>/dev/null; then\n    PKG_MGR=\"dnf\"\nelif command -v yum &>/dev/null; then\n    PKG_MGR=\"yum\"\nelif command -v apt-get &>/dev/null; then\n    PKG_MGR=\"apt\"\nelse\n    echo \"ERROR: Unsupported package manager\"\n    exit 1\nfi\n\n# Check for security updates\necho \"Checking for security updates...\"\ncase $PKG_MGR in\n    dnf|yum)\n        $PKG_MGR check-update --security 2>/dev/null || true\n        echo \"Installing security updates...\"\n        $PKG_MGR update --security -y\n        ;;\n    apt)\n        apt-get update\n        apt-get upgrade -s | grep -i security || true\n        echo \"Installing security updates...\"\n        DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\n        ;;\nesac\n\n# Configure automatic updates\nif [ \"$PKG_MGR\" = \"dnf\" ] || [ \"$PKG_MGR\" = \"yum\" ]; then\n    dnf install -y dnf-automatic\n    systemctl enable --now dnf-automatic.timer\n    sed -i 's/apply_updates = no/apply_updates = yes/' /etc/dnf/automatic.conf\nelif [ \"$PKG_MGR\" = \"apt\" ]; then\n    apt-get install -y unattended-upgrades\n    dpkg-reconfigure -plow unattended-upgrades\nfi\n\necho \"SI-2 flaw remediation configured successfully\"\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Ansible Playbook\n- name: SI-2 Flaw Remediation\n  hosts: all\n  become: yes\n  tasks:\n    - name: Update all packages (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: \"*\"\n        state: latest\n        security: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install dnf-automatic (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: dnf-automatic\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Configure automatic security updates (RHEL)\n      ansible.builtin.lineinfile:\n        path: /etc/dnf/automatic.conf\n        regexp: '^apply_updates'\n        line: 'apply_updates = yes'\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Enable dnf-automatic timer\n      ansible.builtin.systemd:\n        name: dnf-automatic.timer\n        enabled: yes\n        state: started\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages (Debian/Ubuntu)\n      ansible.builtin.apt:\n        upgrade: safe\n        update_cache: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Install unattended-upgrades (Debian/Ubuntu)\n      ansible.builtin.apt:\n        name: unattended-upgrades\n        state: present\n      when: ansible_os_family == \"Debian\"\n"
      },
      "windows": {
        "powershell": "# SI-2: Flaw Remediation - Windows Update Management\n# Configures and runs Windows Update for security patches\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-2 Flaw Remediation - Windows ===\" -ForegroundColor Cyan\n\n# Install PSWindowsUpdate module if not present\nif (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {\n    Install-Module PSWindowsUpdate -Force -Confirm:$false\n}\nImport-Module PSWindowsUpdate\n\n# Check for updates\nWrite-Host \"Checking for security updates...\"\n$Updates = Get-WindowsUpdate -Category \"Security Updates\" -Verbose\n\nif ($Updates.Count -eq 0) {\n    Write-Host \"No security updates available\" -ForegroundColor Green\n} else {\n    Write-Host \"Found $($Updates.Count) security updates\" -ForegroundColor Yellow\n\n    # Install security updates\n    Write-Host \"Installing security updates...\"\n    Install-WindowsUpdate -Category \"Security Updates\" -AcceptAll -AutoReboot:$false\n}\n\n# Configure Windows Update settings via registry\n$WUPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\"\nif (-not (Test-Path $WUPath)) {\n    New-Item -Path $WUPath -Force | Out-Null\n}\n\n# Enable automatic updates\nSet-ItemProperty -Path $WUPath -Name \"NoAutoUpdate\" -Value 0 -Type DWord\nSet-ItemProperty -Path $WUPath -Name \"AUOptions\" -Value 4 -Type DWord  # Auto download and schedule install\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallDay\" -Value 0 -Type DWord  # Every day\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallTime\" -Value 3 -Type DWord  # 3 AM\n\nWrite-Host \"SI-2 Windows Update configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Windows Ansible\n- name: SI-2 Windows Flaw Remediation\n  hosts: windows\n  tasks:\n    - name: Install all security updates\n      ansible.windows.win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: installed\n        reboot: no\n      register: update_result\n\n    - name: Configure automatic updates\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\n        name: \"{{ item.name }}\"\n        data: \"{{ item.data }}\"\n        type: dword\n      loop:\n        - { name: 'NoAutoUpdate', data: 0 }\n        - { name: 'AUOptions', data: 4 }\n"
      }
    },
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure central management capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2.1 helps protect system and information integrity by central management.",
    "plain_english_explanation": "This control requires organizations to implement central management to maintain system and information integrity."
  },
  {
    "control_id": "SI-2.2",
    "control_name": "Automated Flaw Remediation Status",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-2",
    "stig_id": "RHEL-08-010010",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-2: Flaw Remediation - Automated Patch Management\n# Checks for and applies security updates\n\nset -euo pipefail\n\necho \"=== SI-2 Flaw Remediation Check ===\"\n\n# Detect package manager\nif command -v dnf &>/dev/null; then\n    PKG_MGR=\"dnf\"\nelif command -v yum &>/dev/null; then\n    PKG_MGR=\"yum\"\nelif command -v apt-get &>/dev/null; then\n    PKG_MGR=\"apt\"\nelse\n    echo \"ERROR: Unsupported package manager\"\n    exit 1\nfi\n\n# Check for security updates\necho \"Checking for security updates...\"\ncase $PKG_MGR in\n    dnf|yum)\n        $PKG_MGR check-update --security 2>/dev/null || true\n        echo \"Installing security updates...\"\n        $PKG_MGR update --security -y\n        ;;\n    apt)\n        apt-get update\n        apt-get upgrade -s | grep -i security || true\n        echo \"Installing security updates...\"\n        DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\n        ;;\nesac\n\n# Configure automatic updates\nif [ \"$PKG_MGR\" = \"dnf\" ] || [ \"$PKG_MGR\" = \"yum\" ]; then\n    dnf install -y dnf-automatic\n    systemctl enable --now dnf-automatic.timer\n    sed -i 's/apply_updates = no/apply_updates = yes/' /etc/dnf/automatic.conf\nelif [ \"$PKG_MGR\" = \"apt\" ]; then\n    apt-get install -y unattended-upgrades\n    dpkg-reconfigure -plow unattended-upgrades\nfi\n\necho \"SI-2 flaw remediation configured successfully\"\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Ansible Playbook\n- name: SI-2 Flaw Remediation\n  hosts: all\n  become: yes\n  tasks:\n    - name: Update all packages (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: \"*\"\n        state: latest\n        security: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install dnf-automatic (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: dnf-automatic\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Configure automatic security updates (RHEL)\n      ansible.builtin.lineinfile:\n        path: /etc/dnf/automatic.conf\n        regexp: '^apply_updates'\n        line: 'apply_updates = yes'\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Enable dnf-automatic timer\n      ansible.builtin.systemd:\n        name: dnf-automatic.timer\n        enabled: yes\n        state: started\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages (Debian/Ubuntu)\n      ansible.builtin.apt:\n        upgrade: safe\n        update_cache: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Install unattended-upgrades (Debian/Ubuntu)\n      ansible.builtin.apt:\n        name: unattended-upgrades\n        state: present\n      when: ansible_os_family == \"Debian\"\n"
      },
      "windows": {
        "powershell": "# SI-2: Flaw Remediation - Windows Update Management\n# Configures and runs Windows Update for security patches\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-2 Flaw Remediation - Windows ===\" -ForegroundColor Cyan\n\n# Install PSWindowsUpdate module if not present\nif (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {\n    Install-Module PSWindowsUpdate -Force -Confirm:$false\n}\nImport-Module PSWindowsUpdate\n\n# Check for updates\nWrite-Host \"Checking for security updates...\"\n$Updates = Get-WindowsUpdate -Category \"Security Updates\" -Verbose\n\nif ($Updates.Count -eq 0) {\n    Write-Host \"No security updates available\" -ForegroundColor Green\n} else {\n    Write-Host \"Found $($Updates.Count) security updates\" -ForegroundColor Yellow\n\n    # Install security updates\n    Write-Host \"Installing security updates...\"\n    Install-WindowsUpdate -Category \"Security Updates\" -AcceptAll -AutoReboot:$false\n}\n\n# Configure Windows Update settings via registry\n$WUPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\"\nif (-not (Test-Path $WUPath)) {\n    New-Item -Path $WUPath -Force | Out-Null\n}\n\n# Enable automatic updates\nSet-ItemProperty -Path $WUPath -Name \"NoAutoUpdate\" -Value 0 -Type DWord\nSet-ItemProperty -Path $WUPath -Name \"AUOptions\" -Value 4 -Type DWord  # Auto download and schedule install\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallDay\" -Value 0 -Type DWord  # Every day\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallTime\" -Value 3 -Type DWord  # 3 AM\n\nWrite-Host \"SI-2 Windows Update configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Windows Ansible\n- name: SI-2 Windows Flaw Remediation\n  hosts: windows\n  tasks:\n    - name: Install all security updates\n      ansible.windows.win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: installed\n        reboot: no\n      register: update_result\n\n    - name: Configure automatic updates\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\n        name: \"{{ item.name }}\"\n        data: \"{{ item.data }}\"\n        type: dword\n      loop:\n        - { name: 'NoAutoUpdate', data: 0 }\n        - { name: 'AUOptions', data: 4 }\n"
      }
    },
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure automated flaw remediation status capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2.2 helps protect system and information integrity by automated flaw remediation status.",
    "plain_english_explanation": "This control requires organizations to implement automated flaw remediation status to maintain system and information integrity."
  },
  {
    "control_id": "SI-2.3",
    "control_name": "Time to Remediate Flaws and Benchmarks for Corrective Actions",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-2",
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure time to remediate flaws and benchmarks for corrective actions capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2.3 helps protect system and information integrity by time to remediate flaws and benchmarks for corrective actions.",
    "plain_english_explanation": "This control requires organizations to implement time to remediate flaws and benchmarks for corrective actions to maintain system and information integrity."
  },
  {
    "control_id": "SI-2.4",
    "control_name": "Automated Patch Management Tools",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-2",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-2: Flaw Remediation - Automated Patch Management\n# Checks for and applies security updates\n\nset -euo pipefail\n\necho \"=== SI-2 Flaw Remediation Check ===\"\n\n# Detect package manager\nif command -v dnf &>/dev/null; then\n    PKG_MGR=\"dnf\"\nelif command -v yum &>/dev/null; then\n    PKG_MGR=\"yum\"\nelif command -v apt-get &>/dev/null; then\n    PKG_MGR=\"apt\"\nelse\n    echo \"ERROR: Unsupported package manager\"\n    exit 1\nfi\n\n# Check for security updates\necho \"Checking for security updates...\"\ncase $PKG_MGR in\n    dnf|yum)\n        $PKG_MGR check-update --security 2>/dev/null || true\n        echo \"Installing security updates...\"\n        $PKG_MGR update --security -y\n        ;;\n    apt)\n        apt-get update\n        apt-get upgrade -s | grep -i security || true\n        echo \"Installing security updates...\"\n        DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\n        ;;\nesac\n\n# Configure automatic updates\nif [ \"$PKG_MGR\" = \"dnf\" ] || [ \"$PKG_MGR\" = \"yum\" ]; then\n    dnf install -y dnf-automatic\n    systemctl enable --now dnf-automatic.timer\n    sed -i 's/apply_updates = no/apply_updates = yes/' /etc/dnf/automatic.conf\nelif [ \"$PKG_MGR\" = \"apt\" ]; then\n    apt-get install -y unattended-upgrades\n    dpkg-reconfigure -plow unattended-upgrades\nfi\n\necho \"SI-2 flaw remediation configured successfully\"\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Ansible Playbook\n- name: SI-2 Flaw Remediation\n  hosts: all\n  become: yes\n  tasks:\n    - name: Update all packages (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: \"*\"\n        state: latest\n        security: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install dnf-automatic (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: dnf-automatic\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Configure automatic security updates (RHEL)\n      ansible.builtin.lineinfile:\n        path: /etc/dnf/automatic.conf\n        regexp: '^apply_updates'\n        line: 'apply_updates = yes'\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Enable dnf-automatic timer\n      ansible.builtin.systemd:\n        name: dnf-automatic.timer\n        enabled: yes\n        state: started\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages (Debian/Ubuntu)\n      ansible.builtin.apt:\n        upgrade: safe\n        update_cache: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Install unattended-upgrades (Debian/Ubuntu)\n      ansible.builtin.apt:\n        name: unattended-upgrades\n        state: present\n      when: ansible_os_family == \"Debian\"\n"
      },
      "windows": {
        "powershell": "# SI-2: Flaw Remediation - Windows Update Management\n# Configures and runs Windows Update for security patches\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-2 Flaw Remediation - Windows ===\" -ForegroundColor Cyan\n\n# Install PSWindowsUpdate module if not present\nif (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {\n    Install-Module PSWindowsUpdate -Force -Confirm:$false\n}\nImport-Module PSWindowsUpdate\n\n# Check for updates\nWrite-Host \"Checking for security updates...\"\n$Updates = Get-WindowsUpdate -Category \"Security Updates\" -Verbose\n\nif ($Updates.Count -eq 0) {\n    Write-Host \"No security updates available\" -ForegroundColor Green\n} else {\n    Write-Host \"Found $($Updates.Count) security updates\" -ForegroundColor Yellow\n\n    # Install security updates\n    Write-Host \"Installing security updates...\"\n    Install-WindowsUpdate -Category \"Security Updates\" -AcceptAll -AutoReboot:$false\n}\n\n# Configure Windows Update settings via registry\n$WUPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\"\nif (-not (Test-Path $WUPath)) {\n    New-Item -Path $WUPath -Force | Out-Null\n}\n\n# Enable automatic updates\nSet-ItemProperty -Path $WUPath -Name \"NoAutoUpdate\" -Value 0 -Type DWord\nSet-ItemProperty -Path $WUPath -Name \"AUOptions\" -Value 4 -Type DWord  # Auto download and schedule install\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallDay\" -Value 0 -Type DWord  # Every day\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallTime\" -Value 3 -Type DWord  # 3 AM\n\nWrite-Host \"SI-2 Windows Update configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Windows Ansible\n- name: SI-2 Windows Flaw Remediation\n  hosts: windows\n  tasks:\n    - name: Install all security updates\n      ansible.windows.win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: installed\n        reboot: no\n      register: update_result\n\n    - name: Configure automatic updates\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\n        name: \"{{ item.name }}\"\n        data: \"{{ item.data }}\"\n        type: dword\n      loop:\n        - { name: 'NoAutoUpdate', data: 0 }\n        - { name: 'AUOptions', data: 4 }\n"
      }
    },
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure automated patch management tools capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2.4 helps protect system and information integrity by automated patch management tools.",
    "plain_english_explanation": "This control requires organizations to implement automated patch management tools to maintain system and information integrity."
  },
  {
    "control_id": "SI-2.5",
    "control_name": "Automatic Software and Firmware Updates",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-2",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-2: Flaw Remediation - Automated Patch Management\n# Checks for and applies security updates\n\nset -euo pipefail\n\necho \"=== SI-2 Flaw Remediation Check ===\"\n\n# Detect package manager\nif command -v dnf &>/dev/null; then\n    PKG_MGR=\"dnf\"\nelif command -v yum &>/dev/null; then\n    PKG_MGR=\"yum\"\nelif command -v apt-get &>/dev/null; then\n    PKG_MGR=\"apt\"\nelse\n    echo \"ERROR: Unsupported package manager\"\n    exit 1\nfi\n\n# Check for security updates\necho \"Checking for security updates...\"\ncase $PKG_MGR in\n    dnf|yum)\n        $PKG_MGR check-update --security 2>/dev/null || true\n        echo \"Installing security updates...\"\n        $PKG_MGR update --security -y\n        ;;\n    apt)\n        apt-get update\n        apt-get upgrade -s | grep -i security || true\n        echo \"Installing security updates...\"\n        DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\n        ;;\nesac\n\n# Configure automatic updates\nif [ \"$PKG_MGR\" = \"dnf\" ] || [ \"$PKG_MGR\" = \"yum\" ]; then\n    dnf install -y dnf-automatic\n    systemctl enable --now dnf-automatic.timer\n    sed -i 's/apply_updates = no/apply_updates = yes/' /etc/dnf/automatic.conf\nelif [ \"$PKG_MGR\" = \"apt\" ]; then\n    apt-get install -y unattended-upgrades\n    dpkg-reconfigure -plow unattended-upgrades\nfi\n\necho \"SI-2 flaw remediation configured successfully\"\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Ansible Playbook\n- name: SI-2 Flaw Remediation\n  hosts: all\n  become: yes\n  tasks:\n    - name: Update all packages (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: \"*\"\n        state: latest\n        security: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install dnf-automatic (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: dnf-automatic\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Configure automatic security updates (RHEL)\n      ansible.builtin.lineinfile:\n        path: /etc/dnf/automatic.conf\n        regexp: '^apply_updates'\n        line: 'apply_updates = yes'\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Enable dnf-automatic timer\n      ansible.builtin.systemd:\n        name: dnf-automatic.timer\n        enabled: yes\n        state: started\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages (Debian/Ubuntu)\n      ansible.builtin.apt:\n        upgrade: safe\n        update_cache: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Install unattended-upgrades (Debian/Ubuntu)\n      ansible.builtin.apt:\n        name: unattended-upgrades\n        state: present\n      when: ansible_os_family == \"Debian\"\n"
      },
      "windows": {
        "powershell": "# SI-2: Flaw Remediation - Windows Update Management\n# Configures and runs Windows Update for security patches\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-2 Flaw Remediation - Windows ===\" -ForegroundColor Cyan\n\n# Install PSWindowsUpdate module if not present\nif (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {\n    Install-Module PSWindowsUpdate -Force -Confirm:$false\n}\nImport-Module PSWindowsUpdate\n\n# Check for updates\nWrite-Host \"Checking for security updates...\"\n$Updates = Get-WindowsUpdate -Category \"Security Updates\" -Verbose\n\nif ($Updates.Count -eq 0) {\n    Write-Host \"No security updates available\" -ForegroundColor Green\n} else {\n    Write-Host \"Found $($Updates.Count) security updates\" -ForegroundColor Yellow\n\n    # Install security updates\n    Write-Host \"Installing security updates...\"\n    Install-WindowsUpdate -Category \"Security Updates\" -AcceptAll -AutoReboot:$false\n}\n\n# Configure Windows Update settings via registry\n$WUPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\"\nif (-not (Test-Path $WUPath)) {\n    New-Item -Path $WUPath -Force | Out-Null\n}\n\n# Enable automatic updates\nSet-ItemProperty -Path $WUPath -Name \"NoAutoUpdate\" -Value 0 -Type DWord\nSet-ItemProperty -Path $WUPath -Name \"AUOptions\" -Value 4 -Type DWord  # Auto download and schedule install\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallDay\" -Value 0 -Type DWord  # Every day\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallTime\" -Value 3 -Type DWord  # 3 AM\n\nWrite-Host \"SI-2 Windows Update configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Windows Ansible\n- name: SI-2 Windows Flaw Remediation\n  hosts: windows\n  tasks:\n    - name: Install all security updates\n      ansible.windows.win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: installed\n        reboot: no\n      register: update_result\n\n    - name: Configure automatic updates\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\n        name: \"{{ item.name }}\"\n        data: \"{{ item.data }}\"\n        type: dword\n      loop:\n        - { name: 'NoAutoUpdate', data: 0 }\n        - { name: 'AUOptions', data: 4 }\n"
      }
    },
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure automatic software and firmware updates capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2.5 helps protect system and information integrity by automatic software and firmware updates.",
    "plain_english_explanation": "This control requires organizations to implement automatic software and firmware updates to maintain system and information integrity."
  },
  {
    "control_id": "SI-2.6",
    "control_name": "Removal of Previous Versions of Software and Firmware",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-2",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-2: Flaw Remediation - Automated Patch Management\n# Checks for and applies security updates\n\nset -euo pipefail\n\necho \"=== SI-2 Flaw Remediation Check ===\"\n\n# Detect package manager\nif command -v dnf &>/dev/null; then\n    PKG_MGR=\"dnf\"\nelif command -v yum &>/dev/null; then\n    PKG_MGR=\"yum\"\nelif command -v apt-get &>/dev/null; then\n    PKG_MGR=\"apt\"\nelse\n    echo \"ERROR: Unsupported package manager\"\n    exit 1\nfi\n\n# Check for security updates\necho \"Checking for security updates...\"\ncase $PKG_MGR in\n    dnf|yum)\n        $PKG_MGR check-update --security 2>/dev/null || true\n        echo \"Installing security updates...\"\n        $PKG_MGR update --security -y\n        ;;\n    apt)\n        apt-get update\n        apt-get upgrade -s | grep -i security || true\n        echo \"Installing security updates...\"\n        DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\n        ;;\nesac\n\n# Configure automatic updates\nif [ \"$PKG_MGR\" = \"dnf\" ] || [ \"$PKG_MGR\" = \"yum\" ]; then\n    dnf install -y dnf-automatic\n    systemctl enable --now dnf-automatic.timer\n    sed -i 's/apply_updates = no/apply_updates = yes/' /etc/dnf/automatic.conf\nelif [ \"$PKG_MGR\" = \"apt\" ]; then\n    apt-get install -y unattended-upgrades\n    dpkg-reconfigure -plow unattended-upgrades\nfi\n\necho \"SI-2 flaw remediation configured successfully\"\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Ansible Playbook\n- name: SI-2 Flaw Remediation\n  hosts: all\n  become: yes\n  tasks:\n    - name: Update all packages (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: \"*\"\n        state: latest\n        security: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install dnf-automatic (RHEL/CentOS)\n      ansible.builtin.dnf:\n        name: dnf-automatic\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Configure automatic security updates (RHEL)\n      ansible.builtin.lineinfile:\n        path: /etc/dnf/automatic.conf\n        regexp: '^apply_updates'\n        line: 'apply_updates = yes'\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Enable dnf-automatic timer\n      ansible.builtin.systemd:\n        name: dnf-automatic.timer\n        enabled: yes\n        state: started\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Update all packages (Debian/Ubuntu)\n      ansible.builtin.apt:\n        upgrade: safe\n        update_cache: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Install unattended-upgrades (Debian/Ubuntu)\n      ansible.builtin.apt:\n        name: unattended-upgrades\n        state: present\n      when: ansible_os_family == \"Debian\"\n"
      },
      "windows": {
        "powershell": "# SI-2: Flaw Remediation - Windows Update Management\n# Configures and runs Windows Update for security patches\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-2 Flaw Remediation - Windows ===\" -ForegroundColor Cyan\n\n# Install PSWindowsUpdate module if not present\nif (-not (Get-Module -ListAvailable -Name PSWindowsUpdate)) {\n    Install-Module PSWindowsUpdate -Force -Confirm:$false\n}\nImport-Module PSWindowsUpdate\n\n# Check for updates\nWrite-Host \"Checking for security updates...\"\n$Updates = Get-WindowsUpdate -Category \"Security Updates\" -Verbose\n\nif ($Updates.Count -eq 0) {\n    Write-Host \"No security updates available\" -ForegroundColor Green\n} else {\n    Write-Host \"Found $($Updates.Count) security updates\" -ForegroundColor Yellow\n\n    # Install security updates\n    Write-Host \"Installing security updates...\"\n    Install-WindowsUpdate -Category \"Security Updates\" -AcceptAll -AutoReboot:$false\n}\n\n# Configure Windows Update settings via registry\n$WUPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\"\nif (-not (Test-Path $WUPath)) {\n    New-Item -Path $WUPath -Force | Out-Null\n}\n\n# Enable automatic updates\nSet-ItemProperty -Path $WUPath -Name \"NoAutoUpdate\" -Value 0 -Type DWord\nSet-ItemProperty -Path $WUPath -Name \"AUOptions\" -Value 4 -Type DWord  # Auto download and schedule install\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallDay\" -Value 0 -Type DWord  # Every day\nSet-ItemProperty -Path $WUPath -Name \"ScheduledInstallTime\" -Value 3 -Type DWord  # 3 AM\n\nWrite-Host \"SI-2 Windows Update configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-2: Flaw Remediation - Windows Ansible\n- name: SI-2 Windows Flaw Remediation\n  hosts: windows\n  tasks:\n    - name: Install all security updates\n      ansible.windows.win_updates:\n        category_names:\n          - SecurityUpdates\n          - CriticalUpdates\n        state: installed\n        reboot: no\n      register: update_result\n\n    - name: Configure automatic updates\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\n        name: \"{{ item.name }}\"\n        data: \"{{ item.data }}\"\n        type: dword\n      loop:\n        - { name: 'NoAutoUpdate', data: 0 }\n        - { name: 'AUOptions', data: 4 }\n"
      }
    },
    "ai_guidance": "SI-2 Flaw Remediation requires identifying, reporting, and correcting system flaws in a timely manner. Implement automated patch management using tools like WSUS, SCCM, Satellite, or Ansible. Establish patch timelines: critical vulnerabilities within 14 days, high within 30 days, medium within 90 days. Test patches in non-production environments before deployment. Track remediation metrics and report exceptions.",
    "intent": "Ensure removal of previous versions of software and firmware capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-2.6 helps protect system and information integrity by removal of previous versions of software and firmware.",
    "plain_english_explanation": "This control requires organizations to implement removal of previous versions of software and firmware to maintain system and information integrity."
  },
  {
    "control_id": "SI-3",
    "control_name": "Malicious Code Protection",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Malicious Code Protection helps prevent harmful software from infecting a system.",
    "example_implementation": "This script regularly update anti-virus software and conduct routine scans to detect and remove any malicious code.",
    "non_technical_guidance": "This plan to comply with the Malicious Code Protection control (si-3), ensure that antivirus software is installed on all systems to protect against the execution of malicious code. Regularly update the antivirus software and perform system scans to detect and remove any malicious code. Additionally, educate users on safe browsing habits and the importance of not downloading or executing suspicious files. Regularly review and update security policies to address new threats and vulnerabilities.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-3.1",
        "title": "Central Management",
        "official_text": ""
      },
      {
        "id": "si-3.2",
        "title": "Automatic Updates",
        "official_text": ""
      },
      {
        "id": "si-3.3",
        "title": "Non-privileged Users",
        "official_text": ""
      },
      {
        "id": "si-3.4",
        "title": "Updates Only by Privileged Users",
        "official_text": "Update malicious code protection mechanisms only when directed by a privileged user."
      },
      {
        "id": "si-3.5",
        "title": "Portable Storage Devices",
        "official_text": ""
      },
      {
        "id": "si-3.6",
        "title": "Testing and Verification",
        "official_text": ""
      },
      {
        "id": "si-3.7",
        "title": "Nonsignature-based Detection",
        "official_text": ""
      },
      {
        "id": "si-3.8",
        "title": "Detect Unauthorized Commands",
        "official_text": ""
      },
      {
        "id": "si-3.9",
        "title": "Authenticate Remote Commands",
        "official_text": ""
      },
      {
        "id": "si-3.10",
        "title": "Malicious Code Analysis",
        "official_text": ""
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:27:26.158379+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "stig_id": "RHEL-08-010000",
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure malicious code protection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3 helps protect system and information integrity by malicious code protection."
  },
  {
    "control_id": "SI-3.1",
    "control_name": "Central Management",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure central management capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.1 helps protect system and information integrity by central management.",
    "plain_english_explanation": "This control requires organizations to implement central management to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.2",
    "control_name": "Automatic Updates",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure automatic updates capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.2 helps protect system and information integrity by automatic updates.",
    "plain_english_explanation": "This control requires organizations to implement automatic updates to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.3",
    "control_name": "Non-privileged Users",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure non-privileged users capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.3 helps protect system and information integrity by non-privileged users.",
    "plain_english_explanation": "This control requires organizations to implement non-privileged users to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.4",
    "control_name": "Updates Only by Privileged Users",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure updates only by privileged users capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.4 helps protect system and information integrity by updates only by privileged users.",
    "plain_english_explanation": "This control requires organizations to implement updates only by privileged users to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.5",
    "control_name": "Portable Storage Devices",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure portable storage devices capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.5 helps protect system and information integrity by portable storage devices.",
    "plain_english_explanation": "This control requires organizations to implement portable storage devices to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.6",
    "control_name": "Testing and Verification",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure testing and verification capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.6 helps protect system and information integrity by testing and verification.",
    "plain_english_explanation": "This control requires organizations to implement testing and verification to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.7",
    "control_name": "Nonsignature-based Detection",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure nonsignature-based detection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.7 helps protect system and information integrity by nonsignature-based detection.",
    "plain_english_explanation": "This control requires organizations to implement nonsignature-based detection to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.8",
    "control_name": "Detect Unauthorized Commands",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure detect unauthorized commands capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.8 helps protect system and information integrity by detect unauthorized commands.",
    "plain_english_explanation": "This control requires organizations to implement detect unauthorized commands to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.9",
    "control_name": "Authenticate Remote Commands",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure authenticate remote commands capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.9 helps protect system and information integrity by authenticate remote commands.",
    "plain_english_explanation": "This control requires organizations to implement authenticate remote commands to maintain system and information integrity."
  },
  {
    "control_id": "SI-3.10",
    "control_name": "Malicious Code Analysis",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-3",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-3: Malicious Code Protection - ClamAV Setup\n# Installs and configures antivirus scanning\n\nset -euo pipefail\n\necho \"=== SI-3 Malicious Code Protection ===\"\n\n# Install ClamAV\nif command -v dnf &>/dev/null; then\n    dnf install -y clamav clamav-update clamd\nelif command -v apt-get &>/dev/null; then\n    apt-get update\n    apt-get install -y clamav clamav-daemon clamav-freshclam\nfi\n\n# Update virus definitions\necho \"Updating virus definitions...\"\nfreshclam || true\n\n# Configure clamd for on-access scanning\ncat > /etc/clamd.d/scan.conf << 'EOF'\nLocalSocket /var/run/clamd.scan/clamd.sock\nFixStaleSocket yes\nLocalSocketGroup clamscan\nLocalSocketMode 660\nUser clamscan\nScanPE yes\nScanELF yes\nDetectBrokenExecutables yes\nScanOLE2 yes\nScanPDF yes\nScanHTML yes\nScanMail yes\nScanArchive yes\nArchiveBlockEncrypted no\nMaxDirectoryRecursion 20\nFollowDirectorySymlinks yes\nFollowFileSymlinks yes\nReadTimeout 180\nMaxThreads 12\nMaxConnectionQueueLength 15\nLogSyslog yes\nLogFacility LOG_LOCAL6\nLogClean no\nLogVerbose yes\nEOF\n\n# Enable and start services\nsystemctl enable clamav-freshclam clamd@scan\nsystemctl start clamav-freshclam clamd@scan || true\n\n# Create daily scan cron job\ncat > /etc/cron.daily/clamscan << 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/clamav/daily_scan.log\"\nclamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" --exclude-dir=\"^/dev\" -l $LOGFILE\nEOF\nchmod +x /etc/cron.daily/clamscan\n\necho \"SI-3 Malicious code protection configured\"\n",
        "ansible": "---\n# SI-3: Malicious Code Protection - Ansible\n- name: SI-3 Malicious Code Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install ClamAV (RHEL)\n      ansible.builtin.dnf:\n        name:\n          - clamav\n          - clamav-update\n          - clamd\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install ClamAV (Debian)\n      ansible.builtin.apt:\n        name:\n          - clamav\n          - clamav-daemon\n          - clamav-freshclam\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Update virus definitions\n      ansible.builtin.command: freshclam\n      changed_when: false\n      failed_when: false\n\n    - name: Enable ClamAV services\n      ansible.builtin.systemd:\n        name: \"{{ item }}\"\n        enabled: yes\n        state: started\n      loop:\n        - clamav-freshclam\n      ignore_errors: yes\n\n    - name: Create daily scan script\n      ansible.builtin.copy:\n        dest: /etc/cron.daily/clamscan\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          clamscan -r / --exclude-dir=\"^/sys\" --exclude-dir=\"^/proc\" -l /var/log/clamav/daily.log\n"
      },
      "windows": {
        "powershell": "# SI-3: Malicious Code Protection - Windows Defender\n# Configures Windows Defender for real-time protection\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-3 Malicious Code Protection ===\" -ForegroundColor Cyan\n\n# Ensure Windows Defender is enabled\nSet-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableBehaviorMonitoring $false\nSet-MpPreference -DisableBlockAtFirstSeen $false\nSet-MpPreference -DisableIOAVProtection $false\nSet-MpPreference -DisableScriptScanning $false\n\n# Configure scan settings\nSet-MpPreference -ScanParameters 2  # Full scan\nSet-MpPreference -ScanScheduleDay 0  # Every day\nSet-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)  # 2 AM\nSet-MpPreference -RemediationScheduleDay 0\nSet-MpPreference -SignatureScheduleDay 0\n\n# Enable cloud-delivered protection\nSet-MpPreference -MAPSReporting Advanced\nSet-MpPreference -SubmitSamplesConsent SendAllSamples\n\n# Enable network protection\nSet-MpPreference -EnableNetworkProtection Enabled\n\n# Enable controlled folder access\nSet-MpPreference -EnableControlledFolderAccess Enabled\n\n# Update definitions\nWrite-Host \"Updating malware definitions...\"\nUpdate-MpSignature\n\n# Run quick scan\nWrite-Host \"Running quick scan...\"\nStart-MpScan -ScanType QuickScan\n\n# Get status\nGet-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, AntivirusSignatureLastUpdated\n\nWrite-Host \"SI-3 Windows Defender configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-3: Windows Defender Configuration\n- name: SI-3 Malicious Code Protection Windows\n  hosts: windows\n  tasks:\n    - name: Enable real-time protection\n      ansible.windows.win_shell: |\n        Set-MpPreference -DisableRealtimeMonitoring $false\n        Set-MpPreference -DisableBehaviorMonitoring $false\n        Set-MpPreference -DisableIOAVProtection $false\n\n    - name: Configure scan schedule\n      ansible.windows.win_shell: |\n        Set-MpPreference -ScanScheduleDay 0\n        Set-MpPreference -ScanScheduleTime (New-TimeSpan -Hours 2)\n\n    - name: Update definitions\n      ansible.windows.win_shell: Update-MpSignature\n"
      }
    },
    "ai_guidance": "SI-3 Malicious Code Protection requires deploying and maintaining antimalware solutions across all endpoints. Use enterprise solutions like CrowdStrike, Microsoft Defender for Endpoint, or ClamAV. Enable real-time scanning, automatic definition updates, and centralized management. Configure to detect malware at entry points (email gateways, web proxies) and on endpoints. Implement application whitelisting where feasible.",
    "intent": "Ensure malicious code analysis capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-3.10 helps protect system and information integrity by malicious code analysis.",
    "plain_english_explanation": "This control requires organizations to implement malicious code analysis to maintain system and information integrity."
  },
  {
    "control_id": "SI-4",
    "control_name": "System Monitoring",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "System Monitoring involves continuously observing and analyzing the behavior of an organization's IT systems to detect and respond to potential security threats.",
    "example_implementation": "This script implement a centralized system monitoring tool that can track and alert on any unusual activity across all systems in real-time, ensuring quick detection and response to security incidents.",
    "non_technical_guidance": "This plan to ensure compliance with control si-4, it is important to implement system monitoring on all relevant systems. This can be achieved by installing a monitoring agent on each system that collects and reports system metrics and logs. Regularly review the monitoring data to identify any anomalies or potential security issues. Additionally, set up alerts to notify relevant personnel in case of any abnormal behavior. Regularly update and maintain the monitoring tools to ensure they are effective in detecting and responding to security incidents.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-4.1",
        "title": "System-wide Intrusion Detection System",
        "official_text": "Connect and configure individual intrusion detection tools into a system-wide intrusion detection system."
      },
      {
        "id": "si-4.2",
        "title": "Automated Tools and Mechanisms for Real-time Analysis",
        "official_text": "Employ automated tools and mechanisms to support near real-time analysis of events."
      },
      {
        "id": "si-4.3",
        "title": "Automated Tool and Mechanism Integration",
        "official_text": "Employ automated tools and mechanisms to integrate intrusion detection tools and mechanisms into access control and flow control mechanisms."
      },
      {
        "id": "si-4.4",
        "title": "Inbound and Outbound Communications Traffic",
        "official_text": ""
      },
      {
        "id": "si-4.5",
        "title": "System-generated Alerts",
        "official_text": "Alert {{ insert: param, si-04.05_odp.01 }} when the following system-generated indications of compromise or potential compromise occur: {{ insert: param, si-04.05_odp.02 }}."
      },
      {
        "id": "si-4.6",
        "title": "Restrict Non-privileged Users",
        "official_text": ""
      },
      {
        "id": "si-4.7",
        "title": "Automated Response to Suspicious Events",
        "official_text": ""
      },
      {
        "id": "si-4.8",
        "title": "Protection of Monitoring Information",
        "official_text": ""
      },
      {
        "id": "si-4.9",
        "title": "Testing of Monitoring Tools and Mechanisms",
        "official_text": "Test intrusion-monitoring tools and mechanisms {{ insert: param, si-04.09_odp }}."
      },
      {
        "id": "si-4.10",
        "title": "Visibility of Encrypted Communications",
        "official_text": "Make provisions so that {{ insert: param, si-04.10_odp.01 }} is visible to {{ insert: param, si-04.10_odp.02 }}."
      },
      {
        "id": "si-4.11",
        "title": "Analyze Communications Traffic Anomalies",
        "official_text": "Analyze outbound communications traffic at the external interfaces to the system and selected {{ insert: param, si-04.11_odp }} to discover anomalies."
      },
      {
        "id": "si-4.12",
        "title": "Automated Organization-generated Alerts",
        "official_text": "Alert {{ insert: param, si-04.12_odp.01 }} using {{ insert: param, si-04.12_odp.02 }} when the following indications of inappropriate or unusual activities with security or privacy implications occur: {{ insert: param, si-04.12_odp.03 }}."
      },
      {
        "id": "si-4.13",
        "title": "Analyze Traffic and Event Patterns",
        "official_text": ""
      },
      {
        "id": "si-4.14",
        "title": "Wireless Intrusion Detection",
        "official_text": "Employ a wireless intrusion detection system to identify rogue wireless devices and to detect attack attempts and potential compromises or breaches to the system."
      },
      {
        "id": "si-4.15",
        "title": "Wireless to Wireline Communications",
        "official_text": "Employ an intrusion detection system to monitor wireless communications traffic as the traffic passes from wireless to wireline networks."
      },
      {
        "id": "si-4.16",
        "title": "Correlate Monitoring Information",
        "official_text": "Correlate information from monitoring tools and mechanisms employed throughout the system."
      },
      {
        "id": "si-4.17",
        "title": "Integrated Situational Awareness",
        "official_text": "Correlate information from monitoring physical, cyber, and supply chain activities to achieve integrated, organization-wide situational awareness."
      },
      {
        "id": "si-4.18",
        "title": "Analyze Traffic and Covert Exfiltration",
        "official_text": "Analyze outbound communications traffic at external interfaces to the system and at the following interior points to detect covert exfiltration of information: {{ insert: param, si-04.18_odp }}."
      },
      {
        "id": "si-4.19",
        "title": "Risk for Individuals",
        "official_text": "Implement {{ insert: param, si-04.19_odp.01 }} of individuals who have been identified by {{ insert: param, si-04.19_odp.02 }} as posing an increased level of risk."
      },
      {
        "id": "si-4.20",
        "title": "Privileged Users",
        "official_text": "Implement the following additional monitoring of privileged users: {{ insert: param, si-04.20_odp }}."
      },
      {
        "id": "si-4.21",
        "title": "Probationary Periods",
        "official_text": "Implement the following additional monitoring of individuals during {{ insert: param, si-04.21_odp.02 }}: {{ insert: param, si-04.21_odp.01 }}."
      },
      {
        "id": "si-4.22",
        "title": "Unauthorized Network Services",
        "official_text": ""
      },
      {
        "id": "si-4.23",
        "title": "Host-based Devices",
        "official_text": "Implement the following host-based monitoring mechanisms at {{ insert: param, si-04.23_odp.02 }}: {{ insert: param, si-04.23_odp.01 }}."
      },
      {
        "id": "si-4.24",
        "title": "Indicators of Compromise",
        "official_text": "Discover, collect, and distribute to {{ insert: param, si-04.24_odp.02 }} , indicators of compromise provided by {{ insert: param, si-04.24_odp.01 }}."
      },
      {
        "id": "si-4.25",
        "title": "Optimize Network Traffic Analysis",
        "official_text": "Provide visibility into network traffic at external and key internal system interfaces to optimize the effectiveness of monitoring devices."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:27:43.790051+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "stig_id": "RHEL-08-030000, RHEL-08-030010",
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure system monitoring capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4 helps protect system and information integrity by system monitoring."
  },
  {
    "control_id": "SI-4.1",
    "control_name": "System-wide Intrusion Detection System",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure system-wide intrusion detection system capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.1 helps protect system and information integrity by system-wide intrusion detection system.",
    "plain_english_explanation": "This control requires organizations to implement system-wide intrusion detection system to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.2",
    "control_name": "Automated Tools and Mechanisms for Real-time Analysis",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure automated tools and mechanisms for real-time analysis capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.2 helps protect system and information integrity by automated tools and mechanisms for real-time analysis.",
    "plain_english_explanation": "This control requires organizations to implement automated tools and mechanisms for real-time analysis to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.3",
    "control_name": "Automated Tool and Mechanism Integration",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure automated tool and mechanism integration capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.3 helps protect system and information integrity by automated tool and mechanism integration.",
    "plain_english_explanation": "This control requires organizations to implement automated tool and mechanism integration to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.4",
    "control_name": "Inbound and Outbound Communications Traffic",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "stig_id": "RHEL-08-030360, RHEL-08-030361",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure inbound and outbound communications traffic capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.4 helps protect system and information integrity by inbound and outbound communications traffic.",
    "plain_english_explanation": "This control requires organizations to implement inbound and outbound communications traffic to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.5",
    "control_name": "System-generated Alerts",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "stig_id": "RHEL-08-030170, RHEL-08-030171",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure system-generated alerts capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.5 helps protect system and information integrity by system-generated alerts.",
    "plain_english_explanation": "This control requires organizations to implement system-generated alerts to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.6",
    "control_name": "Restrict Non-privileged Users",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure restrict non-privileged users capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.6 helps protect system and information integrity by restrict non-privileged users.",
    "plain_english_explanation": "This control requires organizations to implement restrict non-privileged users to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.7",
    "control_name": "Automated Response to Suspicious Events",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure automated response to suspicious events capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.7 helps protect system and information integrity by automated response to suspicious events.",
    "plain_english_explanation": "This control requires organizations to implement automated response to suspicious events to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.8",
    "control_name": "Protection of Monitoring Information",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure protection of monitoring information capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.8 helps protect system and information integrity by protection of monitoring information.",
    "plain_english_explanation": "This control requires organizations to implement protection of monitoring information to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.9",
    "control_name": "Testing of Monitoring Tools and Mechanisms",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure testing of monitoring tools and mechanisms capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.9 helps protect system and information integrity by testing of monitoring tools and mechanisms.",
    "plain_english_explanation": "This control requires organizations to implement testing of monitoring tools and mechanisms to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.10",
    "control_name": "Visibility of Encrypted Communications",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure visibility of encrypted communications capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.10 helps protect system and information integrity by visibility of encrypted communications.",
    "plain_english_explanation": "This control requires organizations to implement visibility of encrypted communications to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.11",
    "control_name": "Analyze Communications Traffic Anomalies",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure analyze communications traffic anomalies capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.11 helps protect system and information integrity by analyze communications traffic anomalies.",
    "plain_english_explanation": "This control requires organizations to implement analyze communications traffic anomalies to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.12",
    "control_name": "Automated Organization-generated Alerts",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure automated organization-generated alerts capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.12 helps protect system and information integrity by automated organization-generated alerts.",
    "plain_english_explanation": "This control requires organizations to implement automated organization-generated alerts to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.13",
    "control_name": "Analyze Traffic and Event Patterns",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure analyze traffic and event patterns capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.13 helps protect system and information integrity by analyze traffic and event patterns.",
    "plain_english_explanation": "This control requires organizations to implement analyze traffic and event patterns to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.14",
    "control_name": "Wireless Intrusion Detection",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure wireless intrusion detection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.14 helps protect system and information integrity by wireless intrusion detection.",
    "plain_english_explanation": "This control requires organizations to implement wireless intrusion detection to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.15",
    "control_name": "Wireless to Wireline Communications",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure wireless to wireline communications capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.15 helps protect system and information integrity by wireless to wireline communications.",
    "plain_english_explanation": "This control requires organizations to implement wireless to wireline communications to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.16",
    "control_name": "Correlate Monitoring Information",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure correlate monitoring information capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.16 helps protect system and information integrity by correlate monitoring information.",
    "plain_english_explanation": "This control requires organizations to implement correlate monitoring information to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.17",
    "control_name": "Integrated Situational Awareness",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure integrated situational awareness capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.17 helps protect system and information integrity by integrated situational awareness.",
    "plain_english_explanation": "This control requires organizations to implement integrated situational awareness to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.18",
    "control_name": "Analyze Traffic and Covert Exfiltration",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure analyze traffic and covert exfiltration capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.18 helps protect system and information integrity by analyze traffic and covert exfiltration.",
    "plain_english_explanation": "This control requires organizations to implement analyze traffic and covert exfiltration to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.19",
    "control_name": "Risk for Individuals",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure risk for individuals capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.19 helps protect system and information integrity by risk for individuals.",
    "plain_english_explanation": "This control requires organizations to implement risk for individuals to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.20",
    "control_name": "Privileged Users",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure privileged users capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.20 helps protect system and information integrity by privileged users.",
    "plain_english_explanation": "This control requires organizations to implement privileged users to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.21",
    "control_name": "Probationary Periods",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure probationary periods capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.21 helps protect system and information integrity by probationary periods.",
    "plain_english_explanation": "This control requires organizations to implement probationary periods to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.22",
    "control_name": "Unauthorized Network Services",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure unauthorized network services capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.22 helps protect system and information integrity by unauthorized network services.",
    "plain_english_explanation": "This control requires organizations to implement unauthorized network services to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.23",
    "control_name": "Host-based Devices",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure host-based devices capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.23 helps protect system and information integrity by host-based devices.",
    "plain_english_explanation": "This control requires organizations to implement host-based devices to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.24",
    "control_name": "Indicators of Compromise",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure indicators of compromise capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.24 helps protect system and information integrity by indicators of compromise.",
    "plain_english_explanation": "This control requires organizations to implement indicators of compromise to maintain system and information integrity."
  },
  {
    "control_id": "SI-4.25",
    "control_name": "Optimize Network Traffic Analysis",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-4",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-4: System Monitoring - Audit and IDS Configuration\n# Configures auditd and basic intrusion detection\n\nset -euo pipefail\n\necho \"=== SI-4 System Monitoring ===\"\n\n# Install audit tools\nif command -v dnf &>/dev/null; then\n    dnf install -y audit audispd-plugins\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y auditd audispd-plugins\nfi\n\n# Configure comprehensive audit rules\ncat > /etc/audit/rules.d/si-4-monitoring.rules << 'EOF'\n# SI-4 System Monitoring Rules\n\n# Delete all existing rules\n-D\n\n# Set buffer size\n-b 8192\n\n# Failure mode - 1 = printk, 2 = panic\n-f 1\n\n# Monitor user/group changes\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/sudoers -p wa -k identity\n-w /etc/sudoers.d/ -p wa -k identity\n\n# Monitor authentication\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n# Monitor privilege escalation\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k privilege_escalation\n\n# Monitor system calls for suspicious activity\n-a always,exit -F arch=b64 -S ptrace -k tracing\n-a always,exit -F arch=b64 -S personality -k bypass\n\n# Monitor network configuration\n-w /etc/hosts -p wa -k network_config\n-w /etc/sysconfig/network -p wa -k network_config\n-w /etc/network/ -p wa -k network_config\n\n# Monitor cron\n-w /etc/crontab -p wa -k cron\n-w /etc/cron.d/ -p wa -k cron\n-w /var/spool/cron/ -p wa -k cron\n\n# Make rules immutable (reboot required to change)\n-e 2\nEOF\n\n# Restart auditd to apply rules\nservice auditd restart\n\n# Configure rsyslog for centralized logging\ncat >> /etc/rsyslog.conf << 'EOF'\n\n# SI-4 Remote logging configuration\n# Uncomment and configure for your SIEM:\n# *.* @@siem.example.com:514\nEOF\n\n# Install and configure AIDE for file integrity\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide\nfi\n\n# Initialize AIDE database\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\necho \"SI-4 System monitoring configured\"\n",
        "ansible": "---\n# SI-4: System Monitoring - Ansible\n- name: SI-4 System Monitoring\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install audit packages\n      ansible.builtin.package:\n        name:\n          - audit\n          - audispd-plugins\n        state: present\n\n    - name: Deploy audit rules\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/si-4.rules\n        content: |\n          -D\n          -b 8192\n          -w /etc/passwd -p wa -k identity\n          -w /etc/group -p wa -k identity\n          -w /etc/shadow -p wa -k identity\n          -w /etc/sudoers -p wa -k identity\n          -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k escalation\n          -e 2\n      notify: restart auditd\n\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n  handlers:\n    - name: restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted\n"
      },
      "windows": {
        "powershell": "# SI-4: System Monitoring - Windows Event Logging\n# Configures comprehensive Windows auditing\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-4 System Monitoring ===\" -ForegroundColor Cyan\n\n# Enable advanced audit policies\n$AuditPolicies = @{\n    \"Account Logon\" = @(\"Credential Validation\", \"Kerberos Authentication Service\", \"Kerberos Service Ticket Operations\")\n    \"Account Management\" = @(\"Computer Account Management\", \"Security Group Management\", \"User Account Management\")\n    \"Logon/Logoff\" = @(\"Account Lockout\", \"Logoff\", \"Logon\", \"Special Logon\")\n    \"Object Access\" = @(\"File System\", \"Registry\", \"SAM\")\n    \"Policy Change\" = @(\"Audit Policy Change\", \"Authentication Policy Change\")\n    \"Privilege Use\" = @(\"Sensitive Privilege Use\")\n    \"System\" = @(\"Security State Change\", \"Security System Extension\", \"System Integrity\")\n}\n\nforeach ($Category in $AuditPolicies.Keys) {\n    foreach ($Subcategory in $AuditPolicies[$Category]) {\n        auditpol /set /subcategory:\"$Subcategory\" /success:enable /failure:enable 2>$null\n    }\n}\n\n# Configure Security log size and retention\n$LogName = \"Security\"\n$Log = Get-WinEvent -ListLog $LogName\n$Log.MaximumSizeInBytes = 1073741824  # 1GB\n$Log.IsEnabled = $true\n$Log.SaveChanges()\n\nwevtutil sl Security /ms:1073741824 /rt:false\n\n# Enable PowerShell script block logging\n$PSLoggingPath = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-not (Test-Path $PSLoggingPath)) {\n    New-Item -Path $PSLoggingPath -Force | Out-Null\n}\nSet-ItemProperty -Path $PSLoggingPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable command line auditing\n$CommandLinePath = \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\"\nif (-not (Test-Path $CommandLinePath)) {\n    New-Item -Path $CommandLinePath -Force | Out-Null\n}\nSet-ItemProperty -Path $CommandLinePath -Name \"ProcessCreationIncludeCmdLine_Enabled\" -Value 1 -Type DWord\n\n# Configure Windows Event Forwarding (WEF) subscription\nWrite-Host \"Configure WEF subscriptions for centralized logging to SIEM\"\n\nWrite-Host \"SI-4 Windows monitoring configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-4: Windows System Monitoring\n- name: SI-4 Windows Monitoring\n  hosts: windows\n  tasks:\n    - name: Enable audit policies\n      ansible.windows.win_shell: |\n        auditpol /set /subcategory:\"Credential Validation\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"User Account Management\" /success:enable /failure:enable\n\n    - name: Configure Security log size\n      ansible.windows.win_shell: wevtutil sl Security /ms:1073741824\n\n    - name: Enable PowerShell logging\n      ansible.windows.win_regedit:\n        path: HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\n        name: EnableScriptBlockLogging\n        data: 1\n        type: dword\n"
      }
    },
    "ai_guidance": "SI-4 System Monitoring requires implementing comprehensive monitoring across networks and systems. Deploy SIEM solutions (Splunk, Elastic, Microsoft Sentinel) to aggregate logs. Configure auditd/Windows Event Logging for detailed system activity. Implement network monitoring (Zeek, Suricata) for traffic analysis. Establish baseline behaviors and alert on anomalies. Retain logs per organizational policy (typically 90 days online, 1 year archived).",
    "intent": "Ensure optimize network traffic analysis capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-4.25 helps protect system and information integrity by optimize network traffic analysis.",
    "plain_english_explanation": "This control requires organizations to implement optimize network traffic analysis to maintain system and information integrity."
  },
  {
    "control_id": "SI-5",
    "control_name": "Security Alerts, Advisories, and Directives",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "This control requires organizations to receive and act on security alerts, advisories, and directives to protect their systems and data.",
    "example_implementation": "This script sets up automated alerts from trusted sources such as CERT to stay informed about potential security threats and vulnerabilities. Regularly review and update your incident response plan based on the information received.",
    "non_technical_guidance": "This plan to comply with control si-5, organizations should establish a process for monitoring security alerts, advisories, and directives from relevant sources such as NIST, US-CERT, vendor notifications, and security mailing lists. This process should include regularly checking for new alerts, advisories, and directives, evaluating their relevance to the organization's systems and networks, and implementing any necessary actions or mitigations in a timely manner. Additionally, organizations should document their process for monitoring security alerts and ensure that relevant personnel are trained on how to respond to alerts effectively.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "si-5.1",
        "title": "Automated Alerts and Advisories",
        "official_text": "Broadcast security alert and advisory information throughout the organization using {{ insert: param, si-05.01_odp }}."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:28:25.656405+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-5 requires receiving and acting upon security alerts, advisories, and directives from authoritative sources. Subscribe to US-CERT alerts, vendor security bulletins, and industry ISACs. Establish processes to evaluate applicability and prioritize response. Document decisions and track implementation of required actions. Share relevant threat intelligence with appropriate personnel.",
    "intent": "Ensure security alerts, advisories, and directives capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-5 helps protect system and information integrity by security alerts, advisories, and directives."
  },
  {
    "control_id": "SI-5.1",
    "control_name": "Automated Alerts and Advisories",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-5",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-5 requires receiving and acting upon security alerts, advisories, and directives from authoritative sources. Subscribe to US-CERT alerts, vendor security bulletins, and industry ISACs. Establish processes to evaluate applicability and prioritize response. Document decisions and track implementation of required actions. Share relevant threat intelligence with appropriate personnel.",
    "intent": "Ensure automated alerts and advisories capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-5.1 helps protect system and information integrity by automated alerts and advisories.",
    "plain_english_explanation": "This control requires organizations to implement automated alerts and advisories to maintain system and information integrity."
  },
  {
    "control_id": "SI-6",
    "control_name": "Security and Privacy Function Verification",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "Security and privacy functions are tested and verified to ensure they are working correctly.",
    "example_implementation": "This script regularly conduct thorough testing and verification of security and privacy functions to ensure they are effectively protecting sensitive data.",
    "non_technical_guidance": "This plan to comply with Control ID si-6, Security and Privacy Function Verification, organizations should establish a process for regularly verifying that security and privacy functions are operating as intended. This can be achieved by conducting regular audits, assessments, and reviews of security controls and privacy measures in place. Organizations should also ensure that any changes to security or privacy configurations are thoroughly tested and validated to ensure they do not introduce vulnerabilities. Additionally, organizations should document and track the results of these verification activities to demonstrate compliance with this control during audits or assessments.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-6.1",
        "title": "Notification of Failed Security Tests",
        "official_text": ""
      },
      {
        "id": "si-6.2",
        "title": "Automation Support for Distributed Testing",
        "official_text": "Implement automated mechanisms to support the management of distributed security and privacy function testing."
      },
      {
        "id": "si-6.3",
        "title": "Report Verification Results",
        "official_text": "Report the results of security and privacy function verification to {{ insert: param, si-06.03_odp }}."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:28:28.880478+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "stig_id": "RHEL-08-010171",
    "ai_guidance": "SI-6 requires verifying security functions operate correctly. Implement automated testing of security controls using tools like OpenSCAP, Nessus, or CIS-CAT. Schedule regular verification scans (weekly minimum). Alert administrators when security functions fail or produce unexpected results. Document testing procedures and maintain evidence of compliance.",
    "intent": "Ensure security and privacy function verification capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-6 helps protect system and information integrity by security and privacy function verification."
  },
  {
    "control_id": "SI-6.1",
    "control_name": "Notification of Failed Security Tests",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-6",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-6 requires verifying security functions operate correctly. Implement automated testing of security controls using tools like OpenSCAP, Nessus, or CIS-CAT. Schedule regular verification scans (weekly minimum). Alert administrators when security functions fail or produce unexpected results. Document testing procedures and maintain evidence of compliance.",
    "intent": "Ensure notification of failed security tests capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-6.1 helps protect system and information integrity by notification of failed security tests.",
    "plain_english_explanation": "This control requires organizations to implement notification of failed security tests to maintain system and information integrity."
  },
  {
    "control_id": "SI-6.2",
    "control_name": "Automation Support for Distributed Testing",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-6",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-6 requires verifying security functions operate correctly. Implement automated testing of security controls using tools like OpenSCAP, Nessus, or CIS-CAT. Schedule regular verification scans (weekly minimum). Alert administrators when security functions fail or produce unexpected results. Document testing procedures and maintain evidence of compliance.",
    "intent": "Ensure automation support for distributed testing capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-6.2 helps protect system and information integrity by automation support for distributed testing.",
    "plain_english_explanation": "This control requires organizations to implement automation support for distributed testing to maintain system and information integrity."
  },
  {
    "control_id": "SI-6.3",
    "control_name": "Report Verification Results",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-6",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-6 requires verifying security functions operate correctly. Implement automated testing of security controls using tools like OpenSCAP, Nessus, or CIS-CAT. Schedule regular verification scans (weekly minimum). Alert administrators when security functions fail or produce unexpected results. Document testing procedures and maintain evidence of compliance.",
    "intent": "Ensure report verification results capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-6.3 helps protect system and information integrity by report verification results.",
    "plain_english_explanation": "This control requires organizations to implement report verification results to maintain system and information integrity."
  },
  {
    "control_id": "SI-7",
    "control_name": "Software, Firmware, and Information Integrity",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "This control ensures that software, firmware, and information are protected from unauthorized access or changes.",
    "example_implementation": "This script regularly scan your systems for any unauthorized changes or malware, and implement software updates and patches to maintain integrity.",
    "non_technical_guidance": "This plan to implement control SI-7 (Software, Firmware, and Information Integrity), you can follow these steps:\n\n1. Establish a baseline of approved software, firmware, and information that is authorized to be present on the systems.\n2. Regularly scan systems to detect any unauthorized or malicious software, firmware, or information.\n3. Implement change management processes to ensure that any changes to software, firmware, or information are authorized and documented.\n4. Use digital signatures and checksums to verify the integrity of software and firmware before installation.\n5. Train employees on the importance of software, firmware, and information integrity and the risks associated with unauthorized changes.\n\nBy following these steps, you can ensure that software, firmware, and information integrity is maintained within your organization.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-7.1",
        "title": "Integrity Checks",
        "official_text": "Perform an integrity check of {{ insert: param, si-7.1_prm_1 }} {{ insert: param, si-7.1_prm_2 }}."
      },
      {
        "id": "si-7.2",
        "title": "Automated Notifications of Integrity Violations",
        "official_text": "Employ automated tools that provide notification to {{ insert: param, si-07.02_odp }} upon discovering discrepancies during integrity verification."
      },
      {
        "id": "si-7.3",
        "title": "Centrally Managed Integrity Tools",
        "official_text": "Employ centrally managed integrity verification tools."
      },
      {
        "id": "si-7.4",
        "title": "Tamper-evident Packaging",
        "official_text": ""
      },
      {
        "id": "si-7.5",
        "title": "Automated Response to Integrity Violations",
        "official_text": "Automatically {{ insert: param, si-07.05_odp.01 }} when integrity violations are discovered."
      },
      {
        "id": "si-7.6",
        "title": "Cryptographic Protection",
        "official_text": "Implement cryptographic mechanisms to detect unauthorized changes to software, firmware, and information."
      },
      {
        "id": "si-7.7",
        "title": "Integration of Detection and Response",
        "official_text": "Incorporate the detection of the following unauthorized changes into the organizational incident response capability: {{ insert: param, si-07.07_odp }}."
      },
      {
        "id": "si-7.8",
        "title": "Auditing Capability for Significant Events",
        "official_text": "Upon detection of a potential integrity violation, provide the capability to audit the event and initiate the following actions: {{ insert: param, si-07.08_odp.01 }}."
      },
      {
        "id": "si-7.9",
        "title": "Verify Boot Process",
        "official_text": "Verify the integrity of the boot process of the following system components: {{ insert: param, si-07.09_odp }}."
      },
      {
        "id": "si-7.10",
        "title": "Protection of Boot Firmware",
        "official_text": "Implement the following mechanisms to protect the integrity of boot firmware in {{ insert: param, si-07.10_odp.02 }}: {{ insert: param, si-07.10_odp.01 }}."
      },
      {
        "id": "si-7.11",
        "title": "Confined Environments with Limited Privileges",
        "official_text": ""
      },
      {
        "id": "si-7.12",
        "title": "Integrity Verification",
        "official_text": "Require that the integrity of the following user-installed software be verified prior to execution: {{ insert: param, si-07.12_odp }}."
      },
      {
        "id": "si-7.13",
        "title": "Code Execution in Protected Environments",
        "official_text": ""
      },
      {
        "id": "si-7.14",
        "title": "Binary or Machine Executable Code",
        "official_text": ""
      },
      {
        "id": "si-7.15",
        "title": "Code Authentication",
        "official_text": "Implement cryptographic mechanisms to authenticate the following software or firmware components prior to installation: {{ insert: param, si-07.15_odp }}."
      },
      {
        "id": "si-7.16",
        "title": "Time Limit on Process Execution Without Supervision",
        "official_text": "Prohibit processes from executing without supervision for more than {{ insert: param, si-07.16_odp }}."
      },
      {
        "id": "si-7.17",
        "title": "Runtime Application Self-protection",
        "official_text": "Implement {{ insert: param, si-07.17_odp }} for application self-protection at runtime."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:28:35.256695+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "stig_id": "RHEL-08-010359, RHEL-08-010360",
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure software, firmware, and information integrity capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7 helps protect system and information integrity by software, firmware, and information integrity."
  },
  {
    "control_id": "SI-7.1",
    "control_name": "Integrity Checks",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "stig_id": "RHEL-08-010510",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure integrity checks capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.1 helps protect system and information integrity by integrity checks.",
    "plain_english_explanation": "This control requires organizations to implement integrity checks to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.2",
    "control_name": "Automated Notifications of Integrity Violations",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure automated notifications of integrity violations capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.2 helps protect system and information integrity by automated notifications of integrity violations.",
    "plain_english_explanation": "This control requires organizations to implement automated notifications of integrity violations to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.3",
    "control_name": "Centrally Managed Integrity Tools",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure centrally managed integrity tools capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.3 helps protect system and information integrity by centrally managed integrity tools.",
    "plain_english_explanation": "This control requires organizations to implement centrally managed integrity tools to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.4",
    "control_name": "Tamper-evident Packaging",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure tamper-evident packaging capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.4 helps protect system and information integrity by tamper-evident packaging.",
    "plain_english_explanation": "This control requires organizations to implement tamper-evident packaging to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.5",
    "control_name": "Automated Response to Integrity Violations",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure automated response to integrity violations capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.5 helps protect system and information integrity by automated response to integrity violations.",
    "plain_english_explanation": "This control requires organizations to implement automated response to integrity violations to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.6",
    "control_name": "Cryptographic Protection",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "stig_id": "RHEL-08-010020",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure cryptographic protection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.6 helps protect system and information integrity by cryptographic protection.",
    "plain_english_explanation": "This control requires organizations to implement cryptographic protection to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.7",
    "control_name": "Integration of Detection and Response",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "stig_id": "RHEL-08-010019",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure integration of detection and response capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.7 helps protect system and information integrity by integration of detection and response.",
    "plain_english_explanation": "This control requires organizations to implement integration of detection and response to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.8",
    "control_name": "Auditing Capability for Significant Events",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure auditing capability for significant events capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.8 helps protect system and information integrity by auditing capability for significant events.",
    "plain_english_explanation": "This control requires organizations to implement auditing capability for significant events to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.9",
    "control_name": "Verify Boot Process",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure verify boot process capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.9 helps protect system and information integrity by verify boot process.",
    "plain_english_explanation": "This control requires organizations to implement verify boot process to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.10",
    "control_name": "Protection of Boot Firmware",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure protection of boot firmware capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.10 helps protect system and information integrity by protection of boot firmware.",
    "plain_english_explanation": "This control requires organizations to implement protection of boot firmware to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.11",
    "control_name": "Confined Environments with Limited Privileges",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure confined environments with limited privileges capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.11 helps protect system and information integrity by confined environments with limited privileges.",
    "plain_english_explanation": "This control requires organizations to implement confined environments with limited privileges to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.12",
    "control_name": "Integrity Verification",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure integrity verification capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.12 helps protect system and information integrity by integrity verification.",
    "plain_english_explanation": "This control requires organizations to implement integrity verification to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.13",
    "control_name": "Code Execution in Protected Environments",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure code execution in protected environments capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.13 helps protect system and information integrity by code execution in protected environments.",
    "plain_english_explanation": "This control requires organizations to implement code execution in protected environments to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.14",
    "control_name": "Binary or Machine Executable Code",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure binary or machine executable code capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.14 helps protect system and information integrity by binary or machine executable code.",
    "plain_english_explanation": "This control requires organizations to implement binary or machine executable code to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.15",
    "control_name": "Code Authentication",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure code authentication capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.15 helps protect system and information integrity by code authentication.",
    "plain_english_explanation": "This control requires organizations to implement code authentication to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.16",
    "control_name": "Time Limit on Process Execution Without Supervision",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure time limit on process execution without supervision capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.16 helps protect system and information integrity by time limit on process execution without supervision.",
    "plain_english_explanation": "This control requires organizations to implement time limit on process execution without supervision to maintain system and information integrity."
  },
  {
    "control_id": "SI-7.17",
    "control_name": "Runtime Application Self-protection",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-7",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-7: Software, Firmware, and Information Integrity\n# Configures AIDE file integrity monitoring\n\nset -euo pipefail\n\necho \"=== SI-7 File Integrity Monitoring ===\"\n\n# Install AIDE\nif command -v dnf &>/dev/null; then\n    dnf install -y aide\nelif command -v apt-get &>/dev/null; then\n    apt-get install -y aide aide-common\nfi\n\n# Configure AIDE rules\ncat > /etc/aide.conf << 'EOF'\n# AIDE Configuration for SI-7 Compliance\n\ndatabase_in=file:/var/lib/aide/aide.db.gz\ndatabase_out=file:/var/lib/aide/aide.db.new.gz\ndatabase_new=file:/var/lib/aide/aide.db.new.gz\n\ngzip_dbout=yes\n\n# Define what to monitor\nNORMAL = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256\nDIR = p+i+n+u+g+acl+selinux+xattrs\nPERMS = p+u+g+acl+selinux\nLOG = p+u+g+n+acl+selinux+ftype\n\n# Critical system binaries\n/bin NORMAL\n/sbin NORMAL\n/usr/bin NORMAL\n/usr/sbin NORMAL\n/usr/local/bin NORMAL\n/usr/local/sbin NORMAL\n\n# Libraries\n/lib NORMAL\n/lib64 NORMAL\n/usr/lib NORMAL\n/usr/lib64 NORMAL\n\n# Configuration files\n/etc NORMAL\n\n# Exclude dynamic files\n!/etc/mtab\n!/etc/.*~\n!/var/log\n!/var/spool\n!/var/cache\n!/proc\n!/sys\n!/dev\n!/run\n\n# Boot files\n/boot NORMAL\n\n# Kernel modules\n/usr/lib/modules NORMAL\nEOF\n\n# Initialize AIDE database\necho \"Initializing AIDE database...\"\naide --init\nmv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\n# Create daily check cron\ncat > /etc/cron.daily/aide-check << 'EOF'\n#!/bin/bash\n/usr/sbin/aide --check > /var/log/aide/aide-check-$(date +%Y%m%d).log 2>&1\nEOF\nchmod +x /etc/cron.daily/aide-check\nmkdir -p /var/log/aide\n\n# Verify GPG signatures on packages (RHEL/CentOS)\nif command -v rpm &>/dev/null; then\n    echo \"Verifying RPM signatures...\"\n    rpm -Va --nofiles --nodigest 2>/dev/null | head -20\nfi\n\necho \"SI-7 File integrity monitoring configured\"\n",
        "ansible": "---\n# SI-7: File Integrity Monitoring\n- name: SI-7 Software and Information Integrity\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install AIDE\n      ansible.builtin.package:\n        name: aide\n        state: present\n\n    - name: Deploy AIDE configuration\n      ansible.builtin.template:\n        src: aide.conf.j2\n        dest: /etc/aide.conf\n        mode: '0600'\n\n    - name: Initialize AIDE database\n      ansible.builtin.command: aide --init\n      args:\n        creates: /var/lib/aide/aide.db.new.gz\n\n    - name: Copy AIDE database\n      ansible.builtin.copy:\n        src: /var/lib/aide/aide.db.new.gz\n        dest: /var/lib/aide/aide.db.gz\n        remote_src: yes\n\n    - name: Create AIDE check cron job\n      ansible.builtin.cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"5\"\n        job: \"/usr/sbin/aide --check > /var/log/aide/check.log 2>&1\"\n"
      },
      "windows": {
        "powershell": "# SI-7: File Integrity Monitoring - Windows\n# Uses Windows built-in tools and System File Checker\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-7 File Integrity Monitoring ===\" -ForegroundColor Cyan\n\n# Run System File Checker\nWrite-Host \"Running System File Checker...\"\n$SFCResult = sfc /scannow\n\n# Run DISM to repair component store\nWrite-Host \"Running DISM health check...\"\nDISM /Online /Cleanup-Image /CheckHealth\nDISM /Online /Cleanup-Image /ScanHealth\n\n# Verify Windows system files with sigverif\nWrite-Host \"Checking driver signatures...\"\n$UnsignedDrivers = Get-WmiObject Win32_PnPSignedDriver | Where-Object { $_.IsSigned -eq $false }\nif ($UnsignedDrivers) {\n    Write-Warning \"Found unsigned drivers:\"\n    $UnsignedDrivers | Select-Object DeviceName, DriverVersion\n}\n\n# Create baseline of critical files\n$CriticalPaths = @(\n    \"$env:SystemRoot\\System32\\*.exe\",\n    \"$env:SystemRoot\\System32\\*.dll\",\n    \"$env:SystemRoot\\System32\\drivers\\*.sys\"\n)\n\n$BaselineFile = \"$env:ProgramData\\SecurityBaseline\\file_hashes.csv\"\n$BaselineDir = Split-Path $BaselineFile\nif (-not (Test-Path $BaselineDir)) {\n    New-Item -ItemType Directory -Path $BaselineDir -Force | Out-Null\n}\n\nWrite-Host \"Creating file integrity baseline...\"\n$Hashes = @()\nforeach ($Path in $CriticalPaths) {\n    Get-ChildItem -Path $Path -ErrorAction SilentlyContinue | ForEach-Object {\n        $Hash = Get-FileHash $_.FullName -Algorithm SHA256 -ErrorAction SilentlyContinue\n        if ($Hash) {\n            $Hashes += [PSCustomObject]@{\n                Path = $_.FullName\n                Hash = $Hash.Hash\n                LastWriteTime = $_.LastWriteTime\n            }\n        }\n    }\n}\n$Hashes | Export-Csv -Path $BaselineFile -NoTypeInformation\n\nWrite-Host \"Baseline created with $($Hashes.Count) files\"\nWrite-Host \"SI-7 configuration complete\" -ForegroundColor Green\n",
        "ansible": "---\n# SI-7: Windows File Integrity\n- name: SI-7 Windows Integrity\n  hosts: windows\n  tasks:\n    - name: Run System File Checker\n      ansible.windows.win_command: sfc /scannow\n      ignore_errors: yes\n\n    - name: Run DISM health check\n      ansible.windows.win_command: DISM /Online /Cleanup-Image /ScanHealth\n      ignore_errors: yes\n\n    - name: Create baseline directory\n      ansible.windows.win_file:\n        path: C:\\ProgramData\\SecurityBaseline\n        state: directory\n"
      }
    },
    "ai_guidance": "SI-7 requires detecting unauthorized changes to software, firmware, and information. Deploy file integrity monitoring using AIDE, Tripwire, or OSSEC. Establish baselines after known-good states. Monitor critical system files, binaries, and configuration files. Alert on unauthorized changes. For firmware, enable Secure Boot and TPM-based attestation where available.",
    "intent": "Ensure runtime application self-protection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-7.17 helps protect system and information integrity by runtime application self-protection.",
    "plain_english_explanation": "This control requires organizations to implement runtime application self-protection to maintain system and information integrity."
  },
  {
    "control_id": "SI-8",
    "control_name": "Spam Protection",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Spam Protection is about preventing unwanted and harmful emails from reaching your inbox.",
    "example_implementation": "This script implement spam filters and regularly update them to block suspicious emails and protect your organization from phishing attacks.",
    "non_technical_guidance": "This plan to ensure compliance with SI-8 (Spam Protection), the organization should implement spam protection measures to prevent the delivery of unsolicited emails to their systems. This can be achieved by installing spam filtering software such as SpamAssassin on all relevant systems. Regularly updating and configuring the spam protection software to effectively filter out spam emails is also crucial. Additionally, providing training to employees on how to recognize and report spam emails can further enhance the organization's spam protection measures. Regular monitoring and auditing of the spam protection system should be conducted to ensure its effectiveness in mitigating spam threats.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-8.1",
        "title": "Central Management",
        "official_text": ""
      },
      {
        "id": "si-8.2",
        "title": "Automatic Updates",
        "official_text": "Automatically update spam protection mechanisms {{ insert: param, si-08.02_odp }}."
      },
      {
        "id": "si-8.3",
        "title": "Continuous Learning Capability",
        "official_text": "Implement spam protection mechanisms with a learning capability to more effectively identify legitimate communications traffic."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:29:04.508978+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-8 Spam Protection requires implementing mechanisms to detect and filter unwanted email. Deploy email security gateways (Proofpoint, Mimecast, Microsoft Defender for Office 365) with spam filtering, URL rewriting, and attachment sandboxing. Enable SPF, DKIM, and DMARC for domain protection. Train users to recognize phishing attempts.",
    "intent": "Ensure spam protection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-8 helps protect system and information integrity by spam protection."
  },
  {
    "control_id": "SI-8.1",
    "control_name": "Central Management",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-8",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-8 Spam Protection requires implementing mechanisms to detect and filter unwanted email. Deploy email security gateways (Proofpoint, Mimecast, Microsoft Defender for Office 365) with spam filtering, URL rewriting, and attachment sandboxing. Enable SPF, DKIM, and DMARC for domain protection. Train users to recognize phishing attempts.",
    "intent": "Ensure central management capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-8.1 helps protect system and information integrity by central management.",
    "plain_english_explanation": "This control requires organizations to implement central management to maintain system and information integrity."
  },
  {
    "control_id": "SI-8.2",
    "control_name": "Automatic Updates",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-8",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-8 Spam Protection requires implementing mechanisms to detect and filter unwanted email. Deploy email security gateways (Proofpoint, Mimecast, Microsoft Defender for Office 365) with spam filtering, URL rewriting, and attachment sandboxing. Enable SPF, DKIM, and DMARC for domain protection. Train users to recognize phishing attempts.",
    "intent": "Ensure automatic updates capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-8.2 helps protect system and information integrity by automatic updates.",
    "plain_english_explanation": "This control requires organizations to implement automatic updates to maintain system and information integrity."
  },
  {
    "control_id": "SI-8.3",
    "control_name": "Continuous Learning Capability",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-8",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-8 Spam Protection requires implementing mechanisms to detect and filter unwanted email. Deploy email security gateways (Proofpoint, Mimecast, Microsoft Defender for Office 365) with spam filtering, URL rewriting, and attachment sandboxing. Enable SPF, DKIM, and DMARC for domain protection. Train users to recognize phishing attempts.",
    "intent": "Ensure continuous learning capability capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-8.3 helps protect system and information integrity by continuous learning capability.",
    "plain_english_explanation": "This control requires organizations to implement continuous learning capability to maintain system and information integrity."
  },
  {
    "control_id": "SI-9",
    "control_name": "Information Input Restrictions",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Information Input Restrictions ensure that only authorized individuals can input data into an information system.",
    "example_implementation": "This script implement user authentication measures such as passwords or biometric verification to control who can input information into the system.",
    "non_technical_guidance": "This plan to implement Information Input Restrictions (si-9) in a non-technical manner, you can follow these steps:\n\n1. Identify the types of information that need to be restricted based on sensitivity and confidentiality.\n2. Develop a policy or set of guidelines outlining what information can be inputted and by whom.\n3. Communicate the policy to all relevant personnel and provide training on how to adhere to the restrictions.\n4. Regularly monitor and audit information input to ensure compliance with the restrictions.\n5. Implement consequences for individuals who violate the information input restrictions to reinforce the importance of compliance.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:29:10.913791+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "Implement Information Input Restrictions according to organizational policies and NIST SP 800-53 Rev 5 guidance.",
    "intent": "Ensure information input restrictions capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-9 helps protect system and information integrity by information input restrictions."
  },
  {
    "control_id": "SI-10",
    "control_name": "Information Input Validation",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Check the validity of the following information inputs: {{ insert: param, si-10_odp }}.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Make sure that the information being inputted into the system is valid and accurate.",
    "example_implementation": "This script implement input validation checks in your application to ensure that only valid data is accepted, reducing the risk of errors and security vulnerabilities.",
    "non_technical_guidance": "This plan to ensure compliance with control si-10 (Information Input Validation), follow these steps:\n1. Identify all information inputs within your system or application.\n2. Develop a validation process for each input to ensure its validity.\n3. Implement input validation mechanisms such as regular expressions, whitelists, or blacklists to filter out malicious inputs.\n4. Regularly review and update the validation process to adapt to new threats and vulnerabilities.\n5. Train developers and system administrators on the importance of input validation and how to properly implement it in their respective roles.\n6. Conduct periodic audits or assessments to verify that information inputs are being properly validated according to the established process.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-10.1",
        "title": "Manual Override Capability",
        "official_text": ""
      },
      {
        "id": "si-10.2",
        "title": "Review and Resolve Errors",
        "official_text": "Review and resolve input validation errors within {{ insert: param, si-10.2_prm_1 }}."
      },
      {
        "id": "si-10.3",
        "title": "Predictable Behavior",
        "official_text": "Verify that the system behaves in a predictable and documented manner when invalid inputs are received."
      },
      {
        "id": "si-10.4",
        "title": "Timing Interactions",
        "official_text": "Account for timing interactions among system components in determining appropriate responses for invalid inputs."
      },
      {
        "id": "si-10.5",
        "title": "Restrict Inputs to Trusted Sources and Approved Formats",
        "official_text": "Restrict the use of information inputs to {{ insert: param, si-10.05_odp.01 }} and/or {{ insert: param, si-10.05_odp.02 }}."
      },
      {
        "id": "si-10.6",
        "title": "Injection Prevention",
        "official_text": "Prevent untrusted data injections."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:02.139700+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure information input validation capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10 helps protect system and information integrity by information input validation."
  },
  {
    "control_id": "SI-10.1",
    "control_name": "Manual Override Capability",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-10",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure manual override capability capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10.1 helps protect system and information integrity by manual override capability.",
    "plain_english_explanation": "This control requires organizations to implement manual override capability to maintain system and information integrity."
  },
  {
    "control_id": "SI-10.2",
    "control_name": "Review and Resolve Errors",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-10",
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure review and resolve errors capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10.2 helps protect system and information integrity by review and resolve errors.",
    "plain_english_explanation": "This control requires organizations to implement review and resolve errors to maintain system and information integrity."
  },
  {
    "control_id": "SI-10.3",
    "control_name": "Predictable Behavior",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-10",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure predictable behavior capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10.3 helps protect system and information integrity by predictable behavior.",
    "plain_english_explanation": "This control requires organizations to implement predictable behavior to maintain system and information integrity."
  },
  {
    "control_id": "SI-10.4",
    "control_name": "Timing Interactions",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-10",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure timing interactions capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10.4 helps protect system and information integrity by timing interactions.",
    "plain_english_explanation": "This control requires organizations to implement timing interactions to maintain system and information integrity."
  },
  {
    "control_id": "SI-10.5",
    "control_name": "Restrict Inputs to Trusted Sources and Approved Formats",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-10",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure restrict inputs to trusted sources and approved formats capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10.5 helps protect system and information integrity by restrict inputs to trusted sources and approved formats.",
    "plain_english_explanation": "This control requires organizations to implement restrict inputs to trusted sources and approved formats to maintain system and information integrity."
  },
  {
    "control_id": "SI-10.6",
    "control_name": "Injection Prevention",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-10",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-10 requires validating all information inputs. Implement input validation at application boundaries using allowlist approaches. Validate data type, length, format, and range. Sanitize inputs to prevent injection attacks (SQL, XSS, command injection). Use parameterized queries for database access. Implement Web Application Firewalls (WAF) for additional protection.",
    "intent": "Ensure injection prevention capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-10.6 helps protect system and information integrity by injection prevention.",
    "plain_english_explanation": "This control requires organizations to implement injection prevention to maintain system and information integrity."
  },
  {
    "control_id": "SI-11",
    "control_name": "Error Handling",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Error Handling control ensures that errors in software applications are handled properly to prevent security vulnerabilities.",
    "example_implementation": "This script implement robust error handling mechanisms in your software applications to catch and handle errors gracefully, preventing potential security risks.",
    "non_technical_guidance": "This plan to ensure compliance with error handling control (si-11), the following non-technical steps should be taken:\n1. Review the application code to ensure that proper error handling mechanisms are implemented.\n2. Document the error handling processes and procedures for developers to follow.\n3. Conduct regular code reviews to verify that error handling best practices are being followed.\n4. Provide training and resources to developers on how to effectively handle errors in their code.\n5. Implement a process for monitoring and logging errors to identify and address any issues promptly.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-10T10:26:13.382729+00:00",
      "source": "ComplianceAsCode",
      "last_updated": "2025-11-10T10:26:13.388855+00:00",
      "platform": "rhcos4",
      "rule_count": 4,
      "certification": "Government-certified"
    },
    "ai_guidance": "SI-11 Error Handling requires generating error messages that provide information necessary for corrective action without revealing sensitive information. Configure applications to log detailed errors internally while displaying generic messages to users. Implement custom error pages. Never expose stack traces, database errors, or system paths to end users.",
    "intent": "Ensure error handling capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-11 helps protect system and information integrity by error handling."
  },
  {
    "control_id": "SI-12",
    "control_name": "Information Management and Retention",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Manage and retain information within the system and information output from the system in accordance with applicable laws, executive orders, directives, regulations, policies, standards, guidelines and operational requirements.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Make sure to properly manage and retain information in the system according to laws and regulations.",
    "example_implementation": "This script implement a document management system that automatically archives and retains information based on retention policies and legal requirements. Regularly review and update these policies to ensure compliance.",
    "non_technical_guidance": "This plan to implement control si-12 for Information Management and Retention, follow these steps:\n1. Identify and understand the applicable laws, executive orders, directives, regulations, policies, standards, guidelines, and operational requirements that govern information management and retention within your organization.\n2. Develop a comprehensive information management and retention policy that aligns with the identified requirements.\n3. Implement procedures and controls to ensure that information is managed and retained in accordance with the policy.\n4. Regularly review and update the policy and procedures to stay current with any changes in regulations or requirements.\n5. Train employees on the importance of information management and retention and ensure they understand their roles and responsibilities in compliance.\n6. Conduct regular audits and assessments to verify compliance with the policy and make any necessary improvements.\n7. Document all processes and actions taken to demonstrate compliance with control si-12 during audits or inspections.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "si-12.1",
        "title": "Limit Personally Identifiable Information Elements",
        "official_text": "Limit personally identifiable information being processed in the information life cycle to the following elements of personally identifiable information: {{ insert: param, si-12.01_odp }}."
      },
      {
        "id": "si-12.2",
        "title": "Minimize Personally Identifiable Information in Testing, Training, and Research",
        "official_text": "Use the following techniques to minimize the use of personally identifiable information for research, testing, or training: {{ insert: param, si-12.2_prm_1 }}."
      },
      {
        "id": "si-12.3",
        "title": "Information Disposal",
        "official_text": "Use the following techniques to dispose of, destroy, or erase information following the retention period: {{ insert: param, si-12.3_prm_1 }}."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:15.024337+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-12 requires managing and retaining information according to applicable laws, policies, and operational requirements. Establish data classification and retention schedules. Implement automated data lifecycle management. Ensure secure disposal of information when retention periods expire. Document handling procedures for each data classification level.",
    "intent": "Ensure information management and retention capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-12 helps protect system and information integrity by information management and retention."
  },
  {
    "control_id": "SI-12.1",
    "control_name": "Limit Personally Identifiable Information Elements",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-12",
    "ai_guidance": "SI-12 requires managing and retaining information according to applicable laws, policies, and operational requirements. Establish data classification and retention schedules. Implement automated data lifecycle management. Ensure secure disposal of information when retention periods expire. Document handling procedures for each data classification level.",
    "intent": "Ensure limit personally identifiable information elements capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-12.1 helps protect system and information integrity by limit personally identifiable information elements.",
    "plain_english_explanation": "This control requires organizations to implement limit personally identifiable information elements to maintain system and information integrity."
  },
  {
    "control_id": "SI-12.2",
    "control_name": "Minimize Personally Identifiable Information in Testing, Training, and Research",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-12",
    "ai_guidance": "SI-12 requires managing and retaining information according to applicable laws, policies, and operational requirements. Establish data classification and retention schedules. Implement automated data lifecycle management. Ensure secure disposal of information when retention periods expire. Document handling procedures for each data classification level.",
    "intent": "Ensure minimize personally identifiable information in testing, training, and research capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-12.2 helps protect system and information integrity by minimize personally identifiable information in testing, training, and research.",
    "plain_english_explanation": "This control requires organizations to implement minimize personally identifiable information in testing, training, and research to maintain system and information integrity."
  },
  {
    "control_id": "SI-12.3",
    "control_name": "Information Disposal",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-12",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-12 requires managing and retaining information according to applicable laws, policies, and operational requirements. Establish data classification and retention schedules. Implement automated data lifecycle management. Ensure secure disposal of information when retention periods expire. Document handling procedures for each data classification level.",
    "intent": "Ensure information disposal capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-12.3 helps protect system and information integrity by information disposal.",
    "plain_english_explanation": "This control requires organizations to implement information disposal to maintain system and information integrity."
  },
  {
    "control_id": "SI-13",
    "control_name": "Predictable Failure Prevention",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Predictable Failure Prevention involves implementing measures to prevent failures that can be predicted based on historical data and analysis.",
    "example_implementation": "This script regularly analyze historical data and trends to identify potential failure points, and proactively implement measures to prevent them from occurring in the future.",
    "non_technical_guidance": "This plan to implement predictable failure prevention for user accounts, regularly review and update password expiration dates for users. Set a random expiration date between 30 and 365 days to prevent predictable patterns that could be exploited by attackers. This can be done manually by system administrators or automated through scripts as shown above. Regularly monitor and enforce password expiration policies to enhance security and prevent predictable failures.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-13.1",
        "title": "Transferring Component Responsibilities",
        "official_text": "Take system components out of service by transferring component responsibilities to substitute components no later than {{ insert: param, si-13.01_odp }} of mean time to failure."
      },
      {
        "id": "si-13.2",
        "title": "Time Limit on Process Execution Without Supervision",
        "official_text": ""
      },
      {
        "id": "si-13.3",
        "title": "Manual Transfer Between Components",
        "official_text": "Manually initiate transfers between active and standby system components when the use of the active component reaches {{ insert: param, si-13.03_odp }} of the mean time to failure."
      },
      {
        "id": "si-13.4",
        "title": "Standby Component Installation and Notification",
        "official_text": "If system component failures are detected:"
      },
      {
        "id": "si-13.5",
        "title": "Failover Capability",
        "official_text": "Provide {{ insert: param, si-13.05_odp.01 }} {{ insert: param, si-13.05_odp.02 }} for the system."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:21.489797+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-13 Predictable Failure Prevention requires protecting against system failures through redundancy and failover capabilities. Implement RAID for storage, clustered services for high availability, and geographic redundancy for disaster recovery. Monitor system health indicators (SMART data, temperature, utilization). Establish thresholds for proactive component replacement.",
    "intent": "Ensure predictable failure prevention capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-13 helps protect system and information integrity by predictable failure prevention."
  },
  {
    "control_id": "SI-13.1",
    "control_name": "Transferring Component Responsibilities",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-13",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-13 Predictable Failure Prevention requires protecting against system failures through redundancy and failover capabilities. Implement RAID for storage, clustered services for high availability, and geographic redundancy for disaster recovery. Monitor system health indicators (SMART data, temperature, utilization). Establish thresholds for proactive component replacement.",
    "intent": "Ensure transferring component responsibilities capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-13.1 helps protect system and information integrity by transferring component responsibilities.",
    "plain_english_explanation": "This control requires organizations to implement transferring component responsibilities to maintain system and information integrity."
  },
  {
    "control_id": "SI-13.2",
    "control_name": "Time Limit on Process Execution Without Supervision",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-13",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-13 Predictable Failure Prevention requires protecting against system failures through redundancy and failover capabilities. Implement RAID for storage, clustered services for high availability, and geographic redundancy for disaster recovery. Monitor system health indicators (SMART data, temperature, utilization). Establish thresholds for proactive component replacement.",
    "intent": "Ensure time limit on process execution without supervision capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-13.2 helps protect system and information integrity by time limit on process execution without supervision.",
    "plain_english_explanation": "This control requires organizations to implement time limit on process execution without supervision to maintain system and information integrity."
  },
  {
    "control_id": "SI-13.3",
    "control_name": "Manual Transfer Between Components",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-13",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-13 Predictable Failure Prevention requires protecting against system failures through redundancy and failover capabilities. Implement RAID for storage, clustered services for high availability, and geographic redundancy for disaster recovery. Monitor system health indicators (SMART data, temperature, utilization). Establish thresholds for proactive component replacement.",
    "intent": "Ensure manual transfer between components capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-13.3 helps protect system and information integrity by manual transfer between components.",
    "plain_english_explanation": "This control requires organizations to implement manual transfer between components to maintain system and information integrity."
  },
  {
    "control_id": "SI-13.4",
    "control_name": "Standby Component Installation and Notification",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-13",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-13 Predictable Failure Prevention requires protecting against system failures through redundancy and failover capabilities. Implement RAID for storage, clustered services for high availability, and geographic redundancy for disaster recovery. Monitor system health indicators (SMART data, temperature, utilization). Establish thresholds for proactive component replacement.",
    "intent": "Ensure standby component installation and notification capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-13.4 helps protect system and information integrity by standby component installation and notification.",
    "plain_english_explanation": "This control requires organizations to implement standby component installation and notification to maintain system and information integrity."
  },
  {
    "control_id": "SI-13.5",
    "control_name": "Failover Capability",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-13",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-13 Predictable Failure Prevention requires protecting against system failures through redundancy and failover capabilities. Implement RAID for storage, clustered services for high availability, and geographic redundancy for disaster recovery. Monitor system health indicators (SMART data, temperature, utilization). Establish thresholds for proactive component replacement.",
    "intent": "Ensure failover capability capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-13.5 helps protect system and information integrity by failover capability.",
    "plain_english_explanation": "This control requires organizations to implement failover capability to maintain system and information integrity."
  },
  {
    "control_id": "SI-14",
    "control_name": "Non-persistence",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Implement non-persistent {{ insert: param, si-14_odp.01 }} that are initiated in a known state and terminated {{ insert: param, si-14_odp.02 }}.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Non-persistence means that systems are set up to start fresh each time they are used and are cleared of any data or changes when they are finished.",
    "example_implementation": "This script make sure to configure systems to reset to a known state at the beginning of each use and to clear any data or changes when they are done being used. This can help prevent unauthorized access or data leakage.",
    "non_technical_guidance": "This plan to implement non-persistence for systems or applications, follow these steps:\n1. Ensure that all systems or applications are configured to start in a known state, either through configuration settings or by resetting to a default state upon startup.\n2. Regularly monitor and audit systems to ensure that they remain in a non-persistent state and take corrective actions if deviations are detected.\n3. Implement proper documentation and training for system administrators and users on the importance of maintaining non-persistence.\n4. Consider implementing automated tools or scripts to assist in enforcing non-persistence where feasible.\n5. Continuously review and update policies and procedures related to non-persistence to adapt to changes in technology and security requirements.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-14.1",
        "title": "Refresh from Trusted Sources",
        "official_text": "Obtain software and data employed during system component and service refreshes from the following trusted sources: {{ insert: param, si-14.01_odp }}."
      },
      {
        "id": "si-14.2",
        "title": "Non-persistent Information",
        "official_text": ""
      },
      {
        "id": "si-14.3",
        "title": "Non-persistent Connectivity",
        "official_text": "Establish connections to the system on demand and terminate connections after {{ insert: param, si-14.03_odp }}."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:31.136959+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-14 Non-persistence requires implementing non-persistent system components that are refreshed from trusted sources. Use immutable infrastructure patterns with containers or read-only root filesystems. Implement golden images rebuilt from known-good sources. Configure stateless applications where possible. Refresh components on defined schedules or after each use.",
    "intent": "Ensure non-persistence capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-14 helps protect system and information integrity by non-persistence."
  },
  {
    "control_id": "SI-14.1",
    "control_name": "Refresh from Trusted Sources",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-14",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-14 Non-persistence requires implementing non-persistent system components that are refreshed from trusted sources. Use immutable infrastructure patterns with containers or read-only root filesystems. Implement golden images rebuilt from known-good sources. Configure stateless applications where possible. Refresh components on defined schedules or after each use.",
    "intent": "Ensure refresh from trusted sources capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-14.1 helps protect system and information integrity by refresh from trusted sources.",
    "plain_english_explanation": "This control requires organizations to implement refresh from trusted sources to maintain system and information integrity."
  },
  {
    "control_id": "SI-14.2",
    "control_name": "Non-persistent Information",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-14",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-14 Non-persistence requires implementing non-persistent system components that are refreshed from trusted sources. Use immutable infrastructure patterns with containers or read-only root filesystems. Implement golden images rebuilt from known-good sources. Configure stateless applications where possible. Refresh components on defined schedules or after each use.",
    "intent": "Ensure non-persistent information capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-14.2 helps protect system and information integrity by non-persistent information.",
    "plain_english_explanation": "This control requires organizations to implement non-persistent information to maintain system and information integrity."
  },
  {
    "control_id": "SI-14.3",
    "control_name": "Non-persistent Connectivity",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-14",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-14 Non-persistence requires implementing non-persistent system components that are refreshed from trusted sources. Use immutable infrastructure patterns with containers or read-only root filesystems. Implement golden images rebuilt from known-good sources. Configure stateless applications where possible. Refresh components on defined schedules or after each use.",
    "intent": "Ensure non-persistent connectivity capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-14.3 helps protect system and information integrity by non-persistent connectivity.",
    "plain_english_explanation": "This control requires organizations to implement non-persistent connectivity to maintain system and information integrity."
  },
  {
    "control_id": "SI-15",
    "control_name": "Information Output Filtering",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Validate information output from the following software programs and/or applications to ensure that the information is consistent with the expected content: {{ insert: param, si-15_odp }}.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Make sure that the information coming out of software programs matches what you expect it to be.",
    "example_implementation": "This script regularly review and test the output of your software programs to ensure that the information being generated is accurate and secure.",
    "non_technical_guidance": "This plan to comply with Control ID si-15, Information Output Filtering, you should establish a process for validating information output from software programs and applications to ensure it aligns with expected content. This can be achieved through manual review by designated personnel who are familiar with the expected output of the software. \n\nCreate a checklist or template that outlines the expected content for each software program or application, and have reviewers compare the actual output against this checklist. Any inconsistencies should be documented and addressed promptly.\n\nRegularly review and update the checklist as software programs and applications are updated or changed to ensure ongoing compliance with this control. Additionally, provide training to relevant staff members on how to effectively validate information output to maintain consistency and accuracy.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:37.644918+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-15 requires validating information output to ensure data integrity and proper handling. Implement output encoding to prevent XSS. Validate data before display or export. Use Content Security Policy headers. Filter sensitive information from logs and error messages. Implement data loss prevention controls for sensitive data egress.",
    "intent": "Ensure information output filtering capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-15 helps protect system and information integrity by information output filtering."
  },
  {
    "control_id": "SI-16",
    "control_name": "Memory Protection",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Implement the following controls to protect the system memory from unauthorized code execution: {{ insert: param, si-16_odp }}.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Make sure to protect your system's memory from unauthorized code execution.",
    "example_implementation": "This script enables memory protection mechanisms such as Data Execution Prevention (DEP) and Address Space Layout Randomization (ASLR) to safeguard against malicious code execution in your IT environment.",
    "non_technical_guidance": "This plan to implement memory protection controls, you can follow these steps:\n1. Enable Data Execution Prevention (DEP) on Windows systems.\n2. Enable Address Space Layout Randomization (ASLR) on Linux systems.\n3. Implement stack smashing protection mechanisms.\n4. Regularly update the system and applications to patch known vulnerabilities that could be exploited for unauthorized code execution.\n5. Implement proper access controls to limit access to memory areas.\n6. Monitor and audit memory access for any unauthorized activities.\n7. Train system administrators and users on best practices for memory protection.\n8. Regularly review and update memory protection measures as new threats emerge.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SI-16: Memory Protection\n# Configures ASLR, DEP/NX, and other memory protections\n\nset -euo pipefail\n\necho \"=== SI-16 Memory Protection ===\"\n\n# Enable full ASLR (Address Space Layout Randomization)\necho \"Configuring ASLR...\"\nsysctl -w kernel.randomize_va_space=2\necho \"kernel.randomize_va_space = 2\" >> /etc/sysctl.d/99-si-16.conf\n\n# Enable ExecShield (RHEL/CentOS 6 legacy)\nif [ -f /proc/sys/kernel/exec-shield ]; then\n    sysctl -w kernel.exec-shield=1\n    echo \"kernel.exec-shield = 1\" >> /etc/sysctl.d/99-si-16.conf\nfi\n\n# Configure memory protections\ncat >> /etc/sysctl.d/99-si-16.conf << 'EOF'\n# Restrict kernel pointer leaks\nkernel.kptr_restrict = 2\n\n# Restrict dmesg access\nkernel.dmesg_restrict = 1\n\n# Enable SMEP/SMAP if available (requires hardware support)\n# These are typically enabled by default in modern kernels\n\n# Restrict ptrace scope\nkernel.yama.ptrace_scope = 1\n\n# Disable core dumps for setuid programs\nfs.suid_dumpable = 0\nEOF\n\n# Apply sysctl settings\nsysctl --system\n\n# Verify ASLR\necho \"Verifying ASLR status:\"\ncat /proc/sys/kernel/randomize_va_space\n\n# Check NX bit support\nif grep -q ' nx ' /proc/cpuinfo; then\n    echo \"NX (No-Execute) bit: SUPPORTED\"\nelse\n    echo \"WARNING: NX bit may not be supported/enabled\"\nfi\n\n# Verify binary hardening on key executables\necho \"Checking binary hardening...\"\nif command -v checksec &>/dev/null; then\n    checksec --file=/bin/bash\n    checksec --file=/usr/sbin/sshd\nelse\n    echo \"Install checksec for detailed binary analysis\"\nfi\n\necho \"SI-16 Memory protection configured\"\n",
        "ansible": "---\n# SI-16: Memory Protection\n- name: SI-16 Memory Protection\n  hosts: all\n  become: yes\n  tasks:\n    - name: Enable ASLR\n      ansible.posix.sysctl:\n        name: kernel.randomize_va_space\n        value: '2'\n        state: present\n        sysctl_file: /etc/sysctl.d/99-si-16.conf\n\n    - name: Restrict kernel pointers\n      ansible.posix.sysctl:\n        name: kernel.kptr_restrict\n        value: '2'\n        state: present\n        sysctl_file: /etc/sysctl.d/99-si-16.conf\n\n    - name: Restrict dmesg\n      ansible.posix.sysctl:\n        name: kernel.dmesg_restrict\n        value: '1'\n        state: present\n        sysctl_file: /etc/sysctl.d/99-si-16.conf\n\n    - name: Enable ptrace restrictions\n      ansible.posix.sysctl:\n        name: kernel.yama.ptrace_scope\n        value: '1'\n        state: present\n        sysctl_file: /etc/sysctl.d/99-si-16.conf\n\n    - name: Disable setuid core dumps\n      ansible.posix.sysctl:\n        name: fs.suid_dumpable\n        value: '0'\n        state: present\n        sysctl_file: /etc/sysctl.d/99-si-16.conf\n"
      },
      "windows": {
        "powershell": "# SI-16: Memory Protection - Windows\n# Configures DEP, ASLR, CFG, and other memory protections\n\n#Requires -RunAsAdministrator\n\nWrite-Host \"=== SI-16 Memory Protection ===\" -ForegroundColor Cyan\n\n# Enable DEP (Data Execution Prevention) for all programs\nbcdedit /set nx AlwaysOn\n\n# Configure Exploit Protection settings\n$ExploitGuardSettings = @{\n    DEP = @{\n        Enable = $true\n        EmulateAtlThunks = $true\n    }\n    ASLR = @{\n        ForceRelocateImages = $true\n        RequireInfo = $true\n        BottomUp = $true\n        HighEntropy = $true\n    }\n    CFG = @{\n        Enable = $true\n        SuppressExports = $true\n    }\n    SEHOP = @{\n        Enable = $true\n    }\n}\n\n# Apply system-wide exploit protection\nSet-ProcessMitigation -System -Enable DEP,BottomUp,SEHOP,CFG,ForceRelocateImages\n\n# Verify current settings\nWrite-Host \"`nCurrent Exploit Protection Settings:\"\nGet-ProcessMitigation -System | Format-List\n\n# Enable Credential Guard (requires Hyper-V)\n$CredGuardPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\LSA\"\nSet-ItemProperty -Path $CredGuardPath -Name \"LsaCfgFlags\" -Value 1 -Type DWord\n\n# Enable Virtualization-based Security\n$VBSPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\"\nif (-not (Test-Path $VBSPath)) {\n    New-Item -Path $VBSPath -Force | Out-Null\n}\nSet-ItemProperty -Path $VBSPath -Name \"EnableVirtualizationBasedSecurity\" -Value 1 -Type DWord\n\nWrite-Host \"`nSI-16 Memory protection configured\" -ForegroundColor Green\nWrite-Host \"Note: Some settings require a reboot to take effect\" -ForegroundColor Yellow\n",
        "ansible": "---\n# SI-16: Windows Memory Protection\n- name: SI-16 Memory Protection\n  hosts: windows\n  tasks:\n    - name: Enable DEP for all programs\n      ansible.windows.win_command: bcdedit /set nx AlwaysOn\n\n    - name: Enable system-wide exploit protection\n      ansible.windows.win_shell: |\n        Set-ProcessMitigation -System -Enable DEP,BottomUp,SEHOP,CFG\n\n    - name: Configure Credential Guard\n      ansible.windows.win_regedit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Control\\LSA\n        name: LsaCfgFlags\n        data: 1\n        type: dword\n"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-10T10:26:39.247769+00:00",
      "source": "ComplianceAsCode",
      "last_updated": "2025-11-10T10:26:39.249070+00:00",
      "platform": "rhcos4",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "stig_id": "RHEL-08-010420, RHEL-08-010421, RHEL-08-010422",
    "ai_guidance": "SI-16 Memory Protection requires implementing hardware and software mechanisms to prevent execution of unauthorized code. Enable ASLR, DEP/NX, Stack Canaries, and Control Flow Guard. Configure kernel parameters (randomize_va_space=2). Use compiler flags (-fstack-protector-strong, -D_FORTIFY_SOURCE=2). Enable Secure Boot and Credential Guard on Windows.",
    "intent": "Ensure memory protection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-16 helps protect system and information integrity by memory protection."
  },
  {
    "control_id": "SI-17",
    "control_name": "Fail-safe Procedures",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Implement the indicated fail-safe procedures when the indicated failures occur: {{ insert: param, si-17_prm_1 }}.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Make sure to have fail-safe procedures in place for when certain failures occur.",
    "example_implementation": "This script regularly review and test your fail-safe procedures to ensure they are effective and will work as intended in case of a failure.",
    "non_technical_guidance": "This plan 1. Identify the potential failures that could occur in your system.\n2. Develop a comprehensive fail-safe plan for each identified failure scenario.\n3. Ensure that all team members are trained on the fail-safe procedures and have access to the necessary documentation.\n4. Regularly test the fail-safe procedures to ensure they are effective and up to date.\n5. Document any changes or updates to the fail-safe procedures for future reference.\n6. Implement a process for reviewing and updating the fail-safe procedures on a regular basis to adapt to any changes in the system.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:40.852840+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-17 Fail-safe Procedures requires implementing mechanisms that ensure systems fail in a secure state. Configure services to fail closed rather than open. Implement circuit breakers and graceful degradation. Define failover procedures that maintain security posture. Test failure scenarios regularly.",
    "intent": "Ensure fail-safe procedures capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-17 helps protect system and information integrity by fail-safe procedures."
  },
  {
    "control_id": "SI-18",
    "control_name": "Personally Identifiable Information Quality Operations",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control ensures that personally identifiable information (PII) is accurate, relevant, timely, and complete.",
    "example_implementation": "This script regularly review and update PII data to ensure accuracy and relevance, and establish processes for handling requests to correct or update PII.",
    "non_technical_guidance": "This plan personally Identifiable Information (PII) quality operations are crucial for maintaining compliance with NIST 800-53 control si-18. To ensure the quality of PII, organizations should establish clear policies and procedures for handling and managing PII data. This includes implementing data validation processes, data cleansing procedures, and regular data quality checks.\n\nKey steps for implementing PII quality operations include:\n1. Identify all sources of PII within the organization.\n2. Define data quality requirements and standards for PII.\n3. Implement data validation checks to ensure accuracy and completeness of PII.\n4. Establish data cleansing procedures to correct any inaccuracies or inconsistencies in PII.\n5. Conduct regular audits and reviews of PII data to ensure compliance with quality standards.\n\nBy following these steps and continuously monitoring and improving PII quality operations, organizations can effectively comply with NIST 800-53 control si-18 and safeguard sensitive PII data.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "si-18.1",
        "title": "Automation Support",
        "official_text": "Correct or delete personally identifiable information that is inaccurate or outdated, incorrectly determined regarding impact, or incorrectly de-identified using {{ insert: param, si-18.01_odp }}."
      },
      {
        "id": "si-18.2",
        "title": "Data Tags",
        "official_text": "Employ data tags to automate the correction or deletion of personally identifiable information across the information life cycle within organizational systems."
      },
      {
        "id": "si-18.3",
        "title": "Collection",
        "official_text": "Collect personally identifiable information directly from the individual."
      },
      {
        "id": "si-18.4",
        "title": "Individual Requests",
        "official_text": "Correct or delete personally identifiable information upon request by individuals or their designated representatives."
      },
      {
        "id": "si-18.5",
        "title": "Notice of Correction or Deletion",
        "official_text": "Notify {{ insert: param, si-18.05_odp }} and individuals that the personally identifiable information has been corrected or deleted."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:42.469980+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-18 requires ensuring the accuracy, relevance, timeliness, and completeness of personally identifiable information throughout its lifecycle. Implement data quality controls at collection points. Establish processes for individuals to review and correct their information. Conduct periodic data quality assessments.",
    "intent": "Ensure personally identifiable information quality operations capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-18 helps protect system and information integrity by personally identifiable information quality operations."
  },
  {
    "control_id": "SI-18.1",
    "control_name": "Automation Support",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-18",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-18 requires ensuring the accuracy, relevance, timeliness, and completeness of personally identifiable information throughout its lifecycle. Implement data quality controls at collection points. Establish processes for individuals to review and correct their information. Conduct periodic data quality assessments.",
    "intent": "Ensure automation support capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-18.1 helps protect system and information integrity by automation support.",
    "plain_english_explanation": "This control requires organizations to implement automation support to maintain system and information integrity."
  },
  {
    "control_id": "SI-18.2",
    "control_name": "Data Tags",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-18",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-18 requires ensuring the accuracy, relevance, timeliness, and completeness of personally identifiable information throughout its lifecycle. Implement data quality controls at collection points. Establish processes for individuals to review and correct their information. Conduct periodic data quality assessments.",
    "intent": "Ensure data tags capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-18.2 helps protect system and information integrity by data tags.",
    "plain_english_explanation": "This control requires organizations to implement data tags to maintain system and information integrity."
  },
  {
    "control_id": "SI-18.3",
    "control_name": "Collection",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-18",
    "ai_guidance": "SI-18 requires ensuring the accuracy, relevance, timeliness, and completeness of personally identifiable information throughout its lifecycle. Implement data quality controls at collection points. Establish processes for individuals to review and correct their information. Conduct periodic data quality assessments.",
    "intent": "Ensure collection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-18.3 helps protect system and information integrity by collection.",
    "plain_english_explanation": "This control requires organizations to implement collection to maintain system and information integrity."
  },
  {
    "control_id": "SI-18.4",
    "control_name": "Individual Requests",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-18",
    "ai_guidance": "SI-18 requires ensuring the accuracy, relevance, timeliness, and completeness of personally identifiable information throughout its lifecycle. Implement data quality controls at collection points. Establish processes for individuals to review and correct their information. Conduct periodic data quality assessments.",
    "intent": "Ensure individual requests capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-18.4 helps protect system and information integrity by individual requests.",
    "plain_english_explanation": "This control requires organizations to implement individual requests to maintain system and information integrity."
  },
  {
    "control_id": "SI-18.5",
    "control_name": "Notice of Correction or Deletion",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-18",
    "ai_guidance": "SI-18 requires ensuring the accuracy, relevance, timeliness, and completeness of personally identifiable information throughout its lifecycle. Implement data quality controls at collection points. Establish processes for individuals to review and correct their information. Conduct periodic data quality assessments.",
    "intent": "Ensure notice of correction or deletion capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-18.5 helps protect system and information integrity by notice of correction or deletion.",
    "plain_english_explanation": "This control requires organizations to implement notice of correction or deletion to maintain system and information integrity."
  },
  {
    "control_id": "SI-19",
    "control_name": "De-identification",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "De-identification is the process of removing or altering personal information so it cannot be linked back to an individual.",
    "example_implementation": "This script implement automated tools to de-identify sensitive information in your IT systems, such as using data masking techniques to replace real data with fake but realistic values.",
    "non_technical_guidance": "This plan to implement the si-19 control for de-identification, follow these steps:\n1. Identify the sensitive information that needs to be de-identified, such as personally identifiable information (PII) or sensitive business data.\n2. Develop a de-identification strategy that outlines how the sensitive information will be anonymized or masked to protect privacy and confidentiality.\n3. Implement data masking techniques, such as tokenization, encryption, or data substitution, to de-identify the sensitive information.\n4. Regularly review and update the de-identification process to ensure that all sensitive information is properly protected.\n5. Train employees on the importance of de-identification and the proper procedures for handling sensitive information.\n6. Conduct periodic audits to verify compliance with the de-identification controls and make any necessary adjustments to the process.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "si-19.1",
        "title": "Collection",
        "official_text": "De-identify the dataset upon collection by not collecting personally identifiable information."
      },
      {
        "id": "si-19.2",
        "title": "Archiving",
        "official_text": "Prohibit archiving of personally identifiable information elements if those elements in a dataset will not be needed after the dataset is archived."
      },
      {
        "id": "si-19.3",
        "title": "Release",
        "official_text": "Remove personally identifiable information elements from a dataset prior to its release if those elements in the dataset do not need to be part of the data release."
      },
      {
        "id": "si-19.4",
        "title": "Removal, Masking, Encryption, Hashing, or Replacement of Direct Identifiers",
        "official_text": "Remove, mask, encrypt, hash, or replace direct identifiers in a dataset."
      },
      {
        "id": "si-19.5",
        "title": "Statistical Disclosure Control",
        "official_text": "Manipulate numerical data, contingency tables, and statistical findings so that no individual or organization is identifiable in the results of the analysis."
      },
      {
        "id": "si-19.6",
        "title": "Differential Privacy",
        "official_text": "Prevent disclosure of personally identifiable information by adding non-deterministic noise to the results of mathematical operations before the results are reported."
      },
      {
        "id": "si-19.7",
        "title": "Validated Algorithms and Software",
        "official_text": "Perform de-identification using validated algorithms and software that is validated to implement the algorithms."
      },
      {
        "id": "si-19.8",
        "title": "Motivated Intruder",
        "official_text": "Perform a motivated intruder test on the de-identified dataset to determine if the identified data remains or if the de-identified data can be re-identified."
      }
    ],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:26:52.246793+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure de-identification capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19 helps protect system and information integrity by de-identification."
  },
  {
    "control_id": "SI-19.1",
    "control_name": "Collection",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure collection capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.1 helps protect system and information integrity by collection.",
    "plain_english_explanation": "This control requires organizations to implement collection to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.2",
    "control_name": "Archiving",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure archiving capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.2 helps protect system and information integrity by archiving.",
    "plain_english_explanation": "This control requires organizations to implement archiving to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.3",
    "control_name": "Release",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure release capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.3 helps protect system and information integrity by release.",
    "plain_english_explanation": "This control requires organizations to implement release to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.4",
    "control_name": "Removal, Masking, Encryption, Hashing, or Replacement of Direct Identifiers",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure removal, masking, encryption, hashing, or replacement of direct identifiers capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.4 helps protect system and information integrity by removal, masking, encryption, hashing, or replacement of direct identifiers.",
    "plain_english_explanation": "This control requires organizations to implement removal, masking, encryption, hashing, or replacement of direct identifiers to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.5",
    "control_name": "Statistical Disclosure Control",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure statistical disclosure control capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.5 helps protect system and information integrity by statistical disclosure control.",
    "plain_english_explanation": "This control requires organizations to implement statistical disclosure control to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.6",
    "control_name": "Differential Privacy",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure differential privacy capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.6 helps protect system and information integrity by differential privacy.",
    "plain_english_explanation": "This control requires organizations to implement differential privacy to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.7",
    "control_name": "Validated Algorithms and Software",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": true,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure validated algorithms and software capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.7 helps protect system and information integrity by validated algorithms and software.",
    "plain_english_explanation": "This control requires organizations to implement validated algorithms and software to maintain system and information integrity."
  },
  {
    "control_id": "SI-19.8",
    "control_name": "Motivated Intruder",
    "family": "System and Information Integrity",
    "family_id": "SI",
    "source": "NIST SP 800-53 Rev 5",
    "is_technical": false,
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "parent_control": "si-19",
    "ai_guidance": "SI-19 De-identification requires removing identifying information from data before release or analysis. Implement techniques like k-anonymity, l-diversity, or differential privacy. Use data masking for test environments. Evaluate re-identification risks. Document de-identification methods and maintain audit trails.",
    "intent": "Ensure motivated intruder capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-19.8 helps protect system and information integrity by motivated intruder.",
    "plain_english_explanation": "This control requires organizations to implement motivated intruder to maintain system and information integrity."
  },
  {
    "control_id": "SI-20",
    "control_name": "Tainting",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Embed data or capabilities in the following systems or system components to determine if organizational data has been exfiltrated or improperly removed from the organization: {{ insert: param, si-20_odp }}.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Tainting is a way to track and monitor data to see if it has been taken out of the organization without permission.",
    "example_implementation": "This script implement data tagging and monitoring tools to track the movement of sensitive data within your organization's systems. This will help you quickly identify any unauthorized data transfers.",
    "non_technical_guidance": "This plan to implement control SI-20 for tainting, the following non-technical steps can be taken:\n\n1. Identify critical systems and components where sensitive organizational data is stored or processed.\n2. Develop a data tagging or labeling system to categorize data based on sensitivity and importance.\n3. Implement access controls to restrict unauthorized access to critical systems and data.\n4. Regularly monitor and audit access logs to detect any unauthorized access or data exfiltration attempts.\n5. Conduct periodic security assessments to identify any gaps in data protection measures.\n6. Train employees on the importance of data protection and the risks associated with data exfiltration.\n7. Establish incident response procedures to quickly respond to and mitigate any data breaches or exfiltration incidents.\n\nBy following these steps, organizations can effectively implement control SI-20 to prevent data exfiltration and ensure the security of organizational data.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:27:19.701809+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-20 Tainting requires embedding data integrity markers to track information flow and detect unauthorized modifications. Implement data provenance tracking. Use digital signatures or MACs for integrity verification. Log data access and transformations.",
    "intent": "Ensure tainting capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-20 helps protect system and information integrity by tainting."
  },
  {
    "control_id": "SI-21",
    "control_name": "Information Refresh",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Refresh {{ insert: param, si-21_odp.01 }} at {{ insert: param, si-21_odp.02 }} or generate the information on demand and delete the information when no longer needed.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Make sure to update or recreate information regularly and delete it when it's no longer necessary.",
    "example_implementation": "This script sets up automated processes to regularly refresh and delete outdated information, reducing the risk of storing unnecessary data.",
    "non_technical_guidance": "This plan to implement this control, ensure that all information is refreshed at {{ si-21_odp.02 }} intervals or generate the information on demand. Once the information is no longer needed, it should be promptly deleted to reduce the risk of unauthorized access or exposure. Regularly review and update the information retention policies to ensure compliance with this control. Conduct training sessions for staff members on the importance of information refresh and deletion practices to maintain data security.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:27:21.339962+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-21 Information Refresh requires periodically refreshing information from authoritative sources to maintain accuracy. Implement automated data synchronization. Define refresh frequencies based on data criticality. Validate refreshed data integrity.",
    "intent": "Ensure information refresh capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-21 helps protect system and information integrity by information refresh."
  },
  {
    "control_id": "SI-22",
    "control_name": "Information Diversity",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Information Diversity ensures that multiple types of information are used to support organizational decision-making and problem-solving.",
    "example_implementation": "This script implement a diverse range of information sources, such as reports, data analytics, and expert opinions, to ensure a well-rounded approach to decision-making within your organization.",
    "non_technical_guidance": "This plan to comply with the Information Diversity control (si-22), organizations should ensure that information is presented in a diverse and comprehensive manner. This can be achieved by using a variety of sources, formats, and perspectives when communicating information. It is important to avoid bias and ensure that all relevant viewpoints are considered. Additionally, organizations should regularly review and update their information sources to ensure they are current and accurate. Training and awareness programs can also help promote information diversity within the organization.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:27:22.946425+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-22 Information Diversity requires using diverse information sources to improve resilience against manipulation. Implement cross-validation of critical data from multiple sources. Use consensus mechanisms for high-integrity decisions.",
    "intent": "Ensure information diversity capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-22 helps protect system and information integrity by information diversity."
  },
  {
    "control_id": "SI-23",
    "control_name": "Information Fragmentation",
    "family": "System and Information Integrity",
    "family_id": "si",
    "official_text": "Based on {{ insert: param, si-23_odp.01 }}:",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Information fragmentation ensures that sensitive data is divided into smaller pieces to reduce the risk of unauthorized access.",
    "example_implementation": "This script implement data encryption and access controls to ensure that only authorized users can access and reassemble fragmented information.",
    "non_technical_guidance": "This plan to implement the Information Fragmentation control (si-23), follow these steps:\n\n1. Identify the different types of information within your organization that need to be fragmented or separated based on sensitivity or classification.\n2. Develop a data classification policy that clearly defines how information should be categorized and fragmented.\n3. Implement access controls to restrict access to sensitive information based on the principle of least privilege.\n4. Train employees on the importance of information fragmentation and the proper handling of sensitive information.\n5. Regularly review and update the data classification policy to ensure it remains effective and relevant.\n6. Conduct periodic audits to verify compliance with the information fragmentation policy.\n\nBy following these steps, you can ensure that sensitive information is appropriately fragmented and protected within your organization to comply with the Information Fragmentation control (si-23).",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [],
    "supplemental_guidance": "",
    "implementation_scripts": {
      "linux": {
        "bash": "",
        "ansible": ""
      },
      "windows": {
        "powershell": "",
        "ansible": ""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-08T07:09:33.938759Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "pending",
      "last_analyzed": "2025-11-10T10:27:24.549989+00:00",
      "source": "ComplianceAsCode",
      "cac_status": "pending",
      "cac_planned": true,
      "implementation_guidance": "Automated implementation planned but not yet available in ComplianceAsCode repository."
    },
    "ai_guidance": "SI-23 Information Fragmentation requires splitting information across multiple systems to limit exposure from any single compromise. Implement data sharding or secret sharing schemes (Shamir's). Ensure no single system holds complete sensitive datasets.",
    "intent": "Ensure information fragmentation capabilities are properly implemented and maintained.",
    "rationale": "Proper implementation of SI-23 helps protect system and information integrity by information fragmentation."
  }
]