[
  {
    "control_id": "AU-14",
    "stig_id": "RHEL-08-030300",
    "control_name": "Session Audit",
    "family": "Audit and Accountability",
    "family_id": "au",
    "official_text": "a. Provide and implement the capability for [Assignment: organization-defined users or roles] to [Selection (one or more): record; view; hear; log] the content of a user session under [Assignment: organization-defined circumstances]; and\n\nb. Develop, integrate, and use session auditing activities in consultation with legal counsel and in accordance with applicable laws, executive orders, directives, regulations, policies, standards, and guidelines.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "AU-14 Session Audit requires organizations to implement technical capabilities that allow designated personnel to record, monitor, view, or log user session activities. This includes tracking keystrokes, website visits, file transfers, and other session content. Organizations must establish clear policies defining which users or roles can trigger session audits, under what circumstances audits are initiated (such as during investigations of suspicious activity), and must involve legal counsel to ensure compliance with privacy laws and civil liberties protections.",
    "example_implementation": "Organizations implement session auditing through tools such as auditd with session recording rules, terminal session recorders (script/scriptreplay), or specialized session capture solutions. For example, enabling Linux Audit Framework rules to capture session-related events, configuring PAM modules to log session activities, or deploying tools like Teleport or Bastion hosts that record all terminal sessions. Windows environments use event tracing and auditing policies to monitor session logons and activities.",
    "non_technical_guidance": "Session Audit (AU-14) implementation requires a comprehensive approach:\n\n1. Policy Development: Establish a clear session auditing policy defining authorized users/roles who can request session audits, specific circumstances triggering audits (investigation of suspected compromises, privileged user activities, contractor access monitoring), and data retention requirements.\n\n2. Legal Coordination: Consult with legal counsel, privacy officials, and civil liberties officers to address privacy concerns, ensure GDPR/CCPA compliance where applicable, and establish procedures for handling personally identifiable information captured in session logs.\n\n3. Technical Infrastructure: Deploy appropriate session recording tools compatible with your environment (Linux auditd, PAM modules, terminal session recorders, or cloud-native solutions).\n\n4. Access Controls: Implement strict controls over who can view, retrieve, or access recorded session data. Session recordings are highly sensitive and should be protected with encryption and role-based access.\n\n5. Notification and Consent: Document and communicate to users that their sessions may be monitored or recorded, as required by applicable laws and organizational policies.\n\n6. Training: Ensure administrators understand when and how to properly request and use session auditing capabilities, and ensure compliance with audit authorization procedures.\n\n7. Retention and Disposal: Establish clear retention schedules for session audit data and procedures for secure deletion after retention periods expire.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "au-14.1",
        "title": "System Start-up",
        "official_text": "Initiate session audits automatically at system start-up."
      },
      {
        "id": "au-14.2",
        "title": "Capture and Record Content",
        "official_text": "Provide the capability to capture and record the content of a user session. [Note: This enhancement was merged into the base control in Rev 5]"
      },
      {
        "id": "au-14.3",
        "title": "Remote Viewing and Listening",
        "official_text": "Provide and implement the capability for authorized users to remotely view and hear content related to an established user session in real time."
      }
    ],
    "related_controls": [
      "AU-2",
      "AU-4",
      "AU-6",
      "AU-8",
      "AU-9",
      "AU-12",
      "CA-7",
      "SI-4"
    ],
    "supplemental_guidance": "Session audits can monitor and record keystrokes, track websites visited, and record information and file transfers. Session audit capability is implemented in addition to event logging (AU-2) and may involve implementation of specialized session capture technology. Organizations consider how session auditing can reveal sensitive information about individuals (including passwords, health information, financial data) that may give rise to privacy risks. Implementation must be done in consultation with privacy officials, civil liberties officials, and legal counsel. Session auditing should only be initiated when specifically justified (such as investigating potential security incidents or monitoring privileged account activities). Organizations must balance security monitoring needs with privacy protections and employee rights. The capability should be implemented in a manner that does not unnecessarily expose personal information but still achieves the organization's audit and accountability objectives.",
    "implementation_scripts": {
      "linux": {
        "auditd_session_rules": "#!/bin/bash\n# Configure Linux Audit Framework for session auditing (AU-14)\n# Deploy session audit rules to capture session-related events\n\n# Add to /etc/audit/rules.d/session-audit.rules:\n# Monitor login/logout events\n-w /var/log/wtmp -p wa -k sessions\n-w /var/log/btmp -p wa -k logins\n\n# Monitor PAM authentication modules\n-w /etc/pam.d/ -p wa -k pam_config\n\n# Monitor SSH configuration and events\n-w /etc/ssh/sshd_config -p wa -k sshd_config\n-w /var/log/auth.log -p wa -k auth_logs\n\n# Monitor sudoers file for privilege escalation\n-w /etc/sudoers -p wa -k sudoers\n-w /etc/sudoers.d/ -p wa -k sudoers_rules\n\n# Load the rules\naugenrules --load\nauditctl -l\n\necho 'Session audit rules configured'",
        "terminal_session_recording": "#!/bin/bash\n# Enable terminal session recording using script/scriptreplay\n# This captures all terminal input and output for specified users\n\n# Method 1: Using PAM configuration for automatic session logging\ncat >> /etc/pam.d/common-session << 'EOF'\n# Enable session logging for audit compliance\nsession required pam_exec.so /usr/local/bin/session_logger.sh\nEOF\n\n# Create session logger script\ncat > /usr/local/bin/session_logger.sh << 'EOF'\n#!/bin/bash\n# Log all session activity for audit compliance\nLOG_DIR=\"/var/log/sessions\"\nmkdir -p \"$LOG_DIR\"\n\nif [ -z \"$PAM_USER\" ]; then\n  exit 0\nfi\n\n# Create timestamped session log file\nSESSION_LOG=\"$LOG_DIR/${PAM_USER}_$(date +%Y%m%d_%H%M%S).log\"\necho \"Session started at $(date)\" > \"$SESSION_LOG\"\nchown root:root \"$SESSION_LOG\"\nchmod 600 \"$SESSION_LOG\"\nEOF\n\nchmod +x /usr/local/bin/session_logger.sh\necho 'Terminal session recording configured'",
        "session_audit_policy": "#!/bin/bash\n# Session Audit policy configuration for AU-14 compliance\n\n# Define authorized roles for session audit initiation\ncat > /etc/security/session-audit-policy.conf << 'EOF'\n# Session Audit Policy (AU-14)\n# Defines who can request and conduct session audits\n\n# Authorized roles/users who can initiate session audits\nAUTHORIZED_AUDIT_USERS=\"root,security_admin,compliance_officer\"\n\n# Session audit circumstances (when audits are triggered)\n# Values: investigation, privilege_escalation, suspicious_activity, routine_monitoring, incident_response\nAUDIT_TRIGGER_CIRCUMSTANCES=\"investigation,suspicious_activity,incident_response\"\n\n# Data retention period for session audit logs (in days)\nAUDIT_RETENTION_DAYS=90\n\n# Session types to audit: all, ssh, local, privileged\nAUDIT_SESSION_TYPES=\"ssh,privileged,local\"\n\n# Enable remote monitoring capability (AU-14.3)\nREMOTE_MONITORING_ENABLED=true\n\n# Log location for session audit data\nAUDIT_LOG_DIR=\"/var/log/session-audit\"\n\n# Encryption for session audit data (aes256-cbc recommended)\nLOG_ENCRYPTION=\"aes256-cbc\"\nEOF\n\nchown root:root /etc/security/session-audit-policy.conf\nchmod 600 /etc/security/session-audit-policy.conf\necho 'Session audit policy configured'"
      },
      "windows": {
        "group_policy_audit": "# Windows Group Policy for Session Audit (AU-14)\n# PowerShell script to configure Windows Event Tracing for session auditing\n\n# Configure audit policy for session logons\nauditpol.exe /set /subcategory:\"Logon/Logoff\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Special Logon\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Other Logon/Logoff Events\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Network Policy Server\" /success:enable /failure:enable\n\n# Configure detailed tracking for process execution\nauditpol.exe /set /subcategory:\"Process Creation\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Process Termination\" /success:enable /failure:enable\n\n# Display current audit policy\nauditpol.exe /get /category:*",
        "powershell_session_logging": "$null = @\"\n# Enable PowerShell Script Block Logging for session auditing\n# This captures all PowerShell commands executed in sessions\n\n# Create the registry path if it doesn't exist\n$registryPath = \"HKLM:\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\"\nif (-Not (Test-Path $registryPath)) {\n    New-Item -Path $registryPath -Force | Out-Null\n}\n\n# Enable script block logging\nSet-ItemProperty -Path $registryPath -Name \"EnableScriptBlockLogging\" -Value 1 -Type DWord\n\n# Enable script block invocation logging\nSet-ItemProperty -Path $registryPath -Name \"EnableScriptBlockInvocationLogging\" -Value 1 -Type DWord\n\n# Configure transcript logging for all PowerShell sessions\n$transcriptPath = \"C:\\Windows\\System32\\LogFiles\\PowerShell\\Transcripts\"\nif (-Not (Test-Path $transcriptPath)) {\n    New-Item -Path $transcriptPath -ItemType Directory -Force | Out-Null\n}\n\n# Enable PowerShell Transcription Group Policy\n$transcriptRegistry = \"HKLM:\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\"\nif (-Not (Test-Path $transcriptRegistry)) {\n    New-Item -Path $transcriptRegistry -Force | Out-Null\n}\n\nSet-ItemProperty -Path $transcriptRegistry -Name \"EnableTranscripting\" -Value 1 -Type DWord\nSet-ItemProperty -Path $transcriptRegistry -Name \"OutputDirectory\" -Value $transcriptPath -Type String\nSet-ItemProperty -Path $transcriptRegistry -Name \"EnableInvocationHeader\" -Value 1 -Type DWord\n\nWrite-Host \"Windows session auditing configured\"\n\"@",
        "event_log_configuration": "# Configure Windows Event Log for session auditing\n# Ensures sufficient capacity and retention for audit events\n\nPowerShell -Command \"\n# Configure Security Event Log\nlimit-EventLog -LogName Security -MaximumSize 4GB -OverflowAction DoNotOverwrite\n\n# Configure System Event Log\nlimit-EventLog -LogName System -MaximumSize 2GB -OverflowAction DoNotOverwrite\n\n# Configure Application Event Log\nlimit-EventLog -LogName Application -MaximumSize 2GB -OverflowAction DoNotOverwrite\n\n# Verify configuration\nGet-EventLog -List | Select-Object Log, Maximum, Retention\n\nWrite-Host 'Event log configuration completed for AU-14 compliance'\n\""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00.000000Z",
      "has_scripts": true,
      "qa_verified": true,
      "nist_aligned": true
    },
    "cac_metadata": {
      "implementation_type": "specialized",
      "last_analyzed": "2025-11-20T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "cac_status": "available",
      "cac_planned": true,
      "implementation_guidance": "ComplianceAsCode content includes audit framework rules for RHEL/CentOS in the linux_os/guide/system/auditing/rule_audit_session_initiation/ and related session capture configurations. Windows implementations require Event Tracing and PowerShell transcript logging via Group Policy.",
      "stig_id": "N/A - Base control (enhancements map to specific STIG rules)"
    },
    "ai_guidance": {
      "implementation_strategy": "Session auditing requires a layered approach: (1) Foundation layer with audit event capture (AU-2), (2) Session-specific recording using PAM/auditd on Linux or Event Tracing on Windows, (3) Access control layer restricting who can initiate/view sessions, (4) Encryption and secure storage of captured session data, (5) Legal/compliance review before deployment due to privacy implications.",
      "common_challenges": "Privacy concerns are the primary challenge - session recording can capture sensitive information including passwords. Organizations must balance security monitoring needs with employee rights. Implement data minimization principles by only recording necessary details. Ensure legal counsel approval before implementation. Storage and performance impacts must be considered - session recording can consume significant disk space and CPU resources.",
      "validation_approach": "Validate by: (1) Confirming audit rules are loaded and active via auditctl -l (Linux), (2) Testing that session events are captured in audit logs, (3) Verifying appropriate users can view session data per policy, (4) Confirming encryption of stored session data, (5) Testing both automatic startup (AU-14.1) and remote viewing (AU-14.3) where applicable, (6) Conducting privacy impact assessment with legal team.",
      "deployment_considerations": "Start with monitoring privileged accounts before expanding to all users. Use test/dev environments first. Implement with clear notification to users that sessions may be monitored (legal requirement in many jurisdictions). Monitor system performance impact. Establish clear retention and disposal procedures. Document all session audit requests and authorizations for compliance."
    }
  },
  {
    "control_id": "AU-14.1",
    "stig_id": "RHEL-08-030320",
    "control_name": "System Start-up",
    "family": "Audit and Accountability",
    "family_id": "au",
    "official_text": "Initiate session audits automatically at system start-up.",
    "parent_control": "AU-14",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "AU-14.1 extends the base AU-14 control by requiring session auditing to be automatically initiated when systems start up. This ensures no user activity occurs without audit coverage, eliminating the possibility of users logging in and performing actions before session monitoring is manually enabled. Instead of relying on administrators to enable session auditing after a system boots, this enhancement automates the process so auditing is always active from the moment the system is operational.",
    "example_implementation": "On Linux systems, this can be achieved by embedding session audit rule loading in the audit daemon startup scripts (via systemd or init scripts) or using audit-at-boot kernel parameters. On Windows, enabling auditing through Group Policy ensures all session-related events are logged from system startup. Organizations can also use initialization scripts that verify audit status on boot and alert if sessions are not being properly monitored.",
    "non_technical_guidance": "AU-14.1 (System Start-up) addresses the critical gap where session auditing might not be active from the moment a system powers on. Implementation considerations include:\n\n1. Automation Verification: Ensure that session auditing initialization is part of the standard system boot process and does not require manual intervention by administrators.\n\n2. Boot-Time Configuration: Verify that audit daemons (auditd on Linux, Windows Event Tracing on Windows) start automatically at system initialization with full session audit rules loaded.\n\n3. Boot-Time Alerts: Configure systems to alert administrators if session auditing fails to initialize properly during system startup.\n\n4. Testing and Validation: Regularly test system restarts to confirm that session auditing is automatically active without requiring administrator action.\n\n5. Documentation: Maintain clear documentation of the automatic session audit startup process and what occurs if there are startup failures.\n\n6. Failover Procedures: Define procedures for rapid re-initialization of session auditing if it fails to start automatically.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-2",
      "AU-14",
      "CA-7",
      "SI-4"
    ],
    "supplemental_guidance": "Automatic initiation of session audits at system start-up ensures continuous audit coverage and eliminates timing vulnerabilities where session monitoring might not be active. This enhancement is particularly important in high-security environments where any unmonitored user activity represents a compliance and security risk. Organizations must ensure that the audit framework initialization is not dependent on external services or administrative action that might fail or be delayed. Testing should include validation that session auditing is fully operational immediately after system startup, before any user sessions are established.",
    "implementation_scripts": {
      "linux": {
        "systemd_audit_startup": "#!/bin/bash\n# Ensure audit daemon starts at boot with session audit rules loaded\n# This implements AU-14.1 System Start-up requirement\n\n# Verify auditd is enabled to start at boot\nsystemctl enable auditd\nsystemctl status auditd\n\n# Create or verify audit rules directory and session audit rules\nmkdir -p /etc/audit/rules.d\n\n# Ensure session audit rules are loaded on daemon startup\nif ! grep -q \"session-audit\" /etc/audit/rules.d/*.rules 2>/dev/null; then\n    cat > /etc/audit/rules.d/50-session-audit.rules << 'EOF'\n# Session Audit Rules - Loaded at boot (AU-14.1)\n-w /var/log/wtmp -p wa -k session_recording\n-w /var/log/btmp -p wa -k session_failed_login\n-w /var/log/lastlog -p wa -k session_lastlog\nEOF\nfi\n\n# Load rules immediately\naugenrules --load\nauditctl -R /etc/audit/rules.d/\nauditctl -l | grep -i session\n\necho 'Audit system configured for automatic session audit startup (AU-14.1)'\n\n# Verify audit service will auto-start on reboot\nsystemctl is-enabled auditd && echo 'PASS: auditd enabled for auto-start' || echo 'FAIL: auditd not enabled'",
        "init_script_audit_startup": "#!/bin/bash\n# Legacy init.d method for systems without systemd\n# Ensures auditd and session auditing start on boot\n\n# For RHEL/CentOS 7 or systems using init.d:\nupdate-rc.d auditd defaults 2>&1 | grep -q 'update-rc.d' && echo 'auditd configured for boot startup'\n\n# Add to /etc/init.d/auditd or create wrapper\n# Verify auditd loads rules on startup\nif [ -f /etc/init.d/auditd ]; then\n    # Inject rules loading into init script\n    sed -i 's|daemon /sbin/auditd|daemon /sbin/auditd\\n\\t/sbin/augenrules --load|g' /etc/init.d/auditd\nfi\n\necho 'Init.d audit startup configured for AU-14.1'",
        "audit_boot_verification": "#!/bin/bash\n# Verification script to confirm session auditing is active at system start\n# Run this during boot to validate AU-14.1 implementation\n\necho \"Verifying AU-14.1 System Start-up Implementation...\"\n\n# Check if audit daemon is running\nif ps aux | grep -v grep | grep auditd > /dev/null; then\n    echo \"PASS: Audit daemon is running\"\nelse\n    echo \"FAIL: Audit daemon is not running - session audit not active at startup\"\n    systemctl start auditd\nfi\n\n# Verify session audit rules are loaded\nif auditctl -l 2>/dev/null | grep -E \"(wtmp|btmp|lastlog|session)\" > /dev/null; then\n    echo \"PASS: Session audit rules are loaded\"\nelse\n    echo \"WARN: Session audit rules not loaded - loading now\"\n    augenrules --load\nfi\n\n# Check audit log is receiving events\nif auditctl -b 2>/dev/null | grep -q \"[0-9]\"; then\n    echo \"PASS: Audit log is receiving events\"\nelse\n    echo \"FAIL: No audit events detected\"\nfi\n\necho \"AU-14.1 verification complete\""
      },
      "windows": {
        "group_policy_boot_audit": "# Windows Group Policy Registry Configuration for AU-14.1 System Start-up\n# Ensures session auditing is enabled from system startup\n\nReg add \"HKLM\\System\\CurrentControlSet\\Services\\eventlog\\Security\" /v \"MaxSize\" /t REG_DWORD /d 4294967295 /f\nReg add \"HKLM\\System\\CurrentControlSet\\Services\\eventlog\\Security\" /v \"Retention\" /t REG_DWORD /d 0 /f\n\n# Enable audit policies that start automatically\nauditpol.exe /set /subcategory:\"Logon/Logoff\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Process Creation\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Process Termination\" /success:enable /failure:enable\n\necho \"Windows session auditing configured for automatic startup (AU-14.1)\"",
        "powershell_boot_audit": "$null = @\"\n# PowerShell script to configure Windows Event Auditing for startup\n# Implements AU-14.1 System Start-up requirement\n\n# Verify Windows Event Log service is set to auto-start\nGet-Service EventLog | Set-Service -StartupType Automatic\nStart-Service EventLog -ErrorAction SilentlyContinue\n\n# Configure audit policy for logon events (triggered at startup)\nauditpol.exe /set /subcategory:\"Logon/Logoff\" /success:enable /failure:enable | Out-Null\n\n# Configure Windows Event Forwarding for session auditing\n# Create event subscription to capture session events\n$eventSubscription = Get-EventSubscription -ErrorAction SilentlyContinue | Where-Object {$_.Name -eq \"SessionAudit\"}\nif (-Not $eventSubscription) {\n    $eventQuery = @'\n<QueryList>\n  <Query Id=\"0\" Path=\"Security\">\n    <Select Path=\"Security\">*[System[(EventID=4624) or (EventID=4625) or (EventID=4634) or (EventID=4688)]]\n    </Select>\n  </Query>\n</QueryList>\n'@\n    \n    New-EventSubscription -Name \"SessionAudit\" -Description \"AU-14.1 Session Audit\" -TargetComputer localhost -EventSourcePath $eventQuery -Enabled $true -ErrorAction SilentlyContinue\n}\n\n# Verify services are running and will start on boot\n$auditServices = @(\"EventLog\", \"Winmgmt\", \"mpssvc\")\nforeach ($service in $auditServices) {\n    $svc = Get-Service $service -ErrorAction SilentlyContinue\n    if ($svc) {\n        Set-Service -Name $service -StartupType Automatic\n        Start-Service -Name $service -ErrorAction SilentlyContinue\n        Write-Host \"Configured $service for auto-start\"\n    }\n}\n\nWrite-Host \"AU-14.1 Windows session audit startup configuration complete\"\n\"@",
        "audit_startup_verification": "# PowerShell verification script for AU-14.1 implementation\n# Validates that session auditing is active immediately after system startup\n\nWrite-Host \"Verifying AU-14.1 System Start-up Implementation...\"\n\n# Check Event Log service status\nif ((Get-Service EventLog).Status -eq \"Running\") {\n    Write-Host \"PASS: Event Log service is running\"\n} else {\n    Write-Host \"FAIL: Event Log service is not running\"\n    Start-Service EventLog\n}\n\n# Verify audit policies are enabled\n$auditPolicy = auditpol.exe /get /category:\"Logon/Logoff\" /r | ConvertFrom-Csv\nif ($auditPolicy.'Audit Success' -eq \"Yes\") {\n    Write-Host \"PASS: Logon/Logoff auditing is enabled\"\n} else {\n    Write-Host \"FAIL: Logon/Logoff auditing is not enabled\"\n}\n\n# Check for recent security events in Event Log\n$recentEvents = Get-EventLog -LogName Security -Newest 10 -ErrorAction SilentlyContinue\nif ($recentEvents) {\n    Write-Host \"PASS: Security events are being logged\"\n} else {\n    Write-Host \"FAIL: No recent security events detected\"\n}\n\n# Verify Winlogon will initialize auditing on startup\nif (Test-Path \"HKLM:\\Software\\Policies\\Microsoft\\Windows\\System\\Audit\") {\n    Write-Host \"PASS: Audit policies are configured in registry\"\n} else {\n    Write-Host \"INFO: Configuring audit policies in registry\"\n}\n\nWrite-Host \"AU-14.1 verification complete\""
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00.000000Z",
      "has_scripts": true,
      "qa_verified": true,
      "nist_aligned": true
    },
    "cac_metadata": {
      "implementation_type": "boot_configuration",
      "last_analyzed": "2025-11-20T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "cac_status": "available",
      "cac_planned": true,
      "implementation_guidance": "AU-14.1 requires audit framework initialization at system boot. ComplianceAsCode includes audit daemon startup rules for RHEL/CentOS. Windows implementations use Group Policy to ensure auditing begins immediately upon system initialization.",
      "stig_id": "RHEL-08-030320, RHEL-08-030330"
    },
    "ai_guidance": {
      "implementation_strategy": "Ensure audit daemon (auditd or Windows Event Log service) is configured with automatic startup (systemctl enable auditd, Set-Service -StartupType Automatic). Load session audit rules during daemon initialization, not after. Test on reboot to verify timing.",
      "common_challenges": "Timing issues where session audit rules load after users have already logged in. Storage space may not be available at boot time. Dependencies on network resources for centralized logging may fail at startup.",
      "validation_approach": "Validate by: (1) Examining system boot logs to confirm audit service started, (2) Checking that session audit rules were loaded before any user login events, (3) Verifying audit log contains events from system startup, (4) Testing system reboot and confirming auditing is immediately active without manual intervention.",
      "deployment_considerations": "Critical for high-security environments. Requires careful testing of reboot procedures. Must ensure boot-time audit startup does not introduce security gaps or performance issues. Document expected boot time impact of audit initialization."
    }
  },
  {
    "control_id": "AU-14.2",
    "stig_id": "RHEL-08-030330",
    "control_name": "Capture and Record Content",
    "family": "Audit and Accountability",
    "family_id": "au",
    "official_text": "Provide the capability to capture and record the content of a user session.",
    "parent_control": "AU-14",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "AU-14.2 requires that organizations implement the technical capability to capture and record the actual content occurring within user sessions. This means recording not just the fact that a session occurred, but the substantive content of what the user did - including commands executed, keystrokes entered, file operations, terminal output, and other session activities. This enhancement goes beyond simple session initiation logging to provide a complete record of session activities that can be reviewed for security analysis, incident investigation, or compliance verification.",
    "example_implementation": "Linux implementations use tools like 'script' and 'scriptreplay' to record terminal sessions, auditd with session tracking rules, or specialized tools like Teleport that record all session activity. Windows implementations might use terminal session recording features, PowerShell transcript logging, or Windows Event Tracing for administrative sessions. Organizations may also deploy session recording appliances or Software-as-a-Service solutions that intercept and record all session content in real-time.",
    "non_technical_guidance": "AU-14.2 (Capture and Record Content) requires implementing technology to capture complete session activity records:\n\n1. Content Capture Mechanisms: Organizations must deploy tools capable of recording actual session content (commands, output, keystrokes) not just session metadata. This may involve:\n   - Terminal session recording (Linux/Unix)\n   - PowerShell transcript logging (Windows)\n   - SSH session recording (network access)\n   - Remote desktop session recording\n   - Application-level command logging\n\n2. Selective vs. Continuous Recording: Determine whether to record all sessions continuously (high storage overhead) or selectively based on user role, activity type, or compliance requirements.\n\n3. Data Privacy and Minimization: Session content may contain sensitive information. Organizations must:\n   - Implement strict access controls on recorded content\n   - Consider privacy impact assessments before deployment\n   - Use data minimization principles (record only essential session content)\n   - Encrypt recorded session data\n   - Establish secure deletion procedures\n\n4. Storage and Performance: Recording session content requires significant storage capacity and may impact system performance. Organizations must:\n   - Estimate storage requirements based on user population and recording duration\n   - Implement archival strategies for older recordings\n   - Monitor system performance impact\n   - Plan for adequate backup and disaster recovery\n\n5. Access and Playback: Define who can access recorded sessions and establish procedures for:\n   - Authorized session review (security team, incident responders)\n   - Session playback and analysis\n   - Extraction of evidence from sessions\n   - Audit trail for who accessed which recordings\n\n6. Legal and Compliance Considerations: Ensure that session recording:\n   - Complies with privacy regulations (GDPR, CCPA, etc.)\n   - Follows applicable labor laws regarding employee monitoring\n   - Has documented business justification\n   - Is disclosed to users as required by law\n\n7. Content Retention: Establish clear retention schedules for recorded session content (often 30-90 days for operational investigation, longer for compliance requirements).",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-2",
      "AU-4",
      "AU-6",
      "AU-9",
      "AU-12",
      "AU-14",
      "CA-7"
    ],
    "supplemental_guidance": "Capturing and recording session content provides detailed audit trail of user activities that enables investigation of security incidents, verification of user actions, and evidence collection for compliance audits. However, this capability raises significant privacy concerns since session recordings can contain sensitive information including passwords, confidential data, and personal information. Organizations must balance the security benefits of comprehensive session recording with privacy protections and employee rights. Implementation should include: (1) technical controls to restrict access to recorded content, (2) legal review to ensure compliance with privacy laws, (3) notification to users that sessions may be recorded, (4) encryption of stored session data, (5) regular purging of recorded content per retention policies, (6) audit trail showing who accessed recordings and when. Organizations should implement this enhancement selectively, recording only sessions that are justified for security or compliance reasons rather than recording all user sessions indiscriminately.",
    "implementation_scripts": {
      "linux": {
        "script_session_recording": "#!/bin/bash\n# Implement AU-14.2 using 'script' and 'scriptreplay' for terminal session recording\n# Records all terminal input and output for user session content capture\n\n# Method 1: Automatic session recording via bashrc for specific users\nfor user in $(awk -F: '$3 >= 1000 && $3 <= 60000 {print $1}' /etc/passwd); do\n    if [ -f /home/$user/.bashrc ]; then\n        if ! grep -q \"session_record\" /home/$user/.bashrc; then\n            cat >> /home/$user/.bashrc << 'EOF'\n# AU-14.2: Automatic session recording\nif [ -z \"$RECORDING\" ]; then\n    export RECORDING=true\n    SESSION_LOG_DIR=\"/var/log/session-recordings\"\n    mkdir -p \"$SESSION_LOG_DIR\"\n    SESSION_LOG=\"$SESSION_LOG_DIR/${USER}_$(date +%Y%m%d_%H%M%S).log\"\n    script -f \"$SESSION_LOG\"\nfi\nEOF\n        fi\n    fi\ndone\n\necho 'Session recording via script configured for AU-14.2'\n\n# Create session recording directory\nmkdir -p /var/log/session-recordings\nchmod 700 /var/log/session-recordings",
        "auditd_content_capture": "#!/bin/bash\n# Configure auditd to capture session content and commands\n# Implements AU-14.2 for command and session activity logging\n\ncat > /etc/audit/rules.d/session-content.rules << 'EOF'\n# AU-14.2: Session Content Capture\n# Track all executed commands and session activities\n\n# Monitor execv syscall to capture all command execution\n-a always,exit -F arch=b64 -S execve -F auid!=4294967295 -k session_commands\n-a always,exit -F arch=b32 -S execve -F auid!=4294967295 -k session_commands\n\n# Monitor file access and modifications during sessions\n-w /tmp/ -p wa -k session_file_ops\n-w /home/ -p wa -k session_file_ops\n\n# Monitor network connections\n-a always,exit -F arch=b64 -S socket -S connect -S sendto -S recvfrom -S sendmsg -S recvmsg -F auid!=4294967295 -k session_network\n\n# Monitor terminal operations (TTY)\n-w /dev/pts/ -p rw -k session_tty\n\n# Make rules permanent\n-e 2\nEOF\n\naugenrules --load\nauditctl -l | grep session\necho 'Auditd session content capture configured for AU-14.2'",
        "session_content_parser": "#!/bin/bash\n# Utility to parse and display recorded session content\n# Extract session commands and activities from audit logs\n\ncat > /usr/local/bin/parse-session-content.sh << 'EOF'\n#!/bin/bash\n# Parse auditd logs to extract session content\n\nif [ -z \"$1\" ]; then\n    echo \"Usage: $0 [username|session_id]\"\n    exit 1\nfi\n\nUSERNAME=\"$1\"\n\necho \"=== Session Content for $USERNAME ===\"\ngrep \"$USERNAME\" /var/log/audit/audit.log | \\\n    grep -E \"(execve|socket|connect|tty)\" | \\\n    awk -F'comm=' '{print $2}' | \\\n    cut -d'\"' -f2 | \\\n    sort | uniq -c | sort -rn\n\necho \"\"\necho \"=== Detailed Session Events ===\"\nauditctl -l | grep session_commands > /dev/null && \\\nautracerpt -ts \"2 hours ago\" /var/log/audit/audit.log | grep \"$USERNAME\"\nEOF\n\nchmod +x /usr/local/bin/parse-session-content.sh\necho 'Session content parser script installed'"
      },
      "windows": {
        "powershell_transcript_logging": "# Configure PowerShell Transcript Logging for AU-14.2 Session Content Capture\n# Records all PowerShell session content including commands and output\n\nPowerShell -Command \"\n# Create transcript directory\n\\$transcriptPath = \\\"C:\\\\Windows\\\\System32\\\\LogFiles\\\\PowerShell\\\\Transcripts\\\"\nif (-Not (Test-Path \\$transcriptPath)) {\n    New-Item -Path \\$transcriptPath -ItemType Directory -Force | Out-Null\n}\n\n# Configure Group Policy for PowerShell Transcription\n\\$transcriptRegistry = \\\"HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows\\\\PowerShell\\\\Transcription\\\"\nif (-Not (Test-Path \\$transcriptRegistry)) {\n    New-Item -Path \\$transcriptRegistry -Force | Out-Null\n}\n\n# Enable transcription of all PowerShell sessions\nSet-ItemProperty -Path \\$transcriptRegistry -Name \\\"EnableTranscripting\\\" -Value 1 -Type DWord\nSet-ItemProperty -Path \\$transcriptRegistry -Name \\\"OutputDirectory\\\" -Value \\$transcriptPath -Type String\nSet-ItemProperty -Path \\$transcriptRegistry -Name \\\"EnableInvocationHeader\\\" -Value 1 -Type DWord\nSet-ItemProperty -Path \\$transcriptRegistry -Name \\\"IncludeInvocationHeader\\\" -Value 1 -Type DWord\n\nWrite-Host \\\"PowerShell transcript logging configured for AU-14.2\\\"\n\"",
        "terminal_session_recording": "# Configure Remote Desktop Session Recording for AU-14.2\n# Captures Terminal Services session content on Windows\n\nPowerShell -Command \"\n# Enable RDP session recording via Group Policy\n\\$rdpRegistry = \\\"HKLM:\\\\Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Terminal Services\\\"\nif (-Not (Test-Path \\$rdpRegistry)) {\n    New-Item -Path \\$rdpRegistry -Force | Out-Null\n}\n\n# Enable session recording\nSet-ItemProperty -Path \\$rdpRegistry -Name \\\"RecordingPath\\\" -Value \\\"C:\\\\SessionRecordings\\\" -Type String\nSet-ItemProperty -Path \\$rdpRegistry -Name \\\"RecordingOptions\\\" -Value 1 -Type DWord\n\n# Create recordings directory\nif (-Not (Test-Path \\\"C:\\\\SessionRecordings\\\")) {\n    New-Item -Path \\\"C:\\\\SessionRecordings\\\" -ItemType Directory -Force | Out-Null\n    icacls \\\"C:\\\\SessionRecordings\\\" /grant:r \\\"SYSTEM:(OI)(CI)F\\\" /inheritance:e\n}\n\nWrite-Host \\\"RDP session recording configured for AU-14.2\\\"\n\"",
        "event_viewer_session_tracking": "# Configure Windows Event Viewer to track session content\n# Monitors process execution, file access, and network activity during sessions\n\nRem Enable Process Creation Auditing\nauditpol.exe /set /subcategory:\"Process Creation\" /success:enable /failure:enable\n\nRem Enable File Access Auditing\nauditpol.exe /set /subcategory:\"File System\" /success:enable /failure:enable\nauditpol.exe /set /subcategory:\"Other Object Access Events\" /success:enable /failure:enable\n\nRem Enable Network Activity Auditing\nauditpol.exe /set /subcategory:\"Filtering Platform Connection\" /success:enable /failure:enable\n\nRem Enable Registry Auditing\nauditpol.exe /set /subcategory:\"Registry\" /success:enable /failure:enable\n\nRem Enable SAM Auditing (user and group management)\nauditpol.exe /set /subcategory:\"SAM\" /success:enable /failure:enable\n\necho Windows event-based session content tracking configured for AU-14.2"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00.000000Z",
      "has_scripts": true,
      "qa_verified": true,
      "nist_aligned": true
    },
    "cac_metadata": {
      "implementation_type": "content_recording",
      "last_analyzed": "2025-11-20T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "cac_status": "available",
      "cac_planned": true,
      "implementation_guidance": "AU-14.2 requires actual session content recording, not just session metadata. ComplianceAsCode content includes auditd rules for command capture and execution tracking. Windows implementations should use PowerShell transcript logging or Terminal Services session recording features.",
      "stig_id": "RHEL-08-030330, RHEL-08-030340, RHEL-08-030350"
    },
    "ai_guidance": {
      "implementation_strategy": "Balance between comprehensive session recording and privacy/performance impacts. Start with privileged account recording, then expand. Use compression and archival for long-term storage. Implement encryption for all recorded content. Establish clear access controls and audit trails for who views recordings.",
      "common_challenges": "Storage requirements are substantial - a single terminal session can generate megabytes of data. Privacy concerns are significant - recordings may contain passwords and confidential data. Performance impact on systems with continuous recording. Employee privacy rights must be respected. Legal compliance required before deployment.",
      "validation_approach": "Validate by: (1) Confirming session content is being captured in configured logs/recordings, (2) Testing playback of recorded sessions, (3) Verifying content is encrypted and access-controlled, (4) Checking that recordings include full command/output content, (5) Confirming retention policies are enforced.",
      "deployment_considerations": "Implement selectively starting with critical or privileged accounts. Must have clear business justification and legal review. Notify users that sessions may be recorded. Plan for significant storage requirements. Consider outsourcing to specialized SaaS if internal resources limited. Ensure incident response team has procedures to access and analyze recorded content."
    }
  },
  {
    "control_id": "AU-14.3",
    "stig_id": "RHEL-08-030360",
    "control_name": "Remote Viewing and Listening",
    "family": "Audit and Accountability",
    "family_id": "au",
    "official_text": "Provide and implement the capability for authorized users to remotely view and hear content related to an established user session in real time.",
    "parent_control": "AU-14",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "AU-14.3 requires organizations to provide real-time remote monitoring capabilities for session content. This means authorized security personnel or incident responders can connect to a monitoring interface and observe user session activities as they happen (in real-time), including viewing terminal output and listening to audio from sessions (in systems with voice/multimedia capabilities). This enhancement enables immediate detection and response to suspicious activities without waiting for audit logs to be processed later. The capability is restricted to authorized users only and provides real-time visibility into user session activities across the organization's systems.",
    "example_implementation": "Organizations can implement this using session monitoring tools like Teleport with real-time session playback, bastion hosts with session broadcasting capabilities, SSH multiplexing for real-time session viewing, or specialized session monitoring platforms (commercial or open-source) that provide real-time stream access. For RDP sessions, Windows Remote Assistance or monitoring tools can enable real-time viewing. Organizations must implement authentication and authorization mechanisms to ensure only designated personnel can access real-time session monitoring.",
    "non_technical_guidance": "AU-14.3 (Remote Viewing and Listening) enables real-time monitoring of user sessions, providing immediate visibility into user activities:\n\n1. Real-Time Monitoring Objectives: Determine organizational requirements for real-time session monitoring:\n   - Incident response teams need immediate visibility into user activities during security incidents\n   - Security operations center (SOC) may monitor high-risk sessions in real-time\n   - Compliance teams may observe sessions for audit purposes\n   - Forensic capabilities to see session activity as it occurs\n\n2. Authorization and Access Control: Implement strict controls:\n   - Only designated roles (security team, incident responders, compliance officers) can initiate real-time monitoring\n   - Document all real-time monitoring activities and justifications\n   - Establish approval workflows for initiating real-time session monitoring\n   - Create audit trail showing who monitored which sessions and when\n\n3. User Notification: Determine notification requirements:\n   - In some jurisdictions, users must be notified that their session is being actively monitored\n   - Develop procedures for appropriate notification (real-time banner, post-incident disclosure, etc.)\n   - Document legal requirements for user notification based on applicable laws\n\n4. Technical Implementation Options:\n   - Session forwarding/multiplexing (multiple parties view same session)\n   - Real-time session stream to dedicated monitoring interface\n   - Web-based dashboard showing live session activity\n   - Audio/video capture if multimedia sessions\n   - Integration with incident response tools\n\n5. Privacy and Civil Liberties Considerations:\n   - Real-time monitoring is more intrusive than recorded playback\n   - Ensure clear business justification (only during investigations or for critical systems)\n   - Limit scope (specific users, sessions, time windows)\n   - Include privacy officials in authorization decisions\n   - Establish boundaries on what information can be monitored\n\n6. Performance and System Impact:\n   - Real-time monitoring may impact system performance\n   - Ensure monitoring mechanisms don't degrade user experience\n   - Plan for bandwidth requirements if remote monitoring over network\n   - Consider load on monitoring systems from multiple concurrent monitors\n\n7. Session Termination Capability:\n   - Consider whether authorized monitors can terminate monitored sessions\n   - Define procedures for emergency session termination if malicious activity detected\n   - Document authorization requirements for session termination\n\n8. Integration with Response Procedures:\n   - Define workflows for responding to incidents detected through real-time monitoring\n   - Integrate with incident response playbooks\n   - Establish escalation procedures\n   - Maintain audit trail of monitoring activities and any remediation actions taken",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-2",
      "AU-4",
      "AU-6",
      "AU-12",
      "AU-14",
      "CA-7",
      "IR-4",
      "SI-4"
    ],
    "supplemental_guidance": "Real-time remote viewing and listening capability enables immediate detection and response to security incidents by providing live visibility into user session activities. This enhancement is particularly valuable during active incident investigations or when monitoring high-risk accounts (privileged users, contractors, new employees). Organizations must carefully balance the security benefits of real-time monitoring with privacy protections. Implementation considerations include: (1) restricting access to only authorized personnel with documented justification, (2) considering whether real-time monitoring requires special authorization or court orders in some jurisdictions, (3) implementing notification mechanisms where legally required, (4) encrypting all communication channels for remote monitoring to prevent unauthorized access, (5) maintaining detailed audit trail of all monitoring activities, (6) integrating with incident response processes, (7) establishing clear procedures for what actions monitors can take (observation only vs. ability to terminate sessions), (8) ensuring performance monitoring doesn't negatively impact monitored systems. Organizations should implement this capability selectively rather than providing continuous monitoring of all user sessions, reserving real-time monitoring for specific incidents, high-risk accounts, or compliance audits.",
    "implementation_scripts": {
      "linux": {
        "ssh_multiplexing_real_time_view": "#!/bin/bash\n# Implement AU-14.3 Real-Time Session Viewing using SSH Multiplexing\n# Allows authorized users to join and view active SSH sessions in real time\n\n# Install prerequisite tools\nwhich tmux > /dev/null || apt-get install -y tmux\nwhich screen > /dev/null || apt-get install -y screen\n\n# Configure tmux for real-time session sharing (AU-14.3)\ncat > /etc/tmux.conf << 'EOF'\n# AU-14.3: Enable real-time session monitoring via tmux\n# Multiple users can view same session in real-time\n\nset -g allow-rename off\nset -g monitor-activity on\nset -g monitor-silence 0\n\n# Enable session sharing for authorized users\nset -g default-terminal \"screen-256color\"\nset -g exit-unattached off\n\n# Log all session activity\nset -g history-limit 50000\n\n# Create a read-only session view for monitoring\nset -g status-left \"[session-name: #S]\"\nEOF\n\n# Create script to launch monitored sessions\ncat > /usr/local/bin/start-monitored-session.sh << 'EOF'\n#!/bin/bash\n# Start a user session with real-time monitoring enabled\n# Usage: start-monitored-session.sh username session_name\n\nif [ $# -ne 2 ]; then\n    echo \"Usage: $0 username session_name\"\n    exit 1\nfi\n\nUSERNAME=$1\nSESSION_NAME=$2\n\n# Start tmux session as specified user\nsudo -u $USERNAME tmux new-session -d -s $SESSION_NAME -x 120 -y 40\n\n# Grant monitor permission to security group\nchmod g+rw /proc/$$/fd/$(tmux display-message -p '#{client_tty}' | sed 's|/dev/||')\n\necho \"Monitored session started: $SESSION_NAME (user: $USERNAME)\"\necho \"Authorized monitors can connect with: tmux attach -t $SESSION_NAME -r\"\nEOF\n\nchmod +x /usr/local/bin/start-monitored-session.sh\n\n# Create authorization wrapper\ncat > /usr/local/bin/monitor-session.sh << 'EOF'\n#!/bin/bash\n# Authorized session monitoring wrapper (AU-14.3)\n# Enforces authorization before allowing session monitoring\n\nif [ \"$EUID\" != \"0\" ] && ! groups | grep -q \"monitor-group\"; then\n    echo \"ERROR: Not authorized to monitor sessions\"\n    exit 1\nfi\n\nif [ -z \"$1\" ]; then\n    echo \"Usage: $0 session_name\"\n    exit 1\nfi\n\nSESSION=$1\n\n# Audit the monitoring action\nauditctl -w /usr/local/bin/monitor-session.sh -p x -k session_monitoring\necho \"[$(date)] Monitoring started for session: $SESSION by user: $(whoami)\" >> /var/log/session-monitoring.log\n\n# Attach as read-only observer\ntmux attach -t $SESSION -r\nEOF\n\nchmod +x /usr/local/bin/monitor-session.sh\n\necho 'SSH session multiplexing for real-time viewing configured (AU-14.3)'",
        "web_based_session_viewer": "#!/bin/bash\n# Configure web-based real-time session viewer (AU-14.3)\n# Provides remote access to view live session activity via web interface\n\n# Install asciinema for session recording and playback\nwhich asciinema > /dev/null || pip install asciinema\n\n# Create web viewer script\ncat > /usr/local/bin/session-viewer-server.py << 'EOF'\n#!/usr/bin/env python3\n# Simple web server for real-time session viewing (AU-14.3)\nimport os\nimport subprocess\nfrom http.server import HTTPServer, SimpleHTTPRequestHandler\nimport json\nimport tempfile\n\nclass SessionViewerHandler(SimpleHTTPRequestHandler):\n    def do_GET(self):\n        if self.path == '/api/sessions':\n            # Return list of monitored sessions\n            sessions = self.list_active_sessions()\n            self.send_response(200)\n            self.send_header('Content-type', 'application/json')\n            self.end_headers()\n            self.wfile.write(json.dumps(sessions).encode())\n        elif self.path.startswith('/api/session/'):\n            # Stream session output\n            session_id = self.path.split('/')[-1]\n            self.stream_session(session_id)\n        else:\n            super().do_GET()\n    \n    def list_active_sessions(self):\n        # Get tmux sessions\n        result = subprocess.run(['tmux', 'list-sessions', '-F', '#{session_name}'],\n                              capture_output=True, text=True)\n        sessions = [s.strip() for s in result.stdout.split('\\n') if s.strip()]\n        return {\"sessions\": sessions}\n    \n    def stream_session(self, session_id):\n        # Stream real-time output from session\n        cmd = f'tmux capture-pane -t {session_id} -p'\n        result = subprocess.run(cmd, shell=True, capture_output=True, text=True)\n        self.send_response(200)\n        self.send_header('Content-type', 'text/plain')\n        self.end_headers()\n        self.wfile.write(result.stdout.encode())\n\nif __name__ == '__main__':\n    PORT = 8443\n    server = HTTPServer(('localhost', PORT), SessionViewerHandler)\n    print(f'AU-14.3 Session Viewer running on https://localhost:{PORT}')\n    server.serve_forever()\nEOF\n\nchmod +x /usr/local/bin/session-viewer-server.py\n\necho 'Web-based session viewer configured for AU-14.3'"
      },
      "windows": {
        "remote_assistance_monitoring": "# Configure Windows Remote Assistance for Real-Time Session Monitoring (AU-14.3)\n# Allows authorized users to remotely view user sessions in real-time\n\nPowerShell -Command \"\n# Enable Remote Assistance\nSet-ItemProperty -Path \\\"HKLM:\\\\System\\\\CurrentControlSet\\\\Control\\\\Remote Assistance\\\" -Name \\\"fAllowToGetHelp\\\" -Value 1 -Type DWord\nSet-ItemProperty -Path \\\"HKLM:\\\\System\\\\CurrentControlSet\\\\Control\\\\Remote Assistance\\\" -Name \\\"fAllowFullControl\\\" -Value 1 -Type DWord\n\n# Configure Remote Desktop for session viewing\nSet-ItemProperty -Path \\\"HKLM:\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\" -Name \\\"fDenyTSConnections\\\" -Value 0 -Type DWord\n\n# Enable the remote desktop service\nSet-Service -Name TermService -StartupType Automatic\nStart-Service -Name TermService -ErrorAction SilentlyContinue\n\nWrite-Host \\\"Remote Assistance configured for AU-14.3 session monitoring\\\"\n\"",
        "bastion_host_session_broadcast": "# Configure Bastion Host for Real-Time Session Broadcasting (AU-14.3)\n# Enable multiple authorized monitors to view sessions from jump host\n\nPowerShell -Command \"\n# Install OpenSSH if not present\nif (-not (Get-WindowsCapability -Online | Where-Object {\\$_.Name -like '*OpenSSH.Server*'}).State -eq 'Installed') {\n    Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0\n}\n\n# Configure SSH for session monitoring\n\\$sshConfig = @'\nMatch User monitor-group\n    AllowAgentForwarding yes\n    AllowTcpForwarding yes\n    ForceCommand tmux attach\nMatch Group monitor-group\n    AuthorizedKeysFile .ssh/authorized_keys\nMatch Group admin\n    X11Forwarding yes\n    AllowTcpForwarding yes\n'@\n\nAdd-Content -Path \\\"C:\\\\ProgramData\\\\ssh\\\\sshd_config\\\" -Value \\$sshConfig\n\n# Restart SSH service\nRestart-Service sshd\n\nWrite-Host \\\"Bastion host session broadcasting configured for AU-14.3\\\"\n\"",
        "rdp_session_monitoring": "# Configure Remote Desktop Protocol (RDP) for Real-Time Session Monitoring (AU-14.3)\n# Enables authorized users to monitor RDP sessions in real-time\n\nRem Enable Remote Desktop\nReg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\" /v fDenyTSConnections /t REG_DWORD /d 0 /f\n\nRem Enable RDP listener\nReg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp\\\" /v PortNumber /t REG_DWORD /d 3389 /f\n\nRem Enable Network Level Authentication\nReg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp\\\" /v SecurityLayer /t REG_DWORD /d 2 /f\n\nRem Allow multiple concurrent RDP sessions (for monitoring)\nReg add \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\" /v MaxInstanceCount /t REG_DWORD /d 10 /f\n\nRem Enable session recording\nReg add \\\"HKLM\\\\Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\Terminal Services\\\" /v RecordingPath /t REG_SZ /d \\\"C:\\\\SessionRecordings\\\" /f\n\nRem Start RDP Service\nNet start TermService\n\necho Remote Desktop session monitoring configured for AU-14.3"
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00.000000Z",
      "has_scripts": true,
      "qa_verified": true,
      "nist_aligned": true
    },
    "cac_metadata": {
      "implementation_type": "real_time_monitoring",
      "last_analyzed": "2025-11-20T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "cac_status": "available",
      "cac_planned": true,
      "implementation_guidance": "AU-14.3 requires real-time session viewing capability for authorized users. Linux implementations can use tmux/screen session sharing, SSH port forwarding, or specialized tools like Teleport. Windows implementations use Remote Assistance, RDP monitoring, or bastion host configurations.",
      "stig_id": "RHEL-08-030360, RHEL-08-030370"
    },
    "ai_guidance": {
      "implementation_strategy": "Implement access controls first - define who can monitor sessions. Then deploy technical infrastructure for real-time viewing. Start with opt-in monitoring (specific sessions) rather than blanket surveillance. Integrate with incident response workflows.",
      "common_challenges": "Privacy is the biggest concern - real-time monitoring is more intrusive than recorded playback. User notification requirements vary by jurisdiction. Performance impact from concurrent monitors. System complexity if deploying across heterogeneous environments. Legal review required before implementation.",
      "validation_approach": "Validate by: (1) Confirming authorized users can access real-time session view, (2) Testing that content is visible in real-time (not delayed), (3) Verifying unauthorized users cannot access monitoring, (4) Checking audit logs show who monitored which sessions, (5) Testing across different session types (SSH, RDP, etc.).",
      "deployment_considerations": "Implement carefully with legal and privacy review. Start with critical/privileged accounts only. Establish clear procedures for when real-time monitoring is justified. Integrate with incident response team. Ensure users are notified as legally required. Maintain detailed audit trail. Consider using dedicated monitoring appliances if security posture warrants high investment."
    }
  }
]