[
  {
    "control_id": "AU-9",
    "control_name": "Protection of Audit Information",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030000",
    "official_text": "Protect audit information and audit tools from unauthorized access, modification, and deletion.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Organizations must implement access controls and protection mechanisms to prevent unauthorized access, modification, or deletion of audit logs. This includes file permissions on audit directories, encryption of audit records, and restrictions on who can manage audit logging functionality. Without proper audit protection, attackers could tamper with logs to cover their tracks.",
    "example_implementation": "Configure file permissions on Linux audit logs to 0640 (chmod 640 /var/log/audit/audit.log), restrict auditd configuration changes to root only, implement log forwarding to remote syslog servers, use SELinux contexts to protect audit binaries, and enable the immutable flag (chattr +i) on critical audit files to prevent tampering. On Windows, restrict Event Log write access via Group Policy, implement log forwarding to SIEM, and archive logs regularly to protected storage.",
    "non_technical_guidance": "Establish clear audit log handling procedures. Designate specific personnel (typically security/audit teams) who can access audit logs. Implement a log retention schedule that balances storage requirements with regulatory requirements. Conduct quarterly reviews of audit log access patterns to detect suspicious activity. Train all system administrators on the importance of audit log integrity and the severe consequences of tampering with audit records. Document the change management process for any modifications to audit logging configuration.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "AU-9.1",
        "title": "Hardware Write-once Media",
        "official_text": "Write audit trails to hardware-enforced, write-once media."
      },
      {
        "id": "AU-9.2",
        "title": "Store on Separate Physical Systems or Components",
        "official_text": "Store audit records on a separate physical system or component than the system being audited."
      },
      {
        "id": "AU-9.3",
        "title": "Cryptographic Protection",
        "official_text": "Implement cryptographic mechanisms to protect the integrity of audit information and audit tools."
      },
      {
        "id": "AU-9.4",
        "title": "Access by Subset of Privileged Users",
        "official_text": "Authorize access to management of audit logging functionality to only designated personnel."
      },
      {
        "id": "AU-9.5",
        "title": "Dual Authorization",
        "official_text": "Enforce dual authorization for deletion or alteration of audit records."
      },
      {
        "id": "AU-9.6",
        "title": "Read-only Access",
        "official_text": "Authorize read-only access to audit information to designated personnel."
      },
      {
        "id": "AU-9.7",
        "title": "Store on Component with Different Operating System",
        "official_text": "Store audit information on a component running a different operating system than the system being audited."
      }
    ],
    "related_controls": [
      "AC-2",
      "AC-3",
      "AU-2",
      "AU-4",
      "AU-5",
      "AU-11",
      "SC-28"
    ],
    "supplemental_guidance": "Audit information includes logs from operating systems, applications, and security tools. Protection mechanisms include access controls, encryption, integrity checking, and redundancy. Organizations should consider the sensitivity of audit information and the potential impact of unauthorized access or modification. Audit logs should be protected with the same level of care as other sensitive organizational data.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Audit Log Protection Implementation",
          "script": "#!/bin/bash\nset -euo pipefail\nyum install -y audit\nsystemctl enable auditd\nsystemctl start auditd\nchmod 640 /var/log/audit/audit.log\nchown root:audit /var/log/audit/audit.log\nchmod 750 /var/log/audit\nchattr +i /var/log/audit/audit.log\nauditctl -l"
        }
      },
      "windows": {
        "server2022": {
          "description": "Windows Server 2022 Audit Log Protection",
          "script": "auditpol /set /category:* /success:enable /failure:enable\nwevtutil sl Security /maxsize:2097152\nwevtutil sl Security /retention:true"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 7,
      "certification": "Government-certified"
    },
    "ai_guidance": "When implementing AU-9 controls, prioritize file permissions and immutability flags on Linux systems. Use SELinux contexts for additional defense. Implement centralized logging to survive local system compromise. Consider the 3-2-1 backup rule: 3 copies, 2 different media, 1 offsite."
  },
  {
    "control_id": "AU-9.1",
    "control_name": "Hardware Write-once Media",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030700",
    "official_text": "Write audit trails to hardware-enforced, write-once media.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This enhancement requires audit logs to be written to media that physically prevents modification after writing (write-once, read-many). Examples include WORM optical discs, tape cartridges with write-protection switches, or specialized hardware devices that enforce immutability. This protects against sophisticated attackers who might bypass software-level protections.",
    "example_implementation": "Configure audit log output to write to WORM optical media (DVD-R) or tape drives with physical write-protection mechanisms. Use specialized hardware audit appliances. On Linux, configure auditd to forward logs to WORM-capable archive system via syslog.",
    "non_technical_guidance": "Establish procedures for managing WORM media inventory with secure storage in climate-controlled environments. Define retention periods complying with regulatory requirements. Establish chain-of-custody procedures for WORM media to maintain audit trail integrity.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-9",
      "SC-28",
      "SI-4"
    ],
    "supplemental_guidance": "WORM media provides the highest level of protection against intentional or inadvertent modification. This enhancement is typically implemented in high-security environments where audit log integrity is paramount.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 WORM Media Configuration",
          "script": "#!/bin/bash\nyum install -y audit cdrecord growisofs\nmkdir -p /var/log/audit-worm\nchmod 700 /var/log/audit-worm\necho 'WORM media configuration completed'"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "WORM media implementation requires careful planning of media rotation, storage, and retrieval. Ensure physical security of WORM media storage to prevent theft or destruction."
  },
  {
    "control_id": "AU-9.2",
    "control_name": "Store on Separate Physical Systems or Components",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030300",
    "official_text": "Store audit records in a repository that is part of a physically different system or system component than the system or component being audited.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "Audit logs must be stored on a different physical system to prevent a compromised system from destroying evidence. If audit logs are stored on the same system being audited, an attacker with root/admin access could delete or modify them. By maintaining logs on a separate system (syslog server, SIEM, dedicated repository), you ensure logs survive system compromise.",
    "example_implementation": "Configure rsyslog or syslog-ng on monitored systems to forward audit logs to centralized syslog server. Configure auditd dispatcher to forward events. On syslog server: configure firewall rules, implement log rotation with archival, restrict file access (chmod 600), verify receipt.",
    "non_technical_guidance": "Establish centralized logging governance model defining: which systems forward logs, acceptable retention periods, access controls, archival procedures. Ensure syslog server has adequate capacity for peak logging rates. Monitor to detect systems that stop sending logs unexpectedly.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-4",
      "AU-9",
      "SC-7"
    ],
    "supplemental_guidance": "The separate system must be on different physical host to protect against local privilege escalation. NAS or cloud-based repositories satisfy this if managed independently from audited systems.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Centralized Audit Log Forwarding",
          "script": "#!/bin/bash\nset -euo pipefail\nREMOTE_SYSLOG_SERVER='syslog-server.example.com'\nyum install -y audit\ncat >> /etc/rsyslog.d/99-audit.conf << EOF\n:programname, isequal, \"audispd\" @@${REMOTE_SYSLOG_SERVER}:514\nEOF\nsystemctl restart auditd rsyslog"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "Plan capacity based on systems * avg events/sec * retention. Use TLS/SSL for log transmission. Implement integrity checking via HMAC or signatures."
  },
  {
    "control_id": "AU-9.3",
    "control_name": "Cryptographic Protection",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030500",
    "official_text": "Implement cryptographic mechanisms to protect the integrity of audit information and audit tools.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "Use cryptographic mechanisms (digital signatures, HMAC, hash-based integrity verification) to ensure audit logs have not been modified. This allows detection of tampering even if attacker gains access. Additionally, protect audit tools using cryptographic verification to ensure they have not been replaced by malicious versions.",
    "example_implementation": "On Linux: Use auditd cryptographic features to digitally sign audit logs. Configure immutable audit rules files with SELinux. Implement AIDE to monitor integrity of audit binaries and configuration. Periodically generate SHA-256 hashes of critical audit files and store hashes separately for verification.",
    "non_technical_guidance": "Establish cryptographic key management policy for audit log signing keys. Designate key custodians, define rotation intervals (annually minimum), establish archival procedures. Create process for verifying audit logs using hashes or cryptographic signatures.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-9",
      "SC-12",
      "SC-13"
    ],
    "supplemental_guidance": "Apply cryptographic protection to both audit data and audit tools. Key management is critical—compromised keys allow forged logs. Consider HSMs for key storage in high-security environments.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Cryptographic Audit Protection",
          "script": "#!/bin/bash\nset -euo pipefail\nyum install -y audit aide openssl\nmkdir -p /var/log/audit-hashes\nchmod 700 /var/log/audit-hashes\nauditctl -w /usr/sbin/auditd -p x -k audit_tool_modifications\nauditctl -w /etc/audit/ -p wa -k audit_config_modifications\nauditctl -l"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "Implement defense-in-depth: use HMAC for real-time verification, signatures for archival, AIDE for tool integrity. Store hashes separately from logs. Document key derivation and rotation schedule."
  },
  {
    "control_id": "AU-9.4",
    "control_name": "Access by Subset of Privileged Users",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030200",
    "official_text": "Authorize access to management of audit logging functionality to only designated personnel.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Only specific users should be able to modify audit logging configuration, stop/start auditd, or manage audit rules. All other users should have read-only or no access. This prevents unauthorized disabling of audit logging, which could hide malicious activities.",
    "example_implementation": "On Linux: Create 'audit' group, add only designated admins. Use 640 permissions on audit config files and SELinux. Use sudo with specific commands (allow 'auditctl -l' not 'auditctl -D'). On Windows: Use Group Policy to restrict audit policy modification to Domain Admins and Audit Administrators.",
    "non_technical_guidance": "Define clear RBAC model identifying personnel needing audit modification access. Document exceptions for emergencies. Implement separation of duties: one approves changes, another implements. Track all requests and maintain change history. Review quarterly who has access to audit management.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AC-2",
      "AC-3",
      "AU-9"
    ],
    "supplemental_guidance": "Use Linux sudo with specific command restrictions rather than full root access. Implement sudo logging to track modification attempts. Use Windows Event Log filtering to monitor audit policy modifications.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Restrict Audit Management Access",
          "script": "#!/bin/bash\nset -euo pipefail\ngroupadd -r audit-admins 2>/dev/null || true\nchown root:audit-admins /etc/audit/auditd.conf\nchmod 640 /etc/audit/auditd.conf\nauditctl -w /etc/audit/auditd.conf -p wa -k audit_config_changes\nauditctl -l"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "Use principle of least privilege: grant only specific audit commands needed. Implement sudo logging. Consider RBAC through LDAP/Active Directory. Regularly audit who has access (quarterly minimum)."
  },
  {
    "control_id": "AU-9.5",
    "control_name": "Dual Authorization",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030600",
    "official_text": "Enforce dual authorization for deletion or alteration of audit records.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Require two independent individuals to approve and execute any deletion or modification of audit records. This separation of duties prevents a single compromised administrator from covering up tracks by deleting logs. Even if one admin's credentials are compromised, attacker cannot delete logs without compromising second admin.",
    "example_implementation": "Implement change management process: (1) Admin A submits delete request with business justification, (2) Admin B reviews/approves/denies, (3) Both execute deletion together, (4) Deletion itself is logged. Use multi-signature in log management tools or custom audit log application enforcing workflow.",
    "non_technical_guidance": "Establish formal change control board (CCB) to oversee audit record modifications. Define criteria for acceptable deletion (test data, duplicates). Require written justification and business approval. Maintain permanent record of what deleted, when, by whom, why. Review quarterly for misuse patterns.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AC-5",
      "AU-9"
    ],
    "supplemental_guidance": "Implement at application level if possible. For high-security, use four-eyes principle where auditor/compliance officer is independent reviewer.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Dual Authorization for Audit Modification",
          "script": "#!/bin/bash\nset -euo pipefail\ngroupadd -r audit-mod-admins 2>/dev/null || true\ntouch /var/log/audit-deletion-request.log\nchmod 640 /var/log/audit-deletion-request.log\nauditctl -w /var/log/audit-deletion-request.log -p wa -k audit_deletion_requests\nauditctl -l"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "Implement formal workflow in log management system or ticketing tool. Require electronic approval trails. Consider hold period before execution (24-48 hours). For sensitive environments, add third-party reviewer."
  },
  {
    "control_id": "AU-9.6",
    "control_name": "Read-only Access",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030000",
    "official_text": "Authorize read-only access to audit information to designated personnel.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Grant specific users (security analysts, auditors, compliance officers) read-only access without write/delete permissions. This allows review for investigation and compliance while preventing modification. Enforce at both file system and application level.",
    "example_implementation": "On Linux: Create 'audit-readers' group, add authorized users, set 640 permissions with group read. Use SELinux for read-only audit binaries/config. On Windows: Use NTFS permissions and RBAC for Event Log and security subscriptions.",
    "non_technical_guidance": "Maintain current list of personnel needing audit log access. Review quarterly and revoke immediately for role changes. Document business need for each person. Monitor and alert on write/delete attempts. Review access logs quarterly.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AC-2",
      "AC-3",
      "AU-9"
    ],
    "supplemental_guidance": "Implement via file permissions, RBAC in log systems, SELinux, or dedicated accounts. Ensure read access monitoring is audited.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Configure Read-only Audit Access",
          "script": "#!/bin/bash\nset -euo pipefail\ngroupadd -r audit-readers 2>/dev/null || true\nchmod 750 /var/log/audit\nchgrp audit-readers /var/log/audit\nchmod 640 /var/log/audit/audit.log\nchgrp audit-readers /var/log/audit/audit.log\nauditctl -w /var/log/audit/ -p r -k audit_read_access"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "Combine file-level and app-level controls. Monitor all read attempts. Use view-based access where analysts see only investigation-relevant logs. Rotate credentials quarterly."
  },
  {
    "control_id": "AU-9.7",
    "control_name": "Store on Component with Different Operating System",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030400",
    "official_text": "Store audit information on a component running a different operating system than the system or component being audited.",
    "parent_control": "AU-9",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Store audit logs on different OS (Linux audited→Windows storage, Windows audited→Linux storage). Protects against OS-level attacks that might compromise both audited system and same-OS log storage. Linux attacker cannot use Linux attacks to modify logs on Windows.",
    "example_implementation": "Configure Linux auditd to forward to Windows-based syslog server or SIEM (Splunk/ArcSight on Windows). Configure Windows Event Log forwarding to Linux aggregator (Elasticsearch/Kibana, Graylog on Linux). Use different OS vendors where possible.",
    "non_technical_guidance": "Provides defense-in-depth against OS-specific vulnerabilities. Document OS combinations, maintain both OS platform support, train admins on cross-OS log management. Verify log format translation preserves critical fields. Test forwarding regularly.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "AU-9",
      "SC-7",
      "SI-4"
    ],
    "supplemental_guidance": "Vulnerabilities are typically OS-specific. Windows attacks may not work on Linux and vice versa. Different OSes for storage ensures audited system compromise does not compromise audit trail.",
    "implementation_scripts": {
      "linux": {
        "rhel": {
          "description": "RHEL 8 Forward Logs to Windows Syslog",
          "script": "#!/bin/bash\nset -euo pipefail\nWINDOWS_SYSLOG_SERVER='windows-syslog.example.com'\nyum install -y audit syslog-ng\ncat >> /etc/rsyslog.d/windows-forward.conf << EOF\ndestination d_windows { udp(\"${WINDOWS_SYSLOG_SERVER}\" port(514)); };\nlog { source(s_sys); destination(d_windows); };\nEOF\nsystemctl restart syslog-ng"
        }
      }
    },
    "metadata": {
      "status": "implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "qa_verified": true,
      "qa_verification_date": "2025-11-20"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "platform": "rhel8,rhcos4,windows-server-2022",
      "rule_count": 1,
      "certification": "Government-certified"
    },
    "ai_guidance": "Plan infrastructure using different OS platforms for storage. Verify format translation preserves critical fields. Test cross-OS forwarding regularly. Use containers/VMs for diverse infrastructure. Consider cloud (AWS CloudWatch, Azure Monitor)."
  }
]