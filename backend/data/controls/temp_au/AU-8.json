[
  {
    "control_id": "AU-8",
    "control_name": "Time Stamps",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030740",
    "official_text": "The organization: a) Uses internal system clocks to generate time stamps for audit records; and b) Records time stamps for audit records that meet [Assignment: organization-defined granularity of time measurement] and that use Coordinated Universal Time (UTC), have a fixed local time offset from UTC, or that include the local time offset as part of the time stamp.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Systems must generate and record accurate timestamps for all audit events. These timestamps must be precise enough to correlate events (granularity) and use a consistent time standard. This is essential for security investigations, forensic analysis, and maintaining system accountability. Without accurate timestamps, it becomes impossible to determine when events occurred or establish a reliable audit trail.",
    "example_implementation": "Configure all systems to use chrony (RHEL/CentOS) or timesyncd (Ubuntu/Debian) for automatic time synchronization. Set the granularity to milliseconds or finer for security-critical systems. Ensure all audit logs include timestamps in ISO 8601 format with timezone information.",
    "non_technical_guidance": "Implement organizational procedures to: 1) Select authoritative time sources approved by your organization (such as NIST time servers or GPS); 2) Configure all systems to synchronize with these sources; 3) Define the required time precision (granularity) for your organization; 4) Regularly verify that system clocks remain synchronized (at least daily); 5) Document the time standard used organization-wide (UTC or local with offset); 6) Monitor and alert on time synchronization failures.",
    "is_technical": true,
    "ai_guidance": "To implement AU-8 effectively: First, inventory all systems requiring synchronized time (servers, workstations, network devices). Choose primary time sources - NIST operates authenticated NTP service for U.S. Government (https://www.usno.navy.mil/). For air-gapped networks, establish internal NTP servers synchronized to external authoritative sources. Configure chronyd with maxpoll 16 or less to ensure syncs within 24 hours per STIG RHEL-08-030740. Test time synchronization with 'timedatectl status' on Linux and 'w32tm /query /status' on Windows. Establish monitoring alerts for sync failures and time skew exceeding thresholds (typically 1 second). Document your time standard choice and communicate to all system administrators.",
    "enhancements": [
      {
        "id": "AU-8.1",
        "title": "Synchronization with Authoritative Time Source",
        "official_text": "The information system compares the internal information system clocks at [Assignment: organization-defined frequency] with [Assignment: organization-defined authoritative time source] and synchronizes the internal system clock to the authoritative time source when the time difference is greater than [Assignment: organization-defined time period]."
      },
      {
        "id": "AU-8.2",
        "title": "Secondary Authoritative Time Source",
        "official_text": "The information system identifies a secondary authoritative time source that is in a geographically separated location and implements a mechanism to automatically synchronize the internal system clocks from the secondary authoritative time source if the primary authoritative time source is unavailable."
      }
    ],
    "related_controls": [
      "AU-3",
      "AU-12",
      "SC-45"
    ],
    "supplemental_guidance": "Time synchronization is critical to system security as it underpins identification, authentication, non-repudiation, and access control functions. Granularity of time measurements refers to the degree of synchronization between system clocks and reference clocks - systems may require synchronization within hundreds of milliseconds or tens of milliseconds depending on organizational requirements. Organizations should consider different granularities for different components based on the criticality of functions dependent on accurate time.",
    "implementation_scripts": {
      "linux": {
        "bash_rhel_chrony_au8": "#!/bin/bash\n# RHEL 8 AU-8 Compliance: Install and Configure Chrony\nset -e\n\n# Install chrony if not present\nif ! command -v chronyd &> /dev/null; then\n    yum install -y chrony\nfi\n\n# Backup original configuration\ncp /etc/chrony.conf /etc/chrony.conf.backup.$(date +%s)\n\n# Configure chrony with authorized NTP servers (NIST/USNO example)\ncat > /etc/chrony.conf << 'EOF'\n# NIST Time Servers (replace with your organization's approved servers)\nserver time.nist.gov iburst maxpoll 16\nserver time-a-g.nist.gov iburst maxpoll 16\nserver time-b-g.nist.gov iburst maxpoll 16\n\n# Allow local network time sync\nallow 127.0.0.1\n\n# Synchronization statistics\nlogdir /var/log/chrony\ndriftfile /var/lib/chrony/drift\n\n# Specify chronyd to operate in client-only mode\nstratumweight 0\n\n# Disable chrony's management interface on the network\nbindcmdaddress 127.0.0.1\nbindcmdaddress ::1\nEOF\n\n# Start and enable chrony service\nsystemctl enable chronyd\nsystemctl start chronyd\n\n# Verify synchronization (may take up to maxpoll interval)\necho \"Waiting for time synchronization...\"\nsleep 5\ntimedatectl status\n\n# Verify chrony sources\nchronyc sources -v\n\n# Log compliance check\necho \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] AU-8 Configuration Applied - Chrony configured with authorized servers and maxpoll 16\"",
        "ansible_rhel_chrony_au8": "---\n- name: AU-8 Compliance - Time Synchronization with Chrony\n  hosts: all\n  become: yes\n  tasks:\n    - name: Install chrony package\n      yum:\n        name: chrony\n        state: present\n\n    - name: Backup original chrony.conf\n      copy:\n        src: /etc/chrony.conf\n        dest: /etc/chrony.conf.backup\n        backup: yes\n      ignore_errors: true\n\n    - name: Configure chrony with authorized NTP servers\n      copy:\n        content: |\n          # NIST Time Servers (organization-approved)\n          server time.nist.gov iburst maxpoll 16\n          server time-a-g.nist.gov iburst maxpoll 16\n          server time-b-g.nist.gov iburst maxpoll 16\n          allow 127.0.0.1\n          logdir /var/log/chrony\n          driftfile /var/lib/chrony/drift\n          stratumweight 0\n          bindcmdaddress 127.0.0.1\n          bindcmdaddress ::1\n        dest: /etc/chrony.conf\n        owner: root\n        group: root\n        mode: '0644'\n\n    - name: Enable and start chronyd service\n      systemd:\n        name: chronyd\n        enabled: yes\n        state: started\n        daemon_reload: yes\n\n    - name: Verify time synchronization status\n      command: timedatectl status\n      register: timedatectl_output\n      changed_when: false\n\n    - name: Display synchronization status\n      debug:\n        msg: \"{{ timedatectl_output.stdout }}\"\n\n    - name: Verify chrony sources\n      command: chronyc sources -v\n      register: chronyc_output\n      changed_when: false\n\n    - name: Display chrony sources\n      debug:\n        msg: \"{{ chronyc_output.stdout }}\""
      },
      "windows": {
        "powershell_w32tm_au8": "# PowerShell AU-8 Compliance: Configure Windows Time Service (W32Time)\n# Requires Administrator privileges\n\n# Get current W32Time configuration\nWrite-Host \"Current W32Time Configuration:\"\nw32tm /query /configuration\n\n# Configure Windows Time Service with authorized NTP servers\n# NIST Time Servers: time.nist.gov, time-a-g.nist.gov, time-b-g.nist.gov\n$NTPServers = \"time.nist.gov,0x9 time-a-g.nist.gov,0x9 time-b-g.nist.gov,0x9\"\n\nWrite-Host \"Configuring W32Time with authorized NTP servers...\"\nw32tm /config /manualpeerlist:$NTPServers /syncfromflags:manual /reliable:yes /update\n\n# Set synchronization interval to ensure sync within 24 hours\n# MaxPollInterval = 16 (2^16 seconds ~= 18 hours)\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v MaxPollInterval /t REG_DWORD /d 16 /f\n\n# Set minimum poll interval\n# MinPollInterval = 6 (2^6 seconds = 64 seconds)\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v MinPollInterval /t REG_DWORD /d 6 /f\n\n# Restart W32Time service\nWrite-Host \"Restarting W32Time service...\"\nStop-Service -Name W32Time -Force\nStart-Service -Name W32Time\n\n# Wait for synchronization\nStart-Sleep -Seconds 5\n\n# Verify synchronization status\nWrite-Host \"Verification - Current Time Status:\"\nw32tm /query /status\n\n# Check time synchronization with peers\nWrite-Host \"Configured NTP Peers:\"\nw32tm /query /peers\n\n# Create audit log entry\n$AuditMessage = \"[$(Get-Date -Format 'u')] AU-8 Compliance Applied - W32Time synchronized with authorized NIST servers\"\nWrite-EventLog -LogName \"Application\" -Source \"System\" -EventId 1000 -Message $AuditMessage -EntryType Information\n\nWrite-Host \"AU-8 Compliance Configuration Complete\"",
        "ansible_windows_w32tm_au8": "---\n- name: AU-8 Compliance - Windows Time Service Configuration\n  hosts: windows\n  become: yes\n  tasks:\n    - name: Get current W32Time configuration\n      ansible.windows.win_shell: w32tm /query /configuration\n      register: w32tm_current_config\n      changed_when: false\n\n    - name: Display current W32Time configuration\n      debug:\n        msg: \"{{ w32tm_current_config.stdout_lines }}\"\n\n    - name: Configure W32Time with authorized NTP servers (NIST)\n      ansible.windows.win_shell: w32tm /config /manualpeerlist:\"time.nist.gov,0x9 time-a-g.nist.gov,0x9 time-b-g.nist.gov,0x9\" /syncfromflags:manual /reliable:yes /update\n      register: w32tm_config_result\n      changed_when: \"'The command completed successfully' in w32tm_config_result.stdout\"\n\n    - name: Set MaxPollInterval registry (RHEL-08-030740 equivalent for Windows)\n      ansible.windows.win_reg_edit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\n        name: MaxPollInterval\n        data: 16\n        type: dword\n\n    - name: Set MinPollInterval registry\n      ansible.windows.win_reg_edit:\n        path: HKLM:\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\n        name: MinPollInterval\n        data: 6\n        type: dword\n\n    - name: Restart W32Time service\n      ansible.windows.win_service:\n        name: W32Time\n        state: restarted\n\n    - name: Wait for synchronization\n      ansible.windows.win_shell: Start-Sleep -Seconds 5\n\n    - name: Verify time synchronization status\n      ansible.windows.win_shell: w32tm /query /status\n      register: w32tm_status\n      changed_when: false\n\n    - name: Display W32Time status\n      debug:\n        msg: \"{{ w32tm_status.stdout_lines }}\"\n\n    - name: Display configured NTP peers\n      ansible.windows.win_shell: w32tm /query /peers\n      register: w32tm_peers\n      changed_when: false\n\n    - name: Show NTP peers\n      debug:\n        msg: \"{{ w32tm_peers.stdout_lines }}\""
      }
    },
    "metadata": {
      "status": "fully_implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "validation_status": "NIST SP 800-53 Rev 5 verified"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode",
      "cac_status": "verified",
      "cac_planned": true,
      "implementation_guidance": "ComplianceAsCode provides multiple rules: service_chronyd_or_ntpd_enabled, chronyd_client_only, chronyd_no_chronyc_network, chronyd_or_ntpd_set_maxpoll. These rules directly support AU-8 compliance on RHEL/CentOS systems.",
      "related_cac_rules": [
        "service_chronyd_or_ntpd_enabled",
        "chronyd_client_only",
        "chronyd_no_chronyc_network",
        "chronyd_or_ntpd_set_maxpoll"
      ]
    }
  },
  {
    "control_id": "AU-8.1",
    "control_name": "Synchronization with Authoritative Time Source",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030740",
    "parent_control": "AU-8",
    "official_text": "The information system compares the internal information system clocks at [Assignment: organization-defined frequency] with [Assignment: organization-defined authoritative time source] and synchronizes the internal system clock to the authoritative time source when the time difference is greater than [Assignment: organization-defined time period].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Systems must actively synchronize their clocks with an authorized time source at regular intervals. This enhancement requires not just generating timestamps, but ensuring those timestamps are accurate by comparing against a trusted external time source. When time drift is detected (the system time is significantly different from the authoritative source), the system must automatically correct itself. This is critical for organizations that depend on precise event correlation across multiple systems.",
    "example_implementation": "Deploy chrony with maxpoll set to 16 (meaning synchronization occurs at least every 18 hours). Configure chronyd to sync with NIST time servers. Set the synchronization threshold to 1 second - if clock drift exceeds this, automatic correction occurs. Configure monitoring to alert when sync has not occurred within 24 hours.",
    "non_technical_guidance": "Establish organizational policy specifying: 1) The frequency of time synchronization (e.g., hourly, every 4 hours); 2) The authorized time sources (e.g., NIST servers); 3) The maximum acceptable time difference (time period) before automatic correction (e.g., 1 second); 4) The maximum acceptable time drift threshold (e.g., systems lose no more than X seconds per day); 5) Escalation procedures when synchronization fails. Document these requirements in your system security plan.",
    "is_technical": true,
    "ai_guidance": "Implementation approach: 1) Define organizational parameters - choose synchronization frequency (NIST recommends daily minimum, STIG RHEL-08-030740 requires within 24 hours with maxpoll 16), authorized sources (USNO for government: time.nist.gov, time-a-g.nist.gov), and time threshold (typically 1-5 seconds). 2) Configure chronyd with explicit 'iburst' flag for faster initial sync and maxpoll 16 for 18-hour sync intervals. 3) Implement monitoring - check 'chronyc tracking' to verify sync status; alert if NTP stratum > 16 (no sync). 4) Test failover - disable primary NTP server and verify secondary takes over within expected interval. 5) Document measured time skew - monitor and track actual clock drift between syncs to validate your threshold assumptions.",
    "enhancements": [],
    "related_controls": [
      "AU-8",
      "SC-45(1)"
    ],
    "supplemental_guidance": "RHEL-08-030740 STIG requirement: chrony must be configured with maxpoll value of 16 or less (corresponding to 2^16 seconds, approximately 18.2 hours) to ensure clocks synchronize within the required 24-hour window. The iburst option enables faster initial synchronization. Using DoD-approved time sources (NIST/USNO) ensures time source integrity. Organizations should consider network-isolated systems that may not have regular access to authoritative sources - such systems should employ secondary mechanisms like GPS receivers or internal time servers.",
    "implementation_scripts": {
      "linux": {
        "bash_rhel_au81": "#!/bin/bash\n# RHEL 8 AU-8.1 Compliance: Synchronization with Authoritative Time Source\nset -e\n\necho \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] Starting AU-8.1 Synchronization Configuration\"\n\n# Define organizational parameters\nSYNC_FREQUENCY=\"hourly\"\nAUTHORITATIVE_SOURCE=\"time.nist.gov\"\nTIME_THRESHOLD=\"1\"\nMAXPOLL=\"16\"\n\n# Verify chronyd is installed and running\nif ! systemctl is-active --quiet chronyd; then\n    echo \"Installing and starting chronyd...\"\n    yum install -y chrony\n    systemctl start chronyd\nfi\n\n# Configure chrony with strict synchronization settings\ncat > /etc/chrony.conf << EOF\n# AU-8.1 Compliance Configuration\nserver $AUTHORITATIVE_SOURCE iburst maxpoll $MAXPOLL\nserver time-a-g.nist.gov iburst maxpoll $MAXPOLL\nserver time-b-g.nist.gov iburst maxpoll $MAXPOLL\nallow 127.0.0.1\nlogdir /var/log/chrony\nlog measurements statistics tracking\ndriftfile /var/lib/chrony/drift\nstratumweight 0\nbindcmdaddress 127.0.0.1\nbindcmdaddress ::1\nEOF\n\n# Reload chrony configuration\nsystemctl reload chronyd\n\necho \"Waiting for initial synchronization...\"\nfor i in {1..30}; do\n    SYNC_STATUS=$(chronyc tracking | grep \"System time\" || echo \"\")\n    if [[ $SYNC_STATUS == *\"0.000000000\"* ]] || [ $i -eq 30 ]; then\n        break\n    fi\n    sleep 1\ndone\n\necho \"=== Synchronization Status ===\"\ntimedatectl status\necho \"=== Chrony Tracking Information ===\"\nchronyc tracking\necho \"=== Chrony Sources ===\"\nchronyc sources -v\n\n# Validate STIG RHEL-08-030740 compliance\nMAXPOLL_VALUE=$(grep \"maxpoll\" /etc/chrony.conf | head -1 | awk '{print $NF}')\nif [ \"$MAXPOLL_VALUE\" -le 16 ]; then\n    echo \"[PASS] RHEL-08-030740: maxpoll is set to $MAXPOLL_VALUE (compliant)\"\nelse\n    echo \"[FAIL] RHEL-08-030740: maxpoll is $MAXPOLL_VALUE (must be <= 16)\"\nfi\n\necho \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] AU-8.1 Configuration Complete\""
      },
      "windows": {
        "powershell_w32tm_au81": "# PowerShell AU-8.1 Compliance: Synchronization with Authoritative Time Source\n\n$authoritative_sources = @(\"time.nist.gov\", \"time-a-g.nist.gov\", \"time-b-g.nist.gov\")\n$ntp_peers = $authoritative_sources -join \",0x9 \"\n$ntp_peers += \",0x9\"\n\nWrite-Host \"[$(Get-Date -u -Format 'o')] Configuring W32Time with authoritative sources\"\nw32tm /config /manualpeerlist:$ntp_peers /syncfromflags:manual /reliable:yes /update\n\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v MaxPollInterval /t REG_DWORD /d 16 /f\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v MinPollInterval /t REG_DWORD /d 6 /f\n\nStop-Service -Name W32Time -Force\nStart-Service -Name W32Time\n\nStart-Sleep -Seconds 10\n\nWrite-Host \"=== Time Synchronization Status ===\"\nw32tm /query /status\n\nWrite-Host \"=== Current NTP Configuration ===\"\nw32tm /query /configuration\n\nWrite-Host \"=== Configured NTP Peers ===\"\nw32tm /query /peers\n\n$au81_message = \"[$(Get-Date -u -Format 'o')] AU-8.1 Configuration Applied\"\nWrite-EventLog -LogName \"Application\" -Source \"System\" -EventId 1001 -Message $au81_message -EntryType Information"
      }
    },
    "metadata": {
      "status": "fully_implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "validation_status": "NIST SP 800-53 Rev 5 + RHEL STIG verified"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode + NIST STIG",
      "cac_status": "verified",
      "cac_planned": true,
      "implementation_guidance": "ComplianceAsCode rule 'chronyd_or_ntpd_set_maxpoll' directly enforces AU-8.1 by ensuring maxpoll <= 16 per RHEL-08-030740 STIG requirement.",
      "stig_mapping": {
        "rule_id": "RHEL-08-030740",
        "severity": "Medium",
        "requirement": "RHEL 8 must securely compare internal clocks within 24 hours with authoritative time source"
      }
    }
  },
  {
    "control_id": "AU-8.2",
    "control_name": "Secondary Authoritative Time Source",
    "family": "Audit and Accountability",
    "family_id": "au",
    "stig_id": "RHEL-08-030740",
    "parent_control": "AU-8",
    "official_text": "The information system identifies a secondary authoritative time source that is in a geographically separated location and implements a mechanism to automatically synchronize the internal system clocks from the secondary authoritative time source if the primary authoritative time source is unavailable.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "High-security systems cannot tolerate loss of time synchronization. This enhancement requires redundancy - if the primary time source becomes unavailable (due to network issues, server failure, or attack), systems must automatically fail over to a secondary time source. The secondary source must be geographically separated from the primary to ensure resilience against regional outages. This ensures continuous, accurate timekeeping even during failures.",
    "example_implementation": "Configure chrony with at least two NIST time servers from different geographic locations. For example: primary server in East (time.nist.gov), secondary server in West (time-a-g.nist.gov). Configure chrony to treat both as peers and automatically use available servers. Monitor synchronization sources and alert if only one source remains available.",
    "non_technical_guidance": "Develop and document organizational policy for AU-8.2 that includes: 1) Identification of two or more geographically separated authoritative time sources; 2) Definition of 'geographically separated' (e.g., different data centers, different states); 3) Procedures to verify secondary source availability; 4) Detection thresholds for when primary is unavailable; 5) Procedures to verify failover occurs automatically; 6) Frequency of failover testing (recommend quarterly); 7) Escalation procedures if both sources become unavailable.",
    "is_technical": true,
    "ai_guidance": "Implement AU-8.2 with these technical considerations: 1) Source Selection - NIST operates geographically distributed time servers: time.nist.gov (primary), time-a-g.nist.gov (East), time-b-g.nist.gov (West). Select primary and secondary from different regions. 2) Chrony Configuration - Configure multiple server directives without prefer option, allowing chrony to dynamically select best available source. 3) Monitoring - Check 'chronyc sources' for available sources; alert if sources < 2. 4) Testing - Simulate primary failure by blocking NTP port 123 to primary server and verify secondary is used within synchronization interval. 5) For air-gapped networks - establish internal primary NTP server synchronized to external secondary, or deploy GPS receiver as secondary.",
    "enhancements": [],
    "related_controls": [
      "AU-8",
      "AU-8.1",
      "SC-45(2)"
    ],
    "supplemental_guidance": "RHEL STIG RHEL-08-030740 baseline requires synchronization with at least one authoritative time source. AU-8.2 enhances this by adding redundancy. Geographically separated means physically distant locations (different data centers, regions, or continents) to protect against regional network outages. Organizations should periodically test failover mechanisms to ensure secondary sources are accessible and functional.",
    "implementation_scripts": {
      "linux": {
        "bash_rhel_au82": "#!/bin/bash\n# RHEL 8 AU-8.2 Compliance: Secondary Authoritative Time Source\nset -e\n\necho \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] Starting AU-8.2 Secondary Time Source Configuration\"\n\nPRIMARY_SOURCE=\"time.nist.gov\"\nSECONDARY_SOURCE=\"time-a-g.nist.gov\"\nTERTIARY_SOURCE=\"time-b-g.nist.gov\"\nMAXPOLL=\"16\"\n\nif ! systemctl is-active --quiet chronyd; then\n    yum install -y chrony\n    systemctl start chronyd\nfi\n\necho \"Configuring chrony with geographically separated time sources...\"\n\ncat > /etc/chrony.conf << EOF\n# AU-8.2 Compliance Configuration\nserver $PRIMARY_SOURCE iburst maxpoll $MAXPOLL\nserver $SECONDARY_SOURCE iburst maxpoll $MAXPOLL\nserver $TERTIARY_SOURCE iburst maxpoll $MAXPOLL\nstratumweight 0\ndriftfile /var/lib/chrony/drift\nlogdir /var/log/chrony\nlog measurements statistics tracking\nallow 127.0.0.1\nbindcmdaddress 127.0.0.1\nbindcmdaddress ::1\nleapsectz right/UTC\nEOF\n\nsystemctl reload chronyd\n\necho \"Waiting for synchronization with multiple sources...\"\nsleep 15\n\necho \"=== Chrony Source Status ===\"\nchronyc sources -v\n\nAVAILABLE_SOURCES=$(chronyc sources -v | grep -c \"^\\*\\|^+\\|^-\\|^?\" || true)\necho \"Available time sources: $AVAILABLE_SOURCES\"\n\nif [ \"$AVAILABLE_SOURCES\" -lt 2 ]; then\n    echo \"[WARNING] AU-8.2 requires minimum 2 geographically separated sources\"\nelse\n    echo \"[PASS] Multiple geographically separated time sources are available\"\nfi\n\necho \"=== Time Synchronization Status ===\"\ntimedatectl status\n\necho \"[$(date -u +%Y-%m-%dT%H:%M:%SZ)] AU-8.2 Configuration Complete\""
      },
      "windows": {
        "powershell_w32tm_au82": "# PowerShell AU-8.2 Compliance: Secondary Authoritative Time Source\n\n$primary_source = \"time.nist.gov\"\n$secondary_source = \"time-a-g.nist.gov\"\n$tertiary_source = \"time-b-g.nist.gov\"\n\nWrite-Host \"[$(Get-Date -u -Format 'o')] Configuring W32Time with geographically separated sources\"\n\n$ntp_peers = \"$primary_source,0x9 $secondary_source,0x9 $tertiary_source,0x9\"\nw32tm /config /manualpeerlist:\"$ntp_peers\" /syncfromflags:manual /reliable:yes /update\n\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v MaxPollInterval /t REG_DWORD /d 16 /f\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v MinPollInterval /t REG_DWORD /d 6 /f\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\" /v EventLogFlags /t REG_DWORD /d 2 /f\n\nStop-Service -Name W32Time -Force\nStart-Service -Name W32Time\n\nStart-Sleep -Seconds 15\n\nWrite-Host \"=== W32Time Status ===\"\nw32tm /query /status\n\nWrite-Host \"=== Configured NTP Peers (AU-8.2 Sources) ===\"\nw32tm /query /peers\n\n$reachable_peers = (w32tm /query /peers | Select-String \"Peer:\" | Measure-Object).Count\nWrite-Host \"Reachable NTP peers: $reachable_peers\"\n\nif ($reachable_peers -ge 2) {\n    Write-Host \"[PASS] AU-8.2 Compliant - $reachable_peers geographically separated time sources\"\n} else {\n    Write-Host \"[WARNING] AU-8.2 requires minimum 2 sources, found $reachable_peers\"\n}\n\n$au82_message = \"[$(Get-Date -u -Format 'o')] AU-8.2 Configuration Applied - Secondary sources configured\"\nWrite-EventLog -LogName \"Application\" -Source \"System\" -EventId 1002 -Message $au82_message -EntryType Information"
      }
    },
    "metadata": {
      "status": "fully_implemented",
      "last_updated": "2025-11-20T00:00:00Z",
      "has_scripts": true,
      "validation_status": "NIST SP 800-53 Rev 5 verified"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-20T00:00:00Z",
      "source": "ComplianceAsCode + NIST STIG",
      "cac_status": "verified",
      "cac_planned": true,
      "implementation_guidance": "Deploy multiple NTP servers from ComplianceAsCode rules with geographically separated locations. Configure failover via chrony peer selection or W32Time manualpeerlist.",
      "stig_mapping": {
        "rule_id": "RHEL-08-030740",
        "severity": "Medium",
        "enhancement": "Secondary source failover ensures continuous time sync"
      }
    }
  }
]