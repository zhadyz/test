[
  {
    "control_id": "IR-1",
    "control_name": "Policy and Procedures",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "a. Develop, document, and disseminate to [organization-defined personnel or roles]: 1. [Selection (one or more): Organization-level; Mission/business process-level; System-level] incident response policy that: (a) Addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (b) Is consistent with applicable laws, executive orders, directives, regulations, policies, standards, and guidelines; and 2. Procedures to facilitate the implementation of the incident response policy and the associated incident response controls; b. Designate an [organization-defined official] to manage the development, documentation, and dissemination of the incident response policy and procedures; and c. Review and update the current incident response: 1. Policy [organization-defined frequency] and following [organization-defined events]; and 2. Procedures [organization-defined frequency] and following [organization-defined events].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "stig_id": "not_applicable",
    "intent": "Have a written game plan for when things go wrong. Everyone should know what to do, who to call, and how to handle a security incident before it happens.",
    "plain_english_explanation": "Your organization must create, maintain, and share written policies and procedures that explain how to handle cybersecurity incidents. These documents should clearly define who is responsible for what during an incident, how different teams should coordinate, and what steps to follow when something goes wrong. Assign someone to be in charge of keeping these documents up to date, and review them regularly or whenever significant changes occur. This foundational document ensures everyone knows what to do when a security incident happens, reducing confusion and response time during actual events.",
    "ai_guidance": "Implementing IR-1 requires establishing a comprehensive incident response governance framework. Start by drafting an incident response policy that addresses: (1) the purpose and scope of incident response activities, (2) clear role definitions for the incident response team including CISO, SOC analysts, IT operations, legal counsel, and communications personnel, (3) management commitment demonstrated through resource allocation and executive sponsorship, (4) coordination mechanisms between security, IT, legal, HR, and business units, and (5) compliance requirements with applicable regulations such as FISMA, HIPAA breach notification, PCI-DSS incident handling, or state data breach laws. The procedures should provide step-by-step guidance for incident detection, initial triage, escalation paths, containment strategies, evidence preservation, eradication, recovery, and post-incident activities. Consider implementing a tiered incident classification system (e.g., Severity 1-4) with corresponding response timeframes and escalation requirements. Integrate the policy with your organization's risk management framework and ensure alignment with business continuity and disaster recovery plans. Review triggers should include major organizational changes, new threat landscapes, lessons learned from incidents, regulatory updates, and annual policy review cycles.",
    "implementation_rationale": "Without documented policies, your team will waste precious time figuring out what to do during an actual incident. Written procedures mean faster response, fewer mistakes, and consistent handling every time. Think of it like a fire drill - you practice so the real thing goes smoothly.",
    "example_implementation": "Create an Incident Response Policy document that includes: executive summary, policy statement, scope and applicability, roles and responsibilities matrix, incident classification scheme, reporting requirements, coordination procedures with external entities (law enforcement, CISA, sector ISACs), policy review schedule, and approval signatures. Develop companion procedure documents for common incident types including malware infections, data breaches, denial of service attacks, insider threats, and ransomware incidents.",
    "non_technical_guidance": "1. Draft an Incident Response Policy document covering purpose, scope, roles, responsibilities, and compliance requirements.\n2. Develop detailed incident response procedures for each phase: preparation, detection, analysis, containment, eradication, recovery, and post-incident activities.\n3. Assign an official (typically CISO or Security Director) to own and manage the policy lifecycle.\n4. Establish a policy review schedule (recommend annual minimum) and define triggering events for ad-hoc reviews.\n5. Create a distribution plan ensuring all relevant personnel receive and acknowledge the policy.\n6. Coordinate with legal, HR, communications, and business units during policy development.\n7. Align policies with applicable regulatory requirements and industry frameworks.\n8. Document the approval chain and maintain version control for all policy documents.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PM-9",
      "PS-8",
      "SI-12",
      "IR-2",
      "IR-3",
      "IR-4",
      "IR-5",
      "IR-6",
      "IR-7",
      "IR-8",
      "AT-2",
      "AT-3",
      "CP-1",
      "CP-2",
      "PL-1"
    ],
    "supplemental_guidance": "Incident response policy and procedures should be coordinated among organizational entities with responsibility for incident response including security operations, IT operations, legal counsel, human resources, public affairs, and executive management. The policy addresses the purpose, scope, roles, responsibilities, and compliance requirements associated with the incident response program. Simply restating control requirements does not constitute an organizational policy. Policy and procedures are developed in coordination with privacy programs when incidents may involve personally identifiable information (PII).",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-1 is an organizational/procedural control with no direct technical implementation in DISA STIGs. Compliance is demonstrated through policy documentation rather than system configuration."
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires organizational policy documentation and procedures. No technical automation available - compliance is achieved through documented policies, assigned responsibilities, and scheduled reviews."
    }
  },
  {
    "control_id": "IR-2",
    "control_name": "Incident Response Training",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "a. Provide incident response training to system users consistent with assigned roles and responsibilities: 1. Within [organization-defined time period] of assuming an incident response role or responsibility or acquiring system access; 2. When required by system changes; and 3. [organization-defined frequency] thereafter; and b. Review and update incident response training content [organization-defined frequency] and following [organization-defined events].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "stig_id": "not_applicable",
    "intent": "Train your people to recognize and respond to security incidents. An untrained team can make a bad situation much worse.",
    "plain_english_explanation": "Everyone in your organization who has a role in responding to security incidents needs proper training. This includes regular employees who need to know how to recognize and report suspicious activity, IT staff who need to know how to contain and investigate incidents, and incident responders who need specialized skills like forensics and malware analysis. Training should happen when someone first takes on an incident response role, whenever systems change significantly, and on a regular ongoing basis. Keep the training materials current by reviewing and updating them regularly.",
    "ai_guidance": "Effective incident response training requires a role-based approach that addresses different knowledge and skill requirements. For general users, training should cover: recognizing phishing attempts and social engineering, reporting suspicious activities through proper channels, understanding acceptable use policies, and basic security hygiene. For IT operations staff, training should include: initial incident triage and escalation procedures, evidence preservation basics, containment techniques, and coordination with the security team. For dedicated incident responders and SOC analysts, training must cover: forensic investigation techniques, malware analysis fundamentals, network traffic analysis, log correlation and SIEM usage, chain of custody procedures, threat intelligence integration, and incident documentation requirements. Training delivery methods should include online modules for awareness training, classroom instruction for technical skills, hands-on labs for practical experience, and tabletop exercises for decision-making skills. Track training completion through a Learning Management System (LMS) and maintain records demonstrating compliance. Update training content following major incidents, threat landscape changes, new tool deployments, regulatory updates, or organizational changes. Consider industry certifications (GCIH, GCFA, ECIH) for key responders.",
    "implementation_rationale": "Your employees are your first line of defense. When they know how to spot suspicious activity and who to report it to, incidents get caught early before major damage occurs. Regular training keeps everyone sharp and reduces panic when something actually happens.",
    "example_implementation": "Implement a tiered training program: Tier 1 - Annual security awareness training for all employees covering incident recognition and reporting; Tier 2 - Quarterly technical training for IT staff on incident handling fundamentals; Tier 3 - Monthly advanced training and exercises for dedicated incident response team members including hands-on labs and simulations.",
    "non_technical_guidance": "1. Identify all personnel with incident response roles and responsibilities across the organization.\n2. Develop role-based training curricula addressing different knowledge requirements.\n3. Establish training timelines: initial training within 30-90 days of role assignment, update training when systems change, annual refresher training minimum.\n4. Select appropriate training delivery methods for each audience.\n5. Implement training tracking through LMS or equivalent system.\n6. Define triggers for training content review (major incidents, threat changes, tool updates).\n7. Maintain training records as evidence of compliance.\n8. Evaluate training effectiveness through assessments and exercise performance.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "IR-2.1",
        "title": "Simulated Events",
        "official_text": "Incorporate simulated events into incident response training to facilitate the required response by personnel in crisis situations."
      },
      {
        "id": "IR-2.2",
        "title": "Automated Training Environments",
        "official_text": "Provide an incident response training environment using [organization-defined automated mechanisms]."
      },
      {
        "id": "IR-2.3",
        "title": "Breach",
        "official_text": "Provide incident response training on how to identify and respond to a breach, including the organization's process for reporting a breach."
      }
    ],
    "related_controls": [
      "AT-2",
      "AT-3",
      "AT-4",
      "CP-3",
      "IR-1",
      "IR-3",
      "IR-4",
      "IR-8",
      "PM-14"
    ],
    "supplemental_guidance": "Incident response training is essential to preparing personnel to handle cybersecurity incidents effectively. Training content varies based on personnel roles - general users learn to recognize and report incidents, while technical staff learn investigation and response techniques. Organizations coordinate incident response training with contingency planning training to ensure comprehensive preparedness. Training is updated to reflect changes in the threat landscape, lessons learned from actual incidents, and new response tools or procedures.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-2 is an organizational/procedural control focused on personnel training. No direct STIG implementation exists - compliance demonstrated through training records and curricula."
    },
    "cac_metadata": {
      "implementation_type": "manual",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires manual implementation and verification. Automated scripts not applicable - compliance achieved through documented training programs, completion tracking, and training records."
    }
  },
  {
    "control_id": "IR-2.1",
    "control_name": "Simulated Events",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Incorporate simulated events into incident response training to facilitate the required response by personnel in crisis situations.",
    "parent_control": "IR-2",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "stig_id": "not_applicable",
    "intent": "Run practice drills with realistic scenarios so your team knows what a real incident feels like before they face one.",
    "plain_english_explanation": "Add realistic practice scenarios to your incident response training. Rather than just teaching concepts, create simulated incidents where team members must actually respond as they would in a real situation. This could include tabletop exercises where teams discuss responses to scenarios, red team exercises where attackers simulate real threats, or full-scale simulations with injected events. The goal is to build muscle memory and decision-making skills that work under pressure.",
    "ai_guidance": "Simulated events transform theoretical knowledge into practical skills. Implement multiple simulation types at varying frequencies: (1) Tabletop exercises quarterly - walk through scenarios discussing decisions and coordination points without hands-on technical response; (2) Functional exercises semi-annually - involve actual use of tools and systems in a controlled environment with simulated attack data; (3) Full-scale exercises annually - conduct realistic simulations involving all stakeholders, potentially with red team activity generating real alerts. Design scenarios based on current threat intelligence, past incidents, and risk assessments. Include scenarios for ransomware, data breach, insider threat, DDoS, supply chain compromise, and APT intrusion. Establish clear exercise objectives, success criteria, and evaluation metrics. Document lessons learned and track improvement over multiple exercises. Consider using cyber range platforms for technical simulations. Coordinate with business units to minimize operational impact while maintaining realism. Ensure exercises test communication plans, escalation procedures, and external coordination requirements.",
    "implementation_rationale": "Reading about incidents is different from experiencing them. Simulated events build muscle memory and confidence. When the real thing happens at 2 AM, your team will react from training, not freeze from uncertainty.",
    "example_implementation": "Conduct quarterly tabletop exercises with scenarios like 'ransomware detected on finance server at 3 AM - walk through response steps', semi-annual functional exercises using cyber range environments with injected malware samples, and annual full-scale exercises involving red team simulated attacks with all stakeholders participating in real-time response.",
    "non_technical_guidance": "1. Develop an annual exercise calendar incorporating various simulation types.\n2. Create scenario library covering diverse incident types relevant to organizational risk profile.\n3. Define clear objectives, scope, and evaluation criteria for each exercise.\n4. Involve all relevant stakeholders including IT, security, legal, communications, and management.\n5. Document exercise results, identify gaps, and create corrective action plans.\n6. Track improvement trends across multiple exercises.\n7. Update procedures and training based on exercise findings.\n8. Consider using external facilitators for unbiased evaluation.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-2",
      "IR-3",
      "IR-4",
      "CP-4",
      "AT-3"
    ],
    "supplemental_guidance": "Simulated events provide realistic training that prepares personnel for the stress and complexity of actual incidents. Exercises range from discussion-based tabletops to full-scale simulations with operational impact. The frequency and complexity of simulations should align with the organization's risk profile and incident response maturity.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-2(1) is an organizational training enhancement with no direct technical STIG implementation. Compliance demonstrated through exercise documentation and after-action reports."
    },
    "cac_metadata": {
      "implementation_type": "manual",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Requires organizational exercise program. Technical components may include cyber range platforms, red team tools, or simulation environments, but core compliance is procedural."
    }
  },
  {
    "control_id": "IR-2.2",
    "control_name": "Automated Training Environments",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Provide an incident response training environment using [organization-defined automated mechanisms].",
    "parent_control": "IR-2",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "stig_id": "not_applicable",
    "intent": "Give your team a safe sandbox environment where they can practice incident response without risking production systems.",
    "plain_english_explanation": "Set up dedicated training systems where incident responders can practice their skills safely. This could be a cyber range with simulated networks, sandboxed malware analysis systems, or automated scenario generation tools. The key is providing realistic technical environments where responders can practice investigating incidents, analyzing malware, and using response tools without any risk to production systems.",
    "ai_guidance": "Automated training environments accelerate skill development and enable consistent training delivery. Consider implementing: (1) Cyber range platforms that simulate enterprise network environments with various operating systems, applications, and vulnerabilities; (2) Malware analysis sandboxes (e.g., Cuckoo Sandbox, Any.Run, Joe Sandbox) for safe malware investigation practice; (3) SIEM training instances with pre-loaded attack scenarios for log analysis practice; (4) Capture-the-flag (CTF) platforms for gamified skill development; (5) Automated scenario injection tools that create realistic attack patterns in training environments; (6) Virtual lab environments using platforms like VMware, Proxmox, or cloud-based services; (7) Attack simulation platforms (e.g., Atomic Red Team, MITRE Caldera) for generating realistic threat activity. Key implementation considerations include: isolation from production networks, ability to reset environments quickly, realistic data and configurations, integration with production tool sets for familiarity, and metrics tracking for skill assessment. Budget for commercial cyber range services if internal build is not feasible.",
    "implementation_rationale": "You can't practice defusing bombs on live explosives. A training environment lets your team make mistakes, learn from them, and build skills without any risk to your actual business systems or data.",
    "example_implementation": "Deploy a cyber range environment using open-source tools (e.g., DetectionLab, DVWA, Metasploitable) or commercial platforms (e.g., Immersive Labs, RangeForce, Cyberbit). Configure automated scenario injection using Atomic Red Team to simulate MITRE ATT&CK techniques. Integrate with training SIEM instance for end-to-end investigation practice.",
    "non_technical_guidance": "1. Assess training environment requirements based on team skill levels and training objectives.\n2. Evaluate build vs. buy options for cyber range and simulation platforms.\n3. Ensure training environment mirrors production tool sets for skill transfer.\n4. Implement network isolation to prevent training activity from affecting production.\n5. Develop scenario library aligned with relevant threats and attack techniques.\n6. Establish usage policies and access controls for training environments.\n7. Track usage metrics and skill development progress.\n8. Budget for ongoing maintenance and scenario updates.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-2",
      "IR-2.1",
      "IR-3",
      "AT-3"
    ],
    "supplemental_guidance": "Automated training environments provide realistic, repeatable, and safe venues for developing incident response skills. These environments can range from simple virtual labs to sophisticated cyber ranges with automated scenario generation and scoring. The key requirement is isolation from production systems while maintaining realistic configurations and tools.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-2.2: Automated Training Environment Setup Script\n# This script sets up a basic incident response training lab using Docker\n# WARNING: Run only in isolated training environments\n\nset -e\n\nTRAINING_DIR=\"/opt/ir-training-lab\"\nLOG_FILE=\"/var/log/ir-training-setup.log\"\n\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a \"$LOG_FILE\"\n}\n\nlog_message \"Starting IR Training Environment Setup\"\n\n# Create training directory structure\nmkdir -p \"$TRAINING_DIR\"/{scenarios,logs,evidence,tools}\n\n# Check for Docker installation\nif ! command -v docker &> /dev/null; then\n    log_message \"Docker not found. Installing Docker...\"\n    curl -fsSL https://get.docker.com -o get-docker.sh\n    sh get-docker.sh\n    systemctl enable docker\n    systemctl start docker\nfi\n\n# Pull training images\nlog_message \"Pulling training container images...\"\ndocker pull remnux/remnux-distro:focal 2>/dev/null || log_message \"REMnux image pull skipped\"\ndocker pull vulnerables/web-dvwa 2>/dev/null || log_message \"DVWA image pull skipped\"\ndocker pull metasploitframework/metasploit-framework 2>/dev/null || log_message \"Metasploit image pull skipped\"\n\n# Create isolated training network\nlog_message \"Creating isolated training network...\"\ndocker network create --driver bridge --subnet=172.20.0.0/16 ir-training-net 2>/dev/null || log_message \"Network already exists\"\n\n# Deploy DVWA for web application incident training\nlog_message \"Deploying DVWA training instance...\"\ndocker run -d --name dvwa-training \\\n    --network ir-training-net \\\n    --ip 172.20.0.10 \\\n    -p 8080:80 \\\n    vulnerables/web-dvwa 2>/dev/null || log_message \"DVWA container exists\"\n\n# Create scenario injection script\ncat > \"$TRAINING_DIR/tools/inject_scenario.sh\" << 'SCENARIO_EOF'\n#!/bin/bash\n# Scenario injection script for IR training\nSCENARIO=$1\ncase $SCENARIO in\n    \"malware-download\")\n        echo \"Simulating malware download indicators in logs...\"\n        logger -t ir-training \"ALERT: Suspicious download detected from known malicious IP 203.0.113.66\"\n        ;;\n    \"brute-force\")\n        echo \"Simulating brute force attack in auth logs...\"\n        for i in {1..100}; do\n            logger -t sshd \"Failed password for invalid user admin from 198.51.100.1 port 22\"\n        done\n        ;;\n    \"data-exfil\")\n        echo \"Simulating data exfiltration indicators...\"\n        logger -t ir-training \"ALERT: Large outbound data transfer detected to external IP\"\n        ;;\n    *)\n        echo \"Usage: $0 {malware-download|brute-force|data-exfil}\"\n        ;;\nesac\nSCENARIO_EOF\nchmod +x \"$TRAINING_DIR/tools/inject_scenario.sh\"\n\n# Create training documentation\ncat > \"$TRAINING_DIR/README.md\" << 'README_EOF'\n# Incident Response Training Lab\n\n## Components\n- DVWA (Damn Vulnerable Web Application) - Port 8080\n- Isolated Docker network (172.20.0.0/16)\n- Scenario injection tools\n\n## Usage\n1. Access DVWA at http://localhost:8080\n2. Inject scenarios: /opt/ir-training-lab/tools/inject_scenario.sh <scenario>\n3. Practice investigation and response procedures\n\n## Scenarios\n- malware-download: Simulates malware download indicators\n- brute-force: Simulates SSH brute force attack\n- data-exfil: Simulates data exfiltration indicators\n\n## Safety\nThis environment is ISOLATED from production. Do not connect to production networks.\nREADME_EOF\n\nlog_message \"IR Training Environment Setup Complete\"\nlog_message \"Access DVWA at http://localhost:8080\"\nlog_message \"Training directory: $TRAINING_DIR\"",
        "ansible": "---\n# IR-2.2: Automated Training Environment Deployment\n# Ansible playbook for deploying incident response training infrastructure\n\n- name: Deploy IR Training Environment\n  hosts: training_servers\n  become: yes\n  vars:\n    training_base_dir: /opt/ir-training-lab\n    docker_network_name: ir-training-net\n    docker_network_subnet: \"172.20.0.0/16\"\n\n  tasks:\n    - name: Create training directory structure\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0755'\n      loop:\n        - \"{{ training_base_dir }}\"\n        - \"{{ training_base_dir }}/scenarios\"\n        - \"{{ training_base_dir }}/logs\"\n        - \"{{ training_base_dir }}/evidence\"\n        - \"{{ training_base_dir }}/tools\"\n\n    - name: Install Docker prerequisites\n      package:\n        name:\n          - docker\n          - docker-compose\n          - python3-docker\n        state: present\n\n    - name: Start and enable Docker service\n      service:\n        name: docker\n        state: started\n        enabled: yes\n\n    - name: Create isolated training network\n      docker_network:\n        name: \"{{ docker_network_name }}\"\n        driver: bridge\n        ipam_config:\n          - subnet: \"{{ docker_network_subnet }}\"\n        state: present\n\n    - name: Deploy DVWA training container\n      docker_container:\n        name: dvwa-training\n        image: vulnerables/web-dvwa\n        state: started\n        restart_policy: unless-stopped\n        networks:\n          - name: \"{{ docker_network_name }}\"\n            ipv4_address: \"172.20.0.10\"\n        published_ports:\n          - \"8080:80\"\n\n    - name: Deploy scenario injection script\n      copy:\n        dest: \"{{ training_base_dir }}/tools/inject_scenario.sh\"\n        mode: '0755'\n        content: |\n          #!/bin/bash\n          SCENARIO=$1\n          case $SCENARIO in\n              \"malware-download\")\n                  logger -t ir-training \"ALERT: Suspicious download from malicious IP\"\n                  ;;\n              \"brute-force\")\n                  for i in {1..100}; do\n                      logger -t sshd \"Failed password for admin from 198.51.100.1\"\n                  done\n                  ;;\n              \"data-exfil\")\n                  logger -t ir-training \"ALERT: Large outbound data transfer detected\"\n                  ;;\n          esac\n\n    - name: Create training documentation\n      copy:\n        dest: \"{{ training_base_dir }}/README.md\"\n        content: |\n          # IR Training Lab\n          ## Access\n          - DVWA: http://{{ ansible_host }}:8080\n          ## Scenarios\n          Run: {{ training_base_dir }}/tools/inject_scenario.sh <scenario>\n\n    - name: Log training environment deployment\n      lineinfile:\n        path: /var/log/ir-training-setup.log\n        line: \"{{ ansible_date_time.iso8601 }} - Training environment deployed by Ansible\"\n        create: yes"
      },
      "windows": {
        "powershell": "# IR-2.2: Windows Incident Response Training Environment Setup\n# PowerShell script to deploy training infrastructure on Windows\n# Requires: Windows 10/11 Pro or Server with Hyper-V or Docker Desktop\n\n#Requires -RunAsAdministrator\n\n$ErrorActionPreference = \"Stop\"\n$TrainingDir = \"C:\\IR-Training-Lab\"\n$LogFile = \"C:\\IR-Training-Lab\\setup.log\"\n\nfunction Write-Log {\n    param([string]$Message)\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    \"$timestamp - $Message\" | Tee-Object -FilePath $LogFile -Append\n}\n\n# Create directory structure\nWrite-Log \"Creating training directory structure...\"\n$directories = @(\n    \"$TrainingDir\",\n    \"$TrainingDir\\Scenarios\",\n    \"$TrainingDir\\Evidence\",\n    \"$TrainingDir\\Tools\",\n    \"$TrainingDir\\Logs\"\n)\nforeach ($dir in $directories) {\n    if (-not (Test-Path $dir)) {\n        New-Item -ItemType Directory -Path $dir -Force | Out-Null\n    }\n}\n\n# Check for Docker Desktop\n$dockerInstalled = $null -ne (Get-Command docker -ErrorAction SilentlyContinue)\nif (-not $dockerInstalled) {\n    Write-Log \"Docker Desktop not found. Please install from https://www.docker.com/products/docker-desktop\"\n    Write-Log \"After installation, re-run this script.\"\n    exit 1\n}\n\nWrite-Log \"Docker found. Setting up training containers...\"\n\n# Create isolated network\ntry {\n    docker network create --driver nat --subnet=172.21.0.0/16 ir-training-net 2>$null\n    Write-Log \"Created isolated training network\"\n} catch {\n    Write-Log \"Training network already exists or creation skipped\"\n}\n\n# Deploy DVWA container\nWrite-Log \"Deploying DVWA training instance...\"\ntry {\n    docker run -d --name dvwa-training `\n        --network ir-training-net `\n        -p 8080:80 `\n        vulnerables/web-dvwa 2>$null\n    Write-Log \"DVWA deployed successfully\"\n} catch {\n    Write-Log \"DVWA container exists or deployment skipped\"\n}\n\n# Create scenario injection script\n$scenarioScript = @'\nparam(\n    [Parameter(Mandatory=$true)]\n    [ValidateSet(\"MalwareDownload\", \"BruteForce\", \"DataExfil\")]\n    [string]$Scenario\n)\n\nswitch ($Scenario) {\n    \"MalwareDownload\" {\n        Write-EventLog -LogName Application -Source \"IR-Training\" -EventId 1001 -EntryType Warning -Message \"ALERT: Suspicious download detected from known malicious IP 203.0.113.66\"\n    }\n    \"BruteForce\" {\n        1..100 | ForEach-Object {\n            Write-EventLog -LogName Security -Source \"IR-Training\" -EventId 4625 -EntryType FailureAudit -Message \"Failed logon attempt for user admin from 198.51.100.1\"\n        }\n    }\n    \"DataExfil\" {\n        Write-EventLog -LogName Application -Source \"IR-Training\" -EventId 1002 -EntryType Warning -Message \"ALERT: Large outbound data transfer detected to external IP\"\n    }\n}\nWrite-Host \"Scenario $Scenario injected successfully\"\n'@\n\n$scenarioScript | Out-File -FilePath \"$TrainingDir\\Tools\\Invoke-IRScenario.ps1\" -Encoding UTF8\n\n# Create training README\n$readme = @\"\n# Incident Response Training Lab - Windows\n\n## Components\n- DVWA (Damn Vulnerable Web Application) - http://localhost:8080\n- Scenario injection PowerShell scripts\n- Isolated Docker network\n\n## Usage\n1. Access DVWA at http://localhost:8080 (default: admin/password)\n2. Inject scenarios: .\\Tools\\Invoke-IRScenario.ps1 -Scenario <ScenarioName>\n3. Practice investigation using Event Viewer, Sysmon, etc.\n\n## Available Scenarios\n- MalwareDownload: Simulates malware download indicators\n- BruteForce: Simulates authentication brute force attack\n- DataExfil: Simulates data exfiltration indicators\n\n## Safety Notice\nThis environment is for TRAINING ONLY. Isolated from production.\n\"@\n\n$readme | Out-File -FilePath \"$TrainingDir\\README.md\" -Encoding UTF8\n\n# Register event source for training\ntry {\n    New-EventLog -LogName Application -Source \"IR-Training\" -ErrorAction SilentlyContinue\n} catch {\n    Write-Log \"Event source already registered\"\n}\n\nWrite-Log \"IR Training Environment Setup Complete\"\nWrite-Log \"Access DVWA at http://localhost:8080\"\nWrite-Log \"Training directory: $TrainingDir\"",
        "ansible": "---\n# IR-2.2: Windows Training Environment Deployment\n# Ansible playbook for Windows incident response training infrastructure\n\n- name: Deploy Windows IR Training Environment\n  hosts: windows_training\n  gather_facts: yes\n  vars:\n    training_base_dir: C:\\IR-Training-Lab\n\n  tasks:\n    - name: Create training directory structure\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ training_base_dir }}\"\n        - \"{{ training_base_dir }}\\\\Scenarios\"\n        - \"{{ training_base_dir }}\\\\Evidence\"\n        - \"{{ training_base_dir }}\\\\Tools\"\n        - \"{{ training_base_dir }}\\\\Logs\"\n\n    - name: Check if Docker is installed\n      win_shell: docker --version\n      register: docker_check\n      ignore_errors: yes\n\n    - name: Fail if Docker not installed\n      fail:\n        msg: \"Docker Desktop must be installed on Windows training host\"\n      when: docker_check.rc != 0\n\n    - name: Create training network\n      win_shell: docker network create --driver nat ir-training-net\n      ignore_errors: yes\n\n    - name: Deploy DVWA container\n      win_shell: |\n        docker run -d --name dvwa-training `\n          --network ir-training-net `\n          -p 8080:80 `\n          vulnerables/web-dvwa\n      ignore_errors: yes\n\n    - name: Deploy scenario injection script\n      win_copy:\n        dest: \"{{ training_base_dir }}\\\\Tools\\\\Invoke-IRScenario.ps1\"\n        content: |\n          param([string]$Scenario)\n          switch ($Scenario) {\n              \"MalwareDownload\" { Write-EventLog -LogName Application -Source IR-Training -EventId 1001 -Message \"Suspicious download detected\" }\n              \"BruteForce\" { 1..100 | % { Write-EventLog -LogName Security -Source IR-Training -EventId 4625 -Message \"Failed logon\" } }\n          }\n\n    - name: Register training event source\n      win_shell: New-EventLog -LogName Application -Source \"IR-Training\" -ErrorAction SilentlyContinue\n      ignore_errors: yes\n\n    - name: Create README documentation\n      win_copy:\n        dest: \"{{ training_base_dir }}\\\\README.md\"\n        content: |\n          # Windows IR Training Lab\n          Access DVWA: http://localhost:8080\n          Inject scenarios: .\\Tools\\Invoke-IRScenario.ps1 -Scenario <name>"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true,
      "stig_mapping_notes": "IR-2(2) focuses on training infrastructure rather than production system hardening. No direct STIG mapping exists - technical scripts provided for training environment deployment."
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical implementation involves deploying isolated training infrastructure. Scripts provided deploy containerized vulnerable applications and scenario injection tools for hands-on IR training."
    }
  },
  {
    "control_id": "IR-2.3",
    "control_name": "Breach",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Provide incident response training on how to identify and respond to a breach, including the organization's process for reporting a breach.",
    "parent_control": "IR-2",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "stig_id": "not_applicable",
    "intent": "Make sure everyone knows specifically how to handle data breaches, including your legal obligations to notify affected parties.",
    "plain_english_explanation": "Train your team specifically on how to handle data breaches - situations where sensitive information like personal data, health records, or financial information may have been accessed or stolen by unauthorized parties. This training should cover how to recognize when a breach has occurred, immediate containment steps, evidence preservation for potential legal proceedings, notification requirements under various regulations (HIPAA, state breach laws, GDPR, etc.), and communication procedures with affected individuals, regulators, and the public.",
    "ai_guidance": "Breach-specific training addresses the unique requirements around data breach incidents, which often involve regulatory notification obligations and potential legal liability. Training should cover: (1) Breach identification - recognizing indicators of unauthorized data access including anomalous database queries, large data exports, access from unusual locations, and alerts from DLP systems; (2) Breach classification - determining what types of data were potentially exposed (PII, PHI, financial data, credentials) and the regulatory implications of each; (3) Immediate response - containment actions that preserve evidence while stopping ongoing data loss; (4) Notification requirements - understanding timelines and requirements under HIPAA (60 days), state breach notification laws (varies by state), GDPR (72 hours), PCI-DSS, and other applicable regulations; (5) Documentation requirements - maintaining detailed records of breach discovery, investigation, containment, and notification activities; (6) Communication protocols - coordinating with legal counsel, public relations, law enforcement, and regulatory bodies; (7) Individual notification - preparing and delivering notifications to affected individuals including required content elements. Include tabletop exercises specifically focused on breach scenarios with mock notification letter drafting and regulatory reporting.",
    "implementation_rationale": "Data breaches have strict legal timelines - GDPR requires notification within 72 hours. If your team doesn't know the breach response process cold, you risk regulatory fines on top of the breach damage. This training is literally lawsuit prevention.",
    "example_implementation": "Develop breach-specific training module covering: breach indicators and detection methods, regulatory notification requirements summary table, breach response checklist, sample notification letters for different breach types, tabletop exercise with mock breach scenario requiring notification decision-making.",
    "non_technical_guidance": "1. Develop breach-specific training curriculum separate from general incident response training.\n2. Include overview of applicable breach notification regulations (federal, state, international).\n3. Create breach classification matrix mapping data types to notification requirements.\n4. Develop breach response playbook with clear decision trees.\n5. Include sample notification letters and regulatory reporting templates.\n6. Conduct regular tabletop exercises focused on breach scenarios.\n7. Train personnel on coordination with legal counsel during breach response.\n8. Ensure training covers both internal and external communication requirements.\n9. Document training completion for compliance evidence.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-2",
      "IR-6",
      "IR-8.1",
      "PT-1",
      "PT-3",
      "SI-18"
    ],
    "supplemental_guidance": "Breach training focuses on the specific skills needed to respond to data breaches, which have unique regulatory, legal, and communication requirements compared to other incident types. Training should be coordinated with legal counsel and privacy officers to ensure personnel understand notification obligations and evidence preservation requirements.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-2(3) is a training/procedural control focused on breach response knowledge. No technical STIG implementation - compliance demonstrated through breach-specific training curricula and exercises."
    },
    "cac_metadata": {
      "implementation_type": "manual",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Organizational control requiring breach-specific training development. Consider regulatory requirements specific to industry and jurisdiction when developing content."
    }
  },
  {
    "control_id": "IR-3",
    "control_name": "Incident Response Testing",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Test the effectiveness of the incident response capability for the system [organization-defined frequency] using the following tests: [organization-defined tests].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "stig_id": "not_applicable",
    "intent": "Actually test your incident response plan to make sure it works. A plan that's never been tested is just a wish list.",
    "plain_english_explanation": "Regularly test whether your incident response procedures and team actually work. This goes beyond training - it is about validating that when a real incident occurs, your organization can effectively detect it, respond appropriately, contain the damage, and recover. Testing methods range from simple checklist reviews to full-scale simulations. The key is to identify gaps before real incidents expose them.",
    "ai_guidance": "Incident response testing validates the entire response capability including people, processes, and technology. Implement a testing program that includes: (1) Checklist reviews - quarterly verification that response procedures are current, contact information is accurate, and required tools are available; (2) Tabletop exercises - semi-annual scenario-based discussions testing decision-making and coordination without technical execution; (3) Walk-through exercises - quarterly step-by-step review of response procedures to identify gaps or ambiguities; (4) Functional exercises - annual tests involving actual use of response tools, simulated alerts, and coordination activities; (5) Full-scale exercises - annual or bi-annual realistic simulations potentially involving red team activity, all stakeholders, and external coordination. Testing should cover diverse incident scenarios aligned with risk assessment findings. Document all tests including objectives, participants, scenario details, observations, findings, and corrective actions. Track metrics across tests including mean time to detect (MTTD), mean time to respond (MTTR), and procedure adherence rates. Use findings to update response plans, training content, and tool configurations. Coordinate testing with contingency planning testing (CP-4) to maximize efficiency and identify interdependencies.",
    "implementation_rationale": "Every organization thinks their plan is solid until they test it. Testing reveals gaps like outdated contact lists, tools that don't work, or procedures that take too long. Better to find these issues in a test than during a real attack.",
    "example_implementation": "Establish annual testing calendar: Q1 - Tabletop exercise (ransomware scenario); Q2 - Functional exercise (simulated data breach with tool usage); Q3 - Tabletop exercise (insider threat scenario); Q4 - Full-scale exercise (red team engagement with end-to-end response). Document all exercises with after-action reports and track corrective action completion.",
    "non_technical_guidance": "1. Define testing frequency based on system criticality and organizational risk tolerance (recommend minimum annual for moderate systems).\n2. Select appropriate test types for each testing cycle.\n3. Develop scenario library covering relevant threat scenarios.\n4. Establish clear test objectives and success criteria.\n5. Identify all required participants and external dependencies.\n6. Document test plans, execution records, and results.\n7. Conduct after-action reviews to identify lessons learned.\n8. Create corrective action plans for identified gaps.\n9. Track improvement trends across multiple testing cycles.\n10. Coordinate with contingency plan testing to maximize efficiency.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "IR-3.1",
        "title": "Automated Testing",
        "official_text": "Test the incident response capability using [organization-defined automated mechanisms]."
      },
      {
        "id": "IR-3.2",
        "title": "Coordination with Related Plans",
        "official_text": "Coordinate incident response testing with organizational elements responsible for related plans."
      },
      {
        "id": "IR-3.3",
        "title": "Continuous Improvement",
        "official_text": "Use qualitative and quantitative data from testing to: (a) Determine the effectiveness of incident response processes; (b) Continuously improve incident response processes; and (c) Provide incident response measures and metrics that are accurate, consistent, and in a reproducible format."
      }
    ],
    "related_controls": [
      "CP-3",
      "CP-4",
      "IR-2",
      "IR-4",
      "IR-8",
      "PM-14"
    ],
    "supplemental_guidance": "Incident response testing provides a mechanism for organizations to evaluate the effectiveness of their incident response capability and identify potential weaknesses or deficiencies. Testing can be conducted through tabletop exercises, simulations, or operational exercises. Organizations coordinate incident response testing with contingency planning testing to ensure comprehensive evaluation of response and recovery capabilities.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-3 is an organizational testing control with no direct technical STIG implementation. Compliance demonstrated through test plans, exercise documentation, and after-action reports."
    },
    "cac_metadata": {
      "implementation_type": "manual",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Requires organizational exercise program. Technical components may include simulation platforms but core compliance is procedural documentation of testing activities and results."
    }
  },
  {
    "control_id": "IR-3.1",
    "control_name": "Automated Testing",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Test the incident response capability using [organization-defined automated mechanisms].",
    "parent_control": "IR-3",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "stig_id": "not_applicable",
    "intent": "Use automated tools to test your incident detection and response capabilities, not just manual tabletop exercises.",
    "plain_english_explanation": "Use automated tools to test your incident response systems. This could include attack simulation platforms that automatically execute common attack techniques to test whether your detection systems alert properly, your playbooks trigger correctly, and your response automation functions as designed. Automated testing enables more frequent testing than manual exercises and provides consistent, repeatable results.",
    "ai_guidance": "Automated incident response testing leverages technology to validate detection and response capabilities continuously. Implementation approaches include: (1) Breach and Attack Simulation (BAS) platforms (e.g., SafeBreach, AttackIQ, Cymulate) that automatically execute attack techniques against production systems and validate detection; (2) MITRE ATT&CK-based simulation using tools like Atomic Red Team or MITRE Caldera to test detection across known adversary techniques; (3) Automated SIEM rule testing using tools that generate synthetic log events to validate correlation rules and alerting; (4) Playbook automation testing that triggers response playbooks with test incidents to validate automation workflows; (5) Purple team automation that combines red team attack simulation with blue team detection validation; (6) Continuous security validation integrating automated testing into CI/CD pipelines. Key implementation considerations: ensure test activities are clearly identified as testing to prevent SOC confusion, implement proper authorization and change management for automated attack simulation, establish baseline metrics for detection rates and response times, and integrate results into security dashboards. Automated testing complements rather than replaces manual exercises - use automation for frequent validation of technical controls while retaining manual exercises for testing human decision-making and coordination.",
    "implementation_rationale": "Manual tests are good, but automated testing can simulate attacks 24/7 and test your detection systems continuously. Tools like Atomic Red Team can verify your defenses actually catch what they're supposed to catch.",
    "example_implementation": "Deploy Atomic Red Team integrated with CI/CD pipeline to run weekly tests of MITRE ATT&CK techniques relevant to organizational threat profile. Configure automated reporting to security dashboard showing detection rates by technique. Alert on detection rate drops below defined thresholds.",
    "non_technical_guidance": "1. Assess automated testing tool options based on environment and budget.\n2. Define scope of automated testing - which attack techniques, which systems, which detection mechanisms.\n3. Establish testing frequency appropriate for automated execution (recommend weekly minimum).\n4. Implement proper authorization and change control for automated attack simulation.\n5. Create alerting mechanisms to distinguish test activities from real attacks.\n6. Define baseline metrics and thresholds for detection effectiveness.\n7. Integrate automated testing results into security metrics reporting.\n8. Use results to prioritize detection engineering efforts.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-3",
      "CA-8",
      "SI-4",
      "SI-6"
    ],
    "supplemental_guidance": "Automated testing mechanisms can include breach and attack simulation tools, automated adversary emulation platforms, and continuous security validation systems. Automation enables more frequent testing than manual methods alone, providing continuous assurance that detection and response capabilities remain effective.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-3.1: Automated Incident Response Testing Script\n# Uses Atomic Red Team to test detection capabilities\n# Requires: PowerShell Core, Atomic Red Team installed\n\nset -e\n\nTEST_DIR=\"/opt/ir-testing\"\nRESULTS_DIR=\"$TEST_DIR/results\"\nLOG_FILE=\"$TEST_DIR/ir-test-$(date +%Y%m%d).log\"\n\nlog_msg() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [$1] $2\" | tee -a \"$LOG_FILE\"\n}\n\nmkdir -p \"$RESULTS_DIR\"\n\nlog_msg \"INFO\" \"Starting IR Automated Testing\"\n\n# Check for Atomic Red Team\nif ! command -v pwsh &> /dev/null; then\n    log_msg \"ERROR\" \"PowerShell Core required for Atomic Red Team\"\n    exit 1\nfi\n\n# Define test techniques aligned with common threats\nTECHNIQUES=(\n    \"T1059.001\"  # PowerShell execution\n    \"T1053.005\"  # Scheduled Task\n    \"T1562.001\"  # Disable Security Tools\n    \"T1082\"      # System Information Discovery\n    \"T1016\"      # System Network Configuration Discovery\n)\n\nlog_msg \"INFO\" \"Testing ${#TECHNIQUES[@]} MITRE ATT&CK techniques\"\n\n# Results tracking\nDETECTED=0\nMISSED=0\n\nfor TECHNIQUE in \"${TECHNIQUES[@]}\"; do\n    log_msg \"INFO\" \"Testing technique: $TECHNIQUE\"\n    \n    # Execute atomic test\n    RESULT=$(pwsh -Command \"\n        Import-Module Invoke-AtomicRedTeam -ErrorAction SilentlyContinue\n        try {\n            Invoke-AtomicTest $TECHNIQUE -TimeoutSeconds 60 -GetPrereqs\n            Invoke-AtomicTest $TECHNIQUE -TimeoutSeconds 60\n            'SUCCESS'\n        } catch {\n            'FAILED'\n        }\n    \" 2>&1 || echo \"EXECUTION_ERROR\")\n    \n    log_msg \"INFO\" \"Technique $TECHNIQUE execution result: $RESULT\"\n    \n    # Allow time for detection\n    sleep 30\n    \n    # Check SIEM/detection (placeholder - integrate with actual SIEM API)\n    # This is where you would query your SIEM to verify alerts were generated\n    log_msg \"INFO\" \"Waiting for detection validation for $TECHNIQUE\"\ndone\n\n# Generate summary report\nREPORT_FILE=\"$RESULTS_DIR/ir-test-report-$(date +%Y%m%d).json\"\ncat > \"$REPORT_FILE\" << EOF\n{\n  \"test_date\": \"$(date -Iseconds)\",\n  \"hostname\": \"$(hostname)\",\n  \"techniques_tested\": ${#TECHNIQUES[@]},\n  \"techniques\": [$(printf '\"%s\",' \"${TECHNIQUES[@]}\" | sed 's/,$//')],\n  \"status\": \"completed\",\n  \"log_file\": \"$LOG_FILE\"\n}\nEOF\n\nlog_msg \"INFO\" \"Testing complete. Report: $REPORT_FILE\"\n\n# Cleanup test artifacts\nlog_msg \"INFO\" \"Cleaning up test artifacts\"\nfor TECHNIQUE in \"${TECHNIQUES[@]}\"; do\n    pwsh -Command \"Invoke-AtomicTest $TECHNIQUE -Cleanup\" 2>/dev/null || true\ndone\n\nlog_msg \"INFO\" \"IR Automated Testing Complete\"",
        "ansible": "---\n# IR-3.1: Automated IR Testing Deployment and Execution\n# Deploys Atomic Red Team and executes automated tests\n\n- name: Deploy and Execute Automated IR Testing\n  hosts: test_targets\n  become: yes\n  vars:\n    test_base_dir: /opt/ir-testing\n    atomic_techniques:\n      - \"T1059.001\"  # PowerShell\n      - \"T1053.005\"  # Scheduled Task\n      - \"T1082\"      # System Discovery\n      - \"T1016\"      # Network Discovery\n\n  tasks:\n    - name: Create testing directories\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0755'\n      loop:\n        - \"{{ test_base_dir }}\"\n        - \"{{ test_base_dir }}/results\"\n        - \"{{ test_base_dir }}/logs\"\n\n    - name: Check PowerShell Core installation\n      command: pwsh --version\n      register: pwsh_check\n      ignore_errors: yes\n\n    - name: Install PowerShell Core if missing\n      package:\n        name: powershell\n        state: present\n      when: pwsh_check.rc != 0\n\n    - name: Install Atomic Red Team module\n      shell: |\n        pwsh -Command '\n        Install-Module -Name invoke-atomicredteam -Force -Scope AllUsers\n        Install-Module -Name powershell-yaml -Force -Scope AllUsers\n        '\n      ignore_errors: yes\n\n    - name: Execute automated tests\n      shell: |\n        pwsh -Command '\n        Import-Module Invoke-AtomicRedTeam\n        $results = @()\n        foreach ($technique in @(\"{{ atomic_techniques | join('\",\"') }}\")) {\n            try {\n                Invoke-AtomicTest $technique -TimeoutSeconds 120\n                $results += @{Technique=$technique; Status=\"Executed\"}\n            } catch {\n                $results += @{Technique=$technique; Status=\"Failed\"; Error=$_.Exception.Message}\n            }\n        }\n        $results | ConvertTo-Json | Out-File \"{{ test_base_dir }}/results/test-results-$(Get-Date -Format yyyyMMdd).json\"\n        '\n      register: test_results\n\n    - name: Cleanup test artifacts\n      shell: |\n        pwsh -Command '\n        Import-Module Invoke-AtomicRedTeam\n        foreach ($technique in @(\"{{ atomic_techniques | join('\",\"') }}\")) {\n            Invoke-AtomicTest $technique -Cleanup -ErrorAction SilentlyContinue\n        }\n        '\n      ignore_errors: yes\n\n    - name: Generate test report\n      copy:\n        dest: \"{{ test_base_dir }}/results/summary-{{ ansible_date_time.date }}.json\"\n        content: |\n          {\n            \"test_date\": \"{{ ansible_date_time.iso8601 }}\",\n            \"host\": \"{{ inventory_hostname }}\",\n            \"techniques_tested\": {{ atomic_techniques | length }},\n            \"status\": \"completed\"\n          }"
      },
      "windows": {
        "powershell": "# IR-3.1: Windows Automated Incident Response Testing\n# Uses Atomic Red Team for automated detection validation\n# Requires: Atomic Red Team module installed\n\n#Requires -RunAsAdministrator\n\n$ErrorActionPreference = \"Continue\"\n$TestDir = \"C:\\IR-Testing\"\n$ResultsDir = \"$TestDir\\Results\"\n$LogFile = \"$TestDir\\ir-test-$(Get-Date -Format yyyyMMdd).log\"\n\nfunction Write-Log {\n    param([string]$Level, [string]$Message)\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    \"$timestamp [$Level] $Message\" | Tee-Object -FilePath $LogFile -Append\n}\n\n# Create directories\nNew-Item -ItemType Directory -Path $TestDir, $ResultsDir -Force | Out-Null\n\nWrite-Log \"INFO\" \"Starting IR Automated Testing\"\n\n# Install Atomic Red Team if needed\ntry {\n    Import-Module Invoke-AtomicRedTeam -ErrorAction Stop\n    Write-Log \"INFO\" \"Atomic Red Team module loaded\"\n} catch {\n    Write-Log \"INFO\" \"Installing Atomic Red Team...\"\n    Install-Module -Name invoke-atomicredteam -Force -Scope CurrentUser\n    Install-Module -Name powershell-yaml -Force -Scope CurrentUser\n    Import-Module Invoke-AtomicRedTeam\n}\n\n# Define techniques to test (aligned with common Windows threats)\n$Techniques = @(\n    \"T1059.001\",  # PowerShell execution\n    \"T1053.005\",  # Scheduled Task/Job\n    \"T1562.001\",  # Disable Windows Defender\n    \"T1082\",      # System Information Discovery\n    \"T1016\",      # System Network Configuration\n    \"T1057\",      # Process Discovery\n    \"T1012\",      # Query Registry\n    \"T1083\"       # File and Directory Discovery\n)\n\nWrite-Log \"INFO\" \"Testing $($Techniques.Count) MITRE ATT&CK techniques\"\n\n$Results = @()\n\nforeach ($Technique in $Techniques) {\n    Write-Log \"INFO\" \"Testing technique: $Technique\"\n    \n    try {\n        # Get prerequisites\n        Invoke-AtomicTest $Technique -GetPrereqs -TimeoutSeconds 120 -ErrorAction SilentlyContinue\n        \n        # Execute test\n        $testOutput = Invoke-AtomicTest $Technique -TimeoutSeconds 120 -ErrorAction Stop\n        \n        $Results += [PSCustomObject]@{\n            Technique = $Technique\n            Status = \"Executed\"\n            Timestamp = Get-Date -Format \"o\"\n            Output = $testOutput | Out-String\n        }\n        \n        Write-Log \"INFO\" \"Technique $Technique executed successfully\"\n    } catch {\n        $Results += [PSCustomObject]@{\n            Technique = $Technique\n            Status = \"Failed\"\n            Timestamp = Get-Date -Format \"o\"\n            Error = $_.Exception.Message\n        }\n        Write-Log \"ERROR\" \"Technique $Technique failed: $($_.Exception.Message)\"\n    }\n    \n    # Allow detection systems to process\n    Start-Sleep -Seconds 30\n}\n\n# Generate report\n$Report = @{\n    TestDate = Get-Date -Format \"o\"\n    Hostname = $env:COMPUTERNAME\n    TechniquesTested = $Techniques.Count\n    Results = $Results\n    Summary = @{\n        Executed = ($Results | Where-Object Status -eq \"Executed\").Count\n        Failed = ($Results | Where-Object Status -eq \"Failed\").Count\n    }\n}\n\n$ReportFile = \"$ResultsDir\\ir-test-report-$(Get-Date -Format yyyyMMdd).json\"\n$Report | ConvertTo-Json -Depth 10 | Out-File -FilePath $ReportFile -Encoding UTF8\n\nWrite-Log \"INFO\" \"Testing complete. Report saved: $ReportFile\"\n\n# Cleanup test artifacts\nWrite-Log \"INFO\" \"Cleaning up test artifacts...\"\nforeach ($Technique in $Techniques) {\n    try {\n        Invoke-AtomicTest $Technique -Cleanup -ErrorAction SilentlyContinue\n    } catch {\n        Write-Log \"WARN\" \"Cleanup failed for $Technique\"\n    }\n}\n\nWrite-Log \"INFO\" \"IR Automated Testing Complete\"\n\n# Output summary\nWrite-Host \"`n=== TEST SUMMARY ===\"\nWrite-Host \"Techniques Tested: $($Techniques.Count)\"\nWrite-Host \"Executed: $($Report.Summary.Executed)\"\nWrite-Host \"Failed: $($Report.Summary.Failed)\"\nWrite-Host \"Report: $ReportFile\"",
        "ansible": "---\n# IR-3.1: Windows Automated IR Testing via Ansible\n\n- name: Execute Windows Automated IR Testing\n  hosts: windows_targets\n  gather_facts: yes\n  vars:\n    test_base_dir: C:\\IR-Testing\n    atomic_techniques:\n      - \"T1059.001\"\n      - \"T1053.005\"\n      - \"T1082\"\n      - \"T1016\"\n\n  tasks:\n    - name: Create testing directories\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ test_base_dir }}\"\n        - \"{{ test_base_dir }}\\\\Results\"\n\n    - name: Install Atomic Red Team module\n      win_shell: |\n        Set-ExecutionPolicy Bypass -Scope Process -Force\n        Install-Module -Name invoke-atomicredteam -Force -Scope CurrentUser -ErrorAction SilentlyContinue\n        Install-Module -Name powershell-yaml -Force -Scope CurrentUser -ErrorAction SilentlyContinue\n      ignore_errors: yes\n\n    - name: Execute automated tests\n      win_shell: |\n        Import-Module Invoke-AtomicRedTeam\n        $results = @()\n        $techniques = @('{{ atomic_techniques | join(\"','\") }}')\n        foreach ($t in $techniques) {\n            try {\n                Invoke-AtomicTest $t -TimeoutSeconds 120\n                $results += @{Technique=$t; Status='Executed'}\n            } catch {\n                $results += @{Technique=$t; Status='Failed'}\n            }\n        }\n        $results | ConvertTo-Json | Out-File \"{{ test_base_dir }}\\Results\\test-$(Get-Date -Format yyyyMMdd).json\"\n      register: test_output\n\n    - name: Cleanup test artifacts\n      win_shell: |\n        Import-Module Invoke-AtomicRedTeam\n        @('{{ atomic_techniques | join(\"','\") }}') | ForEach-Object {\n            Invoke-AtomicTest $_ -Cleanup -ErrorAction SilentlyContinue\n        }\n      ignore_errors: yes"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true,
      "stig_mapping_notes": "IR-3(1) focuses on automated testing capability rather than production system hardening. Scripts provided deploy and execute Atomic Red Team for automated detection validation."
    },
    "cac_metadata": {
      "implementation_type": "technical",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical implementation involves deploying breach and attack simulation tools. Scripts provided use Atomic Red Team for MITRE ATT&CK-based automated testing."
    }
  },
  {
    "control_id": "IR-3.2",
    "control_name": "Coordination with Related Plans",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Coordinate incident response testing with organizational elements responsible for related plans.",
    "parent_control": "IR-3",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "stig_id": "not_applicable",
    "intent": "When you test incident response, include everyone who would be involved - IT, legal, PR, management - not just the security team.",
    "plain_english_explanation": "When you test your incident response capabilities, coordinate with the teams responsible for related plans like business continuity, disaster recovery, crisis communications, and contingency operations. Security incidents often trigger these other plans - a ransomware attack might require business continuity activation, or a data breach might require crisis communications. Testing these together reveals how well the plans integrate and where handoffs might fail.",
    "ai_guidance": "Incident response rarely operates in isolation - significant security incidents typically trigger multiple organizational response mechanisms. Coordination ensures these interconnected capabilities work together effectively. Key coordination points include: (1) Contingency Planning (CP) - coordinate with disaster recovery and business continuity teams to test transitions from incident response to recovery operations; (2) Crisis Communications - include public affairs and corporate communications in exercises to test messaging coordination and approval workflows; (3) Legal and Privacy - involve legal counsel in breach scenario exercises to test notification decision-making and evidence preservation; (4) Human Resources - coordinate for insider threat scenarios requiring HR involvement; (5) Physical Security - integrate for scenarios involving physical and cyber convergence; (6) Executive Leadership - include crisis management team in full-scale exercises to test strategic decision-making. Practical coordination mechanisms include: joint exercise planning committees, shared exercise calendars, combined exercise scenarios that span multiple plans, integrated after-action reviews, and shared lessons learned databases. Consider annual enterprise-wide exercises that simultaneously test incident response, business continuity, crisis communications, and disaster recovery.",
    "implementation_rationale": "A real incident touches every department. If legal doesn't know their role or PR hasn't practiced crisis communication, your response will stumble. Coordinated testing ensures everyone is rowing in the same direction.",
    "example_implementation": "Establish quarterly coordination meeting with business continuity, disaster recovery, and crisis communications teams. Develop annual exercise that spans incident response, business continuity activation, and crisis communications. Include representatives from all related plans in exercise planning and after-action reviews.",
    "non_technical_guidance": "1. Identify all related plans and their owners (business continuity, disaster recovery, crisis communications, contingency operations).\n2. Establish regular coordination meetings with related plan owners.\n3. Develop shared exercise calendar to identify coordination opportunities.\n4. Design exercises that span multiple plans and test integration points.\n5. Include representatives from related plans in exercise planning.\n6. Conduct joint after-action reviews to identify cross-plan issues.\n7. Maintain shared lessons learned repository.\n8. Update all related plans based on coordinated exercise findings.\n9. Test escalation and handoff procedures between plans.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-3",
      "CP-2",
      "CP-4",
      "PM-8",
      "PM-11"
    ],
    "supplemental_guidance": "Related plans include business continuity plans, disaster recovery plans, continuity of operations plans, crisis communications plans, and occupant emergency plans. Coordination ensures that incident response testing considers dependencies between plans and identifies integration issues before actual incidents require plan execution.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-3(2) is an organizational coordination requirement with no technical STIG implementation. Compliance demonstrated through coordinated exercise documentation and stakeholder participation records."
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Requires organizational coordination processes. No technical automation - compliance achieved through documented coordination activities and joint exercise participation."
    }
  },
  {
    "control_id": "IR-3.3",
    "control_name": "Continuous Improvement",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Use qualitative and quantitative data from testing to: (a) Determine the effectiveness of incident response processes; (b) Continuously improve incident response processes; and (c) Provide incident response measures and metrics that are accurate, consistent, and in a reproducible format.",
    "parent_control": "IR-3",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "stig_id": "not_applicable",
    "intent": "After each test or real incident, analyze what worked and what didn't, then actually fix the problems you found.",
    "plain_english_explanation": "Use the results from your incident response tests to measure how well your processes work and make them better over time. Track metrics like how quickly you detect incidents, how long containment takes, and whether procedures are followed correctly. Compare these numbers across multiple tests to see if you are improving. Use both hard numbers (quantitative) and observations about what worked or did not (qualitative) to drive improvements.",
    "ai_guidance": "Continuous improvement requires systematic collection and analysis of incident response performance data. Implement a metrics program covering: (1) Quantitative metrics - Mean Time to Detect (MTTD), Mean Time to Respond (MTTR), Mean Time to Contain (MTTC), Mean Time to Recover, detection rate by attack technique, false positive rate, procedure adherence rate, escalation accuracy; (2) Qualitative metrics - exercise observer assessments, participant feedback, stakeholder satisfaction, coordination effectiveness, communication clarity, decision quality; (3) Data sources - exercise observations, after-action reports, SIEM data, incident tickets, automated testing results; (4) Analysis approaches - trend analysis across exercises, comparison against industry benchmarks, root cause analysis of response failures, correlation between training and performance. Establish improvement workflows: collect data -> analyze trends -> identify improvement opportunities -> prioritize based on risk impact -> implement changes -> validate through subsequent testing. Maintain metrics dashboards for ongoing visibility. Report metrics to leadership to demonstrate program value and justify resources. Benchmark against industry data (e.g., Verizon DBIR statistics) where available. Use metrics to inform training priorities, tool investments, and procedure updates.",
    "implementation_rationale": "Testing is pointless if you don't learn from it. Track metrics like response time, detection accuracy, and communication gaps. Use this data to continuously improve. Your incident response should get better every single time.",
    "example_implementation": "Establish monthly metrics review including MTTD, MTTR, detection rate by technique, and exercise findings. Maintain trend dashboard showing 12-month improvement trajectories. Conduct quarterly review with leadership presenting metrics and improvement initiatives. Use metrics to prioritize next quarter training topics and tool enhancements.",
    "non_technical_guidance": "1. Define key performance indicators (KPIs) for incident response effectiveness.\n2. Establish baseline measurements through initial testing.\n3. Implement consistent data collection across all exercises and incidents.\n4. Create metrics dashboard for ongoing visibility.\n5. Conduct regular (recommend monthly) metrics analysis.\n6. Identify improvement opportunities based on data.\n7. Prioritize improvements based on risk impact.\n8. Implement changes and validate through subsequent testing.\n9. Report metrics and trends to leadership.\n10. Benchmark against industry standards where possible.\n11. Document improvement initiatives and outcomes.\n12. Iterate improvement cycle continuously.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-3",
      "IR-4",
      "PM-6",
      "PM-14"
    ],
    "supplemental_guidance": "Continuous improvement programs transform incident response from static procedures to dynamic, maturing capabilities. Metrics should cover the full incident response lifecycle and incorporate both operational data and exercise results. Organizations should establish clear ownership for metrics collection, analysis, and action item follow-through.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "stig_mapping_notes": "IR-3(3) is an organizational improvement program with no direct technical STIG implementation. Compliance demonstrated through metrics dashboards, trend analysis, and documented improvement initiatives."
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Requires organizational metrics program. Technical components may include dashboards and data collection tools, but core compliance is procedural demonstration of data-driven improvement."
    }
  },
  {
    "control_id": "IR-4",
    "control_name": "Incident Handling",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "official_text": "a. Implement an incident handling capability for incidents that is consistent with the incident response plan and includes preparation, detection and analysis, containment, eradication, and recovery; b. Coordinate incident handling activities with contingency planning activities; c. Incorporate lessons learned from ongoing incident handling activities into incident response procedures, training, and testing, and implement the resulting changes accordingly; and d. Ensure the rigor, intensity, scope, and results of incident handling activities are comparable and predictable across the organization.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Incident Handling requires organizations to implement a comprehensive capability for managing security incidents through all phases: preparation, detection and analysis, containment, eradication, and recovery. This process must align with the incident response plan, integrate with business continuity planning, and continuously improve based on lessons learned from actual incidents.",
    "example_implementation": "Establish a dedicated incident response team with clear roles and responsibilities. Implement a ticketing system to track incidents through all phases. Create runbooks for common incident types including malware infections, data breaches, denial of service attacks, and unauthorized access attempts. Conduct quarterly tabletop exercises and annual full-scale simulations to test and improve the incident handling capability.",
    "non_technical_guidance": "To implement IR-4 Incident Handling effectively: 1. Develop comprehensive incident response procedures covering all phases from preparation through recovery. 2. Establish an incident response team with defined roles including incident commander, technical analysts, communications lead, and legal liaison. 3. Create incident classification and prioritization criteria based on impact to confidentiality, integrity, and availability. 4. Implement communication protocols for internal escalation and external notification requirements. 5. Coordinate with contingency planning to ensure incident handling supports business continuity objectives. 6. Conduct post-incident reviews to identify root causes and improvement opportunities. 7. Update procedures, training, and testing based on lessons learned. 8. Establish metrics to measure incident handling effectiveness and consistency across the organization.",
    "is_technical": false,
    "ai_guidance": "Incident handling represents the operational heart of an organization's security posture. When implementing IR-4, focus on establishing repeatable, documented processes that can be executed under pressure. The incident handling lifecycle should flow seamlessly from detection through recovery, with clear handoff points and escalation criteria. Critical success factors include: maintaining current contact lists for internal teams and external parties (law enforcement, ISACs, vendors), establishing communication templates for different stakeholder groups, and creating decision trees for common incident scenarios. Automation should support but not replace human judgment in incident classification and response decisions. Ensure your ticketing system captures sufficient metadata for trend analysis and regulatory reporting. Consider implementing a Security Orchestration, Automation, and Response (SOAR) platform to standardize playbook execution. Regular exercises should test not just technical capabilities but also decision-making under uncertainty, cross-team coordination, and communication with leadership. Document all incidents regardless of severity to build institutional knowledge and identify patterns that may indicate advanced persistent threats.",
    "implementation_rationale": "Structured incident handling ensures nothing falls through the cracks. Proper preparation means having the right tools and access ready. Detection, analysis, containment, eradication, and recovery should all have defined steps. Consistency leads to faster, more effective responses.",
    "enhancements": [
      {
        "id": "IR-4.1",
        "title": "Automated Incident Handling Processes",
        "official_text": "Support the incident handling process using automated mechanisms."
      },
      {
        "id": "IR-4.2",
        "title": "Dynamic Reconfiguration",
        "official_text": "Include the following types of dynamic reconfiguration for organizational systems as part of the incident response capability: changes to router rules, access control lists, intrusion detection/prevention system parameters, and filter rules for guards or firewalls."
      },
      {
        "id": "IR-4.3",
        "title": "Continuity of Operations",
        "official_text": "Identify classes of incidents and take actions in response to those incidents to ensure continuation of organizational mission and business functions."
      },
      {
        "id": "IR-4.4",
        "title": "Information Correlation",
        "official_text": "Correlate incident information and individual incident responses to achieve an organization-wide perspective on incident awareness and response."
      },
      {
        "id": "IR-4.5",
        "title": "Automatic Disabling of System",
        "official_text": "Implement a configurable capability to automatically disable the system if security violations are detected."
      },
      {
        "id": "IR-4.6",
        "title": "Insider Threats",
        "official_text": "Implement an incident handling capability for incidents involving insider threats."
      },
      {
        "id": "IR-4.7",
        "title": "Insider Threats - Intra-organization Coordination",
        "official_text": "Coordinate an incident handling capability for insider threats that includes human resources, legal counsel, management, and information security personnel."
      }
    ],
    "related_controls": [
      "AU-6",
      "CP-2",
      "CP-4",
      "IR-2",
      "IR-3",
      "IR-5",
      "IR-6",
      "IR-8",
      "PE-6",
      "SC-5",
      "SC-7",
      "SI-3",
      "SI-4"
    ],
    "supplemental_guidance": "Organizations recognize that incident response capabilities are dependent on the capabilities of organizational systems and the mission and business processes being supported by those systems. Organizations consider incident response as part of the definition, design, and development of mission and business processes and systems. Incident-related information can be obtained from a variety of sources, including audit monitoring, network monitoring, physical access monitoring, user/administrator reports, and reported supply chain events.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false
    },
    "intent": "Have a systematic process for handling security incidents from detection through resolution. Don't wing it - follow your playbook."
  },
  {
    "control_id": "IR-4.1",
    "control_name": "Automated Incident Handling Processes",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Support the incident handling process using automated mechanisms.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Use automated tools and systems to support incident handling activities. This includes SIEM systems for alert generation, ticketing systems for incident tracking, orchestration platforms for automated response actions, and integration between security tools to streamline the incident lifecycle from detection through resolution.",
    "example_implementation": "Deploy a SIEM platform (such as Splunk, Elastic SIEM, or Microsoft Sentinel) configured to correlate events from multiple sources and generate alerts based on detection rules. Integrate the SIEM with a ticketing system to automatically create incident tickets when high-severity alerts trigger. Implement SOAR playbooks for automated enrichment, notification, and initial containment actions.",
    "non_technical_guidance": "Automation in incident handling should augment human capabilities, not replace human judgment. Start by automating routine tasks such as alert triage, ticket creation, and stakeholder notification. Progress to automated containment actions only after thorough testing and with appropriate safeguards. Ensure automated systems have rollback capabilities and human override options. Regularly review and tune automated processes to reduce false positives and improve response accuracy.",
    "is_technical": true,
    "ai_guidance": "Automated incident handling is essential for organizations facing high volumes of security events that would overwhelm manual processes. The key architectural decision is selecting between a standalone SIEM with custom integrations versus an integrated SOAR platform. For SIEM integration, focus on the following priorities: (1) Ensure all critical security data sources feed into the SIEM including endpoint detection, network monitoring, cloud security logs, and identity systems; (2) Develop detection rules aligned with MITRE ATT&CK framework techniques relevant to your threat model; (3) Configure alert severity levels that map to response SLAs defined in your incident response plan; (4) Implement webhook or API integrations to push high-priority alerts to on-call systems like PagerDuty or Opsgenie. For SOAR implementation, create playbooks that automate: initial alert enrichment (IP reputation, domain reputation, user context), notification workflows, evidence collection, and basic containment actions. Always include human approval gates for actions with significant business impact such as network isolation or account disablement. Monitor automation effectiveness through metrics including mean time to detect, mean time to respond, and analyst workload distribution.",
    "implementation_rationale": "Humans are slow; computers are fast. Automated alerting means you find out about incidents in seconds instead of hours. Automated ticket creation ensures nothing gets lost. The goal is to let your team focus on thinking, not paperwork.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "SI-4",
      "AU-6",
      "CP-2"
    ],
    "supplemental_guidance": "Automated mechanisms for incident handling include online incident management systems and mechanisms that automatically track, collect, catalog, and analyze data and security information associated with incidents.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-4.1: Configure rsyslog to forward security events to SIEM\nSIEM_SERVER=\"siem.organization.local\"\nSIEM_PORT=\"514\"\n\n# Configure rsyslog forwarding\ncat > /etc/rsyslog.d/50-siem-forward.conf << 'EOF'\n# Forward auth and security logs to SIEM\nauth,authpriv.*    @@${SIEM_SERVER}:${SIEM_PORT}\n*.warn;auth.none   @@${SIEM_SERVER}:${SIEM_PORT}\nEOF\n\n# Configure auditd to log security events\ncat >> /etc/audit/rules.d/incident-detection.rules << 'EOF'\n# Monitor authentication failures\n-w /var/log/faillog -p wa -k auth_failures\n-w /var/log/lastlog -p wa -k auth_activity\n# Monitor privilege escalation\n-w /etc/sudoers -p wa -k sudo_config\n-a always,exit -F arch=b64 -S execve -F euid=0 -F auid>=1000 -k priv_exec\nEOF\n\n# Restart services\nsystemctl restart rsyslog\nservice auditd restart\necho \"SIEM forwarding configured successfully\"",
        "ansible": "---\n- name: IR-4.1 Configure SIEM Integration for Automated Incident Handling\n  hosts: all\n  become: yes\n  vars:\n    siem_server: \"siem.organization.local\"\n    siem_port: \"514\"\n  tasks:\n    - name: Install rsyslog if not present\n      package:\n        name: rsyslog\n        state: present\n\n    - name: Configure rsyslog SIEM forwarding\n      template:\n        src: siem-forward.conf.j2\n        dest: /etc/rsyslog.d/50-siem-forward.conf\n        mode: '0644'\n      notify: Restart rsyslog\n\n    - name: Configure auditd rules for incident detection\n      copy:\n        dest: /etc/audit/rules.d/incident-detection.rules\n        content: |\n          -w /var/log/faillog -p wa -k auth_failures\n          -w /var/log/lastlog -p wa -k auth_activity\n          -w /etc/sudoers -p wa -k sudo_config\n          -a always,exit -F arch=b64 -S execve -F euid=0 -F auid>=1000 -k priv_exec\n        mode: '0640'\n      notify: Restart auditd\n\n  handlers:\n    - name: Restart rsyslog\n      service:\n        name: rsyslog\n        state: restarted\n\n    - name: Restart auditd\n      service:\n        name: auditd\n        state: restarted"
      },
      "windows": {
        "powershell": "# IR-4.1: Configure Windows Event Forwarding to SIEM\n$SIEMCollector = \"siem.organization.local\"\n\n# Enable Windows Event Collector service\nSet-Service -Name Wecsvc -StartupType Automatic\nStart-Service -Name Wecsvc\n\n# Configure WinRM for event forwarding\nwinrm quickconfig -q\n\n# Create subscription for security events\n$SubscriptionXml = @\"\n<Subscription xmlns=\"http://schemas.microsoft.com/2006/03/windows/events/subscription\">\n  <SubscriptionId>SecurityEventForwarding</SubscriptionId>\n  <SubscriptionType>SourceInitiated</SubscriptionType>\n  <Description>Forward security events to SIEM</Description>\n  <Enabled>true</Enabled>\n  <Uri>http://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>\n  <Query>\n    <![CDATA[\n      <QueryList>\n        <Query Path=\"Security\">\n          <Select>*[System[(Level=1 or Level=2 or Level=3)]]</Select>\n          <Select>*[System[(EventID=4624 or EventID=4625 or EventID=4648)]]</Select>\n          <Select>*[System[(EventID=4672 or EventID=4673 or EventID=4674)]]</Select>\n        </Query>\n      </QueryList>\n    ]]>\n  </Query>\n  <ReadExistingEvents>false</ReadExistingEvents>\n  <TransportName>HTTP</TransportName>\n  <Delivery Mode=\"Push\">\n    <Batching>\n      <MaxLatencyTime>60000</MaxLatencyTime>\n    </Batching>\n  </Delivery>\n</Subscription>\n\"@\n\n# Enable advanced audit policy for incident detection\nauditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\nauditpol /set /subcategory:\"Account Lockout\" /success:enable /failure:enable\nauditpol /set /subcategory:\"Special Logon\" /success:enable /failure:enable\nauditpol /set /subcategory:\"Sensitive Privilege Use\" /success:enable /failure:enable\n\nWrite-Host \"SIEM event forwarding configured successfully\"",
        "ansible": "---\n- name: IR-4.1 Configure Windows Event Forwarding for Automated Incident Handling\n  hosts: windows\n  tasks:\n    - name: Enable Windows Event Collector service\n      win_service:\n        name: Wecsvc\n        start_mode: auto\n        state: started\n\n    - name: Configure WinRM\n      win_shell: winrm quickconfig -q\n\n    - name: Enable advanced audit policies\n      win_shell: |\n        auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Account Lockout\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Special Logon\" /success:enable /failure:enable\n        auditpol /set /subcategory:\"Sensitive Privilege Use\" /success:enable /failure:enable\n\n    - name: Configure Windows Event Log forwarding\n      win_shell: |\n        wecutil cs C:\\temp\\security-subscription.xml\n      args:\n        creates: C:\\Windows\\System32\\winevt\\Subscriptions\\SecurityEventForwarding"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "intent": "Use automation to speed up incident handling - automatic alerts, ticket creation, and initial response actions."
  },
  {
    "control_id": "IR-4.2",
    "control_name": "Dynamic Reconfiguration",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Include the following types of dynamic reconfiguration for organizational systems as part of the incident response capability: changes to router rules, access control lists, intrusion detection/prevention system parameters, and filter rules for guards or firewalls.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Enable the ability to dynamically modify system configurations during incident response. This includes changing firewall rules, updating intrusion detection signatures, modifying access control lists, and adjusting network routing to contain threats or protect critical assets in real-time during an active incident.",
    "example_implementation": "Implement network automation tools that allow incident responders to push emergency firewall rules to block malicious IP addresses or isolate compromised network segments. Configure IDS/IPS systems with APIs that permit rapid signature updates and threshold adjustments. Establish pre-approved change procedures that allow expedited modifications during declared incidents.",
    "non_technical_guidance": "Dynamic reconfiguration requires both technical capability and organizational authorization frameworks. Establish pre-approved change categories that can be implemented during incidents without full change advisory board review. Define clear escalation paths for changes that exceed pre-approved scopes. Ensure all dynamic changes are logged for post-incident review and rollback capability exists for all modifications. Train incident responders on available dynamic reconfiguration options and their business impacts.",
    "is_technical": true,
    "ai_guidance": "Dynamic reconfiguration capability is critical for containing rapidly evolving threats. The implementation requires establishing secure, authenticated APIs or management interfaces for all network and security infrastructure. Key architectural considerations include: (1) Implement infrastructure-as-code patterns where firewall rules, ACLs, and IDS configurations are version controlled, enabling rapid deployment and reliable rollback; (2) Use network automation platforms like Ansible, Terraform, or vendor-specific tools to execute pre-tested playbooks for common containment scenarios; (3) Segment the network to limit the blast radius of both incidents and dynamic reconfigurations; (4) Implement change logging that captures who made changes, what changed, and when, independent of the systems being modified; (5) Establish network isolation patterns that can quarantine systems while maintaining visibility for forensic analysis; (6) Test dynamic reconfiguration capabilities regularly through tabletop exercises and controlled implementation during maintenance windows. Consider implementing a tiered response model where Tier 1 actions (blocking external IPs) can be automated while Tier 2 actions (internal network changes) require human approval.",
    "implementation_rationale": "When an attacker is in your network, you need to respond in minutes, not days. Dynamic reconfiguration lets you contain threats immediately - quarantine an infected machine, block a malicious IP, or shut down a compromised service without waiting for change control.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "SC-7",
      "AC-4",
      "SI-4"
    ],
    "supplemental_guidance": "Dynamic reconfiguration can include changes to router rules, access control lists, intrusion detection and prevention system parameters, and filter rules for firewalls and gateways.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false
    },
    "intent": "Be able to quickly reconfigure your systems during an incident - block IPs, isolate systems, change firewall rules on the fly."
  },
  {
    "control_id": "IR-4.3",
    "control_name": "Continuity of Operations",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Identify classes of incidents and take actions in response to those incidents to ensure continuation of organizational mission and business functions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Categorize potential security incidents by their impact on business operations and develop specific response actions for each category that maintain business continuity. Different incident types require different responses - a ransomware attack may require switching to backup systems while a data breach may require isolating specific applications.",
    "example_implementation": "Create an incident classification matrix that maps incident types to business impact levels and corresponding continuity actions. For ransomware incidents affecting production systems, define failover procedures to disaster recovery sites. For data breach incidents, define procedures to isolate affected data stores while maintaining operational capability. Integrate incident response playbooks with business continuity plans.",
    "non_technical_guidance": "The intersection of incident response and business continuity requires coordination between security, operations, and business leadership. Develop incident categories based on both technical severity and business impact. For each category, define: (1) Maximum tolerable downtime before business impact becomes critical, (2) Required continuity actions and responsible parties, (3) Decision criteria for invoking disaster recovery procedures, (4) Communication requirements to business stakeholders, and (5) Success criteria for resuming normal operations. Test integrated incident response and continuity procedures annually.",
    "is_technical": false,
    "ai_guidance": "Continuity-focused incident handling bridges the gap between security operations and business resilience. When implementing IR-4.3, start by conducting a business impact analysis that identifies critical systems and their maximum tolerable downtime. Map common incident scenarios to these critical systems to understand which incidents pose the greatest continuity risk. Develop tiered response strategies: incidents affecting non-critical systems may allow for thorough investigation before remediation, while incidents affecting critical systems require immediate stabilization actions followed by investigation. Key implementation elements include: (1) Pre-staged recovery resources for critical systems that can be activated during incidents, (2) Documented manual workaround procedures for systems that cannot be quickly restored, (3) Communication templates for business stakeholders explaining service degradation and recovery timelines, (4) Clear decision authority for invoking business continuity measures during incidents, and (5) Recovery time objectives (RTO) and recovery point objectives (RPO) that inform incident response prioritization. Ensure incident commanders understand both technical and business impacts when making response decisions.",
    "implementation_rationale": "Some incidents threaten business survival. If your payment system goes down or your factory floor gets encrypted, you need a plan B. Identify your critical systems now and pre-plan how to keep the business running even during a major incident.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "CP-2",
      "CP-4",
      "CP-6",
      "CP-7"
    ],
    "supplemental_guidance": "Classes of incidents include malfunctions due to design or implementation errors, targeted malicious attacks, and untargeted malicious attacks.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false
    },
    "intent": "Plan ahead for incidents that could shut down critical business operations, and have workarounds ready."
  },
  {
    "control_id": "IR-4.4",
    "control_name": "Information Correlation",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Correlate incident information and individual incident responses to achieve an organization-wide perspective on incident awareness and response.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "Aggregate and correlate security event data from multiple sources across the organization to identify patterns, detect coordinated attacks, and develop a comprehensive understanding of the threat landscape. Individual incidents that appear unrelated when viewed in isolation may reveal organized attack campaigns when correlated.",
    "example_implementation": "Implement centralized log aggregation collecting events from endpoints, network devices, cloud services, and applications. Configure SIEM correlation rules to identify related events across systems based on common indicators such as IP addresses, user accounts, file hashes, and timing. Establish threat intelligence feeds that enrich events with external context about known threat actors and campaigns.",
    "non_technical_guidance": "Effective information correlation requires both technical integration and organizational processes. Ensure all business units and geographic locations feed security events to central correlation platforms. Establish data normalization standards so events from different sources can be meaningfully compared. Create correlation rule governance processes that balance detection effectiveness against alert fatigue. Develop regular reporting that communicates correlated threat intelligence to appropriate stakeholders including security leadership, IT operations, and business leadership when warranted.",
    "is_technical": true,
    "ai_guidance": "Information correlation transforms disconnected security events into actionable intelligence about threats facing the organization. Effective correlation depends on comprehensive data collection, proper normalization, and intelligent analysis. Begin by ensuring log coverage across all technology layers: endpoints (including EDR telemetry), network (firewall logs, DNS queries, proxy logs, NetFlow), identity systems (Active Directory, SSO platforms), cloud services (cloud provider logs, SaaS security events), and applications (particularly authentication and authorization events). Normalize event data using a common information model to enable cross-source correlation. Implement correlation rules at multiple levels: (1) Technical correlation linking events by common indicators of compromise (IOCs), (2) Temporal correlation identifying suspicious activity clusters, (3) Behavioral correlation detecting anomalies against established baselines, and (4) Campaign correlation using threat intelligence to identify known threat actor techniques. Advanced implementations should incorporate machine learning for anomaly detection and entity behavior analytics to identify compromised accounts. Maintain correlation rule efficacy through regular tuning based on true/false positive rates and emerging threat intelligence.",
    "implementation_rationale": "Attackers rarely trigger just one alert. By correlating information across your environment, you can see the full picture of an attack instead of chasing individual symptoms. A failed login here plus unusual file access there might equal an active breach.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "AU-6",
      "SI-4",
      "RA-5"
    ],
    "supplemental_guidance": "Cross-referencing incident information and sharing incident information can help the organization gain an organization-wide perspective on incident awareness and response.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-4.4: Configure centralized log correlation\n# Elasticsearch/Logstash configuration for log correlation\n\n# Variables\nELASTIC_HOST=\"elastic.organization.local\"\nLOGSTASH_CONF=\"/etc/logstash/conf.d/correlation.conf\"\n\n# Configure Filebeat to ship logs to central Elasticsearch\ncat > /etc/filebeat/filebeat.yml << EOF\nfilebeat.inputs:\n  - type: log\n    enabled: true\n    paths:\n      - /var/log/auth.log\n      - /var/log/secure\n      - /var/log/audit/audit.log\n    fields:\n      log_type: security\n      host_type: linux\n\n  - type: log\n    enabled: true  \n    paths:\n      - /var/log/syslog\n      - /var/log/messages\n    fields:\n      log_type: system\n\nprocessors:\n  - add_host_metadata: ~\n  - add_cloud_metadata: ~\n\noutput.elasticsearch:\n  hosts: [\"${ELASTIC_HOST}:9200\"]\n  index: \"security-logs-%{+yyyy.MM.dd}\"\nEOF\n\n# Enable Filebeat\nsystemctl enable filebeat\nsystemctl restart filebeat\n\necho \"Log correlation forwarding configured\"",
        "ansible": "---\n- name: IR-4.4 Configure Centralized Log Correlation\n  hosts: all\n  become: yes\n  vars:\n    elastic_host: \"elastic.organization.local\"\n    elastic_port: 9200\n  tasks:\n    - name: Install Filebeat\n      package:\n        name: filebeat\n        state: present\n\n    - name: Configure Filebeat for log correlation\n      template:\n        src: filebeat.yml.j2\n        dest: /etc/filebeat/filebeat.yml\n        mode: '0600'\n      notify: Restart Filebeat\n\n    - name: Enable Filebeat modules\n      command: filebeat modules enable system auditd\n      changed_when: false\n\n    - name: Load Filebeat dashboards\n      command: filebeat setup --dashboards\n      changed_when: false\n      run_once: true\n      delegate_to: localhost\n\n    - name: Enable and start Filebeat\n      service:\n        name: filebeat\n        enabled: yes\n        state: started\n\n  handlers:\n    - name: Restart Filebeat\n      service:\n        name: filebeat\n        state: restarted"
      },
      "windows": {
        "powershell": "# IR-4.4: Configure Windows log correlation forwarding\n# Winlogbeat configuration for centralized correlation\n\n$ElasticHost = \"elastic.organization.local\"\n$WinlogbeatPath = \"C:\\Program Files\\Winlogbeat\"\n\n# Create Winlogbeat configuration\n$WinlogbeatConfig = @\"\nwinlogbeat.event_logs:\n  - name: Security\n    event_id: 4624, 4625, 4634, 4648, 4672, 4673, 4688, 4689, 4697, 4698, 4699, 4700, 4701, 4702, 4719, 4720, 4722, 4723, 4724, 4725, 4726, 4738, 4740, 4767, 4768, 4769, 4771, 4776\n    \n  - name: System\n    event_id: 7045, 7040, 1074, 6005, 6006\n    \n  - name: Microsoft-Windows-Sysmon/Operational\n    \n  - name: Microsoft-Windows-PowerShell/Operational\n    event_id: 4103, 4104, 4105, 4106\n\nprocessors:\n  - add_host_metadata:\n      when.not.contains.tags: forwarded\n  - add_cloud_metadata: ~\n\noutput.elasticsearch:\n  hosts: [\"${ElasticHost}:9200\"]\n  index: \"winlogbeat-%{+yyyy.MM.dd}\"\n\nlogging.level: info\nlogging.to_files: true\nlogging.files:\n  path: C:\\ProgramData\\winlogbeat\\Logs\n\"@\n\n# Write configuration\n$WinlogbeatConfig | Out-File -FilePath \"$WinlogbeatPath\\winlogbeat.yml\" -Encoding UTF8\n\n# Install and start Winlogbeat service\n& \"$WinlogbeatPath\\install-service-winlogbeat.ps1\"\nStart-Service winlogbeat\n\nWrite-Host \"Windows log correlation configured successfully\"",
        "ansible": "---\n- name: IR-4.4 Configure Windows Log Correlation\n  hosts: windows\n  vars:\n    elastic_host: \"elastic.organization.local\"\n    winlogbeat_version: \"8.11.0\"\n  tasks:\n    - name: Download Winlogbeat\n      win_get_url:\n        url: \"https://artifacts.elastic.co/downloads/beats/winlogbeat/winlogbeat-{{ winlogbeat_version }}-windows-x86_64.zip\"\n        dest: \"C:\\\\temp\\\\winlogbeat.zip\"\n\n    - name: Extract Winlogbeat\n      win_unzip:\n        src: \"C:\\\\temp\\\\winlogbeat.zip\"\n        dest: \"C:\\\\Program Files\"\n\n    - name: Configure Winlogbeat\n      win_template:\n        src: winlogbeat.yml.j2\n        dest: \"C:\\\\Program Files\\\\Winlogbeat\\\\winlogbeat.yml\"\n\n    - name: Install Winlogbeat service\n      win_shell: |\n        & \"C:\\Program Files\\Winlogbeat\\install-service-winlogbeat.ps1\"\n\n    - name: Start Winlogbeat service\n      win_service:\n        name: winlogbeat\n        state: started\n        start_mode: auto"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "intent": "Connect the dots between different incidents and alerts. What looks like three small problems might actually be one big attack."
  },
  {
    "control_id": "IR-4.5",
    "control_name": "Automatic Disabling of System",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Implement a configurable capability to automatically disable the system if security violations are detected.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Create automated mechanisms that can disable or isolate systems when serious security violations are detected. This provides immediate containment of threats before they can spread or cause additional damage, particularly important for protecting high-value assets or systems processing sensitive data.",
    "example_implementation": "Configure endpoint detection and response (EDR) solutions to automatically isolate endpoints when critical malware indicators are detected. Implement network access control that quarantines systems failing security health checks. Deploy intrusion prevention systems that can block traffic to/from systems exhibiting attack behaviors.",
    "non_technical_guidance": "Automatic system disabling is a high-impact capability that requires careful governance. Define specific, measurable conditions that trigger automatic disabling, ensuring they represent genuine security threats rather than operational anomalies. Establish override procedures for authorized personnel to restore disabled systems. Create monitoring to ensure disabled systems remain contained until properly remediated. Document all automatic disabling events for post-incident analysis. Consider the business impact of false positives and tune detection thresholds accordingly.",
    "is_technical": true,
    "ai_guidance": "Automatic system disabling represents the most aggressive automated response capability and must be implemented with careful consideration of operational impact. The capability should be reserved for high-confidence, high-severity threat detections where immediate containment outweighs the cost of potential false positives. Implementation approaches include: (1) EDR-based isolation that disconnects endpoints from the network while maintaining management connectivity for investigation and remediation, (2) Network-based quarantine using 802.1X or software-defined networking to move compromised systems to isolated VLANs, (3) Application-layer controls that disable user accounts or revoke access tokens when compromise indicators are detected, and (4) Cloud-native controls that suspend virtual machines or containerized workloads. Critical design considerations include: defining clear trigger conditions based on high-fidelity indicators, implementing tiered response levels where less impactful actions precede full isolation, ensuring forensic evidence preservation during the disabling process, providing secure out-of-band access for incident responders to investigate isolated systems, and creating documented procedures for safely re-enabling systems after remediation. Test automatic disabling capabilities regularly to ensure they function as expected without causing unintended business disruption.",
    "implementation_rationale": "Sometimes you need to act faster than humans can respond. Automatic system disabling can stop ransomware before it spreads or disconnect a compromised server before data is stolen. It's like a circuit breaker - sacrifice one system to save the rest.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "SI-4",
      "SC-7",
      "AC-3"
    ],
    "supplemental_guidance": "Security violations include unauthorized changes to hardware, software, or firmware components.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-4.5: Automatic threat response and system isolation\n# Configurable thresholds for automatic containment\n\nLOG_FILE=\"/var/log/ir-4.5-autoresponse.log\"\nQUARANTINE_VLAN=\"999\"\nMAX_FAILED_AUTH=10\nCHECK_INTERVAL=60\n\nlog_event() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" >> \"$LOG_FILE\"\n}\n\n# Function to isolate system\nisolate_system() {\n    REASON=$1\n    log_event \"ISOLATION TRIGGERED: $REASON\"\n    \n    # Disable network except management interface\n    for iface in $(ip link show | grep -oP '^\\d+: \\K[^:@]+' | grep -v lo | grep -v mgmt); do\n        ip link set \"$iface\" down\n        log_event \"Interface $iface disabled\"\n    done\n    \n    # Block all outbound except management\n    iptables -I OUTPUT -p tcp ! --dport 22 -j DROP\n    iptables -I OUTPUT -p udp -j DROP\n    log_event \"Outbound traffic blocked\"\n    \n    # Alert SOC\n    logger -p auth.crit \"IR-4.5: System isolated - $REASON\"\n}\n\n# Monitor for brute force attacks\ncheck_auth_failures() {\n    FAILURES=$(grep -c 'authentication failure' /var/log/auth.log 2>/dev/null || echo 0)\n    if [ \"$FAILURES\" -gt \"$MAX_FAILED_AUTH\" ]; then\n        isolate_system \"Excessive authentication failures: $FAILURES\"\n        return 1\n    fi\n    return 0\n}\n\n# Monitor for suspicious processes\ncheck_suspicious_processes() {\n    # Check for known malware process names\n    SUSPICIOUS=$(pgrep -l 'cryptominer|xmrig|kinsing|dota' 2>/dev/null)\n    if [ -n \"$SUSPICIOUS\" ]; then\n        isolate_system \"Suspicious process detected: $SUSPICIOUS\"\n        # Kill the process\n        pkill -9 'cryptominer|xmrig|kinsing|dota'\n        return 1\n    fi\n    return 0\n}\n\nlog_event \"IR-4.5 Auto-response monitoring started\"\necho \"Automatic threat response monitoring active\"",
        "ansible": "---\n- name: IR-4.5 Configure Automatic Threat Response\n  hosts: all\n  become: yes\n  vars:\n    max_failed_auth: 10\n    quarantine_vlan: 999\n  tasks:\n    - name: Install fail2ban for automatic response\n      package:\n        name: fail2ban\n        state: present\n\n    - name: Configure fail2ban jail for SSH brute force\n      copy:\n        dest: /etc/fail2ban/jail.d/ssh-aggressive.conf\n        content: |\n          [sshd-aggressive]\n          enabled = true\n          port = ssh\n          filter = sshd\n          logpath = /var/log/auth.log\n          maxretry = {{ max_failed_auth }}\n          bantime = -1\n          findtime = 3600\n          action = iptables-allports[name=SSH]\n                   %(action_mwl)s\n        mode: '0644'\n      notify: Restart fail2ban\n\n    - name: Deploy automatic isolation script\n      copy:\n        dest: /usr/local/bin/ir-4.5-isolate.sh\n        mode: '0700'\n        content: |\n          #!/bin/bash\n          # Isolate system and alert SOC\n          logger -p auth.crit \"IR-4.5: System isolation triggered by $1\"\n          for iface in $(ip link show | grep -oP '^\\d+: \\K[^:@]+' | grep -v lo); do\n            ip link set \"$iface\" down 2>/dev/null\n          done\n\n    - name: Configure auditd to trigger on critical events\n      copy:\n        dest: /etc/audit/rules.d/ir-4.5-triggers.rules\n        content: |\n          -w /etc/passwd -p wa -k identity_modification\n          -w /etc/shadow -p wa -k identity_modification\n          -a always,exit -F arch=b64 -S ptrace -k process_injection\n        mode: '0640'\n      notify: Restart auditd\n\n  handlers:\n    - name: Restart fail2ban\n      service:\n        name: fail2ban\n        state: restarted\n\n    - name: Restart auditd\n      service:\n        name: auditd\n        state: restarted"
      },
      "windows": {
        "powershell": "# IR-4.5: Automatic threat response for Windows\n# Configure automatic containment for security violations\n\n$LogPath = \"C:\\ProgramData\\IR-4.5\\autoresponse.log\"\n$MaxFailedAuth = 10\n$LockoutDurationMinutes = 1440\n\n# Create log directory\nif (!(Test-Path (Split-Path $LogPath))) {\n    New-Item -ItemType Directory -Path (Split-Path $LogPath) -Force\n}\n\nfunction Write-IRLog {\n    param([string]$Message)\n    $Timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    \"$Timestamp - $Message\" | Out-File -FilePath $LogPath -Append\n}\n\nfunction Invoke-SystemIsolation {\n    param([string]$Reason)\n    \n    Write-IRLog \"ISOLATION TRIGGERED: $Reason\"\n    \n    # Disable all network adapters except management\n    Get-NetAdapter | Where-Object {$_.Name -notlike \"*Management*\"} | Disable-NetAdapter -Confirm:$false\n    \n    # Block all outbound traffic\n    New-NetFirewallRule -DisplayName \"IR-4.5 Emergency Block\" -Direction Outbound -Action Block -Enabled True -Profile Any\n    \n    # Alert via Event Log\n    Write-EventLog -LogName Security -Source \"IR-4.5\" -EventId 9999 -EntryType Error -Message \"System isolated: $Reason\"\n    \n    Write-IRLog \"System isolated successfully\"\n}\n\n# Configure account lockout policy\nnet accounts /lockoutthreshold:$MaxFailedAuth /lockoutduration:$LockoutDurationMinutes /lockoutwindow:30\n\n# Create scheduled task to monitor for threats\n$Action = New-ScheduledTaskAction -Execute \"PowerShell.exe\" -Argument @\"\n-NoProfile -ExecutionPolicy Bypass -Command {\n    # Check for excessive failed logons\n    `$FailedLogons = (Get-WinEvent -FilterHashtable @{LogName='Security';ID=4625;StartTime=(Get-Date).AddHours(-1)} -ErrorAction SilentlyContinue | Measure-Object).Count\n    if (`$FailedLogons -gt $MaxFailedAuth) {\n        # Trigger isolation\n        & 'C:\\ProgramData\\IR-4.5\\Invoke-Isolation.ps1' -Reason \"Excessive failed logons: `$FailedLogons\"\n    }\n    \n    # Check for suspicious processes\n    `$Suspicious = Get-Process | Where-Object {`$_.Name -match 'cryptominer|xmrig|mimikatz'}\n    if (`$Suspicious) {\n        `$Suspicious | Stop-Process -Force\n        & 'C:\\ProgramData\\IR-4.5\\Invoke-Isolation.ps1' -Reason \"Malicious process detected: `$(`$Suspicious.Name)\"\n    }\n}\n\"@\n\n$Trigger = New-ScheduledTaskTrigger -Once -At (Get-Date) -RepetitionInterval (New-TimeSpan -Minutes 5)\n$Settings = New-ScheduledTaskSettingsSet -ExecutionTimeLimit (New-TimeSpan -Minutes 10)\n\nRegister-ScheduledTask -TaskName \"IR-4.5-ThreatMonitor\" -Action $Action -Trigger $Trigger -Settings $Settings -User \"SYSTEM\" -RunLevel Highest\n\nWrite-Host \"IR-4.5 Automatic threat response configured\"",
        "ansible": "---\n- name: IR-4.5 Configure Windows Automatic Threat Response\n  hosts: windows\n  vars:\n    max_failed_auth: 10\n    lockout_duration: 1440\n  tasks:\n    - name: Create IR-4.5 directory\n      win_file:\n        path: C:\\ProgramData\\IR-4.5\n        state: directory\n\n    - name: Deploy isolation script\n      win_copy:\n        dest: C:\\ProgramData\\IR-4.5\\Invoke-Isolation.ps1\n        content: |\n          param([string]$Reason)\n          Get-NetAdapter | Where-Object {$_.Name -notlike \"*Management*\"} | Disable-NetAdapter -Confirm:$false\n          New-NetFirewallRule -DisplayName \"IR-4.5 Emergency Block\" -Direction Outbound -Action Block -Enabled True\n          Write-EventLog -LogName Security -Source \"IR-4.5\" -EventId 9999 -EntryType Error -Message \"Isolated: $Reason\"\n\n    - name: Configure account lockout policy\n      win_security_policy:\n        section: System Access\n        key: LockoutBadCount\n        value: \"{{ max_failed_auth }}\"\n\n    - name: Create threat monitoring scheduled task\n      win_scheduled_task:\n        name: IR-4.5-ThreatMonitor\n        actions:\n          - path: PowerShell.exe\n            arguments: -File C:\\ProgramData\\IR-4.5\\Monitor-Threats.ps1\n        triggers:\n          - type: registration\n            repetition:\n              interval: PT5M\n        username: SYSTEM\n        run_level: highest\n        state: present"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    },
    "intent": "Set up automatic kill switches that can shut down compromised systems before attackers can do more damage."
  },
  {
    "control_id": "IR-4.6",
    "control_name": "Insider Threats",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Implement an incident handling capability for incidents involving insider threats.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Develop specialized procedures for handling security incidents that involve current or former employees, contractors, or other insiders with legitimate access to organizational systems. Insider threat incidents require different handling procedures due to the insider's knowledge of systems, potential legal implications, and the need for discretion during investigation.",
    "example_implementation": "Create insider threat incident playbooks that address evidence preservation, legal coordination, human resources involvement, and discrete investigation techniques. Implement user activity monitoring that can detect anomalous behavior patterns. Establish secure evidence handling procedures that maintain chain of custody for potential legal proceedings.",
    "non_technical_guidance": "Insider threat incident handling requires coordination across multiple organizational functions. Establish clear protocols for involving human resources, legal counsel, and management at appropriate stages of investigation. Ensure investigators have authority to access relevant systems and data without alerting the subject. Develop procedures for handling different insider threat scenarios including data theft, sabotage, fraud, and espionage. Create guidelines for determining when to involve law enforcement. Document all investigative actions to support potential disciplinary or legal proceedings.",
    "is_technical": false,
    "ai_guidance": "Insider threat incident handling presents unique challenges compared to external threat response. The fundamental tension is between thorough investigation and the risk of alerting the insider, who may then destroy evidence or accelerate harmful activities. Key procedural elements include: (1) Establishing a small, need-to-know investigation team that operates outside normal incident response channels, (2) Implementing covert monitoring capabilities that can capture insider activities without their awareness, (3) Coordinating with legal counsel from the outset to ensure evidence admissibility and protect the organization from wrongful termination claims, (4) Developing interview protocols for when/how to approach the suspected insider, (5) Creating procedures for preserving access and evidence when the insider's access must be terminated, and (6) Establishing criteria for involving law enforcement. Technical capabilities should include user behavior analytics (UBA) to baseline normal behavior and detect anomalies, data loss prevention (DLP) to identify unauthorized data movement, privileged access monitoring to detect abuse of administrative access, and email/communication monitoring where legally permitted. Ensure all monitoring activities comply with applicable privacy laws and are documented in employee agreements.",
    "implementation_rationale": "Insider threats are tricky because the attacker already has keys to the kingdom. You can't just block their IP. Insider incident handling requires careful evidence preservation, HR involvement, and often legal coordination. Different threat, different playbook.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-4.7",
      "PM-12",
      "PS-4",
      "PS-5",
      "PS-7"
    ],
    "supplemental_guidance": "Insider threats include organizational insiders acting independently or in collaboration with external entities. The incident handling capability for insider threats may be the same as, or separate from, the capability for external threats based on organizational needs and threat assessment.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false
    },
    "intent": "Have special procedures for when the threat comes from inside - employees, contractors, or partners with legitimate access."
  },
  {
    "control_id": "IR-4.7",
    "control_name": "Insider Threats - Intra-organization Coordination",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-4",
    "official_text": "Coordinate an incident handling capability for insider threats that includes human resources, legal counsel, management, and information security personnel.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Establish formal coordination mechanisms between security, human resources, legal, and management for handling insider threat incidents. Each function plays a critical role: security provides technical investigation capability, HR manages employment implications, legal ensures compliance with laws and protects organizational interests, and management provides decision authority.",
    "example_implementation": "Create an insider threat working group with representatives from information security, human resources, legal, and business leadership. Develop a coordination charter defining roles, responsibilities, and escalation procedures. Establish secure communication channels for sensitive discussions. Conduct annual exercises to test coordination effectiveness.",
    "non_technical_guidance": "Effective insider threat coordination requires pre-established relationships and clear procedures. Key coordination elements include: (1) Defined trigger criteria for convening the insider threat working group, (2) Clear roles for each function: security leads technical investigation, HR handles employment actions, legal provides guidance on evidence and procedures, management approves significant decisions, (3) Escalation procedures for involving senior leadership or law enforcement, (4) Information sharing protocols that balance investigation needs with privacy protections, (5) Decision authority matrix for actions such as access suspension, leave placement, or termination, and (6) Post-incident review processes to improve coordination. Regular meetings and exercises maintain coordination readiness even when no active investigations exist.",
    "is_technical": false,
    "ai_guidance": "Intra-organization coordination for insider threats transforms an IT security problem into a managed organizational response. The coordination framework should operate at multiple levels: operational coordination for active investigations, tactical coordination for program governance, and strategic coordination for policy and resource decisions. Establish the following structural elements: (1) An insider threat program manager who serves as the coordination hub and maintains situational awareness across all active concerns, (2) A standing working group that meets regularly to review indicators, assess risks, and ensure program readiness, (3) An executive steering committee that provides oversight and makes high-impact decisions, and (4) Clear protocols for convening ad-hoc investigation teams when specific concerns arise. Define specific scenarios and corresponding coordination requirements: preliminary concerns may require only security and HR awareness, active investigations require full working group involvement, and imminent threat scenarios require immediate management engagement. Document coordination activities in a secure case management system that tracks all parties involved, decisions made, and actions taken. This documentation supports both operational consistency and potential legal proceedings. Consider engaging external resources such as forensic specialists or outside counsel for high-stakes investigations to provide independence and specialized expertise.",
    "implementation_rationale": "Insider incidents are as much about people as technology. HR needs to handle employment issues, legal needs to protect the organization, physical security may need to escort someone out. A purely technical response misses half the problem.",
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-4.6",
      "PM-12",
      "PS-4",
      "PS-7"
    ],
    "supplemental_guidance": "Coordination with organizational entities such as human resources, legal, and management is essential for properly handling insider threat incidents.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false
    },
    "intent": "Make sure HR, legal, physical security, and IT all work together on insider threat incidents - these aren't just IT problems."
  },
  {
    "control_id": "IR-4.8",
    "control_name": "Correlation with External Organizations",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Coordinate with external organizations to correlate and share incident information to achieve a cross-organization perspective on incident awareness and more effective incident responses.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to establish formal coordination mechanisms with external entities such as ISACs (Information Sharing and Analysis Centers), CISA, sector-specific partners, and peer organizations to share threat intelligence, incident indicators, and response strategies. The goal is to achieve situational awareness that transcends organizational boundaries, enabling faster detection of widespread threats and more coordinated response efforts.",
    "ai_guidance": "Implementing IR-4.8 requires establishing formal information sharing agreements with external organizations including sector-specific ISACs, government agencies like CISA, and trusted industry partners. Organizations should deploy STIX/TAXII-compatible threat intelligence platforms to automate the bidirectional exchange of indicators of compromise (IOCs), tactics, techniques, and procedures (TTPs), and incident timelines. Critical implementation considerations include: (1) Legal review of information sharing agreements to address liability, attribution, and confidentiality concerns; (2) Data sanitization procedures to remove sensitive organizational identifiers before external sharing; (3) Tiered sharing protocols based on TLP (Traffic Light Protocol) classifications; (4) Real-time correlation engines that match internal incidents against externally shared intelligence; (5) Secure communication channels using encrypted protocols for sensitive incident data exchange. Organizations should establish a dedicated external liaison role within the incident response team, participate in regular cross-organizational exercises, and maintain updated contact lists for rapid coordination during active incidents. The effectiveness of this control depends heavily on trust relationships built over time through consistent participation in sharing communities.",
    "implementation_rationale": "Attackers reuse tactics. If your industry peer gets hit with a new attack, that information can help you defend yourself. Information sharing through ISACs and trusted partnerships multiplies everyone's defensive capabilities.",
    "non_technical_guidance": "To implement this control: (1) Identify and join relevant ISACs for your industry sector; (2) Establish formal MOUs or information sharing agreements with partner organizations; (3) Designate personnel authorized to share and receive external incident information; (4) Create classification guidelines for determining what can be shared externally; (5) Develop procedures for sanitizing incident data before sharing; (6) Maintain secure communication channels with external partners; (7) Participate in joint incident response exercises; (8) Document all external sharing activities for audit purposes. Regular review of sharing relationships ensures continued value and compliance with evolving regulatory requirements.",
    "example_implementation": "Organization establishes membership in sector-specific ISAC, deploys TAXII server for automated threat intelligence sharing, and conducts quarterly joint incident response exercises with critical supply chain partners.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "PM-15",
      "PM-16",
      "SI-5"
    ],
    "supplemental_guidance": "External coordination should be established before incidents occur. Pre-existing relationships enable rapid information exchange during active incidents when time is critical.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "intent": "Share incident information with other organizations and industry groups - what hits them today might hit you tomorrow."
  },
  {
    "control_id": "IR-4.9",
    "control_name": "Dynamic Response Capability",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Employ dynamic response capabilities to respond to incidents.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to implement incident response capabilities that can adapt in real-time to evolving threat conditions. Rather than relying solely on predefined static playbooks, dynamic response leverages automation, orchestration, and adaptive decision-making to modify containment and eradication strategies as new information becomes available during an incident.",
    "ai_guidance": "Dynamic response capability implementation requires deployment of Security Orchestration, Automation, and Response (SOAR) platforms that enable real-time adaptation of incident response actions based on evolving threat intelligence and system state. Key technical components include: (1) Automated playbook engines with conditional logic that adjust response actions based on IOC matching, asset criticality, and threat severity; (2) API integrations with security tools (EDR, SIEM, firewalls, identity systems) enabling automated containment actions; (3) Machine learning models that recommend response actions based on historical incident patterns; (4) Real-time threat intelligence feeds that automatically update response parameters; (5) Dynamic network segmentation capabilities that can isolate compromised segments without manual intervention. Organizations should implement graduated response tiers that automatically escalate containment measures as threat indicators increase. Critical success factors include maintaining up-to-date asset inventories, establishing automated rollback procedures for false positives, and implementing human-in-the-loop checkpoints for high-impact automated actions. Regular testing of dynamic response capabilities through red team exercises validates effectiveness under realistic conditions.",
    "implementation_rationale": "Not every incident should be handled the same way. Sometimes you want to quietly monitor an attacker to understand the full scope. Other times you need to immediately contain the threat. Having multiple response options lets you choose the right approach for each situation.",
    "non_technical_guidance": "Implement this control by: (1) Deploying SOAR or similar orchestration platform; (2) Developing adaptive playbooks with decision branches based on threat indicators; (3) Integrating response tools via APIs for automated actions; (4) Establishing graduated response levels with clear escalation criteria; (5) Training incident responders on dynamic tool capabilities; (6) Testing adaptive responses through tabletop and technical exercises; (7) Documenting conditions that trigger automated responses; (8) Creating rollback procedures for automated actions that cause unintended impacts.",
    "example_implementation": "Organization deploys SOAR platform with adaptive playbooks that automatically escalate from network monitoring to endpoint isolation to full network segmentation based on spreading indicators detected during ransomware incidents.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-4.1",
      "SI-4",
      "SC-7"
    ],
    "supplemental_guidance": "Dynamic response requires robust change management to prevent automated actions from causing operational disruptions. Balance automation speed against risk of false positive impacts.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "intent": "Have flexible response options ready - sometimes you need to observe an attacker, sometimes you need to kick them out immediately."
  },
  {
    "control_id": "IR-4.10",
    "control_name": "Supply Chain Coordination",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Coordinate incident handling activities involving supply chain events with other organizations involved in the supply chain.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to establish incident response coordination mechanisms with supply chain partners including vendors, suppliers, service providers, and customers. When security incidents affect supply chain relationships, coordinated response ensures containment actions do not inadvertently propagate impacts and that all affected parties can take appropriate protective measures.",
    "ai_guidance": "Supply chain incident coordination demands formalized communication protocols, pre-established contacts, and clear data sharing boundaries with upstream and downstream partners. Implementation requires: (1) Contractual clauses mandating incident notification timeframes and information sharing requirements with all critical suppliers; (2) Secure communication channels (encrypted email, secure portals, dedicated hotlines) for incident coordination; (3) Software Bill of Materials (SBOM) tracking systems that enable rapid identification of supply chain component vulnerabilities; (4) Vendor risk assessment processes that include incident response capability evaluation; (5) Joint incident response procedures documented in supplier agreements; (6) Automated dependency scanning that alerts when supplier-disclosed vulnerabilities affect organizational assets. Organizations should maintain tiered supplier lists based on criticality, with differentiated notification and coordination procedures for each tier. Integration with vulnerability disclosure platforms (NVD, vendor security advisories) enables proactive identification of supply chain risks before exploitation. Regular joint exercises with critical suppliers validate coordination procedures under realistic conditions.",
    "implementation_rationale": "Modern supply chains are interconnected. If your cloud provider has a breach, you need to know. If you have a breach that might affect your customers, they need to know. Established communication channels prevent finger-pointing and speed up response.",
    "non_technical_guidance": "Implement supply chain coordination by: (1) Identifying critical supply chain partners requiring incident coordination; (2) Establishing contractual incident notification requirements; (3) Creating secure communication channels for sensitive incident information; (4) Developing joint incident response procedures with key suppliers; (5) Maintaining current contact lists for supplier security teams; (6) Conducting periodic joint exercises to test coordination; (7) Integrating SBOM tracking into vulnerability management; (8) Documenting supply chain incident response roles and responsibilities.",
    "example_implementation": "Organization requires contractual 24-hour incident notification from critical vendors, maintains secure portal for sharing IOCs with supply chain partners, and conducts annual joint incident response exercises with top 10 suppliers.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-6.3",
      "SR-8",
      "PM-30"
    ],
    "supplemental_guidance": "Supply chain coordination requires balancing transparency with confidentiality. Establish clear guidelines on what incident information can be shared with different partner tiers.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "intent": "Coordinate with your vendors and suppliers when incidents affect shared systems or data."
  },
  {
    "control_id": "IR-4.11",
    "control_name": "Integrated Incident Response Team",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Establish and maintain an integrated incident response team that can be deployed to any location identified by the organization in organization-defined time period.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "This control requires organizations to maintain a dedicated incident response team with cross-functional expertise that can be rapidly deployed to any organizational location. The team integrates technical, legal, communications, and management capabilities to provide comprehensive incident handling regardless of where incidents occur within the enterprise.",
    "ai_guidance": "Integrated incident response teams require careful composition, training, and logistical preparation for rapid deployment. Implementation encompasses: (1) Team composition including technical analysts (forensics, malware analysis, network analysis), legal counsel, HR representatives, communications specialists, and executive liaisons; (2) Deployment kits containing forensic hardware, network analysis tools, secure communication devices, and documentation templates; (3) Pre-positioned equipment at geographically distributed locations to reduce deployment time; (4) Travel logistics including pre-approved travel authorizations, preferred vendor arrangements, and emergency procurement procedures; (5) Secure remote access capabilities enabling team members to begin analysis before physical arrival; (6) Clear command structure defining incident commander role and decision authority; (7) Cross-training ensuring team members can perform multiple roles during extended incidents. Organizations should establish deployment time objectives based on asset criticality, with faster response for critical infrastructure. Regular deployment exercises validate logistics and identify gaps. Team members require specialized training in incident handling frameworks (NIST, SANS), forensic methodology, and legal evidence preservation.",
    "implementation_rationale": "Incidents don't always happen at headquarters. A mobile response team can provide expert assistance wherever it's needed. Whether it's a compromised laptop in a remote office or a breach in your AWS environment, you need people who can respond on-site or virtually.",
    "non_technical_guidance": "Build an integrated response team by: (1) Defining required team roles and competencies; (2) Recruiting or developing personnel with required skills; (3) Creating deployment procedures with defined activation criteria; (4) Assembling deployable toolkits with necessary equipment; (5) Establishing travel logistics and pre-authorizations; (6) Conducting regular deployment exercises; (7) Maintaining team member availability through on-call rotations; (8) Documenting lessons learned from each deployment to improve procedures.",
    "example_implementation": "Organization maintains 6-person integrated response team with forensics, legal, communications, and management expertise. Team can deploy anywhere globally within 24 hours using pre-positioned equipment caches and pre-approved travel protocols.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-2",
      "IR-10"
    ],
    "supplemental_guidance": "Team sustainability requires rotation schedules preventing burnout. Consider hybrid models with core internal team augmented by contracted specialists for extended incidents.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "intent": "Have a trained incident response team that can deploy anywhere - your main office, branch locations, or cloud environments."
  },
  {
    "control_id": "IR-4.12",
    "control_name": "Malicious Code and Forensic Analysis",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Analyze malicious code and/or other residual artifacts remaining in the system after the incident.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to conduct forensic analysis of malicious code samples and other artifacts discovered during incident investigation. Analysis reveals attacker tactics, enables development of detection signatures, and informs remediation completeness verification. This capability is essential for understanding sophisticated attacks and preventing recurrence.",
    "ai_guidance": "Malicious code and forensic analysis requires specialized tooling, isolated analysis environments, and trained personnel. Technical implementation includes: (1) Isolated malware analysis sandbox environments (Cuckoo, Any.Run, Joe Sandbox) that detonate samples safely while capturing behavioral indicators; (2) Static analysis tools for disassembly and decompilation (Ghidra, IDA Pro, Binary Ninja) enabling code-level examination; (3) YARA rule development capabilities for creating custom detection signatures from analyzed samples; (4) Memory forensics tools (Volatility, Rekall) for analyzing RAM dumps captured from compromised systems; (5) Disk forensics platforms (Autopsy, FTK, EnCase) for file system artifact examination; (6) Network traffic analysis tools (Wireshark, Zeek) for PCAP examination; (7) Log aggregation and analysis platforms for timeline reconstruction. Organizations should establish evidence handling procedures maintaining chain of custody for potential legal proceedings. Analysis results should feed back into detection engineering, enabling development of SIEM rules, EDR signatures, and network detection patterns. Integration with threat intelligence platforms enables correlation of analyzed samples with known threat actor campaigns.",
    "implementation_rationale": "Cleaning up isn't enough. Understanding HOW you were attacked reveals whether the same vulnerability exists elsewhere, what data was accessed, and how to prevent future attacks. Forensic analysis turns a painful incident into valuable intelligence.",
    "non_technical_guidance": "Establish forensic analysis capability by: (1) Acquiring and maintaining forensic analysis tools; (2) Building isolated analysis environments; (3) Training personnel in forensic methodology; (4) Developing evidence handling procedures; (5) Creating analysis documentation templates; (6) Establishing malware sample handling protocols; (7) Integrating analysis results with detection engineering; (8) Maintaining relationships with external analysis resources for complex samples.",
    "example_implementation": "Organization operates isolated malware analysis lab with sandbox detonation, static analysis workstations, and forensic imaging stations. Analysis outputs include YARA signatures, SIEM detection rules, and detailed incident reports.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "SI-3",
      "AU-12",
      "SC-44"
    ],
    "supplemental_guidance": "Malware analysis environments require strict isolation to prevent accidental infection. Consider cloud-based analysis services for organizations lacking dedicated analysis capability.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-4.12: YARA-based malware scanning\n# Scans directory for known malware signatures\n\nYARA_RULES=\"/opt/yara-rules/index.yar\"\nSCAN_DIR=\"${1:-/tmp/quarantine}\"\nOUTPUT_FILE=\"/var/log/ir/yara_scan_$(date +%Y%m%d_%H%M%S).log\"\n\nif [ ! -f \"$YARA_RULES\" ]; then\n    echo \"[ERROR] YARA rules not found at $YARA_RULES\"\n    exit 1\nfi\n\necho \"[IR-4.12] Starting YARA scan at $(date)\" | tee \"$OUTPUT_FILE\"\necho \"Scanning: $SCAN_DIR\" | tee -a \"$OUTPUT_FILE\"\n\nyara -r -s \"$YARA_RULES\" \"$SCAN_DIR\" 2>&1 | tee -a \"$OUTPUT_FILE\"\n\necho \"[IR-4.12] Scan complete at $(date)\" | tee -a \"$OUTPUT_FILE\"",
        "clamav_scan": "#!/bin/bash\n# IR-4.12: ClamAV malware scanning\n# Performs comprehensive scan with signature updates\n\nSCAN_DIR=\"${1:-/tmp/quarantine}\"\nLOG_DIR=\"/var/log/ir\"\nOUTPUT_FILE=\"$LOG_DIR/clamav_scan_$(date +%Y%m%d_%H%M%S).log\"\n\nmkdir -p \"$LOG_DIR\"\n\necho \"[IR-4.12] Updating ClamAV signatures...\" | tee \"$OUTPUT_FILE\"\nfreshclam --quiet 2>&1 | tee -a \"$OUTPUT_FILE\"\n\necho \"[IR-4.12] Starting ClamAV scan at $(date)\" | tee -a \"$OUTPUT_FILE\"\nclamscan -r -i --bell --log=\"$OUTPUT_FILE\" \"$SCAN_DIR\"\n\nINFECTED=$(grep -c 'FOUND' \"$OUTPUT_FILE\" || echo \"0\")\necho \"[IR-4.12] Scan complete. Infected files found: $INFECTED\" | tee -a \"$OUTPUT_FILE\"",
        "collect_forensic_artifacts": "#!/bin/bash\n# IR-4.12: Forensic artifact collection\n# Collects system artifacts for analysis\n\nOUTPUT_DIR=\"/tmp/forensics/$(hostname)_$(date +%Y%m%d_%H%M%S)\"\nmkdir -p \"$OUTPUT_DIR\"/{memory,disk,network,logs}\n\necho \"[IR-4.12] Collecting forensic artifacts to $OUTPUT_DIR\"\n\n# Memory artifacts\necho \"Collecting /proc data...\"\ncp -r /proc/*/maps \"$OUTPUT_DIR/memory/\" 2>/dev/null\ncat /proc/meminfo > \"$OUTPUT_DIR/memory/meminfo.txt\"\n\n# Running processes\nps auxwwf > \"$OUTPUT_DIR/processes.txt\"\nlsof > \"$OUTPUT_DIR/open_files.txt\" 2>/dev/null\n\n# Network connections\nnetstat -tulpan > \"$OUTPUT_DIR/network/netstat.txt\" 2>/dev/null\nss -tulpan > \"$OUTPUT_DIR/network/ss.txt\" 2>/dev/null\n\n# System logs\ncp -r /var/log/auth.log* \"$OUTPUT_DIR/logs/\" 2>/dev/null\ncp -r /var/log/syslog* \"$OUTPUT_DIR/logs/\" 2>/dev/null\njournalctl --since \"24 hours ago\" > \"$OUTPUT_DIR/logs/journal_24h.txt\" 2>/dev/null\n\n# File system artifacts\nfind /tmp /var/tmp -type f -mtime -1 -ls > \"$OUTPUT_DIR/disk/recent_tmp_files.txt\" 2>/dev/null\nfind /home -name \".*\" -type f -mtime -1 -ls > \"$OUTPUT_DIR/disk/recent_hidden_files.txt\" 2>/dev/null\n\necho \"[IR-4.12] Artifact collection complete: $OUTPUT_DIR\""
      },
      "windows": {
        "powershell": "# IR-4.12: YARA-based malware scanning for Windows\n# Scans directory for known malware signatures\n\nparam(\n    [string]$ScanPath = \"C:\\Quarantine\",\n    [string]$YaraRules = \"C:\\Tools\\yara-rules\\index.yar\",\n    [string]$OutputPath = \"C:\\Logs\\IR\"\n)\n\n$timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$logFile = Join-Path $OutputPath \"yara_scan_$timestamp.log\"\n\nif (-not (Test-Path $OutputPath)) { New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null }\n\nif (-not (Test-Path $YaraRules)) {\n    Write-Error \"[ERROR] YARA rules not found at $YaraRules\"\n    exit 1\n}\n\n\"[IR-4.12] Starting YARA scan at $(Get-Date)\" | Tee-Object -FilePath $logFile\n\"Scanning: $ScanPath\" | Tee-Object -FilePath $logFile -Append\n\n& yara64.exe -r $YaraRules $ScanPath 2>&1 | Tee-Object -FilePath $logFile -Append\n\n\"[IR-4.12] Scan complete at $(Get-Date)\" | Tee-Object -FilePath $logFile -Append",
        "collect_forensic_artifacts": "# IR-4.12: Forensic artifact collection for Windows\n# Collects system artifacts for malware/forensic analysis\n\nparam(\n    [string]$OutputPath = \"C:\\Forensics\"\n)\n\n$timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$artifactDir = Join-Path $OutputPath \"$env:COMPUTERNAME`_$timestamp\"\n\nNew-Item -ItemType Directory -Path \"$artifactDir\\Processes\" -Force | Out-Null\nNew-Item -ItemType Directory -Path \"$artifactDir\\Network\" -Force | Out-Null\nNew-Item -ItemType Directory -Path \"$artifactDir\\Registry\" -Force | Out-Null\nNew-Item -ItemType Directory -Path \"$artifactDir\\EventLogs\" -Force | Out-Null\n\nWrite-Host \"[IR-4.12] Collecting forensic artifacts to $artifactDir\"\n\n# Process information\nGet-Process | Select-Object Name, Id, Path, StartTime, CPU | Export-Csv \"$artifactDir\\Processes\\running_processes.csv\" -NoTypeInformation\nGet-WmiObject Win32_Process | Select-Object Name, ProcessId, ParentProcessId, CommandLine | Export-Csv \"$artifactDir\\Processes\\process_details.csv\" -NoTypeInformation\n\n# Network connections\nGet-NetTCPConnection | Export-Csv \"$artifactDir\\Network\\tcp_connections.csv\" -NoTypeInformation\nGet-NetUDPEndpoint | Export-Csv \"$artifactDir\\Network\\udp_endpoints.csv\" -NoTypeInformation\n\n# Registry run keys\n$runKeys = @(\n    'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run',\n    'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run',\n    'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce'\n)\nforeach ($key in $runKeys) {\n    if (Test-Path $key) {\n        Get-ItemProperty $key | Out-File \"$artifactDir\\Registry\\$(Split-Path $key -Leaf).txt\" -Append\n    }\n}\n\n# Recent event logs\n$logs = @('Security', 'System', 'Application')\nforeach ($log in $logs) {\n    try {\n        Get-WinEvent -LogName $log -MaxEvents 1000 | Export-Csv \"$artifactDir\\EventLogs\\$log.csv\" -NoTypeInformation\n    } catch { Write-Warning \"Could not export $log log\" }\n}\n\nWrite-Host \"[IR-4.12] Artifact collection complete: $artifactDir\""
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "intent": "After an incident, analyze any malware or attack artifacts to understand exactly what happened and prevent it from happening again."
  },
  {
    "control_id": "IR-4.13",
    "control_name": "Behavior Analysis",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Analyze anomalous or suspected adversarial behavior in or related to organization-defined environments or resources.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to implement behavioral analysis capabilities that detect deviations from normal patterns in user activity, system processes, and network traffic. Unlike signature-based detection which identifies known threats, behavior analysis identifies anomalies that may indicate novel attacks, insider threats, or compromised accounts acting abnormally.",
    "ai_guidance": "Behavior analysis implementation requires User and Entity Behavior Analytics (UEBA) platforms combined with baseline establishment and anomaly detection algorithms. Technical components include: (1) Data collection infrastructure aggregating logs from authentication systems, endpoints, network devices, and applications; (2) Baseline modeling engines that establish normal behavior patterns for users, systems, and network segments; (3) Anomaly detection algorithms (statistical, ML-based) that identify deviations from established baselines; (4) Risk scoring engines that prioritize anomalies based on deviation magnitude and asset criticality; (5) Alert correlation capabilities linking related anomalies into coherent incident narratives; (6) Investigation interfaces enabling analysts to drill into anomaly details and context. Key behavioral indicators to monitor include: impossible travel (logins from geographically distant locations), unusual access times, privilege escalation patterns, abnormal data access volumes, lateral movement indicators, and process execution anomalies. Integration with threat intelligence enriches anomaly context. Organizations should tune detection thresholds balancing sensitivity against alert fatigue. Periodic baseline refresh accommodates legitimate behavioral changes.",
    "implementation_rationale": "Sophisticated attackers avoid triggering alerts. Behavior analysis can catch anomalies like an employee accessing files they've never touched before, or login patterns that don't match someone's normal routine. It's about finding the unusual in the ordinary.",
    "non_technical_guidance": "Implement behavior analysis by: (1) Deploying UEBA platform with comprehensive log collection; (2) Establishing behavioral baselines across users and systems; (3) Configuring anomaly detection rules for key risk indicators; (4) Integrating with SIEM for centralized alerting; (5) Training analysts on anomaly investigation procedures; (6) Developing response playbooks for common anomaly types; (7) Tuning detection thresholds based on operational feedback; (8) Periodically refreshing baselines to reflect legitimate changes.",
    "example_implementation": "Organization deploys UEBA platform analyzing authentication logs, VPN access, file share activity, and endpoint telemetry. System alerts on impossible travel, unusual data access volumes, and off-hours privileged operations with risk scores prioritizing analyst investigation.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "SI-4",
      "AU-6",
      "AC-2"
    ],
    "supplemental_guidance": "Behavioral baselines require sufficient historical data for accuracy. Plan for 30-90 day baseline establishment periods before relying on anomaly detection.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-4.13: UEBA baseline data collection\n# Collects user behavior data for baseline analysis\n\nOUTPUT_DIR=\"/var/log/ueba/baselines\"\nDATE=$(date +%Y%m%d)\nmkdir -p \"$OUTPUT_DIR\"\n\necho \"[IR-4.13] Collecting behavioral baseline data for $DATE\"\n\n# Login patterns\nlast -F | head -500 > \"$OUTPUT_DIR/login_history_$DATE.txt\"\nwho > \"$OUTPUT_DIR/current_sessions_$DATE.txt\"\n\n# Process execution patterns\nps aux --sort=-%cpu | head -100 > \"$OUTPUT_DIR/top_processes_$DATE.txt\"\n\n# Network connection patterns\nss -tulpan > \"$OUTPUT_DIR/network_connections_$DATE.txt\"\n\n# File access patterns (if auditd enabled)\nif [ -f /var/log/audit/audit.log ]; then\n    ausearch -ts today -m OPEN -i 2>/dev/null | head -1000 > \"$OUTPUT_DIR/file_access_$DATE.txt\"\nfi\n\n# Authentication events\ngrep -E '(sshd|sudo|su)' /var/log/auth.log 2>/dev/null | tail -1000 > \"$OUTPUT_DIR/auth_events_$DATE.txt\"\n\necho \"[IR-4.13] Baseline collection complete: $OUTPUT_DIR\"",
        "anomaly_detection": "#!/bin/bash\n# IR-4.13: Basic anomaly detection script\n# Detects behavioral anomalies in authentication logs\n\nLOG_FILE=\"/var/log/auth.log\"\nALERT_FILE=\"/var/log/ir/anomaly_alerts_$(date +%Y%m%d).log\"\nmkdir -p \"$(dirname $ALERT_FILE)\"\n\necho \"[IR-4.13] Running anomaly detection at $(date)\" | tee \"$ALERT_FILE\"\n\n# Detect failed authentication spikes (brute force indicator)\nFAILED_COUNT=$(grep -c 'Failed password' \"$LOG_FILE\" 2>/dev/null || echo 0)\nif [ \"$FAILED_COUNT\" -gt 50 ]; then\n    echo \"[ALERT] High failed authentication count: $FAILED_COUNT\" | tee -a \"$ALERT_FILE\"\nfi\n\n# Detect unusual hours authentication (off-hours access)\nOFFHOURS_LOGINS=$(awk '/Accepted/ && /[0-3]:[0-5][0-9]:[0-5][0-9]/' \"$LOG_FILE\" | wc -l)\nif [ \"$OFFHOURS_LOGINS\" -gt 10 ]; then\n    echo \"[ALERT] Unusual off-hours logins detected: $OFFHOURS_LOGINS\" | tee -a \"$ALERT_FILE\"\nfi\n\n# Detect new source IPs\nTODAY_IPS=$(grep 'Accepted' \"$LOG_FILE\" | grep -oE '([0-9]{1,3}\\.){3}[0-9]{1,3}' | sort -u)\necho \"[INFO] Unique source IPs today: $(echo \"$TODAY_IPS\" | wc -l)\" | tee -a \"$ALERT_FILE\"\n\necho \"[IR-4.13] Anomaly detection complete\" | tee -a \"$ALERT_FILE\""
      },
      "windows": {
        "powershell": "# IR-4.13: UEBA baseline data collection for Windows\n# Collects user behavior data for baseline analysis\n\nparam(\n    [string]$OutputPath = \"C:\\UEBA\\Baselines\"\n)\n\n$date = Get-Date -Format \"yyyyMMdd\"\n$outputDir = Join-Path $OutputPath $date\nNew-Item -ItemType Directory -Path $outputDir -Force | Out-Null\n\nWrite-Host \"[IR-4.13] Collecting behavioral baseline data for $date\"\n\n# Login events (Event ID 4624)\ntry {\n    Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624} -MaxEvents 500 |\n        Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}}, @{N='LogonType';E={$_.Properties[8].Value}}, @{N='SourceIP';E={$_.Properties[18].Value}} |\n        Export-Csv \"$outputDir\\login_events.csv\" -NoTypeInformation\n} catch { Write-Warning \"Could not collect login events\" }\n\n# Failed logons (Event ID 4625)\ntry {\n    Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625} -MaxEvents 500 |\n        Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}}, @{N='SourceIP';E={$_.Properties[19].Value}} |\n        Export-Csv \"$outputDir\\failed_logons.csv\" -NoTypeInformation\n} catch { Write-Warning \"Could not collect failed logon events\" }\n\n# Process creation (if auditing enabled)\ntry {\n    Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4688} -MaxEvents 500 |\n        Select-Object TimeCreated, @{N='Process';E={$_.Properties[5].Value}}, @{N='User';E={$_.Properties[1].Value}} |\n        Export-Csv \"$outputDir\\process_creation.csv\" -NoTypeInformation\n} catch { Write-Warning \"Could not collect process creation events\" }\n\nWrite-Host \"[IR-4.13] Baseline collection complete: $outputDir\"",
        "anomaly_detection": "# IR-4.13: Behavioral anomaly detection for Windows\n# Detects anomalous authentication and access patterns\n\nparam(\n    [int]$FailedLogonThreshold = 50,\n    [string]$OutputPath = \"C:\\Logs\\IR\"\n)\n\n$timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$alertFile = Join-Path $OutputPath \"anomaly_alerts_$timestamp.log\"\nNew-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n\n\"[IR-4.13] Running anomaly detection at $(Get-Date)\" | Tee-Object -FilePath $alertFile\n\n# Detect failed logon spikes\ntry {\n    $failedLogons = (Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4625; StartTime=(Get-Date).AddHours(-24)} -ErrorAction SilentlyContinue).Count\n    if ($failedLogons -gt $FailedLogonThreshold) {\n        \"[ALERT] High failed logon count in 24h: $failedLogons\" | Tee-Object -FilePath $alertFile -Append\n    }\n} catch { \"[INFO] Could not query failed logons\" | Tee-Object -FilePath $alertFile -Append }\n\n# Detect off-hours logons (11PM - 5AM)\ntry {\n    $offHoursLogons = Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4624; StartTime=(Get-Date).AddHours(-24)} -ErrorAction SilentlyContinue |\n        Where-Object { $_.TimeCreated.Hour -ge 23 -or $_.TimeCreated.Hour -lt 5 }\n    if ($offHoursLogons.Count -gt 10) {\n        \"[ALERT] Unusual off-hours logons: $($offHoursLogons.Count)\" | Tee-Object -FilePath $alertFile -Append\n    }\n} catch { \"[INFO] Could not query off-hours logons\" | Tee-Object -FilePath $alertFile -Append }\n\n\"[IR-4.13] Anomaly detection complete\" | Tee-Object -FilePath $alertFile -Append"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "intent": "Look for unusual behavior patterns that might indicate an attack - even if no specific alert was triggered."
  },
  {
    "control_id": "IR-4.14",
    "control_name": "Security Operations Center",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Establish and maintain a security operations center.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to establish a dedicated Security Operations Center (SOC) providing continuous monitoring, detection, and initial response capabilities. The SOC serves as the central nervous system for security operations, aggregating telemetry from across the enterprise, detecting threats through correlation and analysis, and coordinating response activities.",
    "ai_guidance": "Security Operations Center implementation requires integration of people, processes, and technology for continuous security monitoring. Technical infrastructure includes: (1) SIEM platform aggregating logs from all security-relevant sources (endpoints, network devices, applications, cloud services, identity systems); (2) Security orchestration and automation (SOAR) platform for playbook-driven response; (3) Endpoint Detection and Response (EDR) providing endpoint visibility and response capability; (4) Network Detection and Response (NDR) or network traffic analysis tools; (5) Threat intelligence platform integrating external feeds with internal detections; (6) Case management system tracking incidents through lifecycle; (7) Visualization dashboards providing operational awareness. Staffing models include 24x7 coverage through shift rotation or follow-the-sun arrangements with geographically distributed analysts. SOC maturity progression typically follows tiers: Tier 1 (alert triage), Tier 2 (investigation), Tier 3 (advanced analysis and threat hunting). Key operational metrics include Mean Time to Detect (MTTD), Mean Time to Respond (MTTR), false positive rates, and coverage metrics. Continuous improvement through post-incident reviews and purple team exercises enhances detection capabilities over time.",
    "implementation_rationale": "Attackers don't work 9-to-5. A SOC provides continuous monitoring, ensuring that alerts get investigated at 3 AM on Sunday, not Monday morning. It's your always-on security nerve center that catches and responds to threats around the clock.",
    "non_technical_guidance": "Establish a SOC by: (1) Defining SOC mission, scope, and service level objectives; (2) Acquiring and integrating core technology stack (SIEM, EDR, SOAR); (3) Developing staffing model appropriate for organization size and risk; (4) Creating standard operating procedures for monitoring and response; (5) Establishing escalation paths and communication protocols; (6) Implementing metrics tracking operational performance; (7) Conducting regular exercises to validate capabilities; (8) Establishing continuous improvement processes.",
    "example_implementation": "Organization operates 24x7 SOC with SIEM aggregating 50+ log sources, SOAR automating Tier 1 response actions, and three-tier analyst structure handling 500+ daily alerts with 4-hour MTTD and 2-hour MTTR for critical incidents.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "SI-4",
      "AU-6",
      "IR-5"
    ],
    "supplemental_guidance": "SOC effectiveness depends heavily on proper tool configuration and tuning. Plan for significant initial tuning period to reduce false positives to manageable levels.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# IR-4.14: SOC infrastructure health check\n# Verifies SOC components are operational\n\nLOG_FILE=\"/var/log/ir/soc_health_$(date +%Y%m%d_%H%M%S).log\"\nmkdir -p \"$(dirname $LOG_FILE)\"\n\necho \"[IR-4.14] SOC Health Check - $(date)\" | tee \"$LOG_FILE\"\necho \"==========================================\" | tee -a \"$LOG_FILE\"\n\n# Check SIEM connectivity (example: Elasticsearch)\nif curl -s -o /dev/null -w \"%{http_code}\" http://localhost:9200 | grep -q \"200\"; then\n    echo \"[PASS] SIEM (Elasticsearch): Operational\" | tee -a \"$LOG_FILE\"\nelse\n    echo \"[FAIL] SIEM (Elasticsearch): Not responding\" | tee -a \"$LOG_FILE\"\nfi\n\n# Check log collection (rsyslog)\nif systemctl is-active --quiet rsyslog; then\n    echo \"[PASS] Log Collector (rsyslog): Running\" | tee -a \"$LOG_FILE\"\nelse\n    echo \"[FAIL] Log Collector (rsyslog): Not running\" | tee -a \"$LOG_FILE\"\nfi\n\n# Check log shipping agent (example: Filebeat)\nif systemctl is-active --quiet filebeat 2>/dev/null; then\n    echo \"[PASS] Log Shipper (Filebeat): Running\" | tee -a \"$LOG_FILE\"\nelse\n    echo \"[WARN] Log Shipper (Filebeat): Not running or not installed\" | tee -a \"$LOG_FILE\"\nfi\n\n# Check disk space for log storage\nDISK_USAGE=$(df -h /var/log | awk 'NR==2 {print $5}' | sed 's/%//')\nif [ \"$DISK_USAGE\" -lt 80 ]; then\n    echo \"[PASS] Log Storage: ${DISK_USAGE}% used\" | tee -a \"$LOG_FILE\"\nelse\n    echo \"[WARN] Log Storage: ${DISK_USAGE}% used - approaching capacity\" | tee -a \"$LOG_FILE\"\nfi\n\necho \"==========================================\" | tee -a \"$LOG_FILE\"\necho \"[IR-4.14] Health check complete\" | tee -a \"$LOG_FILE\"",
        "siem_log_forwarding": "#!/bin/bash\n# IR-4.14: Configure log forwarding to SIEM\n# Sets up rsyslog forwarding to central SIEM\n\nSIEM_SERVER=\"${1:-siem.example.com}\"\nSIEM_PORT=\"${2:-514}\"\nCONFIG_FILE=\"/etc/rsyslog.d/99-siem-forward.conf\"\n\necho \"[IR-4.14] Configuring log forwarding to $SIEM_SERVER:$SIEM_PORT\"\n\ncat > \"$CONFIG_FILE\" << EOF\n# IR-4.14: Forward all logs to SIEM\n# Generated: $(date)\n\n# Forward auth logs\nauth,authpriv.*    @@${SIEM_SERVER}:${SIEM_PORT}\n\n# Forward all logs at info level and above\n*.info    @@${SIEM_SERVER}:${SIEM_PORT}\n\n# Forward kernel messages\nkern.*    @@${SIEM_SERVER}:${SIEM_PORT}\nEOF\n\necho \"[IR-4.14] Configuration written to $CONFIG_FILE\"\necho \"[IR-4.14] Restarting rsyslog...\"\nsystemctl restart rsyslog\n\nif systemctl is-active --quiet rsyslog; then\n    echo \"[IR-4.14] Log forwarding configured successfully\"\nelse\n    echo \"[ERROR] Failed to restart rsyslog\"\n    exit 1\nfi"
      },
      "windows": {
        "powershell": "# IR-4.14: SOC infrastructure health check for Windows\n# Verifies SOC components are operational\n\nparam(\n    [string]$OutputPath = \"C:\\Logs\\IR\"\n)\n\n$timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$logFile = Join-Path $OutputPath \"soc_health_$timestamp.log\"\nNew-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n\n\"[IR-4.14] SOC Health Check - $(Get-Date)\" | Tee-Object -FilePath $logFile\n\"==========================================\" | Tee-Object -FilePath $logFile -Append\n\n# Check Windows Event Log service\n$eventLog = Get-Service -Name EventLog -ErrorAction SilentlyContinue\nif ($eventLog.Status -eq 'Running') {\n    \"[PASS] Windows Event Log: Running\" | Tee-Object -FilePath $logFile -Append\n} else {\n    \"[FAIL] Windows Event Log: Not running\" | Tee-Object -FilePath $logFile -Append\n}\n\n# Check Windows Event Forwarding\n$wecsvc = Get-Service -Name Wecsvc -ErrorAction SilentlyContinue\nif ($wecsvc -and $wecsvc.Status -eq 'Running') {\n    \"[PASS] Windows Event Collector: Running\" | Tee-Object -FilePath $logFile -Append\n} else {\n    \"[INFO] Windows Event Collector: Not running (may not be configured)\" | Tee-Object -FilePath $logFile -Append\n}\n\n# Check Windows Defender\n$defender = Get-Service -Name WinDefend -ErrorAction SilentlyContinue\nif ($defender -and $defender.Status -eq 'Running') {\n    \"[PASS] Windows Defender: Running\" | Tee-Object -FilePath $logFile -Append\n} else {\n    \"[WARN] Windows Defender: Not running\" | Tee-Object -FilePath $logFile -Append\n}\n\n# Check Security Event Log size\n$secLog = Get-WinEvent -ListLog Security -ErrorAction SilentlyContinue\nif ($secLog) {\n    $usedMB = [math]::Round($secLog.FileSize / 1MB, 2)\n    $maxMB = [math]::Round($secLog.MaximumSizeInBytes / 1MB, 2)\n    \"[INFO] Security Log: $usedMB MB / $maxMB MB\" | Tee-Object -FilePath $logFile -Append\n}\n\n\"==========================================\" | Tee-Object -FilePath $logFile -Append\n\"[IR-4.14] Health check complete\" | Tee-Object -FilePath $logFile -Append",
        "configure_event_forwarding": "# IR-4.14: Configure Windows Event Forwarding for SOC\n# Sets up event subscription forwarding to collector\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CollectorServer\n)\n\nWrite-Host \"[IR-4.14] Configuring Windows Event Forwarding to $CollectorServer\"\n\n# Enable WinRM service\nWrite-Host \"Enabling WinRM...\"\nSet-Service -Name WinRM -StartupType Automatic\nStart-Service -Name WinRM\n\n# Configure WinRM\nwinrm quickconfig -q\n\n# Add collector to trusted hosts\nSet-Item WSMan:\\localhost\\Client\\TrustedHosts -Value $CollectorServer -Force\n\n# Configure event forwarding\nwecutil qc /q\n\nWrite-Host \"[IR-4.14] Event forwarding infrastructure configured\"\nWrite-Host \"[INFO] Create subscription on collector server to complete setup\""
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "intent": "Run a Security Operations Center (SOC) that monitors your environment 24/7 for threats and incidents."
  },
  {
    "control_id": "IR-4.15",
    "control_name": "Public Relations and Reputation Repair",
    "family": "Incident Response",
    "family_id": "ir",
    "parent_control": "IR-4",
    "stig_id": "not_applicable",
    "official_text": "Manage public relations and organizational reputation in response to incidents.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "This control requires organizations to integrate public relations and reputation management capabilities into incident response. When security incidents become public through disclosure requirements, media attention, or customer impact, coordinated communications protect organizational reputation and maintain stakeholder trust. This includes preparing statements, managing media inquiries, and executing reputation repair strategies.",
    "ai_guidance": "Public relations integration with incident response requires pre-planned communication strategies, designated spokespersons, and coordinated messaging across stakeholders. Implementation encompasses: (1) Pre-drafted communication templates for common incident scenarios (data breach, service outage, ransomware) adaptable to specific circumstances; (2) Designated incident communications team including legal counsel, PR professionals, and executive sponsors; (3) Media monitoring capabilities tracking coverage and sentiment during active incidents; (4) Social media response procedures addressing customer concerns on public platforms; (5) Customer notification systems capable of reaching affected populations at scale; (6) Regulatory notification procedures addressing mandatory disclosure requirements (GDPR, HIPAA, state breach laws); (7) Internal communications ensuring employees receive accurate information before external announcement; (8) Post-incident reputation assessment measuring lasting reputational impact. Critical success factors include rapid response (first 24-48 hours shape narrative), consistent messaging across channels, acknowledgment of impact without speculation on cause during investigation, and demonstrated remediation actions. Legal review of all external communications prevents inadvertent liability exposure.",
    "implementation_rationale": "A data breach can destroy customer trust overnight. Professional crisis communication - saying the right things at the right time - can limit reputation damage. Silence or bad messaging often hurts more than the incident itself.",
    "non_technical_guidance": "Integrate PR into incident response by: (1) Including communications professional in incident response team structure; (2) Pre-drafting communication templates for likely incident scenarios; (3) Establishing media inquiry handling procedures; (4) Designating trained spokespersons authorized for incident communications; (5) Creating customer notification procedures and systems; (6) Documenting regulatory notification requirements and timelines; (7) Establishing internal communication procedures for employee awareness; (8) Developing post-incident reputation monitoring and repair strategies; (9) Conducting communications exercises during incident response drills.",
    "example_implementation": "Organization maintains incident communications playbook with templates for data breach, ransomware, and service disruption scenarios. Communications team participates in quarterly incident exercises. Customer notification system can reach 500,000 customers within 24 hours. Media monitoring tracks coverage sentiment throughout incidents.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-6",
      "IR-8"
    ],
    "supplemental_guidance": "Legal review of incident communications is essential but should not unduly delay disclosure. Balance legal risk mitigation against reputational damage from perceived delayed notification.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "intent": "Have a plan to manage public communications and protect your reputation during and after a major incident."
  },
  {
    "control_id": "IR-5",
    "control_name": "Incident Monitoring",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Track and document incidents.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Incident Monitoring requires tracking and documenting any security incidents that occur. Organizations must maintain records of detected incidents, including their nature, impact, timeline, and response actions taken. This provides a historical record for analysis, compliance verification, and continuous improvement of security posture.",
    "example_implementation": "Deploy a centralized incident tracking system (SIEM or ticketing system) that logs all security incidents with timestamps, severity classifications, affected systems, and response actions. Configure automated alerting for high-priority incidents and establish procedures for regular incident data review.",
    "non_technical_guidance": "To ensure compliance with control IR-5 (Incident Monitoring), implement these measures: 1. Establish a clear incident tracking and documentation process within your organization using standardized forms and procedures. 2. Develop incident response procedures that outline how incidents will be monitored, tracked, and documented throughout their lifecycle. 3. Train personnel on how to recognize, report, and document incidents effectively using organization-approved tools. 4. Regularly review and update incident documentation to ensure accuracy and completeness. 5. Conduct periodic audits to verify that incident monitoring is being effectively implemented and documented. 6. Document incidents promptly and thoroughly, including the nature of the incident, impact assessment, response actions taken, and lessons learned. 7. Retain incident documentation for the required retention period as per organizational policies and regulatory requirements. 8. Continuously improve incident monitoring processes based on lessons learned from past incidents and emerging threat intelligence.",
    "is_technical": false,
    "ai_guidance": "IR-5 Incident Monitoring is a foundational control that enables organizational awareness of security events. Implementation requires establishing systematic processes for tracking security incidents from initial detection through final resolution. Key technical components include deploying Security Information and Event Management (SIEM) systems such as Splunk, ELK Stack, or QRadar to aggregate and correlate security events across the enterprise. For Linux systems, configure auditd with comprehensive rules to capture security-relevant events and forward logs to central collectors using rsyslog or syslog-ng with TLS encryption. For Windows environments, enable Advanced Audit Policy Configuration to capture detailed security events, configure Windows Event Forwarding (WEF) to centralize logs from distributed systems, and ensure Security event logs are sized appropriately per STIG requirements (minimum 196608 KB). Incident tracking should include: unique incident identifiers, timestamps for detection/reporting/resolution, affected systems and users, incident classification and severity, containment and eradication actions, evidence preservation records, and post-incident analysis. Integration with ticketing systems like ServiceNow, Jira, or TheHive provides workflow automation and audit trails. Organizations should establish metrics including Mean Time to Detect (MTTD), Mean Time to Respond (MTTR), and incident volume trends to measure program effectiveness.",
    "implementation_rationale": "You can't improve what you don't measure. Tracking incidents reveals patterns - maybe the same vulnerability keeps getting exploited, or certain departments have more problems. Good records also prove compliance and help justify security budgets.",
    "enhancements": [
      {
        "id": "IR-5.1",
        "title": "Automated Tracking, Data Collection, and Analysis",
        "official_text": "Track incidents and collect and analyze incident information using automated mechanisms."
      }
    ],
    "related_controls": [
      "AU-6",
      "AU-7",
      "IR-4",
      "IR-6",
      "IR-8",
      "SI-4"
    ],
    "supplemental_guidance": "Documenting incidents includes maintaining records about each incident, the status of the incident, and other pertinent information necessary for forensics, evaluation of incident details, trends, and handling. Incident information can be obtained from a variety of sources, including network monitoring, intrusion detection, anti-virus software, audit log analysis, security-relevant events, and personnel and user reports.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Implement centralized logging with SIEM integration. Linux systems use auditd and rsyslog; Windows systems use Event Forwarding and Advanced Audit Policies."
    },
    "intent": "Keep track of all security incidents - what happened, when, how it was handled, and the outcome."
  },
  {
    "control_id": "IR-5.1",
    "control_name": "Automated Tracking, Data Collection, and Analysis",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Track incidents and collect and analyze incident information using automated mechanisms.",
    "parent_control": "IR-5",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": true
    },
    "plain_english_explanation": "Implement automated tools and mechanisms to track security incidents, collect relevant incident data, and analyze incident information. Automation reduces human error, ensures consistent data collection, and enables rapid correlation of events across multiple systems and timeframes.",
    "example_implementation": "Deploy a SIEM solution with automated incident creation from correlated alerts. Configure auditd on Linux and Windows Event Forwarding on Windows systems to automatically capture and forward security events. Implement automated analysis rules for common attack patterns.",
    "non_technical_guidance": "To implement automated incident tracking: 1. Select and deploy a SIEM or incident management platform capable of automated incident creation and tracking. 2. Define correlation rules that automatically create incidents from detected security events. 3. Configure automated data collection from all security-relevant sources including firewalls, IDS/IPS, endpoint protection, and authentication systems. 4. Implement automated analysis capabilities to identify patterns, trends, and anomalies. 5. Establish automated alerting and escalation procedures based on incident severity. 6. Create dashboards for real-time visibility into incident status and metrics.",
    "is_technical": true,
    "stig_id": "V-230386",
    "stig_references": [
      {
        "stig_id": "V-230386",
        "title": "RHEL 8 audit system privileged function auditing",
        "description": "Configure auditd to audit execution of privileged functions"
      },
      {
        "stig_id": "V-230396",
        "title": "RHEL 8 audit log permissions",
        "description": "Audit logs must have mode 0600 or more restrictive"
      },
      {
        "stig_id": "V-93161",
        "title": "Windows Server 2019 Special Logon auditing",
        "description": "Configure audit for Special Logon successes"
      },
      {
        "stig_id": "V-205797",
        "title": "Windows Server 2019 Security event log size",
        "description": "Security event log size must be 196608 KB or greater"
      }
    ],
    "ai_guidance": "IR-5.1 requires organizations to implement automated mechanisms for incident tracking, data collection, and analysis. This enhancement addresses the limitations of manual incident tracking by leveraging technology to ensure comprehensive, consistent, and timely incident management. For Linux environments, the auditd framework provides the foundation for automated security event collection. Configure audit rules in /etc/audit/rules.d/ following STIG guidance: deploy 10-base-config.rules for base configuration, 30-stig.rules for STIG-required auditing, 31-privileged.rules for privileged command auditing, and 99-finalize.rules to lock configuration. Key syscall auditing includes execve for privilege escalation detection (-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv). Use rsyslog with omfwd action to forward audit logs to SIEM systems over TCP with TLS encryption. For Windows environments, implement Windows Event Forwarding (WEF) using source-initiated subscriptions for scalability. Configure Advanced Audit Policy through Group Policy: enable Success/Failure auditing for Logon/Logoff events, Privilege Use, System Integrity, and Security State Change categories. Set Security log size to minimum 196608 KB per STIG V-205797. Deploy Windows Event Collector service on designated servers and configure WinRM on source systems. SIEM integration should include automated parsing rules for both Syslog (Linux) and Windows Event Format, correlation rules for common attack patterns (brute force, privilege escalation, lateral movement), and automated incident ticket creation based on alert severity. Analysis automation should include baseline deviation detection, threat intelligence enrichment, and automated IOC extraction. Implement retention policies ensuring audit data availability for forensic analysis (typically 90+ days online, 1+ year archived).",
    "implementation_rationale": "Manual tracking is slow and error-prone. Automated systems ensure every incident is logged consistently, evidence is preserved properly, and you can quickly pull reports showing incident trends over time. It's the difference between filing cabinets and a searchable database.",
    "enhancements": [],
    "related_controls": [
      "AU-6",
      "AU-7",
      "AU-12",
      "IR-4",
      "SI-4"
    ],
    "supplemental_guidance": "Automated mechanisms for tracking incidents and collecting and analyzing incident information include automated data collection from hosts, networks, and applications as well as automated tools for analysis and reporting.",
    "implementation_scripts": {
      "linux": {
        "bash": {
          "description": "Configure auditd for comprehensive incident tracking with STIG compliance",
          "script": "#!/bin/bash\n# IR-5.1: Automated Incident Tracking via auditd\n# STIG Reference: V-230386, V-230396\n\nset -euo pipefail\n\nAUDIT_RULES_DIR=\"/etc/audit/rules.d\"\nSIEM_SERVER=\"siem.example.com\"\nSIEM_PORT=\"514\"\n\necho \"[INFO] Configuring auditd for IR-5.1 compliance...\"\n\n# Ensure auditd package is installed\nif ! rpm -q audit &>/dev/null; then\n    dnf install -y audit audit-libs audispd-plugins\nfi\n\n# Create base configuration\ncat > \"${AUDIT_RULES_DIR}/10-base-config.rules\" << 'EOF'\n## Base audit configuration for incident tracking\n-D\n-b 8192\n--backlog_wait_time 60000\n-f 1\nEOF\n\n# Create STIG-compliant audit rules\ncat > \"${AUDIT_RULES_DIR}/30-incident-tracking.rules\" << 'EOF'\n## IR-5.1: Incident Tracking Rules\n## Privileged function execution (STIG V-230386)\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n\n## Authentication events\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock -p wa -k logins\n\n## Session events\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\n## Privileged command execution\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd\n-a always,exit -F path=/usr/bin/chfn -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd\n\n## User and group modifications\n-w /etc/passwd -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n\n## Audit configuration changes\n-w /etc/audit/ -p wa -k audit_config\n-w /etc/audisp/ -p wa -k audit_config\n-w /etc/libaudit.conf -p wa -k audit_config\n\n## Network configuration changes\n-a always,exit -F arch=b64 -S sethostname,setdomainname -k network_mod\n-a always,exit -F arch=b32 -S sethostname,setdomainname -k network_mod\n-w /etc/hosts -p wa -k network_mod\n-w /etc/sysconfig/network -p wa -k network_mod\n\n## File system mounts\n-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=unset -k mounts\n-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=unset -k mounts\n\n## Kernel module loading\n-w /sbin/insmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-a always,exit -F arch=b64 -S init_module,finit_module,delete_module -k modules\n-a always,exit -F arch=b32 -S init_module,finit_module,delete_module -k modules\nEOF\n\n# Create finalize rules\ncat > \"${AUDIT_RULES_DIR}/99-finalize.rules\" << 'EOF'\n## Make audit configuration immutable until reboot\n-e 2\nEOF\n\n# Set proper permissions on audit logs (STIG V-230396)\nchmod 0600 /var/log/audit/audit.log 2>/dev/null || true\nchown root:root /var/log/audit/audit.log 2>/dev/null || true\nchmod 0700 /var/log/audit/ 2>/dev/null || true\n\n# Configure rsyslog for SIEM forwarding\ncat > /etc/rsyslog.d/50-incident-siem.conf << EOF\n# IR-5.1: Forward audit logs to SIEM\nmodule(load=\"imfile\")\n\ninput(type=\"imfile\"\n      File=\"/var/log/audit/audit.log\"\n      Tag=\"auditd:\"\n      Facility=\"local6\")\n\nlocal6.* action(type=\"omfwd\"\n               target=\"${SIEM_SERVER}\"\n               port=\"${SIEM_PORT}\"\n               protocol=\"tcp\")\nEOF\n\n# Load new rules\naugenrules --load\n\n# Enable and start services\nsystemctl enable --now auditd\nsystemctl restart rsyslog\n\necho \"[SUCCESS] IR-5.1 auditd incident tracking configured\"\nauditctl -l | head -20\necho \"...\""
        },
        "siem_integration_elk": {
          "description": "Configure Filebeat for ELK Stack SIEM integration",
          "script": "#!/bin/bash\n# IR-5.1: ELK Stack Integration for Incident Analysis\n\nset -euo pipefail\n\nELK_HOST=\"elasticsearch.example.com\"\nELK_PORT=\"9200\"\n\necho \"[INFO] Installing and configuring Filebeat for ELK integration...\"\n\n# Install Filebeat\nif ! rpm -q filebeat &>/dev/null; then\n    rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch\n    cat > /etc/yum.repos.d/elastic.repo << 'EOF'\n[elastic-8.x]\nname=Elastic repository for 8.x packages\nbaseurl=https://artifacts.elastic.co/packages/8.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md\nEOF\n    dnf install -y filebeat\nfi\n\n# Configure Filebeat for audit logs\ncat > /etc/filebeat/filebeat.yml << EOF\nfilebeat.inputs:\n  - type: log\n    enabled: true\n    paths:\n      - /var/log/audit/audit.log\n    tags: [\"auditd\", \"incident-tracking\"]\n    fields:\n      log_type: auditd\n      compliance: IR-5.1\n    fields_under_root: true\n\n  - type: log\n    enabled: true\n    paths:\n      - /var/log/secure\n      - /var/log/messages\n    tags: [\"syslog\", \"security\"]\n    fields:\n      log_type: syslog\n    fields_under_root: true\n\nprocessors:\n  - add_host_metadata:\n      when.not.contains.tags: forwarded\n  - add_cloud_metadata: ~\n  - dissect:\n      tokenizer: \"type=%{audit_type} msg=audit(%{audit_time}):\"\n      field: \"message\"\n      target_prefix: \"audit\"\n      when:\n        contains:\n          tags: auditd\n\noutput.elasticsearch:\n  hosts: [\"${ELK_HOST}:${ELK_PORT}\"]\n  index: \"security-incidents-%{+yyyy.MM.dd}\"\n  pipeline: \"incident-enrichment\"\n\nsetup.ilm:\n  enabled: true\n  rollover_alias: \"security-incidents\"\n  pattern: \"{now/d}-000001\"\n  policy_name: \"incident-retention\"\nEOF\n\n# Enable and start Filebeat\nsystemctl enable --now filebeat\n\necho \"[SUCCESS] Filebeat configured for ELK SIEM integration\"\nfilebeat test config\nfilebeat test output"
        }
      },
      "windows": {
        "powershell": {
          "description": "Configure Windows Event Forwarding for centralized incident tracking",
          "script": "# IR-5.1: Windows Event Forwarding Configuration\n# STIG Reference: V-93161, V-205797\n\n#Requires -RunAsAdministrator\n\n$ErrorActionPreference = \"Stop\"\n$SIEMCollector = \"siem-collector.example.com\"\n$SubscriptionName = \"Security-Incident-Tracking\"\n\nWrite-Host \"[INFO] Configuring Windows Event Forwarding for IR-5.1...\" -ForegroundColor Cyan\n\n# Enable Windows Remote Management\nWrite-Host \"[INFO] Enabling WinRM service...\"\nSet-Service -Name WinRM -StartupType Automatic\nStart-Service WinRM\nwinrm quickconfig -quiet\n\n# Configure Event Log sizes per STIG V-205797\nWrite-Host \"[INFO] Configuring Security Event Log size (STIG V-205797)...\"\n$logName = \"Security\"\n$logSize = 204800KB  # 200MB, exceeds STIG minimum of 196608KB\n\nwevtutil sl $logName /ms:$logSize\n\n# Verify log configuration\n$secLog = Get-WinEvent -ListLog Security\nWrite-Host \"Security Log Max Size: $($secLog.MaximumSizeInBytes / 1KB) KB\"\n\n# Configure Advanced Audit Policies for comprehensive tracking\nWrite-Host \"[INFO] Configuring Advanced Audit Policies...\"\n\n$auditPolicies = @{\n    # Logon/Logoff (STIG V-93161)\n    \"Logon\" = \"Success,Failure\"\n    \"Logoff\" = \"Success\"\n    \"Special Logon\" = \"Success\"\n    \"Account Lockout\" = \"Failure\"\n    \n    # Account Management\n    \"User Account Management\" = \"Success,Failure\"\n    \"Security Group Management\" = \"Success\"\n    \"Computer Account Management\" = \"Success\"\n    \n    # Privilege Use\n    \"Sensitive Privilege Use\" = \"Success,Failure\"\n    \n    # System\n    \"Security State Change\" = \"Success\"\n    \"Security System Extension\" = \"Success\"\n    \"System Integrity\" = \"Success,Failure\"\n    \n    # Object Access\n    \"File System\" = \"Failure\"\n    \"Registry\" = \"Failure\"\n    \"SAM\" = \"Success\"\n    \n    # Policy Change\n    \"Audit Policy Change\" = \"Success\"\n    \"Authentication Policy Change\" = \"Success\"\n}\n\nforeach ($policy in $auditPolicies.GetEnumerator()) {\n    $category = $policy.Key\n    $setting = $policy.Value\n    auditpol /set /subcategory:\"$category\" /success:enable /failure:enable 2>$null\n    Write-Host \"  Configured: $category = $setting\"\n}\n\n# Create WEF subscription for incident forwarding\nWrite-Host \"[INFO] Creating Windows Event Forwarding subscription...\"\n\n$subscriptionXml = @\"\n<Subscription xmlns=\"http://schemas.microsoft.com/2006/03/windows/events/subscription\">\n    <SubscriptionId>$SubscriptionName</SubscriptionId>\n    <SubscriptionType>SourceInitiated</SubscriptionType>\n    <Description>IR-5.1 Security Incident Tracking Subscription</Description>\n    <Enabled>true</Enabled>\n    <Uri>http://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>\n    <ConfigurationMode>Custom</ConfigurationMode>\n    <Delivery Mode=\"Push\">\n        <Batching>\n            <MaxLatencyTime>60000</MaxLatencyTime>\n        </Batching>\n        <PushSettings>\n            <Heartbeat Interval=\"3600000\"/>\n        </PushSettings>\n    </Delivery>\n    <Query>\n        <![CDATA[\n            <QueryList>\n                <Query Id=\"0\" Path=\"Security\">\n                    <Select Path=\"Security\">*[System[(Level=1 or Level=2 or Level=3)]]</Select>\n                    <Select Path=\"Security\">*[System[(EventID=4624 or EventID=4625 or EventID=4634 or EventID=4648 or EventID=4672 or EventID=4719 or EventID=4720 or EventID=4722 or EventID=4723 or EventID=4724 or EventID=4725 or EventID=4726 or EventID=4738 or EventID=4740 or EventID=4767 or EventID=4776)]]</Select>\n                </Query>\n                <Query Id=\"1\" Path=\"System\">\n                    <Select Path=\"System\">*[System[(Level=1 or Level=2)]]</Select>\n                </Query>\n                <Query Id=\"2\" Path=\"Microsoft-Windows-PowerShell/Operational\">\n                    <Select Path=\"Microsoft-Windows-PowerShell/Operational\">*[System[(EventID=4103 or EventID=4104)]]</Select>\n                </Query>\n            </QueryList>\n        ]]>\n    </Query>\n    <ReadExistingEvents>false</ReadExistingEvents>\n    <TransportName>HTTP</TransportName>\n    <ContentFormat>RenderedText</ContentFormat>\n    <Locale Language=\"en-US\"/>\n    <LogFile>ForwardedEvents</LogFile>\n    <AllowedSourceNonDomainComputers/>\n    <AllowedSourceDomainComputers>O:NSG:NSD:(A;;GA;;;DC)(A;;GA;;;NS)</AllowedSourceDomainComputers>\n</Subscription>\n\"@\n\n$subscriptionFile = \"$env:TEMP\\wef-subscription.xml\"\n$subscriptionXml | Out-File -FilePath $subscriptionFile -Encoding UTF8\n\n# Enable Event Collector service\nSet-Service -Name Wecsvc -StartupType Automatic\nStart-Service Wecsvc\n\nWrite-Host \"[SUCCESS] Windows Event Forwarding configured for IR-5.1 compliance\"\nauditpol /get /category:*"
        },
        "splunk_universal_forwarder": {
          "description": "Configure Splunk Universal Forwarder for SIEM integration",
          "script": "# IR-5.1: Splunk Universal Forwarder Configuration\n# For centralized incident tracking and analysis\n\n#Requires -RunAsAdministrator\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$SplunkIndexer,\n    \n    [Parameter(Mandatory=$false)]\n    [int]$SplunkPort = 9997,\n    \n    [Parameter(Mandatory=$false)]\n    [string]$SplunkInstallerPath = \"C:\\Temp\\splunkforwarder.msi\"\n)\n\n$ErrorActionPreference = \"Stop\"\n$SplunkHome = \"C:\\Program Files\\SplunkUniversalForwarder\"\n\nWrite-Host \"[INFO] Configuring Splunk Universal Forwarder for IR-5.1...\" -ForegroundColor Cyan\n\n# Check if Splunk UF is installed\nif (!(Test-Path \"$SplunkHome\\bin\\splunk.exe\")) {\n    Write-Host \"[ERROR] Splunk Universal Forwarder not found at $SplunkHome\" -ForegroundColor Red\n    Write-Host \"Please install Splunk Universal Forwarder first\"\n    exit 1\n}\n\n# Configure outputs.conf for indexer connection\n$outputsConf = @\"\n# IR-5.1 Incident Tracking - Splunk Output Configuration\n[tcpout]\ndefaultGroup = primary_indexers\n\n[tcpout:primary_indexers]\nserver = ${SplunkIndexer}:${SplunkPort}\ncompressed = true\nuseACK = true\n\"@\n\n$outputsPath = \"$SplunkHome\\etc\\system\\local\\outputs.conf\"\n$outputsConf | Out-File -FilePath $outputsPath -Encoding ASCII\nWrite-Host \"[INFO] Created outputs.conf\"\n\n# Configure inputs.conf for security event collection\n$inputsConf = @\"\n# IR-5.1 Incident Tracking - Input Configuration\n\n[WinEventLog://Security]\nindex = security\nsourcetype = WinEventLog:Security\ndisabled = 0\nstart_from = oldest\ncurrent_only = 0\nevt_resolve_ad_obj = 1\ncheckpointInterval = 5\nrenderXml = true\n\n[WinEventLog://System]\nindex = security  \nsourcetype = WinEventLog:System\ndisabled = 0\nstart_from = oldest\ncurrent_only = 0\ncheckpointInterval = 5\n\n[WinEventLog://Application]\nindex = main\nsourcetype = WinEventLog:Application\ndisabled = 0\ncurrent_only = 1\n\n[WinEventLog://Microsoft-Windows-PowerShell/Operational]\nindex = security\nsourcetype = WinEventLog:PowerShell\ndisabled = 0\nstart_from = oldest\ncurrent_only = 0\n\n[WinEventLog://Microsoft-Windows-Sysmon/Operational]\nindex = security\nsourcetype = XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\ndisabled = 0\nrenderXml = true\n\n[monitor://C:\\Windows\\System32\\LogFiles\\Firewall\\pfirewall.log]\nindex = security\nsourcetype = windows_firewall\ndisabled = 0\n\"@\n\n$inputsPath = \"$SplunkHome\\etc\\system\\local\\inputs.conf\"\n$inputsConf | Out-File -FilePath $inputsPath -Encoding ASCII\nWrite-Host \"[INFO] Created inputs.conf\"\n\n# Restart Splunk Universal Forwarder\nWrite-Host \"[INFO] Restarting Splunk Universal Forwarder...\"\n& \"$SplunkHome\\bin\\splunk.exe\" restart\n\nStart-Sleep -Seconds 10\n\n# Verify connection\nWrite-Host \"[INFO] Verifying Splunk forwarder status...\"\n& \"$SplunkHome\\bin\\splunk.exe\" list forward-server\n\nWrite-Host \"[SUCCESS] Splunk Universal Forwarder configured for IR-5.1\" -ForegroundColor Green"
        }
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "stig_mappings": [
        "V-230386",
        "V-230396",
        "V-93161",
        "V-205797"
      ],
      "implementation_guidance": "Deploy auditd with STIG-compliant rules on Linux. Configure Windows Event Forwarding and Advanced Audit Policies on Windows. Integrate with SIEM for automated analysis."
    },
    "intent": "Use automated tools to track incidents, collect evidence, and analyze trends instead of relying on spreadsheets and emails."
  },
  {
    "control_id": "IR-6",
    "control_name": "Incident Reporting",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Require personnel to report suspected incidents to the organizational incident response capability within organization-defined time period; and report incident information to organization-defined authorities.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Incident Reporting requires organizations to establish clear procedures for personnel to promptly report security incidents to the appropriate internal response teams and external authorities when required. This includes defining reporting timeframes, communication channels, required incident information, and escalation procedures.",
    "example_implementation": "Implement a clear incident reporting process that includes designated contact points (security operations center, incident response team), multiple communication channels (ticketing system, email, phone hotline), and escalation procedures to ensure incidents are reported and addressed promptly. Configure automated alerts to notify incident response personnel.",
    "non_technical_guidance": "To implement incident reporting: 1. Establish a clear incident reporting process within your organization, including who should be notified, what information should be included in the report, and how quickly incidents should be reported. 2. Train all employees on the incident reporting process to ensure timely and accurate reporting. 3. Establish multiple reporting channels including email aliases, phone hotlines, and ticketing systems. 4. Define incident classification criteria and reporting timeframes based on severity. 5. Document requirements for reporting to external authorities (US-CERT, law enforcement, regulators). 6. Regularly review and update the incident reporting process to incorporate lessons learned from past incidents and stay compliant with regulations. 7. Conduct regular drills or simulations to test the effectiveness of the incident reporting process.",
    "is_technical": false,
    "ai_guidance": "IR-6 Incident Reporting establishes the organizational framework for ensuring security incidents are communicated to appropriate stakeholders in a timely manner. Effective implementation requires both procedural and technical components. Technical infrastructure should include: dedicated incident reporting email aliases (security@org.com) with automated acknowledgment, ticketing system integration (ServiceNow, Jira Service Desk, TheHive) for structured incident submission, phone hotline capability for urgent incidents, and mobile applications for field reporting. Configure automated alerting through SIEM platforms to notify SOC analysts immediately upon detection of high-severity events. Establish tiered notification procedures: Tier 1 (informational) within 72 hours, Tier 2 (moderate impact) within 24 hours, Tier 3 (significant impact) within 4 hours, Tier 4 (critical/emergency) within 1 hour. For federal systems, configure automated reporting capabilities to US-CERT following CISA incident reporting guidelines. Organizations handling specific data types must configure reporting to sector-specific authorities: healthcare incidents to HHS/OCR for HIPAA, financial incidents to relevant regulators. Documentation requirements should include: incident timestamp and detection method, affected systems and data classification, initial impact assessment, containment status, and assigned responder. Integration with ticketing systems should auto-populate fields from SIEM alerts to reduce reporting friction and ensure consistent data collection.",
    "implementation_rationale": "Many incidents have legal reporting requirements. HIPAA breaches must be reported to HHS. Financial incidents may need SEC disclosure. Even internal incidents should be reported up the chain so leadership can make informed decisions. Hiding incidents always backfires.",
    "enhancements": [
      {
        "id": "IR-6.1",
        "title": "Automated Reporting",
        "official_text": "Report incidents using automated mechanisms."
      },
      {
        "id": "IR-6.2",
        "title": "Vulnerabilities Related to Incidents",
        "official_text": "Report system vulnerabilities associated with reported incidents to organization-defined personnel or roles."
      },
      {
        "id": "IR-6.3",
        "title": "Supply Chain Coordination",
        "official_text": "Provide incident information to the provider of the product or service and other organizations involved in the supply chain or supply chain governance for systems or system components related to the incident."
      }
    ],
    "related_controls": [
      "CM-6",
      "CP-2",
      "IR-4",
      "IR-5",
      "IR-8",
      "IR-9"
    ],
    "supplemental_guidance": "The intent of this control is to address both specific incident reporting requirements within an organization and the formal incident reporting requirements for the organization. Suspected incidents include the receipt of suspicious email communications that can contain malicious code. The types of incidents reported and the content and timeliness of the reports are consistent with the incident response plan.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Establish multiple incident reporting channels. Configure automated alerting from SIEM. Define reporting timeframes by severity tier. Document external reporting requirements."
    },
    "intent": "Report security incidents to the right people - management, regulators, affected customers - as required by law and policy."
  },
  {
    "control_id": "IR-6.1",
    "control_name": "Automated Reporting",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Report incidents using automated mechanisms.",
    "parent_control": "IR-6",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Implement automated mechanisms to generate and distribute incident reports to designated personnel and systems. Automation ensures consistent, timely reporting without relying solely on manual processes that may be delayed or inconsistent during incident response activities.",
    "example_implementation": "Configure SIEM to automatically create incident tickets in the organization's ITSM platform when correlation rules detect security events above defined thresholds. Set up automated email notifications to incident response team members and management. Implement webhook integrations for real-time alerting to communication platforms.",
    "non_technical_guidance": "To implement automated incident reporting: 1. Configure SIEM or monitoring tools to automatically generate alerts based on defined detection rules. 2. Integrate monitoring tools with ticketing systems to create incident records automatically. 3. Set up email distribution lists and notification templates for different incident types. 4. Configure escalation workflows that automatically notify management for high-severity incidents. 5. Implement dashboard reporting for real-time incident status visibility. 6. Document automated reporting procedures and ensure backup manual processes exist.",
    "is_technical": true,
    "stig_id": "V-230482",
    "stig_references": [
      {
        "stig_id": "V-230482",
        "title": "RHEL 8 remote logging authentication",
        "description": "Must authenticate remote logging server for off-loading audit logs"
      },
      {
        "stig_id": "V-73403",
        "title": "Windows Server audit record off-loading",
        "description": "Must off-load audit records of interconnected systems in real time"
      }
    ],
    "ai_guidance": "IR-6.1 Automated Reporting requires implementation of technical mechanisms that generate and distribute incident notifications without manual intervention. For SIEM platforms like Splunk, configure alert actions to: create tickets via REST API integration with ServiceNow/Jira, send SMTP notifications to incident response distribution lists, trigger webhooks to Slack/Teams/PagerDuty for real-time alerting, and generate STIX/TAXII formatted threat intelligence for automated sharing. On Linux systems, configure aureport and ausearch to generate periodic incident summary reports. Use logwatch or custom scripts triggered by cron to scan for security-relevant patterns and email reports to SOC. For rsyslog, configure action(type=\"omprog\") to execute incident notification scripts when specific patterns are detected. On Windows systems, configure Task Scheduler triggers on Security Event Log events (Event ID 4625 for failed logons, 4720 for account creation, 4719 for audit policy changes) to execute PowerShell notification scripts. Windows Admin Center can provide automated alerting capabilities. For both platforms, implement SOAR (Security Orchestration, Automation and Response) integration through tools like Phantom, Demisto (XSOAR), or TheHive with Cortex. These platforms enable automated playbook execution including: auto-enrichment of IOCs, automated containment actions, and multi-channel notification. Email notifications should include: incident summary, affected assets, initial classification, assigned analyst, and ticket URL. Consider implementing SMS/voice alerting for critical incidents outside business hours. All automated reports should be logged for audit trail purposes.",
    "implementation_rationale": "When you're fighting a fire, it's easy to forget to file the paperwork. Automated reporting ensures regulatory notifications happen on time, management gets informed immediately, and you have an audit trail proving you did the right thing.",
    "enhancements": [],
    "related_controls": [
      "AU-6",
      "IR-5.1",
      "IR-7.1",
      "SI-4"
    ],
    "supplemental_guidance": "Automated mechanisms for reporting incidents include email, automated reporting systems, and automated notification systems.",
    "implementation_scripts": {
      "linux": {
        "bash": {
          "description": "Configure rsyslog and custom scripts for automated incident alerting",
          "script": "#!/bin/bash\n# IR-6.1: Automated Incident Reporting via rsyslog\n# Triggers alerts on security-relevant events\n\nset -euo pipefail\n\nALERT_EMAIL=\"soc@example.com\"\nSMTP_SERVER=\"smtp.example.com\"\nTICKET_API=\"https://tickets.example.com/api/v2/tickets\"\nTICKET_TOKEN=\"your-api-token\"\n\necho \"[INFO] Configuring automated incident reporting...\"\n\n# Create incident notification script\ncat > /usr/local/bin/incident-notify.sh << 'SCRIPT'\n#!/bin/bash\n# Automated incident notification handler\n\nALERT_EMAIL=\"soc@example.com\"\nSMTP_SERVER=\"smtp.example.com\"\nTICKET_API=\"https://tickets.example.com/api/v2/tickets\"\nTICKET_TOKEN=\"your-api-token\"\nLOG_FILE=\"/var/log/incident-alerts.log\"\n\nread -r message\n\ntimestamp=$(date -u +\"%Y-%m-%dT%H:%M:%SZ\")\nhostname=$(hostname -f)\n\n# Log the alert\necho \"$timestamp | $hostname | $message\" >> \"$LOG_FILE\"\n\n# Determine severity based on message content\nif echo \"$message\" | grep -qE \"(CRITICAL|EMERGENCY|authentication failure.*root)\"; then\n    SEVERITY=\"critical\"\n    PRIORITY=\"1\"\nelif echo \"$message\" | grep -qE \"(WARNING|failed password|sudo)\"; then\n    SEVERITY=\"high\"\n    PRIORITY=\"2\"\nelse\n    SEVERITY=\"medium\"\n    PRIORITY=\"3\"\nfi\n\n# Create JSON payload for ticketing system\nticket_payload=$(cat << EOF\n{\n    \"ticket\": {\n        \"subject\": \"[IR-6.1] Security Alert: $SEVERITY - $hostname\",\n        \"description\": \"Automated security alert detected.\\\\n\\\\nTimestamp: $timestamp\\\\nHost: $hostname\\\\nSeverity: $SEVERITY\\\\n\\\\nAlert Details:\\\\n$message\",\n        \"priority\": \"$PRIORITY\",\n        \"type\": \"incident\",\n        \"tags\": [\"automated\", \"ir-6.1\", \"$SEVERITY\"]\n    }\n}\nEOF\n)\n\n# Send to ticketing system\ncurl -s -X POST \"$TICKET_API\" \\\n    -H \"Content-Type: application/json\" \\\n    -H \"Authorization: Bearer $TICKET_TOKEN\" \\\n    -d \"$ticket_payload\" >> /var/log/ticket-creation.log 2>&1 &\n\n# Send email notification for high/critical alerts\nif [[ \"$SEVERITY\" == \"critical\" || \"$SEVERITY\" == \"high\" ]]; then\n    echo -e \"Subject: [IR-6.1] $SEVERITY Security Alert - $hostname\\n\\nAutomated security alert from IR-6.1 monitoring.\\n\\nTimestamp: $timestamp\\nHost: $hostname\\nSeverity: $SEVERITY\\n\\nAlert Details:\\n$message\" | \\\n    sendmail -t \"$ALERT_EMAIL\" &\nfi\nSCRIPT\n\nchmod 755 /usr/local/bin/incident-notify.sh\n\n# Configure rsyslog to trigger notifications\ncat > /etc/rsyslog.d/60-incident-notify.conf << 'EOF'\n# IR-6.1: Automated incident reporting rules\nmodule(load=\"omprog\")\n\n# Authentication failures - immediate notification\nif ($programname == 'sshd' and $msg contains 'Failed password') then {\n    action(type=\"omprog\"\n           binary=\"/usr/local/bin/incident-notify.sh\"\n           template=\"RSYSLOG_TraditionalFileFormat\")\n}\n\n# Privilege escalation - immediate notification  \nif ($programname == 'sudo' and $msg contains 'COMMAND') then {\n    action(type=\"omprog\"\n           binary=\"/usr/local/bin/incident-notify.sh\"\n           template=\"RSYSLOG_TraditionalFileFormat\")\n}\n\n# Auditd alerts for privileged access\nif ($programname == 'audispd' and $msg contains 'execpriv') then {\n    action(type=\"omprog\"\n           binary=\"/usr/local/bin/incident-notify.sh\"\n           template=\"RSYSLOG_TraditionalFileFormat\")\n}\n\n# PAM authentication events\nif ($programname == 'pam' and $msg contains 'authentication failure') then {\n    action(type=\"omprog\"\n           binary=\"/usr/local/bin/incident-notify.sh\"\n           template=\"RSYSLOG_TraditionalFileFormat\")\n}\nEOF\n\n# Create periodic incident summary report script\ncat > /usr/local/bin/daily-incident-report.sh << 'SCRIPT'\n#!/bin/bash\n# Daily incident summary report\n\nREPORT_EMAIL=\"soc@example.com\"\nREPORT_DATE=$(date -d yesterday +\"%Y-%m-%d\")\n\necho \"IR-6.1 Daily Incident Summary Report\"\necho \"====================================\"\necho \"Report Date: $REPORT_DATE\"\necho \"Generated: $(date)\"\necho \"\"\necho \"Authentication Failures:\"\ngrep \"Failed password\" /var/log/secure | grep \"$REPORT_DATE\" | wc -l\necho \"\"\necho \"Successful Root Logins:\"\ngrep \"session opened for user root\" /var/log/secure | grep \"$REPORT_DATE\" | wc -l\necho \"\"\necho \"Sudo Commands Executed:\"\ngrep \"COMMAND=\" /var/log/secure | grep \"$REPORT_DATE\" | wc -l\necho \"\"\necho \"Auditd Alerts:\"\naureport -ts \"$REPORT_DATE 00:00:00\" -te \"$REPORT_DATE 23:59:59\" --summary 2>/dev/null || echo \"No auditd data\"\nSCRIPT\n\nchmod 755 /usr/local/bin/daily-incident-report.sh\n\n# Add cron job for daily report\necho \"0 6 * * * root /usr/local/bin/daily-incident-report.sh | mail -s '[IR-6.1] Daily Incident Report' $ALERT_EMAIL\" > /etc/cron.d/incident-report\n\n# Restart rsyslog\nsystemctl restart rsyslog\n\necho \"[SUCCESS] Automated incident reporting configured\""
        }
      },
      "windows": {
        "powershell": {
          "description": "Configure Windows Event-triggered automated incident reporting",
          "script": "# IR-6.1: Automated Incident Reporting via Windows Events\n# Creates Task Scheduler triggers for security event notifications\n\n#Requires -RunAsAdministrator\n\nparam(\n    [Parameter(Mandatory=$false)]\n    [string]$AlertEmail = \"soc@example.com\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$SMTPServer = \"smtp.example.com\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$TicketingAPI = \"https://tickets.example.com/api/v2/tickets\"\n)\n\n$ErrorActionPreference = \"Stop\"\n\nWrite-Host \"[INFO] Configuring automated incident reporting (IR-6.1)...\" -ForegroundColor Cyan\n\n# Create incident notification script\n$notifyScriptPath = \"C:\\ProgramData\\IncidentReporting\"\nNew-Item -ItemType Directory -Path $notifyScriptPath -Force | Out-Null\n\n$notifyScript = @'\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$EventID,\n    \n    [Parameter(Mandatory=$true)]\n    [string]$EventMessage,\n    \n    [Parameter(Mandatory=$true)]\n    [string]$Severity\n)\n\n$AlertEmail = \"soc@example.com\"\n$SMTPServer = \"smtp.example.com\"\n$TicketingAPI = \"https://tickets.example.com/api/v2/tickets\"\n$LogFile = \"C:\\ProgramData\\IncidentReporting\\alerts.log\"\n\n$timestamp = Get-Date -Format \"yyyy-MM-ddTHH:mm:ssZ\"\n$hostname = $env:COMPUTERNAME\n\n# Log the alert\n\"$timestamp | $hostname | EventID:$EventID | $Severity | $EventMessage\" | Out-File -Append -FilePath $LogFile\n\n# Create ticket payload\n$ticketPayload = @{\n    ticket = @{\n        subject = \"[IR-6.1] Security Alert: $Severity - $hostname - Event $EventID\"\n        description = @\"\nAutomated security alert detected.\n\nTimestamp: $timestamp\nHost: $hostname\nEvent ID: $EventID\nSeverity: $Severity\n\nEvent Details:\n$EventMessage\n\"@\n        priority = switch ($Severity) {\n            \"Critical\" { \"1\" }\n            \"High\" { \"2\" }\n            \"Medium\" { \"3\" }\n            default { \"4\" }\n        }\n        type = \"incident\"\n        tags = @(\"automated\", \"ir-6.1\", $Severity.ToLower(), \"windows\")\n    }\n} | ConvertTo-Json -Depth 3\n\n# Send to ticketing system (async)\nStart-Job -ScriptBlock {\n    param($api, $payload)\n    try {\n        Invoke-RestMethod -Uri $api -Method Post -Body $payload -ContentType \"application/json\"\n    } catch {\n        $_ | Out-File -Append \"C:\\ProgramData\\IncidentReporting\\ticket-errors.log\"\n    }\n} -ArgumentList $TicketingAPI, $ticketPayload | Out-Null\n\n# Send email for Critical/High severity\nif ($Severity -in @(\"Critical\", \"High\")) {\n    $emailParams = @{\n        From = \"security-alerts@$($env:USERDNSDOMAIN)\"\n        To = $AlertEmail\n        Subject = \"[IR-6.1] $Severity Security Alert - $hostname\"\n        Body = @\"\nAutomated security alert from IR-6.1 monitoring.\n\nTimestamp: $timestamp\nHost: $hostname  \nEvent ID: $EventID\nSeverity: $Severity\n\nEvent Details:\n$EventMessage\n\nThis is an automated notification. Please review and respond according to incident response procedures.\n\"@\n        SmtpServer = $SMTPServer\n    }\n    \n    try {\n        Send-MailMessage @emailParams\n    } catch {\n        \"Email failed: $_\" | Out-File -Append \"C:\\ProgramData\\IncidentReporting\\email-errors.log\"\n    }\n}\n'@\n\n$notifyScript | Out-File -FilePath \"$notifyScriptPath\\Send-IncidentAlert.ps1\" -Encoding UTF8\n\n# Define security events to monitor\n$monitoredEvents = @(\n    @{ EventID = 4625; Severity = \"High\"; Description = \"Failed logon attempt\" },\n    @{ EventID = 4648; Severity = \"Medium\"; Description = \"Explicit credential logon\" },\n    @{ EventID = 4719; Severity = \"Critical\"; Description = \"System audit policy changed\" },\n    @{ EventID = 4720; Severity = \"High\"; Description = \"User account created\" },\n    @{ EventID = 4726; Severity = \"High\"; Description = \"User account deleted\" },\n    @{ EventID = 4732; Severity = \"Critical\"; Description = \"Member added to security-enabled local group\" },\n    @{ EventID = 4735; Severity = \"High\"; Description = \"Security-enabled local group changed\" },\n    @{ EventID = 4740; Severity = \"High\"; Description = \"User account locked out\" },\n    @{ EventID = 4756; Severity = \"Critical\"; Description = \"Member added to universal security group\" },\n    @{ EventID = 4672; Severity = \"Medium\"; Description = \"Special privileges assigned\" },\n    @{ EventID = 1102; Severity = \"Critical\"; Description = \"Audit log cleared\" }\n)\n\n# Create scheduled tasks for each monitored event\nforeach ($event in $monitoredEvents) {\n    $taskName = \"IR61_Alert_Event$($event.EventID)\"\n    \n    # Create event trigger\n    $trigger = New-ScheduledTaskTrigger -AtLogon  # Placeholder, will be replaced\n    \n    # Create action\n    $action = New-ScheduledTaskAction -Execute \"powershell.exe\" -Argument @\"\n-ExecutionPolicy Bypass -NoProfile -File \"$notifyScriptPath\\Send-IncidentAlert.ps1\" -EventID \"$($event.EventID)\" -EventMessage \"$($event.Description)\" -Severity \"$($event.Severity)\"\n\"@\n    \n    # Create task settings\n    $settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable\n    \n    # Create event-based trigger using XML\n    $taskXml = @\"\n<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n<Task version=\"1.4\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n  <RegistrationInfo>\n    <Description>IR-6.1 Automated Alert for Security Event $($event.EventID)</Description>\n  </RegistrationInfo>\n  <Triggers>\n    <EventTrigger>\n      <Enabled>true</Enabled>\n      <Subscription>&lt;QueryList&gt;&lt;Query Id=\"0\" Path=\"Security\"&gt;&lt;Select Path=\"Security\"&gt;*[System[EventID=$($event.EventID)]]&lt;/Select&gt;&lt;/Query&gt;&lt;/QueryList&gt;</Subscription>\n    </EventTrigger>\n  </Triggers>\n  <Principals>\n    <Principal id=\"Author\">\n      <UserId>S-1-5-18</UserId>\n      <RunLevel>HighestAvailable</RunLevel>\n    </Principal>\n  </Principals>\n  <Settings>\n    <MultipleInstancesPolicy>Parallel</MultipleInstancesPolicy>\n    <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\n    <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>\n    <AllowHardTerminate>true</AllowHardTerminate>\n    <StartWhenAvailable>true</StartWhenAvailable>\n    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n    <AllowStartOnDemand>true</AllowStartOnDemand>\n    <Enabled>true</Enabled>\n    <Hidden>false</Hidden>\n    <ExecutionTimeLimit>PT1H</ExecutionTimeLimit>\n    <Priority>7</Priority>\n  </Settings>\n  <Actions Context=\"Author\">\n    <Exec>\n      <Command>powershell.exe</Command>\n      <Arguments>-ExecutionPolicy Bypass -NoProfile -File \"$notifyScriptPath\\Send-IncidentAlert.ps1\" -EventID \"$($event.EventID)\" -EventMessage \"$($event.Description)\" -Severity \"$($event.Severity)\"</Arguments>\n    </Exec>\n  </Actions>\n</Task>\n\"@\n    \n    # Unregister existing task if present\n    Unregister-ScheduledTask -TaskName $taskName -Confirm:$false -ErrorAction SilentlyContinue\n    \n    # Register new task\n    Register-ScheduledTask -TaskName $taskName -Xml $taskXml -TaskPath \"\\IncidentResponse\\\" -Force | Out-Null\n    \n    Write-Host \"  Created alert task for Event ID $($event.EventID): $($event.Description)\" -ForegroundColor Green\n}\n\nWrite-Host \"\"\nWrite-Host \"[SUCCESS] IR-6.1 automated incident reporting configured\" -ForegroundColor Green\nWrite-Host \"Monitored events: $($monitoredEvents.Count)\"\nWrite-Host \"Alert script: $notifyScriptPath\\Send-IncidentAlert.ps1\"\nWrite-Host \"Log file: $notifyScriptPath\\alerts.log\""
        }
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "stig_mappings": [
        "V-230482",
        "V-73403"
      ],
      "implementation_guidance": "Configure rsyslog with omprog for automated alerting on Linux. Create Windows Task Scheduler triggers for security events. Integrate with ticketing and email systems."
    },
    "intent": "Automate incident reporting so required notifications happen quickly and consistently, without someone having to remember."
  },
  {
    "control_id": "IR-6.2",
    "control_name": "Vulnerabilities Related to Incidents",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Report system vulnerabilities associated with reported incidents to organization-defined personnel or roles.",
    "parent_control": "IR-6",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "When security incidents are investigated, any vulnerabilities discovered during the investigation must be reported to designated personnel such as vulnerability management teams, system owners, or security architects. This ensures vulnerabilities exploited or discovered during incidents are remediated to prevent recurrence.",
    "example_implementation": "Integrate incident response procedures with vulnerability management workflows. When incident responders identify exploited vulnerabilities, create records in the vulnerability management system with cross-references to incident tickets. Notify system owners and remediation teams of discovered vulnerabilities.",
    "non_technical_guidance": "To implement vulnerability reporting from incidents: 1. Define which personnel/roles should receive vulnerability reports from incident investigations. 2. Create procedures for incident responders to document and report discovered vulnerabilities. 3. Establish a cross-reference system between incident tickets and vulnerability records. 4. Define timelines for vulnerability notification based on severity. 5. Create templates for vulnerability reports that include CVE references, affected systems, and remediation recommendations. 6. Integrate vulnerability reporting into incident closure checklists.",
    "is_technical": false,
    "ai_guidance": "IR-6.2 addresses the critical linkage between incident response and vulnerability management programs. When incidents occur, they often reveal vulnerabilities that enabled the attack or were discovered during investigation. Effective implementation requires: establishing clear communication channels between IR and vulnerability management teams, creating standardized vulnerability documentation templates that capture CVE identifiers where applicable, affected systems, exploitation evidence, and recommended remediation. Technical integration points include: configuring incident ticketing systems (ServiceNow, Jira) with fields for vulnerability cross-references, integrating with vulnerability scanners (Nessus, Qualys, Tenable.io) to trigger targeted scans of affected systems post-incident, and linking to patch management systems for accelerated remediation tracking. For discovered zero-day vulnerabilities, implement procedures for coordinated disclosure to vendors and CISA. Automation opportunities include: SOAR playbooks that automatically create vulnerability tickets when specific exploit signatures are detected, API integration between incident and vulnerability management platforms, and automated enrichment that queries NVD for CVE details when vulnerability identifiers are mentioned in incident notes. Reporting should include: vulnerability severity (CVSS score), systems at risk beyond the incident scope, compensating controls in place, remediation status tracking, and validation that fixes are effective.",
    "implementation_rationale": "If an attacker exploited a vulnerability in one system, that same vulnerability probably exists in others. Reporting it to your vulnerability management team ensures the hole gets patched across your entire environment, not just where the incident occurred.",
    "enhancements": [],
    "related_controls": [
      "CA-2",
      "CA-7",
      "IR-4",
      "RA-5",
      "SI-2"
    ],
    "supplemental_guidance": "Vulnerabilities associated with incidents include product vulnerabilities, configuration errors, and procedural gaps.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "procedural",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Integrate incident response with vulnerability management workflows. Create cross-reference procedures between incident tickets and vulnerability records."
    },
    "intent": "When an incident reveals a vulnerability, report it so it can be fixed everywhere, not just in the affected system."
  },
  {
    "control_id": "IR-6.3",
    "control_name": "Supply Chain Coordination",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Provide incident information to the provider of the product or service and other organizations involved in the supply chain or supply chain governance for systems or system components related to the incident.",
    "parent_control": "IR-6",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "When security incidents involve third-party products, services, or components, share relevant incident information with those providers and other supply chain partners. This coordination helps identify widespread impacts, enables vendors to develop patches, and allows other affected organizations to take protective action.",
    "example_implementation": "Maintain a supply chain contact registry with security notification contacts for critical vendors. When incidents involve third-party components, notify vendors following established protocols. Participate in ISACs and threat sharing communities to share and receive supply chain threat intelligence.",
    "non_technical_guidance": "To implement supply chain incident coordination: 1. Inventory critical vendors and supply chain partners. 2. Obtain security contact information for each vendor (typically in contracts or vendor security portals). 3. Define incident types that trigger supply chain notification requirements. 4. Create notification templates that share relevant details while protecting sensitive internal information. 5. Establish communication channels (encrypted email, secure portals) for sensitive incident sharing. 6. Document notification activities for compliance purposes. 7. Participate in relevant ISACs for industry-specific threat sharing. 8. Include supply chain notification requirements in incident response playbooks.",
    "is_technical": false,
    "ai_guidance": "IR-6.3 addresses supply chain incident coordination, which has become critical given increasing supply chain attacks (SolarWinds, Kaseya, Log4j). Implementation requires: maintaining a vendor security contact database with 24/7 emergency contacts for critical suppliers, defining incident classification criteria that trigger supply chain notifications (e.g., any incident involving vendor software, compromised credentials for vendor systems, malware that may spread to connected partners). Technical infrastructure should include: secure communication channels (Signal, encrypted email) for sharing sensitive incident details, STIX/TAXII feeds for automated indicator sharing with trusted partners, and integration with ISACs (Information Sharing and Analysis Centers) for sector-specific coordination. For software supply chain incidents, establish procedures for: notifying vendors of discovered vulnerabilities in their products, receiving and acting on vendor security advisories, and coordinating disclosure timelines for vulnerabilities affecting shared components. Documentation should include: what information was shared, with whom, when, and acknowledgment of receipt. This creates audit trails for compliance and enables post-incident review of coordination effectiveness. Organizations using cloud services should understand provider incident notification obligations in contracts and configure webhook integrations for provider status pages. Consider implementing SBOM (Software Bill of Materials) tracking to rapidly identify exposure when supply chain vulnerabilities are announced.",
    "implementation_rationale": "If you discover a vulnerability in a vendor's product, they need to know so they can patch it for everyone. Good supply chain citizenship means sharing incident information that could help others. What you report today might prevent thousands of breaches tomorrow.",
    "enhancements": [],
    "related_controls": [
      "CA-3",
      "IR-4",
      "PM-30",
      "SA-9",
      "SR-8"
    ],
    "supplemental_guidance": "The types of incident information shared may vary over time. Factors to consider include the type of incident and the interests of third-party providers and other supply chain organizations.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "procedural",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Maintain supply chain contact registry. Define notification triggers and templates. Participate in ISACs for threat sharing. Implement STIX/TAXII for automated sharing."
    },
    "intent": "When incidents involve your vendors' products or services, let them know so they can fix issues for all their customers."
  },
  {
    "control_id": "IR-7",
    "control_name": "Incident Response Assistance",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Provide an incident response support resource, integral to the organizational incident response capability, that offers advice and assistance to users of the system for the handling and reporting of incidents.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Have a designated resource available to help users with handling and reporting security incidents. This can be a help desk, security operations center, or dedicated incident response team that users can contact for guidance when they suspect a security incident.",
    "example_implementation": "Train a team of IT security staff to serve as incident response support, and ensure they are easily accessible to all users through multiple channels (phone, email, chat) in case of a security incident. Create self-service resources including incident reporting guides and FAQ documents.",
    "non_technical_guidance": "To comply with IR-7: 1. Designate knowledgeable individuals within your organization to serve as incident response support personnel. 2. Ensure these individuals are trained on incident response procedures, communication protocols, and reporting requirements. 3. Establish clear guidelines on how users can access the incident response support resource, such as a dedicated email address, phone number, or ticketing portal. 4. Regularly communicate the availability of this resource to all system users and provide training on how to effectively engage with the incident response support team. 5. Continuously monitor and evaluate the effectiveness of the incident response support resource to ensure it meets the needs of users. 6. Create self-service resources (knowledge base, FAQs) for common incident types.",
    "is_technical": false,
    "ai_guidance": "IR-7 ensures users have access to guidance and support when they encounter or suspect security incidents. Effective implementation requires: establishing multiple contact channels including phone hotline (with 24/7 availability for critical systems), email alias (security@org.com), chat/messaging platforms (Slack channel, Teams), and ticketing system with incident category. Support staff should have access to incident response runbooks, escalation procedures, and authority to initiate containment actions. Self-service resources should include: incident reporting guides explaining what information to collect, decision trees for common scenarios (phishing, malware, data breach), and FAQ documents. Technical infrastructure includes: knowledge base platforms (Confluence, SharePoint) with searchable incident guidance, chatbots for initial triage and information collection, and automated ticket routing based on incident type. For distributed organizations, consider regional or time-zone-based support coverage. Metrics to track include: average response time to user inquiries, user satisfaction with support, and percentage of incidents properly reported through official channels (vs. discovered through other means). Training programs should ensure support staff understand: common attack types and indicators, proper evidence preservation, when to escalate to senior responders, and how to communicate with stressed users during active incidents. Regular tabletop exercises should include scenarios testing user awareness of how to contact support resources.",
    "implementation_rationale": "Most incidents are first noticed by regular employees, not security tools. If reporting is hard or confusing, people won't do it. An accessible, responsive support resource turns every employee into a potential incident detector.",
    "enhancements": [
      {
        "id": "IR-7.1",
        "title": "Automation Support for Availability of Information and Support",
        "official_text": "Increase the availability of incident response information and support using automated mechanisms."
      },
      {
        "id": "IR-7.2",
        "title": "Coordination with External Providers",
        "official_text": "Establish a direct, cooperative relationship between its incident response capability and external providers of system protection capability."
      }
    ],
    "related_controls": [
      "AT-2",
      "AT-3",
      "IR-4",
      "IR-6",
      "IR-8",
      "PM-22",
      "SA-9"
    ],
    "supplemental_guidance": "Incident response support resources provided by organizations include help desks, assistance groups, and access to forensics services. System users may require assistance when indicators of compromise are discovered or detected.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Establish multiple contact channels for incident support. Create self-service knowledge base. Train support staff on incident procedures."
    },
    "intent": "Give your users an easy way to get help when they think something might be wrong - a security hotline or help desk."
  },
  {
    "control_id": "IR-7.1",
    "control_name": "Automation Support for Availability of Information and Support",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Increase the availability of incident response information and support using automated mechanisms.",
    "parent_control": "IR-7",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "Use automated mechanisms to increase the availability of incident response information and support to users. This includes self-service portals, chatbots, automated knowledge bases, and always-available digital resources that users can access without waiting for human assistance.",
    "example_implementation": "Deploy a security knowledge base portal with searchable incident guidance, implement a chatbot for initial incident triage, and create automated email responses with relevant resources when users report incidents. Ensure 24/7 availability of self-service resources.",
    "non_technical_guidance": "To implement automated incident support: 1. Deploy a knowledge base platform with incident response guides and FAQs. 2. Implement chatbot or virtual assistant for initial triage questions. 3. Configure automated email responses with relevant resources for incident reports. 4. Create mobile-accessible incident reporting and guidance. 5. Develop video tutorials for common incident scenarios. 6. Implement ticketing system with automated routing and SLA tracking. 7. Ensure all automated resources are available 24/7.",
    "is_technical": true,
    "ai_guidance": "IR-7.1 requires leveraging automation to ensure incident response information and support are available continuously, regardless of human analyst availability. Key implementation areas include: Self-Service Knowledge Base - Deploy platforms like Confluence, SharePoint, or dedicated security portals with searchable incident response documentation. Content should include: step-by-step guides for common incidents (phishing, malware, account compromise), decision trees for incident classification, evidence preservation procedures, and contact escalation paths. Chatbots and Virtual Assistants - Implement conversational AI (Microsoft Power Virtual Agents, ServiceNow Virtual Agent, custom solutions) to provide 24/7 initial triage. Chatbots should collect key incident information (what happened, when, affected systems), provide immediate guidance (disconnect from network, preserve evidence), and route to appropriate human responders. Automated Ticket Management - Configure ticketing systems to auto-acknowledge submissions, assign priority based on keywords, route to appropriate queues, and provide estimated response times. SLA monitoring should automatically escalate overdue tickets. Mobile Accessibility - Ensure all resources are accessible via mobile devices for field personnel or remote workers. Consider dedicated mobile apps for incident reporting with features like photo attachment for physical security incidents. Automated Notification Systems - Implement broadcast capability to push security advisories to all users during active incidents (e.g., phishing campaigns). Video and Interactive Training - Deploy on-demand training modules covering incident recognition and reporting. APIs and Integration - Expose incident reporting APIs for integration with other tools (endpoint protection reporting, SIEM ticket creation). Metrics should track: self-service utilization rates, chatbot resolution rates, average time to first response, and user satisfaction.",
    "implementation_rationale": "Security incidents don't wait for business hours. Automated support systems can provide immediate guidance at 2 AM, collect initial information, and escalate to humans when needed. Even simple automation beats 'leave a voicemail and we'll call you back Monday.'",
    "enhancements": [],
    "related_controls": [
      "IR-5.1",
      "IR-6.1",
      "PM-22"
    ],
    "supplemental_guidance": "Automated mechanisms can increase the availability of incident response-related information, including guidance on how to handle incidents and supporting information for reporting incidents.",
    "implementation_scripts": {
      "linux": {
        "bash": {
          "description": "Deploy automated incident support portal using open-source tools",
          "script": "#!/bin/bash\n# IR-7.1: Automated Incident Support Portal Setup\n# Deploys Wiki.js for knowledge base and Node-RED for automation\n\nset -euo pipefail\n\nDOMAIN=\"security.example.com\"\nADMIN_EMAIL=\"security-admin@example.com\"\nINSTALL_DIR=\"/opt/incident-portal\"\n\necho \"[INFO] Setting up automated incident support infrastructure...\"\n\n# Install dependencies\ndnf install -y nodejs npm nginx postgresql-server postgresql-contrib\n\n# Initialize PostgreSQL\npostgresql-setup --initdb\nsystemctl enable --now postgresql\n\n# Create database for Wiki.js\nsudo -u postgres psql << 'EOF'\nCREATE USER wikijs WITH PASSWORD 'changeme_wikijs_password';\nCREATE DATABASE wikijs OWNER wikijs;\nGRANT ALL PRIVILEGES ON DATABASE wikijs TO wikijs;\nEOF\n\n# Create installation directory\nmkdir -p \"$INSTALL_DIR\"\ncd \"$INSTALL_DIR\"\n\n# Download and setup Wiki.js\necho \"[INFO] Installing Wiki.js knowledge base...\"\nmkdir -p wiki\ncd wiki\ncurl -sSo wiki-js.tar.gz https://github.com/Requarks/wiki/releases/latest/download/wiki-js.tar.gz\ntar xzf wiki-js.tar.gz\nrm wiki-js.tar.gz\n\n# Configure Wiki.js\ncat > config.yml << EOF\nport: 3000\ndb:\n  type: postgres\n  host: localhost\n  port: 5432\n  user: wikijs\n  pass: changeme_wikijs_password\n  db: wikijs\nbindIP: 127.0.0.1\nlogLevel: info\nha: false\noffline: false\nEOF\n\n# Create systemd service for Wiki.js\ncat > /etc/systemd/system/wikijs.service << 'EOF'\n[Unit]\nDescription=Wiki.js Incident Knowledge Base\nAfter=network.target postgresql.service\n\n[Service]\nType=simple\nWorkingDirectory=/opt/incident-portal/wiki\nExecStart=/usr/bin/node server\nRestart=always\nRestartSec=10\nUser=root\nEnvironment=NODE_ENV=production\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n# Setup nginx reverse proxy\ncat > /etc/nginx/conf.d/incident-portal.conf << EOF\nserver {\n    listen 80;\n    server_name $DOMAIN;\n    return 301 https://\\$server_name\\$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name $DOMAIN;\n    \n    # SSL configuration (update paths to your certificates)\n    ssl_certificate /etc/pki/tls/certs/server.crt;\n    ssl_certificate_key /etc/pki/tls/private/server.key;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    \n    location / {\n        proxy_pass http://127.0.0.1:3000;\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n        proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \\$scheme;\n    }\n    \n    # Incident reporting API endpoint\n    location /api/report-incident {\n        proxy_pass http://127.0.0.1:1880/report-incident;\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n    }\n}\nEOF\n\n# Install Node-RED for automation workflows\ncd \"$INSTALL_DIR\"\nnpm install -g node-red\nmkdir -p nodered\n\n# Create Node-RED service\ncat > /etc/systemd/system/nodered.service << 'EOF'\n[Unit]\nDescription=Node-RED Incident Automation\nAfter=network.target\n\n[Service]\nType=simple\nWorkingDirectory=/opt/incident-portal/nodered\nExecStart=/usr/bin/node-red --userDir /opt/incident-portal/nodered\nRestart=always\nRestartSec=10\nUser=root\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n# Create sample incident reporting flow for Node-RED\ncat > \"$INSTALL_DIR/nodered/flows.json\" << 'EOF'\n[\n    {\n        \"id\": \"incident-report-endpoint\",\n        \"type\": \"http in\",\n        \"url\": \"/report-incident\",\n        \"method\": \"post\",\n        \"name\": \"Incident Report API\"\n    },\n    {\n        \"id\": \"process-incident\",\n        \"type\": \"function\",\n        \"name\": \"Process Incident\",\n        \"func\": \"var incident = msg.payload;\\nincident.timestamp = new Date().toISOString();\\nincident.status = 'new';\\nmsg.payload = incident;\\nreturn msg;\"\n    },\n    {\n        \"id\": \"send-notification\",\n        \"type\": \"e-mail\",\n        \"name\": \"Notify SOC\",\n        \"to\": \"soc@example.com\"\n    },\n    {\n        \"id\": \"auto-response\",\n        \"type\": \"http response\",\n        \"name\": \"Auto Response\"\n    }\n]\nEOF\n\n# Enable and start services\nsystemctl daemon-reload\nsystemctl enable --now wikijs nodered nginx\n\n# Open firewall ports\nfirewall-cmd --permanent --add-service=https\nfirewall-cmd --reload\n\necho \"[SUCCESS] Incident support portal infrastructure deployed\"\necho \"Knowledge Base: https://$DOMAIN\"\necho \"Automation Engine: http://localhost:1880 (Node-RED)\""
        }
      },
      "windows": {
        "powershell": {
          "description": "Deploy PowerShell-based incident triage chatbot integration",
          "script": "# IR-7.1: Incident Support Automation for Windows\n# Creates self-service incident reporting and automated responses\n\n#Requires -RunAsAdministrator\n\nparam(\n    [Parameter(Mandatory=$false)]\n    [string]$SharePointSite = \"https://contoso.sharepoint.com/sites/Security\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$TeamsWebhook = \"https://outlook.office.com/webhook/your-webhook-url\"\n)\n\n$ErrorActionPreference = \"Stop\"\n$InstallPath = \"C:\\ProgramData\\IncidentSupport\"\n\nWrite-Host \"[INFO] Configuring automated incident support (IR-7.1)...\" -ForegroundColor Cyan\n\n# Create directory structure\nNew-Item -ItemType Directory -Path $InstallPath -Force | Out-Null\nNew-Item -ItemType Directory -Path \"$InstallPath\\Reports\" -Force | Out-Null\nNew-Item -ItemType Directory -Path \"$InstallPath\\KnowledgeBase\" -Force | Out-Null\n\n# Create incident reporting PowerShell function module\n$reportingModule = @'\nfunction Submit-IncidentReport {\n    <#\n    .SYNOPSIS\n    Submit a security incident report through the automated system.\n    \n    .DESCRIPTION\n    IR-7.1 compliant incident reporting that provides immediate guidance\n    and routes reports to appropriate responders.\n    \n    .PARAMETER IncidentType\n    Type of incident: Phishing, Malware, AccountCompromise, DataBreach, Other\n    \n    .PARAMETER Description\n    Detailed description of the incident\n    \n    .PARAMETER AffectedSystems\n    List of affected system names or IP addresses\n    #>\n    [CmdletBinding()]\n    param(\n        [Parameter(Mandatory=$true)]\n        [ValidateSet(\"Phishing\", \"Malware\", \"AccountCompromise\", \"DataBreach\", \"PhysicalSecurity\", \"Other\")]\n        [string]$IncidentType,\n        \n        [Parameter(Mandatory=$true)]\n        [string]$Description,\n        \n        [Parameter(Mandatory=$false)]\n        [string[]]$AffectedSystems,\n        \n        [Parameter(Mandatory=$false)]\n        [string]$ContactEmail = $env:USERNAME + \"@\" + $env:USERDNSDOMAIN\n    )\n    \n    $timestamp = Get-Date -Format \"yyyy-MM-ddTHH:mm:ssZ\"\n    $incidentId = \"INC-\" + (Get-Date -Format \"yyyyMMdd-HHmmss\") + \"-\" + (Get-Random -Maximum 9999).ToString(\"D4\")\n    \n    $incident = @{\n        IncidentId = $incidentId\n        Timestamp = $timestamp\n        Reporter = $env:USERNAME\n        ReporterEmail = $ContactEmail\n        ComputerName = $env:COMPUTERNAME\n        IncidentType = $IncidentType\n        Description = $Description\n        AffectedSystems = $AffectedSystems -join \", \"\n        Status = \"New\"\n    }\n    \n    # Save report locally\n    $reportPath = \"C:\\ProgramData\\IncidentSupport\\Reports\\$incidentId.json\"\n    $incident | ConvertTo-Json | Out-File -FilePath $reportPath\n    \n    # Provide immediate guidance based on incident type\n    $guidance = switch ($IncidentType) {\n        \"Phishing\" {\n            @\"\n=== IMMEDIATE ACTIONS FOR PHISHING ===\"\n1. DO NOT click any links or open attachments in the suspicious email\n2. DO NOT reply to the sender\n3. If you clicked a link, disconnect from the network immediately\n4. If you entered credentials, change your password NOW at: https://password.example.com\n5. Forward the suspicious email to: phishing@example.com\n6. Your incident has been logged: $incidentId\n\nSOC will contact you within 30 minutes.\n\"@\n        }\n        \"Malware\" {\n            @\"\n=== IMMEDIATE ACTIONS FOR MALWARE ===\"\n1. DISCONNECT your computer from the network (unplug Ethernet or disable WiFi)\n2. DO NOT power off the computer (preserves evidence)\n3. DO NOT try to clean the malware yourself\n4. Note any unusual behavior, pop-ups, or error messages\n5. Your incident has been logged: $incidentId\n\nSOC will contact you within 15 minutes. A technician may be dispatched.\n\"@\n        }\n        \"AccountCompromise\" {\n            @\"\n=== IMMEDIATE ACTIONS FOR ACCOUNT COMPROMISE ===\"\n1. Change your password immediately at: https://password.example.com\n2. Enable MFA if not already enabled\n3. Review recent account activity for unauthorized access\n4. Check for unauthorized email rules or forwarding\n5. Your incident has been logged: $incidentId\n\nSOC will contact you within 20 minutes.\n\"@\n        }\n        \"DataBreach\" {\n            @\"\n=== IMMEDIATE ACTIONS FOR DATA BREACH ===\"\n1. DO NOT share information about this incident outside security channels\n2. Document what data may have been exposed\n3. Identify how the data was accessed or shared\n4. Preserve any evidence (emails, files, logs)\n5. Your incident has been logged: $incidentId\n\n** THIS IS HIGH PRIORITY - SOC will contact you within 10 minutes **\n\"@\n        }\n        default {\n            @\"\n=== INCIDENT RECEIVED ===\"\nYour incident has been logged: $incidentId\n\nSOC will review and contact you within 60 minutes.\nFor emergencies, call the security hotline: 1-800-SEC-HELP\n\"@\n        }\n    }\n    \n    Write-Host \"\"\n    Write-Host $guidance -ForegroundColor Yellow\n    Write-Host \"\"\n    \n    # Send to Teams webhook if configured\n    $TeamsWebhook = \"https://outlook.office.com/webhook/your-webhook-url\"\n    if ($TeamsWebhook -and $TeamsWebhook -notlike \"*your-webhook*\") {\n        $teamsPayload = @{\n            \"@type\" = \"MessageCard\"\n            \"@context\" = \"http://schema.org/extensions\"\n            themeColor = switch ($IncidentType) {\n                \"DataBreach\" { \"FF0000\" }\n                \"Malware\" { \"FF6600\" }\n                \"AccountCompromise\" { \"FF9900\" }\n                default { \"0076D7\" }\n            }\n            summary = \"New Incident: $incidentId\"\n            sections = @(\n                @{\n                    activityTitle = \"Security Incident Report: $incidentId\"\n                    facts = @(\n                        @{ name = \"Type\"; value = $IncidentType },\n                        @{ name = \"Reporter\"; value = $env:USERNAME },\n                        @{ name = \"Computer\"; value = $env:COMPUTERNAME },\n                        @{ name = \"Time\"; value = $timestamp }\n                    )\n                    text = $Description\n                }\n            )\n        }\n        \n        try {\n            Invoke-RestMethod -Uri $TeamsWebhook -Method Post -Body ($teamsPayload | ConvertTo-Json -Depth 10) -ContentType \"application/json\" | Out-Null\n        } catch {\n            Write-Warning \"Could not send Teams notification: $_\"\n        }\n    }\n    \n    return $incidentId\n}\n\nfunction Get-IncidentGuidance {\n    <#\n    .SYNOPSIS\n    Get guidance for handling specific incident types\n    #>\n    param(\n        [Parameter(Mandatory=$true)]\n        [ValidateSet(\"Phishing\", \"Malware\", \"AccountCompromise\", \"DataBreach\", \"PhysicalSecurity\", \"SuspiciousActivity\")]\n        [string]$Topic\n    )\n    \n    $guidanceBase = \"C:\\ProgramData\\IncidentSupport\\KnowledgeBase\"\n    $guidanceFile = Join-Path $guidanceBase \"$Topic.md\"\n    \n    if (Test-Path $guidanceFile) {\n        Get-Content $guidanceFile -Raw\n    } else {\n        \"Guidance for $Topic not found locally. Visit https://security.example.com/kb for online resources.\"\n    }\n}\n\nExport-ModuleMember -Function Submit-IncidentReport, Get-IncidentGuidance\n'@\n\n$reportingModule | Out-File -FilePath \"$InstallPath\\IncidentSupport.psm1\" -Encoding UTF8\n\n# Create knowledge base content\n$phishingGuide = @\"\n# Phishing Incident Response Guide\n\n## What is Phishing?\nPhishing is a type of social engineering attack where attackers send fraudulent\nmessages designed to trick you into revealing sensitive information.\n\n## How to Identify Phishing\n- Unexpected emails asking for personal information\n- Urgent or threatening language\n- Suspicious sender addresses\n- Links that don't match the displayed text\n- Attachments you weren't expecting\n\n## What to Do\n1. Don't click links or open attachments\n2. Don't reply to the sender\n3. Report using: Submit-IncidentReport -IncidentType Phishing -Description \"...\"\n4. Forward the email to phishing@example.com\n5. Delete the email after reporting\n\n## If You Clicked a Link\n1. Disconnect from network immediately\n2. Report the incident using the command above\n3. If you entered credentials, change passwords immediately\n4. Wait for SOC to contact you\n\"@\n\n$phishingGuide | Out-File -FilePath \"$InstallPath\\KnowledgeBase\\Phishing.md\" -Encoding UTF8\n\n# Add module to PowerShell profile for easy access\n$profileContent = @\"\n\n# IR-7.1 Incident Support Module\nImport-Module C:\\ProgramData\\IncidentSupport\\IncidentSupport.psm1 -Force\nWrite-Host \"Incident Support loaded. Use Submit-IncidentReport or Get-IncidentGuidance for help.\" -ForegroundColor Cyan\n\"@\n\n$profilePath = $PROFILE.AllUsersAllHosts\nif (!(Test-Path $profilePath)) {\n    New-Item -ItemType File -Path $profilePath -Force | Out-Null\n}\n\nif (!(Get-Content $profilePath -ErrorAction SilentlyContinue | Select-String \"IncidentSupport\")) {\n    Add-Content -Path $profilePath -Value $profileContent\n}\n\nWrite-Host \"\"\nWrite-Host \"[SUCCESS] IR-7.1 Automated Incident Support configured\" -ForegroundColor Green\nWrite-Host \"\"\nWrite-Host \"Users can now use:\"\nWrite-Host \"  Submit-IncidentReport -IncidentType <type> -Description '<details>'\"\nWrite-Host \"  Get-IncidentGuidance -Topic <topic>\"\nWrite-Host \"\"\nWrite-Host \"Supported incident types: Phishing, Malware, AccountCompromise, DataBreach, PhysicalSecurity, Other\""
        }
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "automated",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Deploy self-service knowledge base portal. Implement chatbot or automated triage. Create PowerShell module for user incident reporting. Configure Teams/Slack integration."
    },
    "intent": "Use technology to make incident support available 24/7 - chatbots, knowledge bases, automated triage."
  },
  {
    "control_id": "IR-7.2",
    "control_name": "Coordination with External Providers",
    "family": "Incident Response",
    "family_id": "IR",
    "official_text": "Establish a direct, cooperative relationship between its incident response capability and external providers of system protection capability.",
    "parent_control": "IR-7",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Establish formal relationships with external incident response and security service providers to enable coordinated response when incidents exceed internal capabilities or involve external systems. This includes managed security service providers (MSSPs), threat intelligence providers, and cloud service provider security teams.",
    "example_implementation": "Execute agreements with MSSP for 24/7 SOC support, establish communication channels with cloud provider security teams, contract with incident response retainer firm for major incidents, and document escalation procedures to external providers in incident response plans.",
    "non_technical_guidance": "To implement external provider coordination: 1. Inventory all security-relevant external providers (MSSP, cloud providers, ISP, threat intelligence). 2. Establish contractual agreements that include incident response cooperation clauses. 3. Obtain and document security contact information for each provider. 4. Define escalation criteria for engaging external providers. 5. Conduct joint exercises with critical providers to test coordination procedures. 6. Establish secure communication channels for incident information sharing. 7. Review and update agreements annually.",
    "is_technical": false,
    "ai_guidance": "IR-7.2 addresses the critical need for external incident response coordination, recognizing that organizations rarely have all capabilities needed to respond to sophisticated attacks. Key implementation areas include: Managed Security Service Providers (MSSPs) - Establish SOC augmentation agreements with defined escalation paths, SLAs for response times, and secure communication channels. Ensure MSSPs have VPN access or other secure connectivity for remote investigation. Cloud Service Providers - For AWS, Azure, GCP: understand shared responsibility models, configure security contact information in provider consoles, understand provider incident notification mechanisms (AWS PHD, Azure Service Health), and know how to request provider assistance during incidents. Incident Response Retainers - Contract with IR firms (CrowdStrike, Mandiant, Secureworks) for on-call major incident support. Define retainer terms, engagement triggers, and evidence handling procedures. Threat Intelligence Providers - Integrate feeds from ISACs, commercial providers (Recorded Future, Anomali), and government sources (CISA). Establish bidirectional sharing agreements where appropriate. Law Enforcement - Know when and how to engage FBI, Secret Service, or local law enforcement. Understand evidence preservation requirements for potential prosecution. Technical Infrastructure - Deploy secure communication tools (Signal, encrypted email) for external coordination. Create shared incident workspaces (secure SharePoint, dedicated Slack channels) that can be provisioned quickly. Establish VPN tunnels or secure API integrations for provider tool access. Documentation - Maintain current contact matrices with 24/7 phone numbers, define escalation criteria in runbooks, and include external coordination steps in incident response playbooks.",
    "implementation_rationale": "Not every organization can handle every incident in-house. Pre-arranged relationships with forensics firms, legal counsel, and incident response vendors mean help is a phone call away. When you're drowning, you don't want to be searching for a lifeguard.",
    "enhancements": [],
    "related_controls": [
      "PM-29",
      "SA-9",
      "IR-6.3"
    ],
    "supplemental_guidance": "External providers include managed security service providers, information technology security service providers, security operations centers, vendors, and contractors.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false,
      "enhancement_date": "2025-11-22"
    },
    "cac_metadata": {
      "implementation_type": "procedural",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Establish MSSP and IR retainer agreements. Document cloud provider security contacts. Create external provider contact matrix. Define escalation criteria."
    },
    "intent": "Have arrangements with external security experts who can help with incidents that exceed your team's capabilities."
  },
  {
    "control_id": "IR-8",
    "control_name": "Incident Response Plan",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "official_text": "Develop an incident response plan that: (a) Provides the organization with a roadmap for implementing its incident response capability; (b) Describes the structure and organization of the incident response capability; (c) Provides a high-level approach for how the incident response capability fits into the overall organization; (d) Meets the unique requirements of the organization, which relate to mission, size, structure, and functions; (e) Defines reportable incidents; (f) Provides metrics for measuring the incident response capability within the organization; (g) Defines the resources and management support needed to effectively maintain and mature an incident response capability; (h) Addresses the sharing of incident information; (i) Is reviewed and approved by organizational officials; (j) Is distributed to organization-defined incident response personnel and organizational elements; (k) Is reviewed at organization-defined frequency; (l) Is updated to address system and organizational changes or problems encountered during plan implementation, execution, or testing; (m) Communicates changes to organization-defined incident response personnel and organizational elements; and (n) Is protected from unauthorized disclosure and modification.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "plain_english_explanation": "An Incident Response Plan (IRP) is the comprehensive documented strategy that defines how an organization will prepare for, detect, respond to, and recover from security incidents. The plan establishes clear roles and responsibilities, communication protocols, escalation procedures, and post-incident analysis requirements to ensure consistent and effective incident handling.",
    "example_implementation": "Develop and maintain a formal incident response plan document that includes: organizational incident response team structure, roles and responsibilities matrix, incident classification criteria, communication trees, escalation thresholds, external reporting requirements (law enforcement, regulators), evidence preservation procedures, and recovery checklists. Store the plan in a secure location accessible to authorized responders.",
    "non_technical_guidance": "Establish a formal incident response program by: (1) Designating an Incident Response Team (IRT) with defined roles including Incident Commander, Communications Lead, Technical Lead, and Legal Liaison; (2) Creating incident classification categories (Critical, High, Medium, Low) with corresponding response timeframes; (3) Documenting escalation procedures and decision authorities; (4) Establishing communication protocols for internal stakeholders, customers, regulators, and media; (5) Defining post-incident review processes; (6) Scheduling annual plan reviews and updates; (7) Maintaining distribution lists and version control.",
    "ai_guidance": "Organizations implementing IR-8 should leverage AI-enhanced capabilities for incident response plan development and maintenance. AI systems can assist in: (1) Analyzing historical incident data to identify patterns and improve plan coverage; (2) Generating scenario-based tabletop exercises customized to the organization's threat landscape; (3) Automating plan distribution and acknowledgment tracking; (4) Monitoring regulatory changes that may affect incident reporting requirements; (5) Creating dynamic runbooks that adapt based on incident type and severity; (6) Correlating threat intelligence feeds with plan coverage gaps; (7) Generating executive summaries and metrics dashboards for plan effectiveness. Machine learning models can predict incident likelihood based on environmental factors and recommend plan enhancements. Natural language processing can analyze incident reports to extract lessons learned and automatically update relevant plan sections. Ensure AI recommendations undergo human review before implementation.",
    "implementation_rationale": "Your incident response plan is the playbook your team will follow under pressure. It should cover roles, responsibilities, communication channels, escalation procedures, and technical response steps. A good plan is specific enough to be useful but flexible enough to handle surprises.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "IR-8.1",
        "title": "Breaches",
        "official_text": "Include the following in the Incident Response Plan for breaches involving personally identifiable information: (a) A process to determine if notice is required to individuals or Federal agencies and other organizations; (b) An assessment process to determine the extent of the harm, embarrassment, inconvenience, or unfairness to affected individuals and any mechanisms to mitigate such harms; and (c) Identification of applicable privacy requirements."
      }
    ],
    "related_controls": [
      "IR-1",
      "IR-4",
      "IR-6",
      "IR-7",
      "IR-9",
      "CP-2",
      "PM-8",
      "PM-22"
    ],
    "supplemental_guidance": "The incident response plan serves as the foundational document for the organizational incident response capability. It should be developed in coordination with business continuity, disaster recovery, and crisis management plans. Organizations should consider supply chain incident scenarios and coordinate with external service providers.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires organizational policy documentation and procedures. Technical automation supports plan maintenance and distribution but core implementation is procedural."
    },
    "intent": "Document your complete incident response plan - who does what, when, with what resources, and how."
  },
  {
    "control_id": "IR-8.1",
    "control_name": "Breaches",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-8",
    "official_text": "Include the following in the Incident Response Plan for breaches involving personally identifiable information: (a) A process to determine if notice is required to individuals or Federal agencies and other organizations; (b) An assessment process to determine the extent of the harm, embarrassment, inconvenience, or unfairness to affected individuals and any mechanisms to mitigate such harms; and (c) Identification of applicable privacy requirements.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "When personal information is breached, organizations must have specific procedures to assess harm to affected individuals, determine notification requirements under applicable laws (GDPR, HIPAA, CCPA, state breach notification laws), and provide appropriate remediation such as credit monitoring services.",
    "example_implementation": "Integrate PII breach-specific procedures into the incident response plan including: (1) Data classification lookup to identify PII categories affected; (2) Breach notification timeline calculator based on applicable regulations; (3) Template notification letters for affected individuals; (4) Pre-established relationships with credit monitoring providers; (5) Legal team escalation procedures for regulatory notification; (6) Media response templates.",
    "non_technical_guidance": "For PII breaches: (1) Immediately involve Privacy Officer and Legal Counsel; (2) Document all affected data types and record counts; (3) Determine notification requirements using jurisdiction-specific decision trees; (4) Assess harm factors: data sensitivity, encryption status, attacker capability, likelihood of misuse; (5) Prepare individual notifications within statutory timeframes; (6) Coordinate regulatory notifications (HHS for HIPAA, state AGs, supervisory authorities under GDPR); (7) Establish call center for affected individual inquiries; (8) Offer identity protection services where appropriate; (9) Document lessons learned for plan improvement.",
    "ai_guidance": "AI systems enhance PII breach response through: (1) Automated data inventory scanning to rapidly identify all PII categories and records affected by a breach; (2) Jurisdiction mapping - AI can cross-reference affected individual locations with applicable notification laws (50+ US state laws, GDPR, LGPD, PIPEDA, etc.) and calculate notification deadlines; (3) Harm assessment scoring - ML models can evaluate breach severity based on data sensitivity, exposure duration, threat actor sophistication, and historical breach outcomes; (4) Template generation - NLP can generate customized notification letters incorporating required legal language for each jurisdiction; (5) Sentiment analysis of public response to guide PR strategy; (6) Predictive modeling for identity theft risk based on exposed data elements; (7) Automated regulatory form population (HHS breach portal, state AG notifications); (8) Real-time compliance dashboard tracking notification status across jurisdictions. Organizations should validate AI-generated notifications with legal counsel before distribution.",
    "implementation_rationale": "PII breaches trigger specific laws like GDPR, CCPA, and HIPAA. Your plan needs to cover breach assessment, notification requirements, timing obligations, and what to tell affected individuals. Getting this wrong can turn a bad incident into an expensive lawsuit.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-8",
      "PT-2",
      "PT-3",
      "PM-20",
      "PM-22",
      "SI-18"
    ],
    "supplemental_guidance": "Organizations processing PII should maintain current understanding of applicable breach notification requirements. State breach notification laws in the US vary significantly in scope, timing, and required content. International operations require awareness of GDPR, LGPD, PIPEDA, and other regional privacy frameworks.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PII Breach Notification Tracker\n# Creates incident record and calculates notification deadlines\n\nset -euo pipefail\n\nINCIDENT_DIR=\"/var/log/security/pii_breaches\"\nmkdir -p \"$INCIDENT_DIR\"\n\nTIMESTAMP=$(date -u +%Y%m%d_%H%M%S)\nINCIDENT_FILE=\"$INCIDENT_DIR/breach_$TIMESTAMP.json\"\n\ncat > \"$INCIDENT_FILE\" << 'EOF'\n{\n  \"incident_id\": \"PII-'\"$TIMESTAMP\"'\",\n  \"detection_time\": \"'\"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"'\",\n  \"status\": \"investigating\",\n  \"pii_categories\": [],\n  \"affected_count\": 0,\n  \"jurisdictions\": [],\n  \"notification_deadlines\": {\n    \"gdpr_72hr\": \"'\"$(date -u -d '+72 hours' +%Y-%m-%dT%H:%M:%SZ)\"'\",\n    \"hipaa_60day\": \"'\"$(date -u -d '+60 days' +%Y-%m-%dT%H:%M:%SZ)\"'\"\n  },\n  \"checklist\": {\n    \"legal_notified\": false,\n    \"privacy_officer_notified\": false,\n    \"forensics_engaged\": false,\n    \"data_inventory_complete\": false,\n    \"harm_assessment_complete\": false,\n    \"notifications_sent\": false\n  }\n}\nEOF\n\nchmod 600 \"$INCIDENT_FILE\"\necho \"[+] Breach incident created: $INCIDENT_FILE\"\necho \"[!] GDPR 72-hour deadline: $(date -u -d '+72 hours' +%Y-%m-%dT%H:%M:%SZ)\""
      },
      "windows": {
        "powershell": "# PII Breach Notification Tracker (PowerShell)\n# Creates incident record and calculates notification deadlines\n\n$IncidentDir = \"C:\\SecurityLogs\\PIIBreaches\"\nNew-Item -ItemType Directory -Force -Path $IncidentDir | Out-Null\n\n$Timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$IncidentFile = Join-Path $IncidentDir \"breach_$Timestamp.json\"\n\n$IncidentData = @{\n    incident_id = \"PII-$Timestamp\"\n    detection_time = (Get-Date).ToUniversalTime().ToString(\"o\")\n    status = \"investigating\"\n    pii_categories = @()\n    affected_count = 0\n    jurisdictions = @()\n    notification_deadlines = @{\n        gdpr_72hr = (Get-Date).AddHours(72).ToUniversalTime().ToString(\"o\")\n        hipaa_60day = (Get-Date).AddDays(60).ToUniversalTime().ToString(\"o\")\n        ccpa_45day = (Get-Date).AddDays(45).ToUniversalTime().ToString(\"o\")\n    }\n    checklist = @{\n        legal_notified = $false\n        privacy_officer_notified = $false\n        forensics_engaged = $false\n        data_inventory_complete = $false\n        harm_assessment_complete = $false\n        notifications_sent = $false\n    }\n}\n\n$IncidentData | ConvertTo-Json -Depth 5 | Out-File -FilePath $IncidentFile -Encoding UTF8\n\n$Acl = Get-Acl $IncidentFile\n$Acl.SetAccessRuleProtection($true, $false)\n$AdminRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"Administrators\",\"FullControl\",\"Allow\")\n$Acl.AddAccessRule($AdminRule)\nSet-Acl $IncidentFile $Acl\n\nWrite-Host \"[+] Breach incident created: $IncidentFile\"\nWrite-Host \"[!] GDPR 72-hour deadline: $((Get-Date).AddHours(72).ToUniversalTime().ToString('o'))\""
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical automation supports deadline tracking and documentation but core implementation requires legal and privacy team coordination."
    },
    "intent": "Have specific procedures for data breaches involving personal information - these have unique legal requirements."
  },
  {
    "control_id": "IR-9",
    "control_name": "Information Spillage Response",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "official_text": "Respond to information spills by: (a) Assigning organization-defined personnel or roles with responsibility for responding to information spills; (b) Identifying the specific information involved in the system contamination; (c) Alerting organization-defined personnel or roles of the information spill using a method of communication not associated with the spill; (d) Isolating the contaminated system or system component; (e) Eradicating the information from the contaminated system or component; (f) Identifying other systems or system components that may have been subsequently contaminated; and (g) Performing the following additional actions: organization-defined actions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Information spillage occurs when classified, sensitive, or controlled data is transferred to a system not authorized to process that data classification level. This differs from data breaches in that spillage often occurs through inadvertent actions rather than malicious attacks. Response requires immediate containment, secure eradication, and chain-of-custody documentation.",
    "example_implementation": "Implement spillage response procedures that include: (1) Immediate network isolation of affected systems; (2) Classification determination through security officer consultation; (3) Forensic imaging before sanitization; (4) NSA-approved sanitization methods for classified spillage; (5) Chain-of-custody documentation for all evidence; (6) Out-of-band communication protocols to avoid using contaminated channels.",
    "non_technical_guidance": "For information spillage: (1) Immediately stop work and do not attempt to delete data yourself; (2) Contact Security Officer and Classification Authority; (3) Document what was transferred, when, how, and to which systems; (4) Identify all personnel who may have viewed the spilled information; (5) Isolate affected media pending sanitization decision; (6) Communicate only through unaffected channels; (7) Await sanitization instructions from appropriate authority; (8) Complete spillage incident report; (9) Coordinate with originating agency if external classified data involved.",
    "ai_guidance": "AI systems can enhance information spillage detection and response through: (1) Content-aware DLP systems that use machine learning to identify classification indicators (markings, keywords, document structure patterns) and detect potential spillage in near-real-time; (2) Automated chain-of-custody tracking for affected systems and media; (3) Network flow analysis to identify all systems that may have received spilled data through lateral movement; (4) Intelligent sanitization verification using multiple detection methods to confirm data eradication; (5) Natural language processing to analyze email and file shares for unmarked but sensitive content; (6) Anomaly detection for unusual data transfers across classification boundaries; (7) Automated reporting generation for spillage incidents. AI-based classification assistance can help identify spillage of unmarked CUI/FOUO content that humans might miss. However, final classification determinations must remain with authorized personnel.",
    "implementation_rationale": "Information spillage can range from an email sent to the wrong person to classified data posted online. Each situation requires assessment of the damage, containment of further spread, and cleanup. The goal is to minimize exposure and prevent it from happening again.",
    "is_technical": true,
    "enhancements": [
      {
        "id": "IR-9.1",
        "title": "Responsible Personnel",
        "official_text": "Assign organization-defined personnel or roles with responsibility for responding to information spills."
      },
      {
        "id": "IR-9.2",
        "title": "Training",
        "official_text": "Provide information spillage response training at organization-defined frequency."
      },
      {
        "id": "IR-9.3",
        "title": "Post-spill Operations",
        "official_text": "Implement organization-defined procedures to ensure that organizational personnel impacted by information spills can continue to carry out assigned tasks while contaminated systems are undergoing corrective actions."
      },
      {
        "id": "IR-9.4",
        "title": "Exposure to Unauthorized Personnel",
        "official_text": "Employ organization-defined controls for personnel exposed to information not within assigned access authorizations."
      }
    ],
    "related_controls": [
      "CP-2",
      "IR-4",
      "IR-6",
      "PM-26",
      "PM-27",
      "PT-2",
      "PT-3",
      "PT-7",
      "RA-7"
    ],
    "supplemental_guidance": "Information spillage can occur across classification levels or between organizations with different data handling requirements. For classified spillage, NSA/CSS provides guidance on approved sanitization methods. For CUI spillage, NARA CUI Registry provides handling requirements. Organizations should establish relationships with relevant authorities before incidents occur.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# Information Spillage Containment Script\n# Isolates affected system and preserves evidence\n\nset -euo pipefail\n\nif [[ $EUID -ne 0 ]]; then\n   echo \"[!] Must run as root\"\n   exit 1\nfi\n\nLOG_DIR=\"/var/log/security/spillage\"\nmkdir -p \"$LOG_DIR\"\nTIMESTAMP=$(date -u +%Y%m%d_%H%M%S)\nLOG_FILE=\"$LOG_DIR/containment_$TIMESTAMP.log\"\n\nexec &> >(tee -a \"$LOG_FILE\")\necho \"[+] Spillage containment initiated: $(date -u)\"\necho \"[+] Hostname: $(hostname)\"\necho \"[+] Operator: $SUDO_USER\"\n\n# Preserve network state before isolation\necho \"[+] Capturing network state...\"\nnetstat -tulpn > \"$LOG_DIR/netstat_$TIMESTAMP.txt\" 2>&1 || true\nss -tulpn > \"$LOG_DIR/ss_$TIMESTAMP.txt\" 2>&1 || true\nip addr > \"$LOG_DIR/ip_addr_$TIMESTAMP.txt\" 2>&1 || true\nip route > \"$LOG_DIR/ip_route_$TIMESTAMP.txt\" 2>&1 || true\narp -a > \"$LOG_DIR/arp_$TIMESTAMP.txt\" 2>&1 || true\n\n# Capture running processes and open files\necho \"[+] Capturing process state...\"\nps auxf > \"$LOG_DIR/ps_$TIMESTAMP.txt\" 2>&1 || true\nlsof > \"$LOG_DIR/lsof_$TIMESTAMP.txt\" 2>&1 || true\n\n# Network isolation - drop all traffic except established\necho \"[+] Isolating network interfaces...\"\nfor iface in $(ip -o link show | awk -F': ' '{print $2}' | grep -v lo); do\n    iptables -I INPUT -i \"$iface\" -m state --state NEW -j DROP\n    iptables -I OUTPUT -o \"$iface\" -m state --state NEW -j DROP\n    echo \"[+] Isolated interface: $iface\"\ndone\n\n# Disable USB storage\necho \"[+] Disabling USB storage...\"\necho 'blacklist usb-storage' > /etc/modprobe.d/spillage-usb.conf\nmodprobe -r usb-storage 2>/dev/null || true\n\necho \"[!] SYSTEM ISOLATED - DO NOT SHUTDOWN\"\necho \"[!] Contact Security Officer immediately\"\necho \"[!] Log file: $LOG_FILE\""
      },
      "windows": {
        "powershell": "# Information Spillage Containment Script (PowerShell)\n# Isolates affected system and preserves evidence\n# Requires Administrator privileges\n\n#Requires -RunAsAdministrator\n\n$ErrorActionPreference = \"Continue\"\n$LogDir = \"C:\\SecurityLogs\\Spillage\"\nNew-Item -ItemType Directory -Force -Path $LogDir | Out-Null\n\n$Timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$LogFile = Join-Path $LogDir \"containment_$Timestamp.log\"\n\nStart-Transcript -Path $LogFile\n\nWrite-Host \"[+] Spillage containment initiated: $(Get-Date -Format 'o')\"\nWrite-Host \"[+] Hostname: $env:COMPUTERNAME\"\nWrite-Host \"[+] Operator: $env:USERNAME\"\n\n# Preserve network state\nWrite-Host \"[+] Capturing network state...\"\nGet-NetTCPConnection | Export-Csv (Join-Path $LogDir \"tcp_connections_$Timestamp.csv\") -NoTypeInformation\nGet-NetAdapter | Export-Csv (Join-Path $LogDir \"adapters_$Timestamp.csv\") -NoTypeInformation\nGet-NetIPAddress | Export-Csv (Join-Path $LogDir \"ip_addresses_$Timestamp.csv\") -NoTypeInformation\nGet-NetRoute | Export-Csv (Join-Path $LogDir \"routes_$Timestamp.csv\") -NoTypeInformation\nGet-NetNeighbor | Export-Csv (Join-Path $LogDir \"arp_$Timestamp.csv\") -NoTypeInformation\n\n# Capture process state\nWrite-Host \"[+] Capturing process state...\"\nGet-Process | Select-Object Id, ProcessName, Path, StartTime | Export-Csv (Join-Path $LogDir \"processes_$Timestamp.csv\") -NoTypeInformation\n\n# Network isolation via firewall\nWrite-Host \"[+] Isolating network...\"\n$RuleName = \"Spillage-Containment-$Timestamp\"\nNew-NetFirewallRule -DisplayName \"$RuleName-BlockOutbound\" -Direction Outbound -Action Block -Enabled True | Out-Null\nNew-NetFirewallRule -DisplayName \"$RuleName-BlockInbound\" -Direction Inbound -Action Block -Enabled True | Out-Null\nWrite-Host \"[+] Firewall rules created to block traffic\"\n\n# Disable USB storage\nWrite-Host \"[+] Disabling USB storage...\"\nSet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\" -Name \"Start\" -Value 4 -ErrorAction SilentlyContinue\n\nWrite-Host \"`n[!] SYSTEM ISOLATED - DO NOT SHUTDOWN\" -ForegroundColor Red\nWrite-Host \"[!] Contact Security Officer immediately\" -ForegroundColor Red\nWrite-Host \"[!] Log file: $LogFile\" -ForegroundColor Yellow\n\nStop-Transcript"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical scripts support containment and evidence preservation. Sanitization must follow classification-appropriate procedures."
    },
    "intent": "Know what to do when sensitive information ends up where it shouldn't - whether by accident or attack."
  },
  {
    "control_id": "IR-9.1",
    "control_name": "Responsible Personnel",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-9",
    "official_text": "Assign organization-defined personnel or roles with responsibility for responding to information spills.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "Organizations must designate specific individuals or roles with the authority and responsibility to respond to information spillage incidents. These personnel must have appropriate clearances, training, and access to sanitization tools.",
    "example_implementation": "Document in the incident response plan specific roles responsible for spillage response: (1) Information System Security Officer (ISSO) as primary responder; (2) Classification Management Officer for classification determination; (3) Facility Security Officer for classified spillage coordination; (4) IT Operations for technical containment and sanitization; (5) Legal Counsel for liability assessment.",
    "non_technical_guidance": "Establish a spillage response team with documented roles: (1) Incident Commander - overall response coordination; (2) Classification Authority - determines data sensitivity and required handling; (3) Technical Lead - executes containment and sanitization; (4) Documentation Specialist - maintains chain-of-custody and incident records; (5) Communications Lead - coordinates with external authorities (ISSM, originating agency). Ensure 24/7 contact information is maintained and backup personnel are designated for each role.",
    "ai_guidance": "AI-enhanced personnel management for spillage response includes: (1) Automated on-call rotation and contact management systems that ensure appropriate personnel are always reachable; (2) Skills-based routing that matches spillage characteristics (classification level, data type, affected systems) with appropriately qualified responders; (3) Training compliance tracking to ensure all designated personnel maintain current spillage response certifications; (4) Clearance verification systems that confirm personnel have appropriate access before granting response duties; (5) Workload analysis to ensure response team capacity is adequate based on historical incident volume. AI can also assist in identifying personnel who may have been inadvertently exposed to spilled information by analyzing access logs and communication patterns. Organizations should maintain human oversight of personnel assignments to avoid clearance or need-to-know violations.",
    "implementation_rationale": "Spillage incidents often involve sensitive judgment calls - what's the real risk, who needs to know, how do we clean this up? Designated personnel with the right training, clearances, and authority can make these decisions quickly and appropriately.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-9",
      "IR-4",
      "AT-3",
      "PM-13",
      "PS-2"
    ],
    "supplemental_guidance": "Personnel assigned spillage response duties should receive specialized training beyond general incident response. For classified environments, this may include NSA-approved sanitization procedures and coordination protocols with cognizant security agencies.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires organizational documentation of personnel assignments. Technical automation supports contact management and notification."
    },
    "intent": "Designate specific people who are responsible for handling information spillage incidents."
  },
  {
    "control_id": "IR-9.2",
    "control_name": "Training",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-9",
    "official_text": "Provide information spillage response training at organization-defined frequency.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "All personnel who may encounter or respond to information spillage must receive training on recognition, reporting, and response procedures. Training should be tailored to role - general users need recognition and reporting training, while responders need technical sanitization training.",
    "example_implementation": "Implement spillage training program with: (1) Annual general awareness training for all cleared personnel covering spillage recognition and reporting; (2) Specialized response training for designated responders including hands-on sanitization exercises; (3) Tabletop exercises simulating spillage scenarios; (4) Just-in-time refresher training triggered by spillage indicators; (5) Training completion tracking and compliance reporting.",
    "non_technical_guidance": "Develop tiered spillage training: Tier 1 (All Users) - Annual training covering: what constitutes spillage, recognition indicators, immediate actions (stop, isolate, report), what NOT to do (delete, forward, discuss). Tier 2 (Response Team) - Quarterly training on: containment procedures, sanitization methods, evidence preservation, documentation requirements, coordination protocols. Tier 3 (Specialists) - Annual certification on: NSA-approved sanitization tools, forensic imaging, classification handling. Include practical exercises and scenario-based assessments.",
    "ai_guidance": "AI can enhance spillage training through: (1) Adaptive learning platforms that adjust content difficulty based on learner performance and role requirements; (2) Simulated spillage scenarios using realistic but sanitized examples generated by ML models; (3) Natural language chatbots that answer spillage-related questions and reinforce training concepts; (4) Automated competency assessment that identifies knowledge gaps and recommends remediation; (5) Training effectiveness analytics that correlate training completion with actual incident response performance; (6) Personalized learning paths based on user role, clearance level, and previous incident involvement; (7) Spaced repetition systems that optimize retention of critical procedures. Virtual reality environments can provide immersive spillage response exercises without risk of actual contamination. AI-generated after-action reviews can identify training improvements based on real incident outcomes.",
    "implementation_rationale": "Spillage often happens by accident - someone emails the wrong file or posts data publicly. Training helps people recognize spillage when they cause it (so they report it) and respond correctly when they receive spilled information (so they don't make it worse).",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "IR-9",
      "AT-2",
      "AT-3",
      "AT-4",
      "PM-13"
    ],
    "supplemental_guidance": "Training should incorporate actual sanitization tools and procedures used by the organization. For classified environments, training may require coordination with cognizant security agency. Consider using simulated spillage scenarios to provide realistic practice without actual contamination risk.",
    "implementation_scripts": {
      "linux": {},
      "windows": {}
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": false
    },
    "cac_metadata": {
      "implementation_type": "organizational",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "This control requires documented training program and completion tracking. LMS integration can provide automated compliance monitoring."
    },
    "intent": "Train your people specifically on how to recognize and respond to information spillage."
  },
  {
    "control_id": "IR-9.3",
    "control_name": "Post-spill Operations",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-9",
    "official_text": "Implement organization-defined procedures to ensure that organizational personnel impacted by information spills can continue to carry out assigned tasks while contaminated systems are undergoing corrective actions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "When systems are contaminated by spillage and must be isolated for sanitization, affected personnel still need to perform their duties. Organizations must have contingency procedures including backup workstations, alternate processing locations, and temporary access arrangements.",
    "example_implementation": "Establish post-spill operational continuity through: (1) Pre-staged clean workstations that can be rapidly deployed; (2) Virtual desktop infrastructure allowing work from alternate systems; (3) Network segmentation enabling isolation of contaminated systems while maintaining operations; (4) Data backup procedures ensuring clean copies are available; (5) Credential rotation to maintain access on replacement systems; (6) Communication procedures for coordinating degraded operations.",
    "non_technical_guidance": "Develop operational continuity procedures for spillage events: (1) Maintain inventory of backup systems that can be deployed within 4 hours; (2) Document manual workarounds for critical processes; (3) Establish priority tiers for system restoration based on mission criticality; (4) Pre-authorize overtime and temporary staff augmentation; (5) Create communication templates for notifying stakeholders of delays; (6) Identify alternate work locations if primary facility is affected; (7) Maintain current contact information for all affected personnel; (8) Document data recovery procedures from clean backups.",
    "ai_guidance": "AI systems support post-spill operations through: (1) Intelligent workload redistribution that automatically routes tasks to unaffected systems based on skill matching and priority; (2) Predictive capacity planning that anticipates operational impact and pre-positions resources; (3) Automated backup system provisioning that spins up clean virtual environments with appropriate configurations; (4) Dependency mapping that identifies all systems and personnel affected by containment actions; (5) Communication automation that notifies stakeholders and coordinates alternate arrangements; (6) Progress tracking dashboards that monitor remediation and predict return-to-normal timelines; (7) Resource optimization that balances operational continuity against sanitization priorities. Machine learning can analyze historical spillage events to improve continuity plan effectiveness and identify bottlenecks. Natural language interfaces can help affected personnel quickly find alternative procedures and resources.",
    "implementation_rationale": "Cleaning up spillage can require taking systems offline or restricting access. But business needs to continue. Post-spill procedures ensure affected personnel can keep working, perhaps on alternative systems, while contaminated systems are being sanitized.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-9",
      "CP-2",
      "CP-7",
      "CP-8",
      "CP-9",
      "CP-10"
    ],
    "supplemental_guidance": "Post-spill procedures should be coordinated with business continuity and contingency plans. Backup systems must be at appropriate classification level and must not introduce additional spillage risk. Virtual desktop infrastructure can provide rapid recovery capability.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# Post-Spillage Backup Workstation Deployment\n# Deploys clean VM for affected user\n\nset -euo pipefail\n\nUSER_ID=\"${1:-}\"\nif [[ -z \"$USER_ID\" ]]; then\n    echo \"Usage: $0 <user_id>\"\n    exit 1\nfi\n\nLOG_FILE=\"/var/log/security/spillage/backup_deploy_$(date +%Y%m%d_%H%M%S).log\"\nmkdir -p \"$(dirname \"$LOG_FILE\")\"\n\nexec &> >(tee -a \"$LOG_FILE\")\necho \"[+] Backup workstation deployment: $(date -u)\"\necho \"[+] User: $USER_ID\"\n\n# Check for clean VM template\nTEMPLATE_PATH=\"/var/lib/libvirt/images/clean_workstation_template.qcow2\"\nif [[ ! -f \"$TEMPLATE_PATH\" ]]; then\n    echo \"[!] ERROR: Clean template not found: $TEMPLATE_PATH\"\n    exit 1\nfi\n\n# Create new VM from template\nVM_NAME=\"backup_${USER_ID}_$(date +%Y%m%d%H%M%S)\"\nVM_DISK=\"/var/lib/libvirt/images/${VM_NAME}.qcow2\"\n\necho \"[+] Creating VM: $VM_NAME\"\nqemu-img create -f qcow2 -b \"$TEMPLATE_PATH\" -F qcow2 \"$VM_DISK\"\n\nvirt-install --name \"$VM_NAME\" \\\n    --memory 8192 \\\n    --vcpus 4 \\\n    --disk \"$VM_DISK\" \\\n    --import \\\n    --os-variant generic \\\n    --network network=default \\\n    --noautoconsole \\\n    --wait 0 2>/dev/null || true\n\necho \"[+] VM created and starting: $VM_NAME\"\necho \"[+] Waiting for IP assignment...\"\nsleep 30\n\nVM_IP=$(virsh domifaddr \"$VM_NAME\" | grep -oE '\\b[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\b' | head -1 || echo \"pending\")\necho \"[+] VM IP: $VM_IP\"\necho \"[+] Notify user $USER_ID of backup workstation availability\""
      },
      "windows": {
        "powershell": "# Post-Spillage Backup Workstation Deployment (PowerShell)\n# Deploys Hyper-V VM for affected user\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$UserId\n)\n\n$ErrorActionPreference = \"Stop\"\n$LogDir = \"C:\\SecurityLogs\\Spillage\"\nNew-Item -ItemType Directory -Force -Path $LogDir | Out-Null\n$LogFile = Join-Path $LogDir \"backup_deploy_$(Get-Date -Format 'yyyyMMdd_HHmmss').log\"\n\nStart-Transcript -Path $LogFile\n\nWrite-Host \"[+] Backup workstation deployment: $(Get-Date -Format 'o')\"\nWrite-Host \"[+] User: $UserId\"\n\n# Configuration\n$TemplatePath = \"D:\\HyperV\\Templates\\CleanWorkstation.vhdx\"\n$VMPath = \"D:\\HyperV\\VMs\"\n$VMSwitch = \"CorpNetwork\"\n\nif (-not (Test-Path $TemplatePath)) {\n    Write-Host \"[!] ERROR: Clean template not found: $TemplatePath\" -ForegroundColor Red\n    Stop-Transcript\n    exit 1\n}\n\n$Timestamp = Get-Date -Format \"yyyyMMddHHmmss\"\n$VMName = \"Backup_${UserId}_${Timestamp}\"\n$VMDisk = Join-Path $VMPath \"$VMName.vhdx\"\n\nWrite-Host \"[+] Creating VM: $VMName\"\n\n# Create differencing disk from template\nNew-VHD -Path $VMDisk -ParentPath $TemplatePath -Differencing\n\n# Create VM\nNew-VM -Name $VMName -MemoryStartupBytes 8GB -VHDPath $VMDisk -Generation 2 -SwitchName $VMSwitch\nSet-VM -Name $VMName -ProcessorCount 4 -DynamicMemory -MemoryMinimumBytes 4GB -MemoryMaximumBytes 16GB\n\n# Start VM\nStart-VM -Name $VMName\n\nWrite-Host \"[+] VM created and starting: $VMName\"\nWrite-Host \"[+] Waiting for IP assignment...\"\n\nStart-Sleep -Seconds 60\n\n$VMNetwork = Get-VMNetworkAdapter -VMName $VMName\n$VMIP = $VMNetwork.IPAddresses | Where-Object { $_ -match '^\\d+\\.\\d+\\.\\d+\\.\\d+$' } | Select-Object -First 1\n\nWrite-Host \"[+] VM IP: $VMIP\"\nWrite-Host \"[+] Notify user $UserId of backup workstation availability\"\nWrite-Host \"[+] Connection: $VMIP or $VMName.domain.local\"\n\nStop-Transcript"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical automation supports rapid deployment of backup systems. Organizational procedures define priority and coordination."
    },
    "intent": "Have a plan for keeping business running while you clean up an information spillage."
  },
  {
    "control_id": "IR-9.4",
    "control_name": "Exposure to Unauthorized Personnel",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "parent_control": "IR-9",
    "official_text": "Employ organization-defined controls for personnel exposed to information not within assigned access authorizations.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "When personnel are inadvertently exposed to information beyond their authorized access level, organizations must implement controls to mitigate the exposure. This may include debriefing, security acknowledgment, enhanced monitoring, or in severe cases, security review or clearance action.",
    "example_implementation": "Implement exposure mitigation procedures: (1) Document all personnel exposed to spilled information; (2) Brief exposed personnel on handling requirements and restrictions; (3) Obtain signed acknowledgment of exposure and non-disclosure obligations; (4) Notify security officer for clearance file documentation; (5) Implement enhanced monitoring for specified period; (6) For classified exposure, coordinate with cognizant security agency; (7) Update access logs to document exposure event.",
    "non_technical_guidance": "For unauthorized exposure incidents: (1) Immediately inform exposed personnel to stop viewing/processing and secure any copies; (2) Document exposure - who, what, when, duration, method; (3) Assess exposure severity based on information classification and personnel clearance/need-to-know status; (4) Conduct formal debriefing explaining non-disclosure obligations and potential consequences; (5) Obtain signed Non-Disclosure Agreement or acknowledgment; (6) File security incident report in personnel security file; (7) For severe exposures, consult with Legal and HR regarding potential employment actions; (8) For classified exposure, report to cognizant security agency and coordinate any required actions.",
    "ai_guidance": "AI systems can support exposure management through: (1) Access log analysis to precisely identify all personnel who accessed spilled information and duration of exposure; (2) Automated exposure severity scoring based on information classification, personnel clearance status, and exposure duration; (3) Document management integration to track signed acknowledgments and debriefing completion; (4) Behavioral analytics to detect if exposed personnel attempt to access similar information or exhibit concerning patterns; (5) Case management systems that track exposure incidents through investigation and resolution; (6) Reporting automation that generates required notifications to security offices and oversight bodies; (7) Risk modeling that predicts potential downstream impacts of exposure. Natural language processing can analyze communications for potential unauthorized disclosure by exposed personnel. However, final exposure handling decisions must involve human judgment considering personnel circumstances and security implications.",
    "implementation_rationale": "Sometimes spillage means people get exposed to information above their clearance or outside their need-to-know. These individuals need guidance on their obligations (like not discussing what they saw) and may need security briefings or access reviews.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-9",
      "AT-3",
      "PM-13",
      "PS-3",
      "PS-4",
      "PS-7",
      "PS-8"
    ],
    "supplemental_guidance": "For classified information exposure, coordinate with cognizant security agency (DSS for industry, respective agency security offices for government). Exposure may require polygraph examination, additional background investigation, or administrative action depending on circumstances.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# Personnel Exposure Tracking Script\n# Documents exposure and creates acknowledgment requirements\n\nset -euo pipefail\n\nEXPOSURE_DIR=\"/var/log/security/spillage/exposures\"\nmkdir -p \"$EXPOSURE_DIR\"\n\nTIMESTAMP=$(date -u +%Y%m%d_%H%M%S)\nEXPOSURE_FILE=\"$EXPOSURE_DIR/exposure_$TIMESTAMP.json\"\n\n# Collect exposure details\nread -p \"Spillage Incident ID: \" INCIDENT_ID\nread -p \"Exposed Personnel (comma-separated usernames): \" EXPOSED_USERS\nread -p \"Information Classification: \" INFO_CLASS\nread -p \"Exposure Duration (minutes): \" DURATION\nread -p \"Exposure Method (view/copy/email/other): \" METHOD\n\ncat > \"$EXPOSURE_FILE\" << EOF\n{\n  \"exposure_id\": \"EXP-$TIMESTAMP\",\n  \"incident_id\": \"$INCIDENT_ID\",\n  \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n  \"exposed_personnel\": \"$EXPOSED_USERS\",\n  \"information_classification\": \"$INFO_CLASS\",\n  \"exposure_duration_minutes\": $DURATION,\n  \"exposure_method\": \"$METHOD\",\n  \"status\": \"pending_acknowledgment\",\n  \"acknowledgments\": {},\n  \"actions_required\": [\n    \"Security Officer notification\",\n    \"Personnel debriefing\",\n    \"NDA/acknowledgment signature\",\n    \"Personnel file documentation\"\n  ],\n  \"debriefing_complete\": false,\n  \"acknowledgment_signed\": false,\n  \"security_notified\": false\n}\nEOF\n\nchmod 600 \"$EXPOSURE_FILE\"\necho \"\"\necho \"[+] Exposure record created: $EXPOSURE_FILE\"\necho \"[!] REQUIRED ACTIONS:\"\necho \"    1. Notify Security Officer immediately\"\necho \"    2. Brief exposed personnel within 24 hours\"\necho \"    3. Obtain signed acknowledgments\"\necho \"    4. Document in personnel security files\"\necho \"\"\necho \"For classified exposure, contact cognizant security agency.\""
      },
      "windows": {
        "powershell": "# Personnel Exposure Tracking Script (PowerShell)\n# Documents exposure and creates acknowledgment requirements\n\n$ErrorActionPreference = \"Stop\"\n$ExposureDir = \"C:\\SecurityLogs\\Spillage\\Exposures\"\nNew-Item -ItemType Directory -Force -Path $ExposureDir | Out-Null\n\n$Timestamp = Get-Date -Format \"yyyyMMdd_HHmmss\"\n$ExposureFile = Join-Path $ExposureDir \"exposure_$Timestamp.json\"\n\n# Collect exposure details via prompts\nWrite-Host \"Personnel Exposure Documentation\" -ForegroundColor Cyan\nWrite-Host \"================================\"\n$IncidentId = Read-Host \"Spillage Incident ID\"\n$ExposedUsers = Read-Host \"Exposed Personnel (comma-separated usernames)\"\n$InfoClass = Read-Host \"Information Classification (CUI/Secret/TopSecret)\"\n$Duration = Read-Host \"Exposure Duration (minutes)\"\n$Method = Read-Host \"Exposure Method (view/copy/email/other)\"\n\n$ExposureData = @{\n    exposure_id = \"EXP-$Timestamp\"\n    incident_id = $IncidentId\n    timestamp = (Get-Date).ToUniversalTime().ToString(\"o\")\n    exposed_personnel = $ExposedUsers -split ',' | ForEach-Object { $_.Trim() }\n    information_classification = $InfoClass\n    exposure_duration_minutes = [int]$Duration\n    exposure_method = $Method\n    status = \"pending_acknowledgment\"\n    acknowledgments = @{}\n    actions_required = @(\n        \"Security Officer notification\",\n        \"Personnel debriefing\",\n        \"NDA/acknowledgment signature\",\n        \"Personnel file documentation\"\n    )\n    debriefing_complete = $false\n    acknowledgment_signed = $false\n    security_notified = $false\n}\n\n$ExposureData | ConvertTo-Json -Depth 5 | Out-File -FilePath $ExposureFile -Encoding UTF8\n\n# Restrict access\n$Acl = Get-Acl $ExposureFile\n$Acl.SetAccessRuleProtection($true, $false)\n$AdminRule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"Administrators\",\"FullControl\",\"Allow\")\n$Acl.AddAccessRule($AdminRule)\nSet-Acl $ExposureFile $Acl\n\nWrite-Host \"\"\nWrite-Host \"[+] Exposure record created: $ExposureFile\" -ForegroundColor Green\nWrite-Host \"\"\nWrite-Host \"[!] REQUIRED ACTIONS:\" -ForegroundColor Yellow\nWrite-Host \"    1. Notify Security Officer immediately\"\nWrite-Host \"    2. Brief exposed personnel within 24 hours\"\nWrite-Host \"    3. Obtain signed acknowledgments\"\nWrite-Host \"    4. Document in personnel security files\"\nWrite-Host \"\"\nWrite-Host \"For classified exposure, contact cognizant security agency.\" -ForegroundColor Red"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical scripts support documentation and tracking. Personnel actions require human judgment and appropriate authorities."
    },
    "intent": "Have procedures for people who accidentally see information they weren't supposed to see."
  },
  {
    "control_id": "IR-10",
    "control_name": "Integrated Information Security Analysis Team",
    "family": "Incident Response",
    "family_id": "ir",
    "stig_id": "not_applicable",
    "official_text": "Establish and maintain an integrated information security analysis team of experts that can be deployed in support of incident response activities to: (a) Identify and analyze anomalies that might signify a compromise; (b) Provide organizational guidance for incident handling; (c) Track emerging threats; (d) Develop mitigations for detected vulnerabilities; and (e) Assist in remediation.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "plain_english_explanation": "An Integrated Information Security Analysis Team (IISAT) or Security Operations Center (SOC) is a dedicated team of security experts who provide specialized analysis, threat hunting, and incident response support. This team serves as an internal capability or coordinates with external providers for advanced security operations.",
    "example_implementation": "Establish a SOC/ISOC capability including: (1) 24/7 monitoring and analysis staff; (2) SIEM platform for centralized log analysis; (3) Threat intelligence integration; (4) Incident ticketing and case management; (5) Forensic analysis capability; (6) Malware analysis sandbox; (7) Defined escalation procedures to incident response team; (8) Regular threat hunting exercises; (9) Coordination with external CERTs and ISACs.",
    "non_technical_guidance": "Build an integrated security analysis capability: (1) Define team structure - SOC analysts (Tier 1-3), threat intelligence analysts, forensic specialists, malware analysts; (2) Establish operational procedures - alert triage, escalation criteria, shift handoffs, communication protocols; (3) Develop relationships with external partners - sector ISACs, FBI, CISA, vendor security teams; (4) Create knowledge management - playbooks, past incident documentation, threat profiles; (5) Implement continuous improvement - metrics, post-incident reviews, training programs; (6) Ensure appropriate clearances for classified threat intelligence access.",
    "ai_guidance": "AI and machine learning are fundamental to modern SOC operations: (1) SIEM/SOAR platforms use ML for anomaly detection, alert correlation, and false positive reduction; (2) User and Entity Behavior Analytics (UEBA) establish baselines and detect deviations indicating compromise; (3) Threat intelligence platforms use NLP to extract IOCs and TTPs from unstructured sources; (4) Automated playbook execution handles routine alerts, freeing analysts for complex investigations; (5) Predictive models identify systems likely to be targeted based on threat landscape analysis; (6) Attack surface management tools continuously discover and assess organizational exposure; (7) AI-assisted hunting suggests investigation paths based on observed indicators; (8) Natural language interfaces allow analysts to query security data conversationally; (9) Automated report generation creates executive summaries and technical details; (10) ML-based malware analysis classifies samples and extracts capabilities. Organizations should implement AI guardrails to prevent automated actions that could cause service disruption and maintain human oversight of significant response decisions.",
    "implementation_rationale": "Incident response shouldn't be a part-time job. An integrated security analysis team provides dedicated expertise for investigating incidents, hunting for threats, analyzing trends, and feeding lessons learned back into your security program. They're your security brain trust.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "IR-4",
      "IR-4.1",
      "IR-4.11",
      "IR-4.14",
      "SI-4",
      "AU-6",
      "RA-5",
      "CA-7"
    ],
    "supplemental_guidance": "Organizations may implement internal SOC capability, leverage managed security service providers (MSSPs), or use hybrid models. Smaller organizations may participate in shared SOC services. Integration with threat intelligence feeds and external security communities enhances detection capability.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# SOC Infrastructure Verification Script\n# Validates core SOC tool deployment and connectivity\n\nset -euo pipefail\n\necho \"================================\"\necho \"SOC Infrastructure Health Check\"\necho \"================================\"\necho \"Timestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)\"\necho \"\"\n\n# Define expected SOC components\ndeclare -A SOC_COMPONENTS\nSOC_COMPONENTS[\"siem\"]=\"siem.internal.domain:9200\"\nSOC_COMPONENTS[\"ticketing\"]=\"jira.internal.domain:443\"\nSOC_COMPONENTS[\"threat_intel\"]=\"misp.internal.domain:443\"\nSOC_COMPONENTS[\"case_mgmt\"]=\"thehive.internal.domain:9000\"\nSOC_COMPONENTS[\"sandbox\"]=\"cuckoo.internal.domain:8090\"\nSOC_COMPONENTS[\"wiki\"]=\"confluence.internal.domain:443\"\n\nPASSED=0\nFAILED=0\n\necho \"Checking SOC component connectivity:\"\necho \"------------------------------------\"\nfor component in \"${!SOC_COMPONENTS[@]}\"; do\n    address=\"${SOC_COMPONENTS[$component]}\"\n    host=$(echo \"$address\" | cut -d: -f1)\n    port=$(echo \"$address\" | cut -d: -f2)\n    \n    if nc -z -w 5 \"$host\" \"$port\" 2>/dev/null; then\n        echo \"[PASS] $component ($address)\"\n        ((PASSED++))\n    else\n        echo \"[FAIL] $component ($address) - Connection failed\"\n        ((FAILED++))\n    fi\ndone\n\necho \"\"\necho \"Checking local security tools:\"\necho \"------------------------------\"\n\n# Check for common SOC tools\nfor tool in osqueryd auditd rsyslog filebeat suricata zeek; do\n    if systemctl is-active --quiet \"$tool\" 2>/dev/null; then\n        echo \"[PASS] $tool service running\"\n        ((PASSED++))\n    elif pgrep -x \"$tool\" > /dev/null 2>&1; then\n        echo \"[PASS] $tool process running\"\n        ((PASSED++))\n    else\n        echo \"[WARN] $tool not detected\"\n    fi\ndone\n\necho \"\"\necho \"Summary: $PASSED passed, $FAILED failed\"\nif [[ $FAILED -gt 0 ]]; then\n    echo \"[!] SOC infrastructure degraded - investigate failures\"\n    exit 1\nfi\necho \"[+] SOC infrastructure operational\""
      },
      "windows": {
        "powershell": "# SOC Infrastructure Verification Script (PowerShell)\n# Validates core SOC tool deployment and connectivity\n\n$ErrorActionPreference = \"Continue\"\n\nWrite-Host \"================================\"\nWrite-Host \"SOC Infrastructure Health Check\"\nWrite-Host \"================================\"\nWrite-Host \"Timestamp: $(Get-Date -Format 'o')\"\nWrite-Host \"\"\n\n# Define expected SOC components\n$SOCComponents = @{\n    \"SIEM (Elasticsearch)\" = @{Host=\"siem.internal.domain\"; Port=9200}\n    \"SIEM (Splunk)\" = @{Host=\"splunk.internal.domain\"; Port=8089}\n    \"Ticketing (Jira)\" = @{Host=\"jira.internal.domain\"; Port=443}\n    \"Threat Intel (MISP)\" = @{Host=\"misp.internal.domain\"; Port=443}\n    \"Case Mgmt (TheHive)\" = @{Host=\"thehive.internal.domain\"; Port=9000}\n    \"SOAR\" = @{Host=\"soar.internal.domain\"; Port=443}\n}\n\n$Passed = 0\n$Failed = 0\n\nWrite-Host \"Checking SOC component connectivity:\"\nWrite-Host \"------------------------------------\"\nforeach ($component in $SOCComponents.Keys) {\n    $config = $SOCComponents[$component]\n    try {\n        $result = Test-NetConnection -ComputerName $config.Host -Port $config.Port -WarningAction SilentlyContinue -InformationLevel Quiet\n        if ($result) {\n            Write-Host \"[PASS] $component ($($config.Host):$($config.Port))\" -ForegroundColor Green\n            $Passed++\n        } else {\n            Write-Host \"[FAIL] $component ($($config.Host):$($config.Port)) - Connection failed\" -ForegroundColor Red\n            $Failed++\n        }\n    } catch {\n        Write-Host \"[FAIL] $component - Error: $($_.Exception.Message)\" -ForegroundColor Red\n        $Failed++\n    }\n}\n\nWrite-Host \"\"\nWrite-Host \"Checking local security agents:\"\nWrite-Host \"-------------------------------\"\n\n$SecurityServices = @(\n    \"WinDefend\",\n    \"Sense\",  # Microsoft Defender ATP\n    \"osqueryd\",\n    \"SplunkForwarder\",\n    \"winlogbeat\",\n    \"CarbonBlack\",\n    \"CrowdStrike Falcon Sensor Service\"\n)\n\nforeach ($service in $SecurityServices) {\n    try {\n        $svc = Get-Service -Name $service -ErrorAction SilentlyContinue\n        if ($svc -and $svc.Status -eq 'Running') {\n            Write-Host \"[PASS] $service service running\" -ForegroundColor Green\n            $Passed++\n        } else {\n            Write-Host \"[WARN] $service not running or not installed\" -ForegroundColor Yellow\n        }\n    } catch {\n        Write-Host \"[INFO] $service not found\" -ForegroundColor Gray\n    }\n}\n\nWrite-Host \"\"\nWrite-Host \"Summary: $Passed passed, $Failed failed\"\nif ($Failed -gt 0) {\n    Write-Host \"[!] SOC infrastructure degraded - investigate failures\" -ForegroundColor Red\n    exit 1\n}\nWrite-Host \"[+] SOC infrastructure operational\" -ForegroundColor Green"
      }
    },
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00.000000Z",
      "has_scripts": true
    },
    "cac_metadata": {
      "implementation_type": "hybrid",
      "last_analyzed": "2025-11-22T00:00:00.000000Z",
      "source": "ComplianceAsCode",
      "implementation_guidance": "Technical infrastructure supports SOC operations but core capability requires skilled personnel and defined processes."
    },
    "intent": "Build a dedicated team of security analysts who can investigate incidents, analyze threats, and continuously improve your defenses."
  }
]