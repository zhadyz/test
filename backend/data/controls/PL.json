[
  {
    "control_id": "PL-1",
    "control_name": "Policy and Procedures",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "a. Develop, document, and disseminate to [Assignment: organization-defined personnel or roles]:\n  1. [Selection (one or more): Organization-level; Mission/business process-level; System-level] planning policy that:\n    (a) Addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and\n    (b) Is consistent with applicable laws, executive orders, directives, regulations, policies, standards, and guidelines; and\n  2. Procedures to facilitate the implementation of the planning policy and the associated planning controls;\nb. Designate an [Assignment: organization-defined official] to manage the development, documentation, and dissemination of the planning policy and procedures; and\nc. Review and update the current planning:\n  1. Policy [Assignment: organization-defined frequency] and following [Assignment: organization-defined events]; and\n  2. Procedures [Assignment: organization-defined frequency] and following [Assignment: organization-defined events].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "This control establishes the foundational governance framework for security and privacy planning activities. It ensures organizations have documented policies and procedures that guide all planning-related security activities and controls.",
    "rationale": "Without formal planning policies and procedures, security activities become ad hoc and inconsistent. Documented governance ensures accountability, consistent application of security measures, and provides a framework for continuous improvement of the organization's security posture.",
    "plain_english_explanation": "Your organization needs to create and maintain written policies and procedures for security planning. This includes documenting who is responsible for security planning, how security plans should be developed and maintained, and ensuring everyone knows the rules. These documents should be reviewed regularly (typically annually) and updated whenever significant changes occur in your organization or its systems.",
    "ai_guidance": "Implementation of PL-1 requires a structured approach to security governance documentation. Organizations should establish a hierarchical policy structure with an overarching security planning policy at the enterprise level, supported by mission-specific and system-level procedures. Key implementation steps include: (1) Designate a Security Planning Officer or equivalent role with authority to develop and maintain planning documentation; (2) Create policy templates that address all required elements including purpose, scope, roles, responsibilities, and compliance requirements; (3) Establish a document management system with version control to track policy revisions; (4) Implement an annual review cycle with triggers for ad-hoc reviews following significant organizational changes, security incidents, or regulatory updates; (5) Develop a dissemination strategy ensuring all relevant personnel acknowledge receipt and understanding of policies; (6) Create metrics to measure policy effectiveness and compliance rates. Consider using policy management tools like SharePoint, Confluence, or dedicated GRC platforms to maintain documentation lifecycle. Integrate policy review reminders into organizational calendars and link policy updates to change management processes.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-1: Security Planning Policy Documentation Verification\n# This script verifies the existence and currency of security planning documentation\n\nPOLICY_DIR=\"/etc/security/policies/planning\"\nLOG_FILE=\"/var/log/security/pl1_compliance.log\"\nMAX_AGE_DAYS=365\n\necho \"[$(date '+%Y-%m-%d %H:%M:%S')] PL-1 Compliance Check Started\" | tee -a \"$LOG_FILE\"\n\n# Check if policy directory exists\nif [ ! -d \"$POLICY_DIR\" ]; then\n    echo \"[WARNING] Policy directory $POLICY_DIR does not exist\" | tee -a \"$LOG_FILE\"\n    echo \"Creating policy directory structure...\" | tee -a \"$LOG_FILE\"\n    mkdir -p \"$POLICY_DIR\"/{policies,procedures,acknowledgments}\n    echo \"[ACTION REQUIRED] Populate policy documents in $POLICY_DIR\" | tee -a \"$LOG_FILE\"\n    exit 1\nfi\n\n# Check for required policy documents\nREQUIRED_DOCS=(\"security_planning_policy.pdf\" \"planning_procedures.pdf\" \"roles_responsibilities.pdf\")\nMISSING_DOCS=()\n\nfor doc in \"${REQUIRED_DOCS[@]}\"; do\n    if [ ! -f \"$POLICY_DIR/policies/$doc\" ] && [ ! -f \"$POLICY_DIR/$doc\" ]; then\n        MISSING_DOCS+=(\"$doc\")\n    fi\ndone\n\nif [ ${#MISSING_DOCS[@]} -gt 0 ]; then\n    echo \"[WARNING] Missing required documents: ${MISSING_DOCS[*]}\" | tee -a \"$LOG_FILE\"\nfi\n\n# Check document age (policies should be reviewed annually)\nfor doc in \"$POLICY_DIR\"/**/*.pdf \"$POLICY_DIR\"/**/*.doc*; do\n    if [ -f \"$doc\" ]; then\n        AGE_DAYS=$(( ($(date +%s) - $(stat -c %Y \"$doc\")) / 86400 ))\n        if [ $AGE_DAYS -gt $MAX_AGE_DAYS ]; then\n            echo \"[WARNING] Document $doc is $AGE_DAYS days old - review required\" | tee -a \"$LOG_FILE\"\n        else\n            echo \"[OK] Document $doc last updated $AGE_DAYS days ago\" | tee -a \"$LOG_FILE\"\n        fi\n    fi\ndone\n\necho \"[$(date '+%Y-%m-%d %H:%M:%S')] PL-1 Compliance Check Completed\" | tee -a \"$LOG_FILE\"",
        "ansible": "---\n# PL-1: Security Planning Policy and Procedures Verification\n- name: PL-1 Security Planning Policy Compliance\n  hosts: all\n  become: yes\n  vars:\n    policy_base_dir: /etc/security/policies/planning\n    required_policies:\n      - security_planning_policy\n      - planning_procedures\n      - roles_and_responsibilities\n    max_policy_age_days: 365\n    compliance_report_dir: /var/log/security/compliance\n\n  tasks:\n    - name: Create policy directory structure\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0755'\n        owner: root\n        group: security\n      loop:\n        - \"{{ policy_base_dir }}/policies\"\n        - \"{{ policy_base_dir }}/procedures\"\n        - \"{{ policy_base_dir }}/acknowledgments\"\n        - \"{{ compliance_report_dir }}\"\n\n    - name: Check for required policy documents\n      stat:\n        path: \"{{ policy_base_dir }}/policies/{{ item }}.pdf\"\n      register: policy_check\n      loop: \"{{ required_policies }}\"\n\n    - name: Report missing policies\n      debug:\n        msg: \"COMPLIANCE WARNING: Missing policy document - {{ item.item }}\"\n      when: not item.stat.exists\n      loop: \"{{ policy_check.results }}\"\n      loop_control:\n        label: \"{{ item.item }}\"\n\n    - name: Check policy document age\n      find:\n        paths: \"{{ policy_base_dir }}\"\n        patterns: \"*.pdf,*.docx\"\n        age: \"{{ max_policy_age_days }}d\"\n        recurse: yes\n      register: outdated_policies\n\n    - name: Generate compliance report\n      template:\n        src: pl1_compliance_report.j2\n        dest: \"{{ compliance_report_dir }}/pl1_report_{{ ansible_date_time.date }}.txt\"\n        mode: '0644'\n\n    - name: Alert on outdated policies\n      debug:\n        msg: \"REVIEW REQUIRED: Policy {{ item.path }} exceeds {{ max_policy_age_days }} day review cycle\"\n      loop: \"{{ outdated_policies.files }}\"\n      loop_control:\n        label: \"{{ item.path | basename }}\"\n      when: outdated_policies.files | length > 0"
      },
      "windows": {
        "powershell": "# PL-1: Security Planning Policy Documentation Verification\n# PowerShell script to verify security planning documentation compliance\n\n$PolicyDir = \"C:\\SecurityPolicies\\Planning\"\n$LogFile = \"C:\\SecurityLogs\\PL1_Compliance.log\"\n$MaxAgeDays = 365\n\nfunction Write-ComplianceLog {\n    param([string]$Message, [string]$Level = \"INFO\")\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logEntry = \"[$timestamp] [$Level] $Message\"\n    Add-Content -Path $LogFile -Value $logEntry\n    switch ($Level) {\n        \"WARNING\" { Write-Warning $Message }\n        \"ERROR\" { Write-Error $Message }\n        default { Write-Host $Message }\n    }\n}\n\n# Ensure log directory exists\n$logDir = Split-Path $LogFile -Parent\nif (!(Test-Path $logDir)) {\n    New-Item -ItemType Directory -Path $logDir -Force | Out-Null\n}\n\nWrite-ComplianceLog \"PL-1 Compliance Check Started\"\n\n# Create policy directory structure if missing\n$requiredFolders = @(\n    \"$PolicyDir\\Policies\",\n    \"$PolicyDir\\Procedures\",\n    \"$PolicyDir\\Acknowledgments\",\n    \"$PolicyDir\\Templates\"\n)\n\nforeach ($folder in $requiredFolders) {\n    if (!(Test-Path $folder)) {\n        New-Item -ItemType Directory -Path $folder -Force | Out-Null\n        Write-ComplianceLog \"Created directory: $folder\" \"INFO\"\n    }\n}\n\n# Required policy documents\n$requiredDocs = @(\n    \"Security_Planning_Policy.pdf\",\n    \"Planning_Procedures.pdf\",\n    \"Roles_Responsibilities.pdf\",\n    \"Policy_Review_Schedule.xlsx\"\n)\n\n$missingDocs = @()\nforeach ($doc in $requiredDocs) {\n    $docPath = Join-Path $PolicyDir \"Policies\\$doc\"\n    if (!(Test-Path $docPath)) {\n        $missingDocs += $doc\n    }\n}\n\nif ($missingDocs.Count -gt 0) {\n    Write-ComplianceLog \"Missing required documents: $($missingDocs -join ', ')\" \"WARNING\"\n}\n\n# Check document age for review compliance\n$allDocs = Get-ChildItem -Path $PolicyDir -Recurse -Include *.pdf,*.docx,*.doc | Where-Object { !$_.PSIsContainer }\n$outdatedDocs = @()\n\nforeach ($doc in $allDocs) {\n    $ageInDays = (New-TimeSpan -Start $doc.LastWriteTime -End (Get-Date)).Days\n    if ($ageInDays -gt $MaxAgeDays) {\n        $outdatedDocs += @{\n            Name = $doc.Name\n            Path = $doc.FullName\n            Age = $ageInDays\n            LastModified = $doc.LastWriteTime\n        }\n        Write-ComplianceLog \"Document '$($doc.Name)' is $ageInDays days old - REVIEW REQUIRED\" \"WARNING\"\n    } else {\n        Write-ComplianceLog \"Document '$($doc.Name)' last updated $ageInDays days ago - OK\" \"INFO\"\n    }\n}\n\n# Generate compliance summary\n$summary = @{\n    CheckDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    MissingDocuments = $missingDocs.Count\n    OutdatedDocuments = $outdatedDocs.Count\n    TotalDocuments = $allDocs.Count\n    ComplianceStatus = if ($missingDocs.Count -eq 0 -and $outdatedDocs.Count -eq 0) { \"COMPLIANT\" } else { \"NON-COMPLIANT\" }\n}\n\n$summary | ConvertTo-Json | Out-File \"$PolicyDir\\compliance_status.json\" -Force\n\nWrite-ComplianceLog \"PL-1 Compliance Check Completed - Status: $($summary.ComplianceStatus)\"",
        "ansible": "---\n# PL-1: Windows Security Planning Policy Compliance\n- name: PL-1 Windows Policy Documentation Compliance\n  hosts: windows\n  gather_facts: yes\n  vars:\n    policy_base_dir: C:\\SecurityPolicies\\Planning\n    compliance_log_dir: C:\\SecurityLogs\n    max_policy_age_days: 365\n\n  tasks:\n    - name: Create policy directory structure\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ policy_base_dir }}\\\\Policies\"\n        - \"{{ policy_base_dir }}\\\\Procedures\"\n        - \"{{ policy_base_dir }}\\\\Acknowledgments\"\n        - \"{{ compliance_log_dir }}\"\n\n    - name: Check for policy documents\n      win_find:\n        paths: \"{{ policy_base_dir }}\"\n        patterns: ['*.pdf', '*.docx']\n        recurse: yes\n      register: policy_documents\n\n    - name: Identify outdated policies\n      set_fact:\n        outdated_policies: \"{{ policy_documents.files | selectattr('lastwritetime', 'lt', lookup('pipe', 'date -d \\\"' + max_policy_age_days|string + ' days ago\\\" +%Y-%m-%d')) | list }}\"\n      when: policy_documents.files | length > 0\n\n    - name: Generate Windows compliance report\n      win_copy:\n        content: |\n          PL-1 Compliance Report\n          Generated: {{ ansible_date_time.iso8601 }}\n          Host: {{ inventory_hostname }}\n          \n          Total Documents Found: {{ policy_documents.files | length }}\n          Documents Requiring Review: {{ outdated_policies | default([]) | length }}\n        dest: \"{{ compliance_log_dir }}\\\\PL1_Report_{{ ansible_date_time.date }}.txt\""
      }
    },
    "stig_id": "",
    "related_controls": [
      "PM-9",
      "PS-8",
      "SI-12",
      "PL-2",
      "PL-4"
    ],
    "enhancements": [],
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "implementation_type": "organizational"
    }
  },
  {
    "control_id": "PL-2",
    "control_name": "System Security and Privacy Plans",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "a. Develop security and privacy plans for the system that:\n  1. Are consistent with the organization's enterprise architecture;\n  2. Explicitly define the constituent system components;\n  3. Describe the operational context of the system in terms of mission and business processes;\n  4. Identify the individuals that fulfill system roles and responsibilities;\n  5. Identify the information types processed, stored, and transmitted by the system;\n  6. Provide the security categorization of the system, including supporting rationale;\n  7. Describe any specific threats to the system that are of concern to the organization;\n  8. Provide the results of a privacy risk assessment for systems processing personally identifiable information;\n  9. Describe the operational environment for the system and any dependencies on or connections to other systems or system components;\n  10. Provide an overview of the security and privacy requirements for the system;\n  11. Identify any relevant control baselines or overlays, if applicable;\n  12. Describe the controls in place or planned for meeting the security and privacy requirements, including a rationale for any tailoring decisions;\n  13. Include risk determinations for security and privacy architecture and design decisions;\n  14. Include security- and privacy-related activities affecting the system that require planning and coordination with [Assignment: organization-defined individuals or groups]; and\n  15. Are reviewed and approved by the authorizing official or designated representative prior to plan implementation;\nb. Distribute copies of the plans and communicate subsequent changes to the plans to [Assignment: organization-defined personnel or roles];\nc. Review the plans [Assignment: organization-defined frequency];\nd. Update the plans to address changes to the system and environment of operation or problems identified during plan implementation or control assessments; and\ne. Protect the plans from unauthorized disclosure and modification.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "This control ensures organizations develop comprehensive security and privacy plans that document the security posture, controls, and risk management approach for each system. These plans serve as the authoritative source for system security information.",
    "rationale": "System Security Plans (SSPs) are essential for establishing a clear understanding of a system's security requirements, implemented controls, and residual risks. They enable consistent security management, support authorization decisions, and provide accountability for security responsibilities.",
    "plain_english_explanation": "You need to create a detailed security plan for each system in your organization. This plan should describe what the system does, what data it handles, who is responsible for it, what security controls are in place, and any risks that remain. Think of it as a comprehensive security blueprint that anyone can reference to understand how a system is protected. The plan must be approved by leadership, kept up to date, shared with relevant staff, and protected from unauthorized access.",
    "ai_guidance": "Developing a System Security Plan requires methodical documentation of all security aspects of an information system. Implementation approach: (1) Use NIST SSP templates or FedRAMP SSP templates as starting frameworks to ensure comprehensive coverage; (2) Integrate with enterprise architecture documentation to maintain consistency with organizational standards; (3) Conduct thorough system boundary analysis to accurately define system components and interconnections; (4) Perform FIPS 199 categorization with documented rationale for each information type; (5) Map all applicable control baselines and document tailoring decisions with risk-based justifications; (6) Include current POA&M items and planned remediation activities; (7) Document all interconnections using ISA/MOU references; (8) Maintain version control with change tracking for all SSP updates; (9) Implement access controls on SSP documents limiting access to authorized personnel; (10) Schedule quarterly reviews with formal annual updates or updates triggered by significant system changes. Consider using GRC tools like CSAM, eMASS, or Xacta for SSP lifecycle management. Ensure privacy risk assessments are integrated for PII-processing systems per OMB requirements.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-2: System Security Plan Documentation and Validation\n# Verifies SSP documentation exists and validates key components\n\nSSP_DIR=\"/etc/security/ssp\"\nLOG_FILE=\"/var/log/security/pl2_ssp_compliance.log\"\nSYSTEM_NAME=\"${HOSTNAME}\"\n\nlog_message() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"\n}\n\nlog_message \"PL-2 System Security Plan Compliance Check - System: $SYSTEM_NAME\"\n\n# Create SSP directory structure\nmkdir -p \"$SSP_DIR\"/{documents,attachments,artifacts,change_history}\n\n# Required SSP components\ndeclare -A SSP_COMPONENTS=(\n    [\"system_identification\"]=\"System name, boundaries, and categorization\"\n    [\"security_controls\"]=\"Implemented and planned controls documentation\"\n    [\"system_interconnections\"]=\"ISAs, MOUs, and data flows\"\n    [\"risk_assessment\"]=\"Current risk assessment and POA&M\"\n    [\"authorization_status\"]=\"ATO documentation and expiration\"\n    [\"privacy_impact\"]=\"PIA/PTA if processing PII\"\n)\n\nlog_message \"Checking required SSP components:\"\n\nfor component in \"${!SSP_COMPONENTS[@]}\"; do\n    component_file=\"$SSP_DIR/documents/${component}.pdf\"\n    if [ -f \"$component_file\" ] || [ -f \"${component_file%.pdf}.docx\" ]; then\n        log_message \"  [OK] $component: ${SSP_COMPONENTS[$component]}\"\n    else\n        log_message \"  [MISSING] $component: ${SSP_COMPONENTS[$component]}\"\n    fi\ndone\n\n# Check SSP master document\nif [ -f \"$SSP_DIR/documents/system_security_plan.pdf\" ]; then\n    SSP_DATE=$(stat -c %Y \"$SSP_DIR/documents/system_security_plan.pdf\")\n    SSP_AGE=$(( ($(date +%s) - $SSP_DATE) / 86400 ))\n    if [ $SSP_AGE -gt 365 ]; then\n        log_message \"[WARNING] SSP is $SSP_AGE days old - annual review required\"\n    else\n        log_message \"[OK] SSP last updated $SSP_AGE days ago\"\n    fi\nelse\n    log_message \"[CRITICAL] Master SSP document not found!\"\nfi\n\n# Generate system inventory for SSP update\nlog_message \"Generating system component inventory...\"\necho \"System Component Inventory - $(date)\" > \"$SSP_DIR/artifacts/system_inventory.txt\"\necho \"Hostname: $(hostname -f)\" >> \"$SSP_DIR/artifacts/system_inventory.txt\"\necho \"OS: $(uname -a)\" >> \"$SSP_DIR/artifacts/system_inventory.txt\"\necho \"IP Addresses: $(hostname -I)\" >> \"$SSP_DIR/artifacts/system_inventory.txt\"\necho \"Open Ports:\" >> \"$SSP_DIR/artifacts/system_inventory.txt\"\nss -tlnp 2>/dev/null >> \"$SSP_DIR/artifacts/system_inventory.txt\"\n\nlog_message \"PL-2 Compliance Check Complete - Inventory saved to $SSP_DIR/artifacts/system_inventory.txt\"",
        "ansible": "---\n# PL-2: System Security Plan Documentation Management\n- name: PL-2 System Security Plan Compliance\n  hosts: all\n  become: yes\n  vars:\n    ssp_base_dir: /etc/security/ssp\n    ssp_components:\n      - name: system_identification\n        description: System name, boundaries, and categorization\n      - name: security_controls\n        description: Implemented and planned controls\n      - name: system_interconnections\n        description: ISAs, MOUs, and data flows\n      - name: risk_assessment\n        description: Current risk assessment and POA&M\n      - name: roles_responsibilities\n        description: Personnel security roles\n      - name: authorization_package\n        description: ATO documentation\n    compliance_report_path: /var/log/security/ssp_compliance\n\n  tasks:\n    - name: Create SSP directory structure\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0750'\n        owner: root\n        group: security\n      loop:\n        - \"{{ ssp_base_dir }}/documents\"\n        - \"{{ ssp_base_dir }}/attachments\"\n        - \"{{ ssp_base_dir }}/artifacts\"\n        - \"{{ ssp_base_dir }}/change_history\"\n        - \"{{ compliance_report_path }}\"\n\n    - name: Gather system facts for SSP\n      setup:\n        gather_subset:\n          - hardware\n          - network\n          - virtual\n\n    - name: Generate system component inventory\n      template:\n        src: system_inventory.j2\n        dest: \"{{ ssp_base_dir }}/artifacts/system_inventory_{{ ansible_date_time.date }}.txt\"\n        mode: '0640'\n\n    - name: Check for SSP master document\n      stat:\n        path: \"{{ ssp_base_dir }}/documents/system_security_plan.pdf\"\n      register: ssp_master\n\n    - name: Validate SSP document age\n      debug:\n        msg: \"WARNING: SSP requires annual review - document age exceeds 365 days\"\n      when: \n        - ssp_master.stat.exists\n        - (ansible_date_time.epoch | int) - (ssp_master.stat.mtime | int) > 31536000\n\n    - name: Generate network configuration artifact\n      shell: |\n        echo \"Network Configuration - {{ ansible_date_time.iso8601 }}\" > {{ ssp_base_dir }}/artifacts/network_config.txt\n        ip addr >> {{ ssp_base_dir }}/artifacts/network_config.txt\n        ip route >> {{ ssp_base_dir }}/artifacts/network_config.txt\n        ss -tlnp >> {{ ssp_base_dir }}/artifacts/network_config.txt\n      changed_when: false\n\n    - name: Generate installed packages artifact\n      shell: |\n        echo \"Installed Packages - {{ ansible_date_time.iso8601 }}\" > {{ ssp_base_dir }}/artifacts/packages.txt\n        {{ 'dpkg -l' if ansible_os_family == 'Debian' else 'rpm -qa' }} >> {{ ssp_base_dir }}/artifacts/packages.txt\n      changed_when: false"
      },
      "windows": {
        "powershell": "# PL-2: System Security Plan Documentation and Validation\n# PowerShell script for SSP compliance verification\n\n$SSPDir = \"C:\\SecurityDocs\\SSP\"\n$LogFile = \"C:\\SecurityLogs\\PL2_SSP_Compliance.log\"\n$SystemName = $env:COMPUTERNAME\n\nfunction Write-SSPLog {\n    param([string]$Message, [string]$Level = \"INFO\")\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logEntry = \"[$timestamp] [$Level] $Message\"\n    Add-Content -Path $LogFile -Value $logEntry\n    Write-Host $logEntry\n}\n\n# Ensure directories exist\n$directories = @(\n    \"$SSPDir\\Documents\",\n    \"$SSPDir\\Attachments\",\n    \"$SSPDir\\Artifacts\",\n    \"$SSPDir\\ChangeHistory\",\n    (Split-Path $LogFile -Parent)\n)\n\nforeach ($dir in $directories) {\n    if (!(Test-Path $dir)) {\n        New-Item -ItemType Directory -Path $dir -Force | Out-Null\n    }\n}\n\nWrite-SSPLog \"PL-2 System Security Plan Compliance Check - System: $SystemName\"\n\n# Required SSP components\n$sspComponents = @{\n    \"System_Identification\" = \"System name, boundaries, categorization\"\n    \"Security_Controls\" = \"Implemented and planned controls\"\n    \"System_Interconnections\" = \"ISAs, MOUs, data flows\"\n    \"Risk_Assessment\" = \"Current risk assessment and POA&M\"\n    \"Authorization_Status\" = \"ATO documentation\"\n    \"Privacy_Impact\" = \"PIA/PTA for PII systems\"\n    \"Incident_Response\" = \"IR procedures and contacts\"\n}\n\nWrite-SSPLog \"Checking required SSP components:\"\n$missingComponents = @()\n\nforeach ($component in $sspComponents.Keys) {\n    $docPath = \"$SSPDir\\Documents\\$component.pdf\"\n    $docxPath = \"$SSPDir\\Documents\\$component.docx\"\n    \n    if ((Test-Path $docPath) -or (Test-Path $docxPath)) {\n        Write-SSPLog \"  [OK] $component - $($sspComponents[$component])\"\n    } else {\n        Write-SSPLog \"  [MISSING] $component - $($sspComponents[$component])\" \"WARNING\"\n        $missingComponents += $component\n    }\n}\n\n# Check master SSP document\n$sspMaster = \"$SSPDir\\Documents\\System_Security_Plan.pdf\"\nif (Test-Path $sspMaster) {\n    $sspFile = Get-Item $sspMaster\n    $ageInDays = (New-TimeSpan -Start $sspFile.LastWriteTime -End (Get-Date)).Days\n    \n    if ($ageInDays -gt 365) {\n        Write-SSPLog \"SSP is $ageInDays days old - ANNUAL REVIEW REQUIRED\" \"WARNING\"\n    } else {\n        Write-SSPLog \"SSP last updated $ageInDays days ago - OK\"\n    }\n} else {\n    Write-SSPLog \"Master SSP document not found!\" \"ERROR\"\n}\n\n# Generate system inventory artifact for SSP update\nWrite-SSPLog \"Generating system component inventory...\"\n\n$systemInventory = @{\n    GeneratedDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    ComputerName = $env:COMPUTERNAME\n    Domain = $env:USERDOMAIN\n    OSVersion = (Get-CimInstance Win32_OperatingSystem).Caption\n    OSBuild = (Get-CimInstance Win32_OperatingSystem).BuildNumber\n    IPAddresses = (Get-NetIPAddress -AddressFamily IPv4 | Where-Object { $_.IPAddress -ne '127.0.0.1' }).IPAddress\n    InstalledRoles = (Get-WindowsFeature | Where-Object { $_.Installed }).Name\n    OpenPorts = (Get-NetTCPConnection -State Listen | Select-Object LocalPort -Unique).LocalPort | Sort-Object\n    Services = (Get-Service | Where-Object { $_.Status -eq 'Running' }).DisplayName\n}\n\n$systemInventory | ConvertTo-Json -Depth 3 | Out-File \"$SSPDir\\Artifacts\\system_inventory_$(Get-Date -Format 'yyyyMMdd').json\" -Force\n\n# Generate compliance summary\n$complianceSummary = @{\n    CheckDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    SystemName = $SystemName\n    TotalComponents = $sspComponents.Count\n    MissingComponents = $missingComponents.Count\n    MissingList = $missingComponents\n    ComplianceStatus = if ($missingComponents.Count -eq 0) { \"COMPLIANT\" } else { \"NON-COMPLIANT\" }\n}\n\n$complianceSummary | ConvertTo-Json | Out-File \"$SSPDir\\compliance_status.json\" -Force\n\nWrite-SSPLog \"PL-2 Compliance Check Complete - Status: $($complianceSummary.ComplianceStatus)\"",
        "ansible": "---\n# PL-2: Windows System Security Plan Compliance\n- name: PL-2 Windows SSP Documentation Compliance\n  hosts: windows\n  gather_facts: yes\n  vars:\n    ssp_base_dir: C:\\SecurityDocs\\SSP\n    compliance_log_dir: C:\\SecurityLogs\n\n  tasks:\n    - name: Create SSP directory structure\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ ssp_base_dir }}\\\\Documents\"\n        - \"{{ ssp_base_dir }}\\\\Attachments\"\n        - \"{{ ssp_base_dir }}\\\\Artifacts\"\n        - \"{{ compliance_log_dir }}\"\n\n    - name: Gather Windows system information\n      win_shell: |\n        $info = @{\n          ComputerName = $env:COMPUTERNAME\n          OS = (Get-CimInstance Win32_OperatingSystem).Caption\n          Domain = $env:USERDOMAIN\n          IPAddresses = (Get-NetIPAddress -AddressFamily IPv4).IPAddress -join ', '\n          LastBoot = (Get-CimInstance Win32_OperatingSystem).LastBootUpTime\n        }\n        $info | ConvertTo-Json\n      register: system_info\n\n    - name: Save system inventory artifact\n      win_copy:\n        content: \"{{ system_info.stdout }}\"\n        dest: \"{{ ssp_base_dir }}\\\\Artifacts\\\\system_inventory.json\"\n\n    - name: Check for SSP master document\n      win_stat:\n        path: \"{{ ssp_base_dir }}\\\\Documents\\\\System_Security_Plan.pdf\"\n      register: ssp_check\n\n    - name: Report SSP status\n      debug:\n        msg: \"{{ 'SSP document found' if ssp_check.stat.exists else 'SSP document MISSING - ACTION REQUIRED' }}\""
      }
    },
    "stig_id": "",
    "related_controls": [
      "PL-1",
      "PL-7",
      "PL-8",
      "PM-1",
      "PM-7",
      "PM-8",
      "PM-9",
      "PM-10",
      "PM-11",
      "RA-3",
      "RA-9",
      "SA-5",
      "SA-17",
      "SI-12"
    ],
    "enhancements": [
      {
        "id": "PL-2(3)",
        "title": "Plan and Coordinate with Other Organizational Entities"
      }
    ],
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "implementation_type": "organizational"
    }
  },
  {
    "control_id": "PL-2.1",
    "control_name": "Concept of Operations",
    "family": "Planning",
    "family_id": "PL",
    "parent_control": "PL-2",
    "official_text": "[Withdrawn: Incorporated into PL-7.]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control enhancement has been withdrawn in NIST SP 800-53 Rev 5 and its requirements have been incorporated into PL-7 (Concept of Operations).",
    "rationale": "NIST consolidated concept of operations requirements into a standalone control (PL-7) to provide clearer guidance and better alignment with system development lifecycle practices.",
    "plain_english_explanation": "This control enhancement no longer exists as a separate requirement in NIST SP 800-53 Revision 5. If you need to address concept of operations documentation, refer to control PL-7 which now contains all the relevant requirements. Organizations should update their control mappings and compliance documentation to reference PL-7 instead of PL-2(1).",
    "ai_guidance": "WITHDRAWN CONTROL - This control enhancement (PL-2(1) Concept of Operations) has been withdrawn in NIST SP 800-53 Revision 5 and incorporated into PL-7. Organizations should take the following actions: (1) Remove PL-2(1) from current control implementation tracking; (2) Update any POA&M items referencing PL-2(1) to reference PL-7; (3) Migrate any documentation or evidence previously associated with PL-2(1) to PL-7 control artifacts; (4) Update compliance matrices, SSPs, and assessment documentation to reflect this change; (5) Ensure assessors and auditors are aware of the control consolidation when reviewing historical documentation; (6) For legacy systems still operating under Rev 4, maintain historical records but plan migration to Rev 5 control mapping. No implementation is required for this withdrawn control - all concept of operations requirements are now addressed through PL-7.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-2(1): WITHDRAWN CONTROL NOTICE\n# This control has been incorporated into PL-7 in NIST SP 800-53 Rev 5\n\necho \"============================================================\"\necho \"NOTICE: PL-2(1) Concept of Operations - WITHDRAWN\"\necho \"============================================================\"\necho \"\"\necho \"This control enhancement has been withdrawn in NIST SP 800-53\"\necho \"Revision 5 and incorporated into control PL-7.\"\necho \"\"\necho \"ACTION REQUIRED:\"\necho \"  - Update compliance documentation to reference PL-7\"\necho \"  - Migrate any PL-2(1) evidence to PL-7 control folder\"\necho \"  - Update POA&M items if applicable\"\necho \"\"\necho \"Reference: NIST SP 800-53 Rev 5, Appendix F\"\necho \"============================================================\"",
        "ansible": "---\n# PL-2(1): Withdrawn Control Notice\n- name: PL-2(1) Withdrawn Control Notification\n  hosts: localhost\n  gather_facts: no\n  tasks:\n    - name: Display withdrawn control notice\n      debug:\n        msg:\n          - \"NOTICE: PL-2(1) Concept of Operations has been WITHDRAWN\"\n          - \"This control was incorporated into PL-7 in NIST SP 800-53 Rev 5\"\n          - \"ACTION: Update compliance documentation to reference PL-7\"\n          - \"ACTION: Migrate evidence artifacts to PL-7 control folder\""
      },
      "windows": {
        "powershell": "# PL-2(1): WITHDRAWN CONTROL NOTICE\n# This control has been incorporated into PL-7 in NIST SP 800-53 Rev 5\n\nWrite-Host \"============================================================\" -ForegroundColor Yellow\nWrite-Host \"NOTICE: PL-2(1) Concept of Operations - WITHDRAWN\" -ForegroundColor Yellow\nWrite-Host \"============================================================\" -ForegroundColor Yellow\nWrite-Host \"\"\nWrite-Host \"This control enhancement has been withdrawn in NIST SP 800-53\"\nWrite-Host \"Revision 5 and incorporated into control PL-7.\"\nWrite-Host \"\"\nWrite-Host \"ACTION REQUIRED:\" -ForegroundColor Cyan\nWrite-Host \"  - Update compliance documentation to reference PL-7\"\nWrite-Host \"  - Migrate any PL-2(1) evidence to PL-7 control folder\"\nWrite-Host \"  - Update POA&M items if applicable\"\nWrite-Host \"\"\nWrite-Host \"Reference: NIST SP 800-53 Rev 5, Appendix F\"\nWrite-Host \"============================================================\" -ForegroundColor Yellow",
        "ansible": "---\n# PL-2(1): Withdrawn Control Notice for Windows\n- name: PL-2(1) Withdrawn Control Notification\n  hosts: windows\n  gather_facts: no\n  tasks:\n    - name: Display withdrawn control notice\n      win_shell: |\n        Write-Host 'NOTICE: PL-2(1) Concept of Operations - WITHDRAWN'\n        Write-Host 'Incorporated into PL-7 in NIST SP 800-53 Rev 5'"
      }
    },
    "stig_id": "",
    "related_controls": [
      "PL-7"
    ],
    "withdrawn": true,
    "withdrawn_incorporated_into": "PL-7",
    "enhancements": [],
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false,
      "implementation_type": "withdrawn"
    }
  },
  {
    "control_id": "PL-2.2",
    "control_name": "Functional Architecture",
    "family": "Planning",
    "family_id": "PL",
    "parent_control": "PL-2",
    "official_text": "[Withdrawn: Incorporated into PL-8.]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control enhancement has been withdrawn in NIST SP 800-53 Rev 5 and its requirements have been incorporated into PL-8 (Security and Privacy Architectures).",
    "rationale": "NIST consolidated functional architecture requirements into PL-8 to provide a more comprehensive approach to security and privacy architecture documentation that encompasses both functional and security architecture considerations.",
    "plain_english_explanation": "This control enhancement no longer exists as a separate requirement in NIST SP 800-53 Revision 5. The functional architecture requirements are now part of PL-8 (Security and Privacy Architectures). If your organization needs to document functional architecture from a security perspective, refer to PL-8 for current guidance. Update any compliance tracking to reflect this change.",
    "ai_guidance": "WITHDRAWN CONTROL - This control enhancement (PL-2(2) Functional Architecture) has been withdrawn in NIST SP 800-53 Revision 5 and incorporated into PL-8 (Security and Privacy Architectures). Organizations should take the following actions: (1) Remove PL-2(2) from active control tracking and compliance matrices; (2) Transfer any existing functional architecture documentation to PL-8 control evidence; (3) Update System Security Plans to reference PL-8 for architecture documentation requirements; (4) Ensure that functional architecture diagrams, data flow diagrams, and system component documentation align with PL-8 requirements; (5) Update any assessment procedures that referenced PL-2(2) to instead assess against PL-8; (6) Review enterprise architecture documentation to ensure it addresses both functional and security architecture elements as required by PL-8. The consolidation into PL-8 provides a more holistic approach to documenting system architectures with integrated security and privacy considerations.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-2(2): WITHDRAWN CONTROL NOTICE\n# This control has been incorporated into PL-8 in NIST SP 800-53 Rev 5\n\necho \"============================================================\"\necho \"NOTICE: PL-2(2) Functional Architecture - WITHDRAWN\"\necho \"============================================================\"\necho \"\"\necho \"This control enhancement has been withdrawn in NIST SP 800-53\"\necho \"Revision 5 and incorporated into control PL-8 (Security and\"\necho \"Privacy Architectures).\"\necho \"\"\necho \"ACTION REQUIRED:\"\necho \"  - Update compliance documentation to reference PL-8\"\necho \"  - Migrate architecture documentation to PL-8 evidence\"\necho \"  - Update SSP architecture sections per PL-8 requirements\"\necho \"\"\necho \"Reference: NIST SP 800-53 Rev 5, Appendix F\"\necho \"============================================================\"",
        "ansible": "---\n# PL-2(2): Withdrawn Control Notice\n- name: PL-2(2) Withdrawn Control Notification\n  hosts: localhost\n  gather_facts: no\n  tasks:\n    - name: Display withdrawn control notice\n      debug:\n        msg:\n          - \"NOTICE: PL-2(2) Functional Architecture has been WITHDRAWN\"\n          - \"Incorporated into PL-8 (Security and Privacy Architectures)\"\n          - \"ACTION: Update compliance tracking to reference PL-8\"\n          - \"ACTION: Migrate architecture documentation to PL-8 artifacts\""
      },
      "windows": {
        "powershell": "# PL-2(2): WITHDRAWN CONTROL NOTICE\n# This control has been incorporated into PL-8 in NIST SP 800-53 Rev 5\n\nWrite-Host \"============================================================\" -ForegroundColor Yellow\nWrite-Host \"NOTICE: PL-2(2) Functional Architecture - WITHDRAWN\" -ForegroundColor Yellow\nWrite-Host \"============================================================\" -ForegroundColor Yellow\nWrite-Host \"\"\nWrite-Host \"This control enhancement has been withdrawn in NIST SP 800-53\"\nWrite-Host \"Revision 5 and incorporated into control PL-8.\"\nWrite-Host \"\"\nWrite-Host \"ACTION REQUIRED:\" -ForegroundColor Cyan\nWrite-Host \"  - Update compliance documentation to reference PL-8\"\nWrite-Host \"  - Migrate architecture documentation to PL-8 evidence\"\nWrite-Host \"  - Update SSP architecture sections per PL-8 requirements\"\nWrite-Host \"\"\nWrite-Host \"Reference: NIST SP 800-53 Rev 5, Appendix F\"\nWrite-Host \"============================================================\" -ForegroundColor Yellow",
        "ansible": "---\n# PL-2(2): Withdrawn Control Notice for Windows\n- name: PL-2(2) Withdrawn Control Notification\n  hosts: windows\n  gather_facts: no\n  tasks:\n    - name: Display withdrawn control notice\n      win_shell: |\n        Write-Host 'NOTICE: PL-2(2) Functional Architecture - WITHDRAWN'\n        Write-Host 'Incorporated into PL-8 in NIST SP 800-53 Rev 5'"
      }
    },
    "stig_id": "",
    "related_controls": [
      "PL-8",
      "SA-8",
      "SA-17"
    ],
    "withdrawn": true,
    "withdrawn_incorporated_into": "PL-8",
    "enhancements": [],
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false,
      "implementation_type": "withdrawn"
    }
  },
  {
    "control_id": "PL-2.3",
    "control_name": "Plan and Coordinate with Other Organizational Entities",
    "family": "Planning",
    "family_id": "PL",
    "parent_control": "PL-2",
    "official_text": "Plan and coordinate security- and privacy-related activities affecting the system with [Assignment: organization-defined individuals or groups] before conducting such activities in order to reduce the impact on other organizational entities.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control ensures that security and privacy activities are coordinated across organizational boundaries to prevent negative impacts on interconnected systems, shared services, or other organizational units that may be affected by planned activities.",
    "rationale": "Uncoordinated security activities can disrupt business operations, cause service outages, or create security gaps when changes affect shared infrastructure or interconnected systems. Proper coordination ensures all affected parties are aware and prepared.",
    "plain_english_explanation": "Before you do anything security-related that might affect other teams or systems in your organization, you need to talk to them first. This includes things like security testing, system updates, policy changes, or incident response activities. Coordinate with IT operations, other system owners, privacy officers, and anyone else who might be impacted. This prevents surprises, reduces disruptions, and ensures everyone can prepare for potential impacts.",
    "ai_guidance": "Implementing effective cross-organizational coordination requires establishing formal communication channels and procedures. Key implementation elements: (1) Identify all organizational entities that may be affected by security activities including IT operations, business units, privacy office, legal, HR, and external partners; (2) Develop a coordination matrix mapping activity types to required stakeholders; (3) Establish notification timeframes based on activity impact level - routine changes may need 5-day notice while emergency changes follow incident procedures; (4) Create standardized coordination request templates that capture activity description, timeline, potential impacts, and rollback procedures; (5) Integrate coordination requirements into change management processes; (6) Document coordination activities in change records for audit purposes; (7) Establish escalation procedures when coordination cannot be achieved within required timeframes; (8) Consider using enterprise ticketing systems or change advisory boards (CAB) for formal coordination tracking; (9) For penetration testing and security assessments, ensure coordination with SOC, network operations, and potentially law enforcement liaisons; (10) Maintain a stakeholder contact directory with backup contacts for time-sensitive activities.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-2(3): Security Activity Coordination Tracking\n# Script to log and track coordination of security activities\n\nCOORDINATION_DIR=\"/etc/security/coordination\"\nLOG_FILE=\"/var/log/security/pl2_3_coordination.log\"\nTEMPLATE_DIR=\"$COORDINATION_DIR/templates\"\n\nlog_message() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"\n}\n\n# Create directory structure\nmkdir -p \"$COORDINATION_DIR\"/{active,completed,templates}\nmkdir -p \"$(dirname $LOG_FILE)\"\n\nlog_message \"PL-2(3) Security Activity Coordination System Initialized\"\n\n# Create coordination request template\ncat > \"$TEMPLATE_DIR/coordination_request.txt\" << 'EOF'\n================================================================================\nSECURITY ACTIVITY COORDINATION REQUEST\n================================================================================\n\nRequest ID: [AUTO-GENERATED]\nRequest Date: [DATE]\nRequester: [NAME/ROLE]\n\n--------------------------------------------------------------------------------\nACTIVITY DETAILS\n--------------------------------------------------------------------------------\nActivity Type: [ ] Penetration Testing  [ ] Vulnerability Scan  [ ] System Update\n               [ ] Policy Change  [ ] Incident Response  [ ] Other: _________\n\nActivity Description:\n_______________________________________________________________________________\n_______________________________________________________________________________\n\nPlanned Start Date/Time: _______________\nPlanned End Date/Time: _______________\n\nSystems Affected:\n_______________________________________________________________________________\n\n--------------------------------------------------------------------------------\nIMPACT ASSESSMENT\n--------------------------------------------------------------------------------\nPotential Business Impact: [ ] Low  [ ] Medium  [ ] High  [ ] Critical\n\nPotential Service Disruption: [ ] None  [ ] Minimal  [ ] Moderate  [ ] Significant\n\nImpact Description:\n_______________________________________________________________________________\n\n--------------------------------------------------------------------------------\nSTAKEHOLDER COORDINATION\n--------------------------------------------------------------------------------\n[ ] IT Operations        Contact: ___________ Date Notified: ___________\n[ ] Network Operations   Contact: ___________ Date Notified: ___________\n[ ] Security Operations  Contact: ___________ Date Notified: ___________\n[ ] Privacy Office       Contact: ___________ Date Notified: ___________\n[ ] Business Owners      Contact: ___________ Date Notified: ___________\n[ ] External Partners    Contact: ___________ Date Notified: ___________\n\n--------------------------------------------------------------------------------\nROLLBACK PLAN\n--------------------------------------------------------------------------------\n_______________________________________________________________________________\n_______________________________________________________________________________\n\n--------------------------------------------------------------------------------\nAPPROVALS\n--------------------------------------------------------------------------------\nSystem Owner: _________________ Signature: __________ Date: __________\nISO/ISSO:     _________________ Signature: __________ Date: __________\n\n================================================================================\nEOF\n\nlog_message \"Coordination request template created at $TEMPLATE_DIR/coordination_request.txt\"\n\n# Create stakeholder contact list template\ncat > \"$TEMPLATE_DIR/stakeholder_contacts.csv\" << 'EOF'\nOrganization,Role,Name,Email,Phone,Backup_Contact,Notification_Method\nIT Operations,Operations Manager,,,,,Email/Phone\nNetwork Operations,Network Administrator,,,,,Email/Phone\nSecurity Operations,SOC Manager,,,,,Email/Phone/Ticket\nPrivacy Office,Privacy Officer,,,,,Email\nBusiness Unit 1,System Owner,,,,,Email\nExternal Partner,Security Contact,,,,,Email\nEOF\n\nlog_message \"Stakeholder contact template created at $TEMPLATE_DIR/stakeholder_contacts.csv\"\n\n# Function to create new coordination request\ncreate_coordination_request() {\n    REQUEST_ID=\"COORD-$(date '+%Y%m%d')-$$\"\n    REQUEST_FILE=\"$COORDINATION_DIR/active/${REQUEST_ID}.txt\"\n    cp \"$TEMPLATE_DIR/coordination_request.txt\" \"$REQUEST_FILE\"\n    sed -i \"s/\\[AUTO-GENERATED\\]/$REQUEST_ID/g\" \"$REQUEST_FILE\"\n    sed -i \"s/\\[DATE\\]/$(date '+%Y-%m-%d')/g\" \"$REQUEST_FILE\"\n    log_message \"Created new coordination request: $REQUEST_ID\"\n    echo \"$REQUEST_FILE\"\n}\n\nlog_message \"PL-2(3) Coordination system ready. Templates available in $TEMPLATE_DIR\"",
        "ansible": "---\n# PL-2(3): Security Activity Coordination Management\n- name: PL-2(3) Coordination Framework Setup\n  hosts: all\n  become: yes\n  vars:\n    coordination_dir: /etc/security/coordination\n    notification_lead_days: 5\n    stakeholder_groups:\n      - name: IT Operations\n        email_group: it-ops@organization.com\n        required_for: ['system_changes', 'maintenance']\n      - name: Security Operations\n        email_group: soc@organization.com\n        required_for: ['pen_testing', 'vulnerability_scans', 'incident_response']\n      - name: Network Operations\n        email_group: network-ops@organization.com\n        required_for: ['network_changes', 'firewall_updates']\n      - name: Privacy Office\n        email_group: privacy@organization.com\n        required_for: ['pii_activities', 'privacy_assessments']\n\n  tasks:\n    - name: Create coordination directory structure\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0755'\n      loop:\n        - \"{{ coordination_dir }}/active\"\n        - \"{{ coordination_dir }}/completed\"\n        - \"{{ coordination_dir }}/templates\"\n        - /var/log/security\n\n    - name: Deploy coordination request template\n      copy:\n        dest: \"{{ coordination_dir }}/templates/coordination_request.md\"\n        mode: '0644'\n        content: |\n          # Security Activity Coordination Request\n          \n          **Request ID:** {{ '{{' }} request_id {{ '}}' }}\n          **Date:** {{ '{{' }} date {{ '}}' }}\n          **Requester:** {{ '{{' }} requester {{ '}}' }}\n          \n          ## Activity Details\n          - **Type:** \n          - **Description:** \n          - **Start Date/Time:** \n          - **End Date/Time:** \n          - **Systems Affected:** \n          \n          ## Stakeholder Notification\n          | Stakeholder | Contact | Notified | Approved |\n          |-------------|---------|----------|----------|\n          | IT Operations | | | |\n          | Security Ops | | | |\n          | Network Ops | | | |\n          | Privacy Office | | | |\n          \n          ## Rollback Plan\n          \n          ## Approvals\n          - System Owner: __________ Date: __________\n          - ISSO: __________ Date: __________\n\n    - name: Deploy stakeholder contact list\n      copy:\n        dest: \"{{ coordination_dir }}/stakeholder_contacts.yml\"\n        mode: '0640'\n        content: \"{{ stakeholder_groups | to_nice_yaml }}\"\n\n    - name: Create coordination log\n      file:\n        path: /var/log/security/coordination.log\n        state: touch\n        mode: '0640'"
      },
      "windows": {
        "powershell": "# PL-2(3): Security Activity Coordination Framework\n# PowerShell script for managing security activity coordination\n\n$CoordinationDir = \"C:\\SecurityDocs\\Coordination\"\n$LogFile = \"C:\\SecurityLogs\\PL2_3_Coordination.log\"\n\nfunction Write-CoordLog {\n    param([string]$Message)\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    \"[$timestamp] $Message\" | Tee-Object -FilePath $LogFile -Append\n}\n\n# Create directory structure\n$directories = @(\n    \"$CoordinationDir\\Active\",\n    \"$CoordinationDir\\Completed\",\n    \"$CoordinationDir\\Templates\",\n    (Split-Path $LogFile -Parent)\n)\n\nforeach ($dir in $directories) {\n    if (!(Test-Path $dir)) {\n        New-Item -ItemType Directory -Path $dir -Force | Out-Null\n    }\n}\n\nWrite-CoordLog \"PL-2(3) Security Activity Coordination System Initialized\"\n\n# Create coordination request template\n$coordinationTemplate = @\"\n================================================================================\nSECURITY ACTIVITY COORDINATION REQUEST\n================================================================================\n\nRequest ID: [AUTO-GENERATED]\nRequest Date: [DATE]\nRequester Name: \nRequester Role: \nRequester Email: \n\n--------------------------------------------------------------------------------\nACTIVITY DETAILS\n--------------------------------------------------------------------------------\nActivity Type: (Check one)\n[ ] Penetration Testing\n[ ] Vulnerability Assessment\n[ ] System Patching/Updates\n[ ] Configuration Changes\n[ ] Security Policy Update\n[ ] Incident Response Activity\n[ ] Other: ________________\n\nDetailed Description:\n\n\nPlanned Start Date/Time: \nPlanned End Date/Time: \nEstimated Duration: \n\nSystems/Applications Affected:\n\n\n--------------------------------------------------------------------------------\nIMPACT ASSESSMENT\n--------------------------------------------------------------------------------\nBusiness Impact Level: [ ] Low  [ ] Medium  [ ] High  [ ] Critical\nService Disruption Expected: [ ] None  [ ] Minimal  [ ] Moderate  [ ] Significant\n\nDescription of Potential Impacts:\n\n\n--------------------------------------------------------------------------------\nSTAKEHOLDER COORDINATION CHECKLIST\n--------------------------------------------------------------------------------\n[ ] IT Operations\n    Contact Name: ______________ Notified: ____/____/____ Method: __________\n    \n[ ] Network Operations Center  \n    Contact Name: ______________ Notified: ____/____/____ Method: __________\n    \n[ ] Security Operations Center\n    Contact Name: ______________ Notified: ____/____/____ Method: __________\n    \n[ ] Privacy Office (if PII involved)\n    Contact Name: ______________ Notified: ____/____/____ Method: __________\n    \n[ ] Business Unit Owners\n    Contact Name: ______________ Notified: ____/____/____ Method: __________\n    \n[ ] External Partners/Vendors (if applicable)\n    Contact Name: ______________ Notified: ____/____/____ Method: __________\n\n--------------------------------------------------------------------------------\nCOMMUNICATION PLAN\n--------------------------------------------------------------------------------\nPre-Activity Notification: \nDuring Activity Updates: \nPost-Activity Summary: \n\n--------------------------------------------------------------------------------\nROLLBACK/CONTINGENCY PLAN\n--------------------------------------------------------------------------------\n\n\n--------------------------------------------------------------------------------\nAPPROVALS\n--------------------------------------------------------------------------------\nSystem Owner:\n  Name: __________________ Signature: ________________ Date: ____/____/____\n\nISSO/Security Manager:\n  Name: __________________ Signature: ________________ Date: ____/____/____\n\nChange Advisory Board (if required):\n  CAB Ticket #: ________________ Approval Date: ____/____/____\n\n================================================================================\n\"@\n\n$coordinationTemplate | Out-File \"$CoordinationDir\\Templates\\Coordination_Request_Template.txt\" -Encoding UTF8\nWrite-CoordLog \"Created coordination request template\"\n\n# Create stakeholder contact list\n$stakeholderContacts = @\"\nStakeholder Group,Primary Contact,Email,Phone,Backup Contact,Notification Lead Time\nIT Operations,,,,,5 business days\nNetwork Operations Center,,,,,5 business days\nSecurity Operations Center,,,,,3 business days\nPrivacy Office,,,,,5 business days\nBusiness Unit Owners,,,,,5 business days\nExternal Partners,,,,,10 business days\nExecutive Leadership,,,,,7 business days\n\"@\n\n$stakeholderContacts | Out-File \"$CoordinationDir\\Templates\\Stakeholder_Contacts.csv\" -Encoding UTF8\nWrite-CoordLog \"Created stakeholder contact template\"\n\n# Function to create new coordination request\nfunction New-CoordinationRequest {\n    param(\n        [string]$ActivityType,\n        [string]$Requester\n    )\n    \n    $requestId = \"COORD-\" + (Get-Date -Format \"yyyyMMdd\") + \"-\" + (Get-Random -Maximum 9999).ToString(\"D4\")\n    $requestFile = \"$CoordinationDir\\Active\\$requestId.txt\"\n    \n    $content = Get-Content \"$CoordinationDir\\Templates\\Coordination_Request_Template.txt\" -Raw\n    $content = $content -replace '\\[AUTO-GENERATED\\]', $requestId\n    $content = $content -replace '\\[DATE\\]', (Get-Date -Format \"yyyy-MM-dd\")\n    $content | Out-File $requestFile -Encoding UTF8\n    \n    Write-CoordLog \"Created new coordination request: $requestId\"\n    return $requestFile\n}\n\nWrite-CoordLog \"PL-2(3) Coordination system ready. Use New-CoordinationRequest to create requests.\"",
        "ansible": "---\n# PL-2(3): Windows Security Activity Coordination\n- name: PL-2(3) Windows Coordination Framework\n  hosts: windows\n  vars:\n    coordination_dir: C:\\SecurityDocs\\Coordination\n\n  tasks:\n    - name: Create coordination directories\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ coordination_dir }}\\\\Active\"\n        - \"{{ coordination_dir }}\\\\Completed\"\n        - \"{{ coordination_dir }}\\\\Templates\"\n        - C:\\SecurityLogs\n\n    - name: Deploy coordination request template\n      win_copy:\n        dest: \"{{ coordination_dir }}\\\\Templates\\\\README.txt\"\n        content: |\n          PL-2(3) Security Activity Coordination\n          \n          This folder contains templates for coordinating security activities\n          with other organizational entities.\n          \n          Required coordination stakeholders:\n          - IT Operations\n          - Network Operations\n          - Security Operations Center\n          - Privacy Office (for PII-related activities)\n          - Business Unit Owners\n          - External Partners (as applicable)\n          \n          Minimum notification lead time: 5 business days\n          Emergency activities: Follow incident response procedures"
      }
    },
    "stig_id": "",
    "related_controls": [
      "CA-2",
      "CA-6",
      "CA-7",
      "PL-2",
      "PM-10",
      "SA-10",
      "SI-4"
    ],
    "enhancements": [],
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "implementation_type": "organizational"
    }
  },
  {
    "control_id": "PL-3",
    "control_name": "System Security Plan Update",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "[Withdrawn: Incorporated into PL-2.]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control has been withdrawn in NIST SP 800-53 Rev 5. The requirements for updating system security plans have been incorporated into the base PL-2 control.",
    "rationale": "NIST determined that plan update requirements are an integral part of security plan management and should not be a separate control. Consolidating update requirements into PL-2 provides a more cohesive approach to SSP lifecycle management.",
    "plain_english_explanation": "This control no longer exists as a separate requirement in NIST SP 800-53 Revision 5. The requirements for keeping your System Security Plan up to date are now part of control PL-2. If you were previously tracking compliance against PL-3, update your documentation to reference PL-2 section d, which specifically addresses plan updates in response to system changes and assessment findings.",
    "ai_guidance": "WITHDRAWN CONTROL - This control (PL-3 System Security Plan Update) has been withdrawn in NIST SP 800-53 Revision 5 and incorporated into PL-2. The plan update requirements are now addressed in PL-2 section d, which states organizations must 'Update the plans to address changes to the system and environment of operation or problems identified during plan implementation or control assessments.' Organizations should take the following actions: (1) Remove PL-3 from active control baselines and compliance tracking; (2) Ensure PL-2 implementation includes robust plan update procedures; (3) Update any POA&M items referencing PL-3 to reference PL-2; (4) Migrate evidence and documentation from PL-3 to PL-2 control artifacts; (5) Update compliance matrices, SSPs, and assessment documentation; (6) Establish triggers for SSP updates including significant system changes, security incidents, assessment findings, and organizational changes; (7) Implement version control for SSP documents to track update history. No separate implementation is required - all SSP update requirements are now addressed through PL-2.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-3: WITHDRAWN CONTROL NOTICE\n# This control has been incorporated into PL-2 in NIST SP 800-53 Rev 5\n\necho \"============================================================\"\necho \"NOTICE: PL-3 System Security Plan Update - WITHDRAWN\"\necho \"============================================================\"\necho \"\"\necho \"This control has been withdrawn in NIST SP 800-53 Revision 5\"\necho \"and incorporated into control PL-2 (System Security and\"\necho \"Privacy Plans), specifically section (d).\"\necho \"\"\necho \"PL-2(d) requires organizations to:\"\necho \"  'Update the plans to address changes to the system and\"\necho \"   environment of operation or problems identified during\"\necho \"   plan implementation or control assessments.'\"\necho \"\"\necho \"ACTION REQUIRED:\"\necho \"  - Update compliance documentation to reference PL-2(d)\"\necho \"  - Migrate any PL-3 evidence to PL-2 control folder\"\necho \"  - Update POA&M items referencing PL-3\"\necho \"  - Ensure SSP update procedures are documented under PL-2\"\necho \"\"\necho \"Reference: NIST SP 800-53 Rev 5, Appendix F\"\necho \"============================================================\"",
        "ansible": "---\n# PL-3: Withdrawn Control Notice\n- name: PL-3 Withdrawn Control Notification\n  hosts: localhost\n  gather_facts: no\n  tasks:\n    - name: Display withdrawn control notice\n      debug:\n        msg:\n          - \"NOTICE: PL-3 System Security Plan Update has been WITHDRAWN\"\n          - \"Incorporated into PL-2 section (d) in NIST SP 800-53 Rev 5\"\n          - \"ACTION: Update compliance documentation to reference PL-2(d)\"\n          - \"ACTION: Ensure SSP update procedures address PL-2(d) requirements\"\n          - \"ACTION: Migrate evidence artifacts to PL-2 control folder\""
      },
      "windows": {
        "powershell": "# PL-3: WITHDRAWN CONTROL NOTICE\n# This control has been incorporated into PL-2 in NIST SP 800-53 Rev 5\n\nWrite-Host \"============================================================\" -ForegroundColor Yellow\nWrite-Host \"NOTICE: PL-3 System Security Plan Update - WITHDRAWN\" -ForegroundColor Yellow\nWrite-Host \"============================================================\" -ForegroundColor Yellow\nWrite-Host \"\"\nWrite-Host \"This control has been withdrawn in NIST SP 800-53 Revision 5\"\nWrite-Host \"and incorporated into control PL-2, specifically section (d).\"\nWrite-Host \"\"\nWrite-Host \"PL-2(d) requires organizations to:\" -ForegroundColor Cyan\nWrite-Host \"  'Update the plans to address changes to the system and\"\nWrite-Host \"   environment of operation or problems identified during\"\nWrite-Host \"   plan implementation or control assessments.'\"\nWrite-Host \"\"\nWrite-Host \"ACTION REQUIRED:\" -ForegroundColor Cyan\nWrite-Host \"  - Update compliance documentation to reference PL-2(d)\"\nWrite-Host \"  - Migrate any PL-3 evidence to PL-2 control folder\"\nWrite-Host \"  - Update POA&M items referencing PL-3\"\nWrite-Host \"  - Ensure SSP update procedures are documented under PL-2\"\nWrite-Host \"\"\nWrite-Host \"Reference: NIST SP 800-53 Rev 5, Appendix F\"\nWrite-Host \"============================================================\" -ForegroundColor Yellow",
        "ansible": "---\n# PL-3: Withdrawn Control Notice for Windows\n- name: PL-3 Withdrawn Control Notification\n  hosts: windows\n  gather_facts: no\n  tasks:\n    - name: Display withdrawn control notice\n      win_shell: |\n        Write-Host 'NOTICE: PL-3 System Security Plan Update - WITHDRAWN'\n        Write-Host 'Incorporated into PL-2(d) in NIST SP 800-53 Rev 5'"
      }
    },
    "stig_id": "",
    "related_controls": [
      "PL-2"
    ],
    "withdrawn": true,
    "withdrawn_incorporated_into": "PL-2",
    "enhancements": [],
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false,
      "implementation_type": "withdrawn"
    }
  },
  {
    "control_id": "PL-4",
    "control_name": "Rules of Behavior",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "a. Establish and provide to individuals requiring access to the system, the rules that describe their responsibilities and expected behavior for information and system usage, security, and privacy;\nb. Receive a documented acknowledgment from such individuals, indicating that they have read, understand, and agree to abide by the rules of behavior, before authorizing access to information and the system;\nc. Review and update the rules of behavior [Assignment: organization-defined frequency]; and\nd. Require individuals who have acknowledged a previous version of the rules of behavior to read and re-acknowledge [Selection (one or more): [Assignment: organization-defined frequency]; when the rules are revised or updated].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "This control ensures that all users understand their security and privacy responsibilities before accessing organizational systems. Rules of behavior establish expectations and create accountability for user actions.",
    "rationale": "Users are often the weakest link in security. Clear rules of behavior educate users about acceptable use, security expectations, and consequences of violations. Documented acknowledgment creates accountability and supports enforcement actions when violations occur.",
    "plain_english_explanation": "Before anyone can use your systems, they need to read and sign off on the rules for how they should behave. These rules cover things like acceptable use of systems, password requirements, data handling expectations, social media restrictions, and what happens if they break the rules. Users must acknowledge they understand the rules before getting access, and they need to re-acknowledge whenever the rules change. Think of it like the terms and conditions you accept when using software, but specific to your organization's security requirements.",
    "ai_guidance": "Rules of Behavior (RoB) implementation requires a comprehensive approach covering policy development, acknowledgment tracking, and ongoing management. Implementation guidance: (1) Develop RoB documents that address key areas including acceptable use of systems, data handling and classification, password and authentication requirements, mobile device usage, remote access expectations, social media and external communications, incident reporting obligations, and consequences for violations; (2) Use clear, non-technical language that all users can understand regardless of technical background; (3) Implement electronic acknowledgment through HR onboarding systems, identity management systems, or dedicated compliance platforms; (4) Maintain a tracking system that records user name, date of acknowledgment, version acknowledged, and method of acknowledgment; (5) Integrate RoB acknowledgment into access provisioning workflows to ensure no access is granted without acknowledgment; (6) Establish annual review cycles with triggers for ad-hoc updates following significant policy changes or incidents; (7) Implement version control for RoB documents; (8) Create a re-acknowledgment process for updated rules that notifies users of changes and tracks new acknowledgments; (9) Consider role-based RoB addendums for privileged users, system administrators, or users with access to sensitive data; (10) Integrate with security awareness training to reinforce RoB requirements.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-4: Rules of Behavior Acknowledgment Tracking\n# Script to manage and track user acknowledgment of Rules of Behavior\n\nROB_DIR=\"/etc/security/rules_of_behavior\"\nACK_DIR=\"$ROB_DIR/acknowledgments\"\nLOG_FILE=\"/var/log/security/pl4_rob_compliance.log\"\n\nlog_message() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"\n}\n\n# Create directory structure\nmkdir -p \"$ROB_DIR\"/{current,archive,acknowledgments,templates}\nmkdir -p \"$(dirname $LOG_FILE)\"\n\nlog_message \"PL-4 Rules of Behavior Management System Initialized\"\n\n# Create Rules of Behavior template\ncat > \"$ROB_DIR/templates/rules_of_behavior_template.txt\" << 'EOF'\n================================================================================\nORGANIZATION NAME\nRULES OF BEHAVIOR FOR INFORMATION SYSTEM ACCESS\nVersion: [VERSION]\nEffective Date: [DATE]\n================================================================================\n\n1. PURPOSE\nThese Rules of Behavior establish the security and privacy responsibilities\nfor all individuals who access organizational information systems.\n\n2. SCOPE\nThese rules apply to all employees, contractors, and third-party users who\naccess organizational information systems.\n\n3. ACCEPTABLE USE\n- Use systems only for authorized business purposes\n- Protect login credentials and never share passwords\n- Lock workstations when unattended\n- Report security incidents immediately\n- Follow data classification and handling procedures\n\n4. PROHIBITED ACTIVITIES\n- Unauthorized access attempts to systems or data\n- Installing unauthorized software\n- Circumventing security controls\n- Sharing sensitive information without authorization\n- Using systems for personal gain or illegal activities\n\n5. DATA HANDLING\n- Handle sensitive data according to classification level\n- Encrypt sensitive data in transit and at rest\n- Do not store sensitive data on unauthorized devices\n- Properly dispose of sensitive information\n\n6. PASSWORD AND AUTHENTICATION\n- Use strong passwords meeting complexity requirements\n- Change passwords as required by policy\n- Use multi-factor authentication where required\n- Never share authentication credentials\n\n7. MOBILE AND REMOTE ACCESS\n- Use only approved devices for remote access\n- Secure mobile devices with encryption and PIN/password\n- Connect through approved VPN for remote work\n- Report lost or stolen devices immediately\n\n8. SOCIAL MEDIA AND EXTERNAL COMMUNICATIONS\n- Do not disclose sensitive information on social media\n- Follow organizational social media policy\n- Do not use organizational email for personal matters\n- Be cautious of phishing and social engineering\n\n9. INCIDENT REPORTING\n- Report all security incidents to the Security Operations Center\n- Report suspected phishing attempts\n- Report lost or stolen devices\n- Report unauthorized access or policy violations\n\n10. CONSEQUENCES OF NON-COMPLIANCE\nViolations may result in:\n- Loss of system access\n- Disciplinary action up to and including termination\n- Civil or criminal penalties for illegal activities\n\n================================================================================\nACKNOWLEDGMENT\n================================================================================\nI have read, understand, and agree to comply with these Rules of Behavior.\nI understand that violations may result in disciplinary action.\n\nPrinted Name: ___________________________\n\nSignature: ___________________________\n\nDate: ___________________________\n\nEmployee ID: ___________________________\n================================================================================\nEOF\n\nlog_message \"Rules of Behavior template created at $ROB_DIR/templates/\"\n\n# Function to check user acknowledgment status\ncheck_acknowledgment_status() {\n    log_message \"Checking Rules of Behavior acknowledgment status...\"\n    \n    # Get current RoB version\n    CURRENT_VERSION=\"1.0\"\n    if [ -f \"$ROB_DIR/current/version.txt\" ]; then\n        CURRENT_VERSION=$(cat \"$ROB_DIR/current/version.txt\")\n    fi\n    \n    # Get list of active users\n    ACTIVE_USERS=$(getent passwd | awk -F: '$3 >= 1000 && $3 < 65534 {print $1}')\n    \n    echo \"Current RoB Version: $CURRENT_VERSION\"\n    echo \"====================================\"\n    echo \"User Acknowledgment Status:\"\n    echo \"====================================\"\n    \n    for user in $ACTIVE_USERS; do\n        ACK_FILE=\"$ACK_DIR/${user}_acknowledgment.txt\"\n        if [ -f \"$ACK_FILE\" ]; then\n            ACK_VERSION=$(grep \"Version:\" \"$ACK_FILE\" | awk '{print $2}')\n            ACK_DATE=$(grep \"Date:\" \"$ACK_FILE\" | awk '{print $2}')\n            if [ \"$ACK_VERSION\" == \"$CURRENT_VERSION\" ]; then\n                echo \"[COMPLIANT] $user - Acknowledged v$ACK_VERSION on $ACK_DATE\"\n            else\n                echo \"[RE-ACK REQUIRED] $user - Has v$ACK_VERSION, current is v$CURRENT_VERSION\"\n            fi\n        else\n            echo \"[NOT ACKNOWLEDGED] $user - No acknowledgment on file\"\n        fi\n    done\n}\n\n# Function to record acknowledgment\nrecord_acknowledgment() {\n    USERNAME=$1\n    VERSION=$2\n    \n    if [ -z \"$USERNAME\" ] || [ -z \"$VERSION\" ]; then\n        echo \"Usage: record_acknowledgment <username> <version>\"\n        return 1\n    fi\n    \n    ACK_FILE=\"$ACK_DIR/${USERNAME}_acknowledgment.txt\"\n    cat > \"$ACK_FILE\" << EOF\nRules of Behavior Acknowledgment Record\n========================================\nUsername: $USERNAME\nVersion: $VERSION\nDate: $(date '+%Y-%m-%d')\nTime: $(date '+%H:%M:%S')\nRecorded By: $(whoami)\nMethod: Electronic\n========================================\nEOF\n    \n    log_message \"Recorded RoB acknowledgment for user: $USERNAME, version: $VERSION\"\n    chmod 440 \"$ACK_FILE\"\n}\n\n# Generate compliance report\ngenerate_compliance_report() {\n    REPORT_FILE=\"$ROB_DIR/reports/compliance_report_$(date '+%Y%m%d').txt\"\n    mkdir -p \"$ROB_DIR/reports\"\n    \n    echo \"Rules of Behavior Compliance Report\" > \"$REPORT_FILE\"\n    echo \"Generated: $(date)\" >> \"$REPORT_FILE\"\n    echo \"\" >> \"$REPORT_FILE\"\n    check_acknowledgment_status >> \"$REPORT_FILE\"\n    \n    log_message \"Compliance report generated: $REPORT_FILE\"\n}\n\nlog_message \"PL-4 System ready. Functions available: check_acknowledgment_status, record_acknowledgment, generate_compliance_report\"",
        "ansible": "---\n# PL-4: Rules of Behavior Management\n- name: PL-4 Rules of Behavior Compliance\n  hosts: all\n  become: yes\n  vars:\n    rob_base_dir: /etc/security/rules_of_behavior\n    rob_version: \"1.0\"\n    rob_effective_date: \"2025-01-01\"\n    review_frequency_days: 365\n    compliance_report_dir: /var/log/security/rob_compliance\n\n  tasks:\n    - name: Create Rules of Behavior directory structure\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0755'\n        owner: root\n        group: security\n      loop:\n        - \"{{ rob_base_dir }}/current\"\n        - \"{{ rob_base_dir }}/archive\"\n        - \"{{ rob_base_dir }}/acknowledgments\"\n        - \"{{ rob_base_dir }}/templates\"\n        - \"{{ rob_base_dir }}/reports\"\n        - \"{{ compliance_report_dir }}\"\n\n    - name: Deploy Rules of Behavior document\n      template:\n        src: rules_of_behavior.j2\n        dest: \"{{ rob_base_dir }}/current/rules_of_behavior_v{{ rob_version }}.txt\"\n        mode: '0644'\n\n    - name: Record current version\n      copy:\n        content: \"{{ rob_version }}\"\n        dest: \"{{ rob_base_dir }}/current/version.txt\"\n        mode: '0644'\n\n    - name: Create login banner referencing RoB\n      copy:\n        dest: /etc/issue.net\n        mode: '0644'\n        content: |\n          *******************************************************************************\n          WARNING: This system is for authorized users only.\n          \n          By accessing this system, you acknowledge that you have read and agree to\n          the organization's Rules of Behavior. Unauthorized access is prohibited\n          and may result in disciplinary action and/or criminal prosecution.\n          \n          All activities are monitored and logged.\n          *******************************************************************************\n\n    - name: Get list of human users\n      shell: getent passwd | awk -F: '$3 >= 1000 && $3 < 65534 {print $1}'\n      register: human_users\n      changed_when: false\n\n    - name: Check acknowledgment files\n      stat:\n        path: \"{{ rob_base_dir }}/acknowledgments/{{ item }}_acknowledgment.txt\"\n      register: ack_status\n      loop: \"{{ human_users.stdout_lines }}\"\n      when: human_users.stdout_lines | length > 0\n\n    - name: Generate compliance summary\n      copy:\n        dest: \"{{ compliance_report_dir }}/rob_status_{{ ansible_date_time.date }}.txt\"\n        mode: '0640'\n        content: |\n          Rules of Behavior Compliance Status\n          Generated: {{ ansible_date_time.iso8601 }}\n          Current Version: {{ rob_version }}\n          \n          Users Requiring Acknowledgment:\n          {% for user in human_users.stdout_lines %}\n          - {{ user }}\n          {% endfor %}"
      },
      "windows": {
        "powershell": "# PL-4: Rules of Behavior Management and Tracking\n# PowerShell script for managing Rules of Behavior acknowledgments\n\n$RoBDir = \"C:\\SecurityDocs\\RulesOfBehavior\"\n$LogFile = \"C:\\SecurityLogs\\PL4_RoB_Compliance.log\"\n$CurrentVersion = \"1.0\"\n\nfunction Write-RoBLog {\n    param([string]$Message, [string]$Level = \"INFO\")\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logEntry = \"[$timestamp] [$Level] $Message\"\n    Add-Content -Path $LogFile -Value $logEntry\n    Write-Host $logEntry\n}\n\n# Create directory structure\n$directories = @(\n    \"$RoBDir\\Current\",\n    \"$RoBDir\\Archive\",\n    \"$RoBDir\\Acknowledgments\",\n    \"$RoBDir\\Templates\",\n    \"$RoBDir\\Reports\",\n    (Split-Path $LogFile -Parent)\n)\n\nforeach ($dir in $directories) {\n    if (!(Test-Path $dir)) {\n        New-Item -ItemType Directory -Path $dir -Force | Out-Null\n    }\n}\n\nWrite-RoBLog \"PL-4 Rules of Behavior Management System Initialized\"\n\n# Create Rules of Behavior template\n$robTemplate = @\"\n================================================================================\n[ORGANIZATION NAME]\nRULES OF BEHAVIOR FOR INFORMATION SYSTEM ACCESS\nVersion: $CurrentVersion\nEffective Date: $(Get-Date -Format 'yyyy-MM-dd')\n================================================================================\n\n1. PURPOSE\nThese Rules of Behavior establish the security and privacy responsibilities\nfor all individuals who access organizational information systems.\n\n2. SCOPE\nThese rules apply to all employees, contractors, and third-party users.\n\n3. ACCEPTABLE USE\n- Use systems only for authorized business purposes\n- Protect login credentials and never share passwords\n- Lock workstations when unattended (Windows+L)\n- Report security incidents to the helpdesk immediately\n- Follow data classification and handling procedures\n- Use only approved software applications\n\n4. PROHIBITED ACTIVITIES\n- Attempting unauthorized access to systems or data\n- Installing unauthorized or unlicensed software\n- Circumventing or disabling security controls\n- Sharing sensitive information without authorization\n- Using systems for personal gain or illegal activities\n- Connecting unauthorized devices to the network\n- Storing organizational data on personal devices/cloud services\n\n5. DATA HANDLING REQUIREMENTS\n- Handle sensitive data according to its classification level\n- Encrypt sensitive data when transmitting externally\n- Do not store sensitive data on removable media without encryption\n- Properly dispose of sensitive information using approved methods\n- Do not email sensitive data without encryption\n\n6. PASSWORD AND AUTHENTICATION REQUIREMENTS\n- Use strong passwords (minimum 14 characters with complexity)\n- Change passwords every 90 days or when compromised\n- Use multi-factor authentication where required\n- Never share or write down passwords\n- Use unique passwords for each system\n\n7. MOBILE AND REMOTE ACCESS\n- Use only approved devices for organizational access\n- Secure mobile devices with encryption and strong PIN/password\n- Connect through approved VPN for all remote work\n- Do not use public WiFi without VPN protection\n- Report lost or stolen devices within 1 hour\n\n8. SOCIAL MEDIA AND EXTERNAL COMMUNICATIONS\n- Do not disclose organizational information on social media\n- Do not identify organizational affiliation in controversial posts\n- Use organizational email only for business purposes\n- Be vigilant against phishing and social engineering\n- Verify unexpected requests through alternate channels\n\n9. INCIDENT REPORTING REQUIREMENTS\n- Report all security incidents to the Security Operations Center\n- Report suspected phishing attempts immediately\n- Report lost or stolen devices within 1 hour\n- Report unauthorized access or policy violations\n- Report any suspicious system behavior\n\n10. CONSEQUENCES OF NON-COMPLIANCE\nViolations of these Rules of Behavior may result in:\n- Immediate suspension of system access\n- Formal disciplinary action\n- Termination of employment or contract\n- Civil liability for damages\n- Criminal prosecution for illegal activities\n\n================================================================================\nACKNOWLEDGMENT STATEMENT\n================================================================================\n\nI have read and understand these Rules of Behavior. I agree to comply with\nall requirements and understand that violations may result in disciplinary\naction up to and including termination and/or criminal prosecution.\n\nPrinted Name: _________________________________\n\nSignature: _________________________________\n\nDate: _________________________________\n\nEmployee/Contractor ID: _________________________________\n\nDepartment: _________________________________\n\nSupervisor Name: _________________________________\n\n================================================================================\n\"@\n\n$robTemplate | Out-File \"$RoBDir\\Templates\\Rules_of_Behavior_Template.txt\" -Encoding UTF8\n$CurrentVersion | Out-File \"$RoBDir\\Current\\version.txt\" -Encoding UTF8\nWrite-RoBLog \"Rules of Behavior template created\"\n\n# Function to check acknowledgment status for all users\nfunction Get-RoBComplianceStatus {\n    Write-RoBLog \"Checking Rules of Behavior acknowledgment status...\"\n    \n    # Get domain users (adjust query as needed for your environment)\n    try {\n        $users = Get-ADUser -Filter {Enabled -eq $true} -Properties SamAccountName, DisplayName, Department | \n                 Select-Object SamAccountName, DisplayName, Department\n    } catch {\n        # Fallback for non-domain environments\n        $users = Get-LocalUser | Where-Object { $_.Enabled } | \n                 Select-Object @{N='SamAccountName';E={$_.Name}}, @{N='DisplayName';E={$_.FullName}}, @{N='Department';E={'Local'}}\n    }\n    \n    $compliance = @()\n    \n    foreach ($user in $users) {\n        $ackFile = \"$RoBDir\\Acknowledgments\\$($user.SamAccountName)_acknowledgment.json\"\n        \n        $status = @{\n            Username = $user.SamAccountName\n            DisplayName = $user.DisplayName\n            Department = $user.Department\n            AcknowledgmentFile = $ackFile\n            Compliant = $false\n            AcknowledgedVersion = \"N/A\"\n            AcknowledgmentDate = \"N/A\"\n            RequiresReAck = $true\n        }\n        \n        if (Test-Path $ackFile) {\n            $ack = Get-Content $ackFile | ConvertFrom-Json\n            $status.AcknowledgedVersion = $ack.Version\n            $status.AcknowledgmentDate = $ack.Date\n            \n            if ($ack.Version -eq $CurrentVersion) {\n                $status.Compliant = $true\n                $status.RequiresReAck = $false\n            }\n        }\n        \n        $compliance += [PSCustomObject]$status\n    }\n    \n    return $compliance\n}\n\n# Function to record acknowledgment\nfunction Set-RoBUserAcknowledgment {\n    param(\n        [Parameter(Mandatory=$true)]\n        [string]$Username,\n        \n        [string]$Version = $CurrentVersion,\n        \n        [string]$Method = \"Electronic\"\n    )\n    \n    $ackFile = \"$RoBDir\\Acknowledgments\\${Username}_acknowledgment.json\"\n    \n    $acknowledgment = @{\n        Username = $Username\n        Version = $Version\n        Date = Get-Date -Format \"yyyy-MM-dd\"\n        Time = Get-Date -Format \"HH:mm:ss\"\n        Method = $Method\n        RecordedBy = $env:USERNAME\n        ComputerName = $env:COMPUTERNAME\n    }\n    \n    $acknowledgment | ConvertTo-Json | Out-File $ackFile -Encoding UTF8\n    \n    Write-RoBLog \"Recorded RoB acknowledgment for user: $Username, version: $Version\"\n    return $acknowledgment\n}\n\n# Function to generate compliance report\nfunction New-RoBComplianceReport {\n    $reportDate = Get-Date -Format \"yyyyMMdd\"\n    $reportFile = \"$RoBDir\\Reports\\RoB_Compliance_Report_$reportDate.html\"\n    \n    $compliance = Get-RoBComplianceStatus\n    \n    $compliantCount = ($compliance | Where-Object { $_.Compliant }).Count\n    $nonCompliantCount = ($compliance | Where-Object { -not $_.Compliant }).Count\n    $totalUsers = $compliance.Count\n    $complianceRate = if ($totalUsers -gt 0) { [math]::Round(($compliantCount / $totalUsers) * 100, 2) } else { 0 }\n    \n    $html = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Rules of Behavior Compliance Report</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        h1 { color: #333; }\n        .summary { background-color: #f5f5f5; padding: 15px; border-radius: 5px; margin-bottom: 20px; }\n        .compliant { color: green; }\n        .non-compliant { color: red; }\n        table { border-collapse: collapse; width: 100%; }\n        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n        th { background-color: #4472C4; color: white; }\n        tr:nth-child(even) { background-color: #f2f2f2; }\n    </style>\n</head>\n<body>\n    <h1>Rules of Behavior Compliance Report</h1>\n    <div class=\"summary\">\n        <p><strong>Report Generated:</strong> $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')</p>\n        <p><strong>Current RoB Version:</strong> $CurrentVersion</p>\n        <p><strong>Total Users:</strong> $totalUsers</p>\n        <p class=\"compliant\"><strong>Compliant Users:</strong> $compliantCount</p>\n        <p class=\"non-compliant\"><strong>Non-Compliant Users:</strong> $nonCompliantCount</p>\n        <p><strong>Compliance Rate:</strong> $complianceRate%</p>\n    </div>\n    <h2>User Compliance Details</h2>\n    <table>\n        <tr>\n            <th>Username</th>\n            <th>Display Name</th>\n            <th>Department</th>\n            <th>Status</th>\n            <th>Acknowledged Version</th>\n            <th>Acknowledgment Date</th>\n        </tr>\n\"@\n\n    foreach ($user in ($compliance | Sort-Object -Property Compliant)) {\n        $statusClass = if ($user.Compliant) { \"compliant\" } else { \"non-compliant\" }\n        $statusText = if ($user.Compliant) { \"COMPLIANT\" } else { \"ACTION REQUIRED\" }\n        \n        $html += @\"\n        <tr>\n            <td>$($user.Username)</td>\n            <td>$($user.DisplayName)</td>\n            <td>$($user.Department)</td>\n            <td class=\"$statusClass\">$statusText</td>\n            <td>$($user.AcknowledgedVersion)</td>\n            <td>$($user.AcknowledgmentDate)</td>\n        </tr>\n\"@\n    }\n\n    $html += @\"\n    </table>\n</body>\n</html>\n\"@\n\n    $html | Out-File $reportFile -Encoding UTF8\n    \n    # Also create JSON summary\n    $summary = @{\n        ReportDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n        CurrentVersion = $CurrentVersion\n        TotalUsers = $totalUsers\n        CompliantUsers = $compliantCount\n        NonCompliantUsers = $nonCompliantCount\n        ComplianceRate = $complianceRate\n    }\n    \n    $summary | ConvertTo-Json | Out-File \"$RoBDir\\Reports\\compliance_summary_$reportDate.json\" -Encoding UTF8\n    \n    Write-RoBLog \"Compliance report generated: $reportFile\"\n    return $reportFile\n}\n\nWrite-RoBLog \"PL-4 System ready. Available functions: Get-RoBComplianceStatus, Set-RoBUserAcknowledgment, New-RoBComplianceReport\"",
        "ansible": "---\n# PL-4: Windows Rules of Behavior Management\n- name: PL-4 Windows Rules of Behavior Compliance\n  hosts: windows\n  vars:\n    rob_base_dir: C:\\SecurityDocs\\RulesOfBehavior\n    rob_version: \"1.0\"\n\n  tasks:\n    - name: Create Rules of Behavior directories\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ rob_base_dir }}\\\\Current\"\n        - \"{{ rob_base_dir }}\\\\Archive\"\n        - \"{{ rob_base_dir }}\\\\Acknowledgments\"\n        - \"{{ rob_base_dir }}\\\\Reports\"\n        - C:\\SecurityLogs\n\n    - name: Deploy current version marker\n      win_copy:\n        content: \"{{ rob_version }}\"\n        dest: \"{{ rob_base_dir }}\\\\Current\\\\version.txt\"\n\n    - name: Configure legal notice (login banner)\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\n        name: legalnoticecaption\n        data: \"Security Notice - Rules of Behavior\"\n        type: string\n\n    - name: Configure legal notice text\n      win_regedit:\n        path: HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\n        name: legalnoticetext\n        data: |\n          AUTHORIZED USE ONLY\n          \n          By logging into this system, you acknowledge that you have read,\n          understand, and agree to comply with the organization's Rules of\n          Behavior. All activities are monitored and logged.\n          \n          Unauthorized use is prohibited and may result in disciplinary\n          action and/or criminal prosecution.\n        type: string\n\n    - name: Generate acknowledgment status report\n      win_shell: |\n        $ackDir = '{{ rob_base_dir }}\\Acknowledgments'\n        $users = Get-ChildItem $ackDir -Filter '*_acknowledgment.json' -ErrorAction SilentlyContinue\n        @{\n          ReportDate = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'\n          AcknowledgmentsFound = $users.Count\n        } | ConvertTo-Json\n      register: ack_status"
      }
    },
    "stig_id": "",
    "related_controls": [
      "AC-2",
      "AT-2",
      "AT-3",
      "PL-4(1)",
      "PS-6",
      "PS-8"
    ],
    "enhancements": [
      {
        "id": "PL-4(1)",
        "title": "Social Media and External Site/Application Usage Restrictions"
      }
    ],
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "implementation_type": "organizational"
    }
  },
  {
    "control_id": "PL-4.1",
    "control_name": "Social Media and External Site/Application Usage Restrictions",
    "family": "Planning",
    "family_id": "PL",
    "parent_control": "PL-4",
    "official_text": "Include in the rules of behavior, restrictions on:\n(a) Use of social media, social networking sites, and external sites/applications;\n(b) Posting organizational information on public websites; and\n(c) Use of organization-provided identifiers (e.g., email addresses) and authentication secrets in external sites/applications.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "This control enhancement ensures that rules of behavior specifically address the risks associated with social media and external site usage, which can lead to information disclosure, reputation damage, and security compromises.",
    "rationale": "Social media and external applications present unique security risks including inadvertent disclosure of sensitive information, social engineering attacks, credential compromise through password reuse, and reputation damage. Explicit restrictions help users understand acceptable boundaries.",
    "plain_english_explanation": "Your rules of behavior document must include specific guidelines about using social media and external websites. This includes rules about what employees can and cannot post about the organization on social media, whether they can use their work email to sign up for external services, and how they should behave on networking sites like LinkedIn. The goal is to prevent accidental information leaks, protect the organization's reputation, and reduce the risk of credential-based attacks.",
    "ai_guidance": "This control enhancement requires organizations to develop comprehensive social media and external site usage policies within their Rules of Behavior. Implementation guidance: (1) Define prohibited social media activities including posting confidential information, discussing ongoing incidents, sharing internal communications, and posting photos of secure areas or sensitive systems; (2) Establish guidelines for professional social media use including LinkedIn profiles, conference presentations, and thought leadership content that requires pre-approval; (3) Prohibit use of organizational email addresses for personal social media accounts and external site registrations; (4) Prohibit password reuse between organizational systems and external sites; (5) Provide guidance on separating personal and professional social media presence; (6) Address use of organizational identifiers and logos in personal social media; (7) Establish approval requirements for official organizational social media accounts; (8) Define consequences for social media policy violations; (9) Include guidance on responding to social media inquiries about the organization; (10) Address security risks of third-party applications that request access to organizational credentials or data; (11) Consider implementing technical controls such as web filtering, DLP for social media, and monitoring of organizational mentions; (12) Provide regular training on social media risks and acceptable use; (13) Establish incident response procedures for social media-related security events or reputation issues.",
    "is_technical": false,
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-4(1): Social Media and External Site Usage Policy Verification\n# Script to manage social media usage restrictions documentation\n\nPOLICY_DIR=\"/etc/security/policies/social_media\"\nLOG_FILE=\"/var/log/security/pl4_1_social_media.log\"\n\nlog_message() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"\n}\n\n# Create directory structure\nmkdir -p \"$POLICY_DIR\"/{policies,training,acknowledgments}\nmkdir -p \"$(dirname $LOG_FILE)\"\n\nlog_message \"PL-4(1) Social Media Policy Management System Initialized\"\n\n# Create Social Media Policy Addendum\ncat > \"$POLICY_DIR/policies/social_media_policy_addendum.txt\" << 'EOF'\n================================================================================\nSOCIAL MEDIA AND EXTERNAL SITE/APPLICATION USAGE POLICY\nAddendum to Rules of Behavior\n================================================================================\n\nThis policy addendum establishes specific requirements for social media,\nnetworking sites, and external application usage by all personnel.\n\n--------------------------------------------------------------------------------\n1. SCOPE\n--------------------------------------------------------------------------------\nThis policy applies to:\n- All employees, contractors, and third-party users\n- Both official organizational accounts and personal accounts\n- Usage during work hours and personal time when referencing the organization\n\n--------------------------------------------------------------------------------\n2. PROHIBITED ACTIVITIES\n--------------------------------------------------------------------------------\nThe following activities are strictly prohibited:\n\na) Information Disclosure:\n   - Posting confidential, sensitive, or proprietary information\n   - Discussing security incidents, vulnerabilities, or investigations\n   - Sharing internal communications, emails, or documents\n   - Posting photos of secure areas, server rooms, or sensitive systems\n   - Disclosing information about security tools or configurations\n\nb) Credential Usage:\n   - Using organizational email for personal social media accounts\n   - Using organizational email to register for external services\n   - Reusing organizational passwords on external sites\n   - Sharing organizational authentication credentials\n\nc) Reputation Risks:\n   - Making statements that could be attributed to the organization\n   - Posting inflammatory or controversial content while identifying as an employee\n   - Responding to media inquiries without authorization\n   - Endorsing products or services on behalf of the organization\n\n--------------------------------------------------------------------------------\n3. ACCEPTABLE USE GUIDELINES\n--------------------------------------------------------------------------------\na) Professional Networking (e.g., LinkedIn):\n   - May list organization name and job title\n   - Must not disclose specific projects, clients, or sensitive work\n   - Must use personal email for account registration\n   - Should review privacy settings to limit information exposure\n\nb) Personal Social Media:\n   - May not indicate organizational affiliation in controversial posts\n   - Must not use organizational logos or branding\n   - Must not discuss work matters or colleagues\n   - Should maintain privacy settings on personal accounts\n\nc) Official Organizational Accounts:\n   - Must be pre-approved by Communications/Marketing\n   - Must follow brand guidelines and messaging approval process\n   - Must use organizational credentials stored in approved password manager\n   - Must have designated backup administrators\n\n--------------------------------------------------------------------------------\n4. EXTERNAL APPLICATIONS AND SERVICES\n--------------------------------------------------------------------------------\na) Cloud Services:\n   - Do not store organizational data in personal cloud accounts\n   - Do not connect organizational accounts to third-party applications\n   - Do not grant external applications access to organizational data\n\nb) Productivity Applications:\n   - Only use approved applications for organizational work\n   - Do not upload organizational documents to unauthorized services\n   - Report any requests for organizational credentials from applications\n\n--------------------------------------------------------------------------------\n5. MONITORING AND ENFORCEMENT\n--------------------------------------------------------------------------------\n- The organization may monitor public social media for mentions\n- Violations may result in disciplinary action up to termination\n- Serious violations may result in legal action\n\n--------------------------------------------------------------------------------\n6. REPORTING REQUIREMENTS\n--------------------------------------------------------------------------------\nReport immediately:\n- Suspected social engineering attempts via social media\n- Requests for organizational information through social channels\n- Compromised social media accounts\n- Unauthorized organizational mentions requiring response\n\nReport to: Security Operations Center / [contact information]\n\n================================================================================\nACKNOWLEDGMENT\n================================================================================\nI have read, understand, and agree to comply with this Social Media and\nExternal Site/Application Usage Policy.\n\nPrinted Name: ___________________________\n\nSignature: ___________________________\n\nDate: ___________________________\n================================================================================\nEOF\n\nlog_message \"Social media policy addendum created at $POLICY_DIR/policies/\"\n\n# Create quick reference guide\ncat > \"$POLICY_DIR/policies/social_media_quick_reference.txt\" << 'EOF'\n================================================================================\nSOCIAL MEDIA QUICK REFERENCE - DO's AND DON'Ts\n================================================================================\n\nDO:\n[+] Use personal email for personal social media accounts\n[+] Keep work and personal social media separate\n[+] Review and tighten privacy settings\n[+] Report suspicious social media contact\n[+] Get approval before creating official accounts\n[+] Use unique passwords for each platform\n\nDON'T:\n[-] Post about work projects, clients, or sensitive information\n[-] Use work email for personal accounts\n[-] Share photos of offices, badges, or secure areas\n[-] Reuse work passwords on external sites\n[-] Connect work accounts to third-party apps\n[-] Respond to media on behalf of the organization\n[-] Discuss security incidents or investigations\n[-] Post organizational documents or communications\n\nWHEN IN DOUBT:\n? Ask your supervisor or the Communications team\n? Contact the Security team for guidance\n? Don't post - when unsure, leave it out\n\nREPORT CONCERNS TO:\n- Security Operations Center: [phone/email]\n- Communications Team: [phone/email]\n================================================================================\nEOF\n\nlog_message \"Quick reference guide created\"\n\nlog_message \"PL-4(1) Social Media Policy documents ready at $POLICY_DIR\"",
        "ansible": "---\n# PL-4(1): Social Media and External Site Usage Policy Management\n- name: PL-4(1) Social Media Policy Compliance\n  hosts: all\n  become: yes\n  vars:\n    social_media_policy_dir: /etc/security/policies/social_media\n    organization_name: \"[Organization Name]\"\n\n  tasks:\n    - name: Create social media policy directory structure\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        mode: '0755'\n      loop:\n        - \"{{ social_media_policy_dir }}/policies\"\n        - \"{{ social_media_policy_dir }}/training\"\n        - \"{{ social_media_policy_dir }}/acknowledgments\"\n        - /var/log/security\n\n    - name: Deploy social media policy quick reference\n      copy:\n        dest: \"{{ social_media_policy_dir }}/policies/quick_reference.txt\"\n        mode: '0644'\n        content: |\n          SOCIAL MEDIA AND EXTERNAL SITE USAGE - QUICK REFERENCE\n          ========================================================\n          \n          PROHIBITED:\n          - Posting confidential/sensitive organizational information\n          - Using work email for personal social media accounts\n          - Reusing work passwords on external sites\n          - Sharing photos of secure areas or systems\n          - Discussing security incidents publicly\n          - Granting external apps access to organizational data\n          \n          REQUIRED:\n          - Use unique passwords for each external site\n          - Get approval for official organizational accounts\n          - Report suspicious social media contacts\n          - Maintain separation of work/personal accounts\n          \n          REPORT CONCERNS TO: Security Operations Center\n\n    - name: Create MOTD reminder about social media policy\n      lineinfile:\n        path: /etc/motd\n        line: \"REMINDER: Social media and external site usage is governed by organizational policy. See /etc/security/policies/social_media for details.\"\n        create: yes"
      },
      "windows": {
        "powershell": "# PL-4(1): Social Media and External Site Usage Policy Management\n# PowerShell script for social media policy documentation and tracking\n\n$PolicyDir = \"C:\\SecurityDocs\\Policies\\SocialMedia\"\n$LogFile = \"C:\\SecurityLogs\\PL4_1_SocialMedia.log\"\n\nfunction Write-PolicyLog {\n    param([string]$Message, [string]$Level = \"INFO\")\n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logEntry = \"[$timestamp] [$Level] $Message\"\n    Add-Content -Path $LogFile -Value $logEntry\n    Write-Host $logEntry\n}\n\n# Create directory structure\n$directories = @(\n    \"$PolicyDir\\Policies\",\n    \"$PolicyDir\\Training\",\n    \"$PolicyDir\\Acknowledgments\",\n    (Split-Path $LogFile -Parent)\n)\n\nforeach ($dir in $directories) {\n    if (!(Test-Path $dir)) {\n        New-Item -ItemType Directory -Path $dir -Force | Out-Null\n    }\n}\n\nWrite-PolicyLog \"PL-4(1) Social Media Policy Management System Initialized\"\n\n# Create comprehensive social media policy\n$socialMediaPolicy = @\"\n================================================================================\nSOCIAL MEDIA AND EXTERNAL SITE/APPLICATION USAGE POLICY\nRules of Behavior Addendum - PL-4(1)\n================================================================================\n\nEffective Date: $(Get-Date -Format 'yyyy-MM-dd')\nVersion: 1.0\n\n--------------------------------------------------------------------------------\nPURPOSE\n--------------------------------------------------------------------------------\nThis policy establishes requirements and restrictions for the use of social\nmedia, external websites, and third-party applications by all personnel.\n\n--------------------------------------------------------------------------------\nSCOPE\n--------------------------------------------------------------------------------\nThis policy applies to:\n- All employees, contractors, and authorized third-party users\n- Official organizational social media accounts\n- Personal accounts when referencing the organization\n- External sites and applications used for work or personal purposes\n\n--------------------------------------------------------------------------------\nSOCIAL MEDIA USAGE RESTRICTIONS\n--------------------------------------------------------------------------------\n\n1. PROHIBITED POSTING CONTENT:\n   - Confidential, sensitive, or proprietary information\n   - Security incidents, vulnerabilities, or investigation details\n   - Internal communications, emails, or documents\n   - Photos of secure areas, data centers, or sensitive equipment\n   - Client or partner information without authorization\n   - Financial information or projections\n   - Personal information about colleagues\n\n2. PROHIBITED ACTIVITIES:\n   - Creating official accounts without Communications approval\n   - Responding to media inquiries on behalf of the organization\n   - Making statements that imply organizational endorsement\n   - Engaging in arguments or controversial discussions while\n     identifying as an organizational representative\n   - Using organizational logos or branding without approval\n\n3. PROFESSIONAL NETWORKING GUIDELINES (e.g., LinkedIn):\n   - May list organization name and general job title\n   - Must not disclose specific projects or clients\n   - Must not share proprietary methodologies or tools\n   - Must use personal email for account registration\n   - Must review and maintain appropriate privacy settings\n\n--------------------------------------------------------------------------------\nEXTERNAL SITE AND APPLICATION RESTRICTIONS\n--------------------------------------------------------------------------------\n\n1. CREDENTIAL USAGE:\n   - NEVER use organizational email addresses for personal accounts\n   - NEVER reuse organizational passwords on external sites\n   - NEVER share authentication secrets with external applications\n   - NEVER store organizational credentials in browser password managers\n     for external sites\n\n2. DATA HANDLING:\n   - Do not store organizational data in personal cloud services\n   - Do not upload organizational documents to unauthorized services\n   - Do not grant external applications access to organizational accounts\n   - Do not connect organizational email to third-party aggregators\n\n3. APPROVED EXCEPTIONS:\n   - Use of organizational identity for authorized industry forums\n   - Conference speaker profiles (with Communications approval)\n   - Authorized partnership or vendor portals\n   - Training platforms approved by IT Security\n\n--------------------------------------------------------------------------------\nOFFICIAL ORGANIZATIONAL ACCOUNTS\n--------------------------------------------------------------------------------\nRequirements for official accounts:\n- Must be approved by Communications/Marketing department\n- Must follow brand guidelines and messaging approval process\n- Must use credentials stored in approved enterprise password manager\n- Must have minimum two administrators with succession planning\n- Must be audited quarterly for access and content compliance\n- Must immediately report any compromise or unauthorized access\n\n--------------------------------------------------------------------------------\nMONITORING AND COMPLIANCE\n--------------------------------------------------------------------------------\n- The organization monitors public mentions and social media presence\n- Web filtering may restrict access to certain external sites\n- Data Loss Prevention tools monitor for sensitive data transmission\n- Violations are subject to investigation and disciplinary action\n\n--------------------------------------------------------------------------------\nREPORTING REQUIREMENTS\n--------------------------------------------------------------------------------\nReport the following to the Security Operations Center immediately:\n- Social engineering attempts via social media\n- Compromised social media accounts (personal or organizational)\n- Unauthorized disclosure of organizational information\n- Suspicious friend/connection requests from unknown parties\n- Requests for organizational information through social channels\n\nSecurity Operations Center: [Contact Information]\nCommunications Team: [Contact Information]\n\n--------------------------------------------------------------------------------\nCONSEQUENCES OF VIOLATION\n--------------------------------------------------------------------------------\nViolations of this policy may result in:\n- Formal counseling and documented warning\n- Suspension of network and system access\n- Disciplinary action up to and including termination\n- Civil liability for damages caused by disclosure\n- Criminal prosecution for willful misconduct\n\n================================================================================\nACKNOWLEDGMENT\n================================================================================\n\nI have read, understand, and agree to comply with this Social Media and\nExternal Site/Application Usage Policy. I understand that violations may\nresult in disciplinary action and/or legal consequences.\n\nPrinted Name: _________________________________\n\nSignature: _________________________________\n\nDate: _________________________________\n\nEmployee/Contractor ID: _________________________________\n================================================================================\n\"@\n\n$socialMediaPolicy | Out-File \"$PolicyDir\\Policies\\Social_Media_Policy.txt\" -Encoding UTF8\nWrite-PolicyLog \"Social media policy document created\"\n\n# Create quick reference card\n$quickReference = @\"\n================================================================================\nSOCIAL MEDIA QUICK REFERENCE CARD\n================================================================================\n\n+++ ALWAYS +++\n[+] Use personal email for personal social media\n[+] Use unique passwords for each external site\n[+] Get approval before creating official accounts\n[+] Report suspicious social media contact immediately\n[+] Keep work and personal accounts separate\n[+] Review and update privacy settings regularly\n\n--- NEVER ---\n[-] Post confidential or sensitive information\n[-] Use work email for personal accounts\n[-] Reuse work passwords on external sites\n[-] Share photos of secure areas or systems\n[-] Discuss security incidents or investigations\n[-] Grant external apps access to work accounts\n[-] Speak to media without authorization\n\n??? WHEN IN DOUBT ???\n? Don't post - when unsure, leave it out\n? Ask Communications team for guidance\n? Contact Security team for clarification\n\nREPORT TO:\nSecurity Operations: [phone/email]\nCommunications: [phone/email]\n================================================================================\n\"@\n\n$quickReference | Out-File \"$PolicyDir\\Policies\\Quick_Reference.txt\" -Encoding UTF8\nWrite-PolicyLog \"Quick reference card created\"\n\n# Create training topics list\n$trainingTopics = @\"\nSOCIAL MEDIA SECURITY AWARENESS TRAINING TOPICS\n===============================================\n\n1. Social Engineering Through Social Media\n   - Recognizing phishing via social platforms\n   - Identifying fake profiles and impersonation\n   - Understanding information gathering techniques\n\n2. Protecting Organizational Information\n   - What constitutes sensitive information\n   - OPSEC principles for social media\n   - Metadata and location service risks\n\n3. Personal vs. Professional Boundaries\n   - Separating work and personal presence\n   - Privacy settings and their limitations\n   - Reputation management\n\n4. Credential Security\n   - Password hygiene for external sites\n   - Risks of password reuse\n   - Multi-factor authentication importance\n\n5. Third-Party Application Risks\n   - OAuth and permission grants\n   - Data sharing with external apps\n   - Revoking unnecessary access\n\n6. Incident Reporting\n   - When and how to report concerns\n   - Responding to suspected compromise\n   - Escalation procedures\n\n===============================================\n\"@\n\n$trainingTopics | Out-File \"$PolicyDir\\Training\\Training_Topics.txt\" -Encoding UTF8\nWrite-PolicyLog \"Training topics document created\"\n\nWrite-PolicyLog \"PL-4(1) Social Media Policy documents ready at $PolicyDir\"",
        "ansible": "---\n# PL-4(1): Windows Social Media Policy Management\n- name: PL-4(1) Windows Social Media Policy Compliance\n  hosts: windows\n  vars:\n    policy_dir: C:\\SecurityDocs\\Policies\\SocialMedia\n\n  tasks:\n    - name: Create social media policy directories\n      win_file:\n        path: \"{{ item }}\"\n        state: directory\n      loop:\n        - \"{{ policy_dir }}\\\\Policies\"\n        - \"{{ policy_dir }}\\\\Training\"\n        - \"{{ policy_dir }}\\\\Acknowledgments\"\n        - C:\\SecurityLogs\n\n    - name: Deploy social media quick reference\n      win_copy:\n        dest: \"{{ policy_dir }}\\\\Policies\\\\Quick_Reference.txt\"\n        content: |\n          SOCIAL MEDIA QUICK REFERENCE\n          ============================\n          \n          ALWAYS:\n          + Use personal email for personal accounts\n          + Use unique passwords for each site\n          + Report suspicious contacts\n          \n          NEVER:\n          - Post confidential information\n          - Use work email for personal sites\n          - Reuse work passwords externally\n          - Share photos of secure areas\n          \n          REPORT TO: Security Operations Center"
      }
    },
    "stig_id": "",
    "related_controls": [
      "AC-22",
      "AT-2",
      "AT-3",
      "PL-4",
      "PS-6",
      "PS-8",
      "SC-7"
    ],
    "enhancements": [],
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "implementation_type": "organizational"
    }
  },
  {
    "control_id": "PL-5",
    "control_name": "Privacy Impact Assessment",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "[WITHDRAWN: Incorporated into RA-8]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control was withdrawn in NIST SP 800-53 Rev 5 and its requirements have been incorporated into RA-8 (Privacy Impact Assessment). Organizations should reference RA-8 for privacy impact assessment requirements.",
    "rationale": "NIST consolidated privacy impact assessment requirements into the Risk Assessment (RA) family to better align privacy activities with risk management processes. This reorganization reflects the integral relationship between privacy risk assessment and overall organizational risk management.",
    "plain_english_explanation": "PL-5 Privacy Impact Assessment has been WITHDRAWN in NIST SP 800-53 Revision 5. The privacy impact assessment requirements that were previously in this control have been moved to RA-8. If your organization needs to conduct privacy impact assessments, you should now reference and implement RA-8 instead of PL-5. This change was made to consolidate all risk assessment activities under a single control family.",
    "ai_guidance": "IMPORTANT: PL-5 (Privacy Impact Assessment) has been WITHDRAWN in NIST SP 800-53 Revision 5. All privacy impact assessment requirements have been incorporated into RA-8 (Privacy Impact Assessment) in the Risk Assessment family. Organizations should NOT implement PL-5 for new systems or assessments. Instead, reference RA-8 which provides comprehensive guidance on conducting privacy impact assessments that: (1) Analyze privacy risks associated with information systems and personally identifiable information (PII); (2) Assess the effectiveness of privacy controls; (3) Document privacy risks and mitigations; (4) Update assessments when significant changes occur. For legacy systems that reference PL-5 in their security documentation, update the System Security Plan (SSP) to reference RA-8. When preparing for audits or assessments, note that auditors should accept RA-8 compliance as meeting former PL-5 requirements. This withdrawal was part of NIST's effort to streamline the control catalog and reduce duplication between families.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "RA-8",
      "PT-1",
      "PT-2",
      "PT-3"
    ],
    "supplemental_guidance": "This control was withdrawn and incorporated into RA-8.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-5: Privacy Impact Assessment\n# STATUS: WITHDRAWN in NIST SP 800-53 Rev 5\n# INCORPORATED INTO: RA-8\n\necho \"============================================\"\necho \"PL-5 WITHDRAWN NOTICE\"\necho \"============================================\"\necho \"\"\necho \"PL-5 (Privacy Impact Assessment) has been WITHDRAWN\"\necho \"in NIST SP 800-53 Revision 5.\"\necho \"\"\necho \"Requirements have been incorporated into:\"\necho \"  -> RA-8 (Privacy Impact Assessment)\"\necho \"\"\necho \"Please reference RA-8 for all privacy impact\"\necho \"assessment requirements.\"\necho \"\"\necho \"============================================\"\n\n# Create withdrawal documentation\nOUTPUT_DIR=\"/var/lib/compliance/pl-5-withdrawn\"\nmkdir -p \"${OUTPUT_DIR}\"\n\ncat > \"${OUTPUT_DIR}/pl5_withdrawal_notice.md\" << 'EOF'\n# PL-5 Withdrawal Notice\n\n## Status: WITHDRAWN\n\nPL-5 (Privacy Impact Assessment) has been **withdrawn** in NIST SP 800-53 Revision 5.\n\n## Migration Path\n\nAll privacy impact assessment requirements have been incorporated into:\n\n- **RA-8**: Privacy Impact Assessment (Risk Assessment Family)\n\n## Action Required\n\n1. Update System Security Plans (SSP) to reference RA-8 instead of PL-5\n2. Implement privacy impact assessments per RA-8 requirements\n3. For audits referencing PL-5, provide RA-8 compliance evidence\n\n## Related Controls\n\n- RA-8: Privacy Impact Assessment\n- PT-1: Policy and Procedures (Privacy)\n- PT-2: Authority to Process PII\n- PT-3: PII Processing Purposes\nEOF\n\necho \"[INFO] Withdrawal notice created: ${OUTPUT_DIR}/pl5_withdrawal_notice.md\"",
        "ansible": "---\n# PL-5: Privacy Impact Assessment\n# STATUS: WITHDRAWN in NIST SP 800-53 Rev 5\n# INCORPORATED INTO: RA-8\n\n- name: PL-5 Withdrawal Notice\n  hosts: all\n  tasks:\n    - name: Display PL-5 withdrawal notice\n      ansible.builtin.debug:\n        msg: |\n          ============================================\n          PL-5 WITHDRAWN NOTICE\n          ============================================\n          \n          PL-5 (Privacy Impact Assessment) has been WITHDRAWN\n          in NIST SP 800-53 Revision 5.\n          \n          Requirements have been incorporated into:\n            -> RA-8 (Privacy Impact Assessment)\n          \n          Please reference RA-8 for all privacy impact\n          assessment requirements.\n          ============================================\n\n    - name: Create withdrawal documentation directory\n      ansible.builtin.file:\n        path: /var/lib/compliance/pl-5-withdrawn\n        state: directory\n        mode: '0750'\n\n    - name: Create withdrawal notice document\n      ansible.builtin.copy:\n        dest: /var/lib/compliance/pl-5-withdrawn/withdrawal_notice.md\n        mode: '0640'\n        content: |\n          # PL-5 Withdrawal Notice\n          \n          **Status:** WITHDRAWN in NIST SP 800-53 Rev 5\n          **Incorporated Into:** RA-8\n          **Generated:** {{ ansible_date_time.iso8601 }}\n          \n          ## Migration\n          Reference RA-8 for privacy impact assessment requirements."
      },
      "windows": {
        "powershell": "# PL-5: Privacy Impact Assessment\n# STATUS: WITHDRAWN in NIST SP 800-53 Rev 5\n# INCORPORATED INTO: RA-8\n\nWrite-Host \"`n============================================\" -ForegroundColor Yellow\nWrite-Host \"PL-5 WITHDRAWN NOTICE\" -ForegroundColor Yellow\nWrite-Host \"============================================`n\" -ForegroundColor Yellow\n\nWrite-Host \"PL-5 (Privacy Impact Assessment) has been WITHDRAWN\" -ForegroundColor Red\nWrite-Host \"in NIST SP 800-53 Revision 5.\" -ForegroundColor Red\nWrite-Host \"\"\nWrite-Host \"Requirements have been incorporated into:\" -ForegroundColor White\nWrite-Host \"  -> RA-8 (Privacy Impact Assessment)\" -ForegroundColor Green\nWrite-Host \"\"\nWrite-Host \"Please reference RA-8 for all privacy impact\" -ForegroundColor White\nWrite-Host \"assessment requirements.\" -ForegroundColor White\nWrite-Host \"`n============================================`n\" -ForegroundColor Yellow\n\n# Create withdrawal documentation\n$OutputDir = \"C:\\Compliance\\PL-5-Withdrawn\"\nif (-not (Test-Path $OutputDir)) {\n    New-Item -ItemType Directory -Path $OutputDir -Force | Out-Null\n}\n\n@\"\n# PL-5 Withdrawal Notice\n\n**Status:** WITHDRAWN in NIST SP 800-53 Rev 5\n**Incorporated Into:** RA-8\n**Generated:** $(Get-Date -Format 'o')\n\n## Migration Path\nReference RA-8 for privacy impact assessment requirements.\n\"@ | Out-File \"$OutputDir\\withdrawal_notice.md\" -Encoding UTF8\n\nWrite-Host \"[INFO] Withdrawal notice created: $OutputDir\\withdrawal_notice.md\" -ForegroundColor Green",
        "ansible": "---\n# PL-5: Privacy Impact Assessment - Windows\n# STATUS: WITHDRAWN in NIST SP 800-53 Rev 5\n\n- name: PL-5 Withdrawal Notice - Windows\n  hosts: windows\n  tasks:\n    - name: Display withdrawal notice\n      ansible.builtin.debug:\n        msg: \"PL-5 WITHDRAWN - See RA-8 for privacy impact assessment\"\n\n    - name: Create withdrawal documentation\n      ansible.windows.win_file:\n        path: C:\\Compliance\\PL-5-Withdrawn\n        state: directory\n\n    - name: Write withdrawal notice\n      ansible.windows.win_copy:\n        dest: C:\\Compliance\\PL-5-Withdrawn\\withdrawal_notice.md\n        content: |\n          # PL-5 Withdrawal Notice\n          Status: WITHDRAWN - See RA-8"
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false,
      "withdrawal_info": "Incorporated into RA-8 in NIST SP 800-53 Rev 5"
    }
  },
  {
    "control_id": "PL-6",
    "control_name": "Security-related Activity Planning",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "[WITHDRAWN: Incorporated into PL-2]",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control was withdrawn in NIST SP 800-53 Rev 5 and its requirements have been incorporated into PL-2 (System Security and Privacy Plans). Organizations should reference PL-2 for security-related activity planning.",
    "rationale": "NIST consolidated security activity planning requirements into PL-2 to streamline the planning family and reduce duplication. Security-related activity planning is now an integral part of the system security plan development and maintenance process.",
    "plain_english_explanation": "PL-6 Security-related Activity Planning has been WITHDRAWN in NIST SP 800-53 Revision 5. The requirements for planning security-related activities have been incorporated into PL-2 (System Security and Privacy Plans). If your organization needs to plan security assessments, penetration tests, or other security activities that could affect system availability, you should now address this in your PL-2 system security plan.",
    "ai_guidance": "IMPORTANT: PL-6 (Security-related Activity Planning) has been WITHDRAWN in NIST SP 800-53 Revision 5. All security activity planning requirements have been incorporated into PL-2 (System Security and Privacy Plans). Organizations should NOT implement PL-6 as a standalone control. Instead, ensure that PL-2 implementation includes: (1) Planning for security assessments and penetration testing; (2) Coordination of security activities with affected system owners and users; (3) Scheduling activities to minimize operational impact; (4) Communication plans for security activities that may affect system availability. For legacy systems referencing PL-6, update documentation to reference PL-2. The consolidation reflects that security activity planning should be an integral part of the overall system security planning process.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PL-2",
      "CA-2",
      "CA-8",
      "RA-5"
    ],
    "supplemental_guidance": "This control was withdrawn and incorporated into PL-2.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-6: Security-related Activity Planning\n# STATUS: WITHDRAWN in NIST SP 800-53 Rev 5\n# INCORPORATED INTO: PL-2\n\necho \"============================================\"\necho \"PL-6 WITHDRAWN NOTICE\"\necho \"============================================\"\necho \"\"\necho \"PL-6 (Security-related Activity Planning) has been\"\necho \"WITHDRAWN in NIST SP 800-53 Revision 5.\"\necho \"\"\necho \"Requirements have been incorporated into:\"\necho \"  -> PL-2 (System Security and Privacy Plans)\"\necho \"\"\necho \"Address security activity planning in your\"\necho \"System Security Plan (SSP).\"\necho \"============================================\"",
        "ansible": "---\n# PL-6: Security-related Activity Planning\n# STATUS: WITHDRAWN - See PL-2\n\n- name: PL-6 Withdrawal Notice\n  hosts: all\n  tasks:\n    - name: Display withdrawal notice\n      ansible.builtin.debug:\n        msg: \"PL-6 WITHDRAWN - Security activity planning incorporated into PL-2\""
      },
      "windows": {
        "powershell": "# PL-6: Security-related Activity Planning\n# STATUS: WITHDRAWN in NIST SP 800-53 Rev 5\n# INCORPORATED INTO: PL-2\n\nWrite-Host \"PL-6 WITHDRAWN NOTICE\" -ForegroundColor Yellow\nWrite-Host \"PL-6 (Security-related Activity Planning) has been WITHDRAWN\" -ForegroundColor Red\nWrite-Host \"Requirements incorporated into PL-2 (System Security Plans)\" -ForegroundColor Green",
        "ansible": "---\n# PL-6: Withdrawal Notice - Windows\n- name: PL-6 Notice\n  hosts: windows\n  tasks:\n    - name: Display notice\n      debug:\n        msg: \"PL-6 WITHDRAWN - See PL-2\""
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "withdrawn",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": false,
      "withdrawal_info": "Incorporated into PL-2 in NIST SP 800-53 Rev 5"
    }
  },
  {
    "control_id": "PL-7",
    "control_name": "Concept of Operations",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "a. Develop a Concept of Operations (CONOPS) for the system describing how the organization intends to operate the system from the perspective of information security and privacy; and b. Review and update the CONOPS [Assignment: organization-defined frequency].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control ensures organizations develop and maintain a Concept of Operations document that describes how the system will be operated from security and privacy perspectives. The CONOPS provides operational context essential for understanding security requirements and making risk-based decisions.",
    "rationale": "A Concept of Operations bridges the gap between technical security controls and operational reality. It describes the organizational context, user roles, operational modes, and security considerations that inform control implementation decisions. Without a CONOPS, security controls may be implemented without understanding their operational impact.",
    "plain_english_explanation": "The Concept of Operations (CONOPS) is like an operational playbook for your system. It describes who uses the system, how they use it, what the system is supposed to do, and how security fits into daily operations. Think of it as the story of your system's life from a security perspective. The CONOPS helps everyone understand not just what security controls exist, but why they exist and how they support the mission. It is reviewed and updated regularly to ensure it stays current with how the system actually operates.",
    "ai_guidance": "When implementing PL-7 Concept of Operations, organizations should create a comprehensive document that describes the system's operational environment from security and privacy perspectives. The CONOPS should include: (1) Mission/business objectives the system supports; (2) Organizational context and stakeholders; (3) System description including interfaces and data flows; (4) User roles and responsibilities; (5) Operational scenarios including normal operations, maintenance windows, and incident response; (6) Security and privacy considerations for each operational mode; (7) External dependencies and interconnections; (8) Performance expectations and constraints. The CONOPS should be written in plain language accessible to both technical and non-technical stakeholders. It should be reviewed annually at minimum, or whenever significant operational changes occur. The CONOPS informs the System Security Plan and helps assessors understand the operational context for security controls. For systems with multiple operational modes (development, test, production), document security implications of each mode. Include disaster recovery and continuity scenarios to ensure security considerations extend to degraded operations.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PL-2",
      "PL-8",
      "SA-3",
      "SA-8",
      "PM-7"
    ],
    "supplemental_guidance": "The Concept of Operations includes the security and privacy aspects of system operation. Organizations may incorporate the Concept of Operations into a system security plan or document the security and privacy aspects in a separate document. The Concept of Operations is updated whenever there is a significant change to the system or operating environment or whenever there are substantive changes to security or privacy architecture.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-7: Concept of Operations (CONOPS) Generator\n# Creates a CONOPS template for system security documentation\n\nset -euo pipefail\n\nOUTPUT_DIR=\"/var/lib/compliance/pl-7-conops\"\nDATE=$(date +%Y-%m-%d)\nCONOPS_FILE=\"${OUTPUT_DIR}/conops_${DATE}.md\"\n\nmkdir -p \"${OUTPUT_DIR}\"\n\nSYSTEM_NAME=\"${SYSTEM_NAME:-Production System}\"\nSYSTEM_OWNER=\"${SYSTEM_OWNER:-IT Operations}\"\n\ncat > \"${CONOPS_FILE}\" << EOF\n# Concept of Operations (CONOPS)\n## NIST SP 800-53 Rev 5 Control PL-7\n\n---\n\n## Document Control\n- **Control ID:** PL-7\n- **Generated:** $(date)\n- **System Name:** ${SYSTEM_NAME}\n- **System Owner:** ${SYSTEM_OWNER}\n- **Review Frequency:** Annually or upon significant change\n\n---\n\n## 1. Executive Summary\n\nThis Concept of Operations (CONOPS) describes how ${SYSTEM_NAME} operates from\nsecurity and privacy perspectives. It provides the operational context necessary\nfor understanding security requirements and making risk-based decisions.\n\n---\n\n## 2. System Overview\n\n### 2.1 Mission/Business Objectives\n[Describe the primary mission or business function the system supports]\n\n### 2.2 System Description\n[High-level description of system components, architecture, and capabilities]\n\n### 2.3 System Boundaries\n[Define what is included and excluded from the system authorization boundary]\n\n---\n\n## 3. Stakeholders\n\n| Stakeholder | Role | Security Responsibility |\n|-------------|------|------------------------|\n| System Owner | Accountable | Overall security posture |\n| ISSO | Advisor | Security compliance monitoring |\n| Users | Operator | Following security policies |\n| Administrators | Operator | Security configuration |\n\n---\n\n## 4. Operational Scenarios\n\n### 4.1 Normal Operations\n- Operating hours: [Define]\n- User access patterns: [Describe]\n- Security monitoring: [Active/Passive]\n- Backup schedule: [Define]\n\n### 4.2 Maintenance Windows\n- Scheduled maintenance: [Frequency]\n- Security implications: [Describe]\n- User notification: [Process]\n\n### 4.3 Incident Response Mode\n- Activation criteria: [Define]\n- Security escalation: [Process]\n- Communication plan: [Define]\n\n### 4.4 Degraded Operations\n- Fallback procedures: [Describe]\n- Security considerations: [List]\n- Recovery objectives: [RTO/RPO]\n\n---\n\n## 5. Security Considerations\n\n### 5.1 Data Classification\n[Describe data types and sensitivity levels]\n\n### 5.2 Access Control Model\n[Describe how access is managed]\n\n### 5.3 Audit and Monitoring\n[Describe logging and monitoring approach]\n\n### 5.4 Encryption Requirements\n[Data at rest and in transit encryption]\n\n---\n\n## 6. External Dependencies\n\n| Dependency | Type | Security Implication |\n|------------|------|---------------------|\n| [Service] | [Type] | [Impact if unavailable] |\n\n---\n\n## 7. Review and Update\n\nThis CONOPS will be reviewed:\n- Annually at minimum\n- Upon significant system changes\n- Following security incidents\n- When operational requirements change\n\n---\n\n## Approval\n\n| Role | Name | Date | Signature |\n|------|------|------|-----------|\n| System Owner | _______ | _____ | _______ |\n| ISSO | _______ | _____ | _______ |\nEOF\n\necho \"[INFO] CONOPS template generated: ${CONOPS_FILE}\"\necho \"[SUCCESS] PL-7 Concept of Operations documentation complete\"",
        "ansible": "---\n# PL-7: Concept of Operations Configuration\n# Ansible playbook for CONOPS documentation\n\n- name: PL-7 Concept of Operations\n  hosts: all\n  become: yes\n  vars:\n    compliance_dir: /var/lib/compliance/pl-7-conops\n    system_name: \"{{ inventory_hostname }}\"\n    review_frequency: \"Annually\"\n\n  tasks:\n    - name: Create CONOPS compliance directory\n      ansible.builtin.file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n        mode: '0750'\n\n    - name: Generate CONOPS document\n      ansible.builtin.template:\n        src: templates/pl7_conops.md.j2\n        dest: \"{{ compliance_dir }}/conops_{{ ansible_date_time.date }}.md\"\n        mode: '0640'\n\n    - name: Create CONOPS metadata\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/conops_metadata.json\"\n        mode: '0640'\n        content: |\n          {\n            \"control_id\": \"PL-7\",\n            \"system\": \"{{ system_name }}\",\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"review_frequency\": \"{{ review_frequency }}\",\n            \"next_review\": \"{{ (ansible_date_time.date | to_datetime('%Y-%m-%d')).strftime('%Y-%m-%d') }}\"\n          }\n\n    - name: Display CONOPS status\n      ansible.builtin.debug:\n        msg: |\n          PL-7 Concept of Operations generated for {{ system_name }}\n          Review frequency: {{ review_frequency }}"
      },
      "windows": {
        "powershell": "# PL-7: Concept of Operations (CONOPS) Generator for Windows\n# Creates a CONOPS template for system security documentation\n\n$ErrorActionPreference = 'Stop'\n\n$ComplianceDir = \"C:\\Compliance\\PL-7-CONOPS\"\n$Date = Get-Date -Format 'yyyy-MM-dd'\n$SystemName = $env:COMPUTERNAME\n\nif (-not (Test-Path $ComplianceDir)) {\n    New-Item -ItemType Directory -Path $ComplianceDir -Force | Out-Null\n}\n\n$ConopsContent = @\"\n# Concept of Operations (CONOPS)\n## NIST SP 800-53 Rev 5 Control PL-7\n\n---\n\n## Document Control\n- **Control ID:** PL-7\n- **Generated:** $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\n- **System Name:** $SystemName\n- **Review Frequency:** Annually or upon significant change\n\n---\n\n## 1. System Overview\n\n### Windows System Information\n- **Operating System:** $(Get-WmiObject Win32_OperatingSystem | Select-Object -ExpandProperty Caption)\n- **Domain:** $((Get-WmiObject Win32_ComputerSystem).Domain)\n- **Role:** $((Get-WmiObject Win32_ComputerSystem).DomainRole)\n\n---\n\n## 2. Operational Scenarios\n\n### Normal Operations\n- Windows services running\n- Group Policy applied\n- Security monitoring active\n\n### Maintenance Mode\n- Windows Update installation windows\n- Backup operations\n- Security patching\n\n---\n\n## 3. Security Considerations\n\n### Windows Security Features\n- Windows Defender: Active\n- Firewall: Enabled\n- BitLocker: [Check manually]\n- Audit Policy: Configured\n\n---\n\n## Review Schedule\n- Annual review required\n- Update upon significant system changes\n\"@\n\n$ConopsFile = Join-Path $ComplianceDir \"CONOPS_$Date.md\"\n$ConopsContent | Out-File -FilePath $ConopsFile -Encoding UTF8\n\nWrite-Host \"[INFO] CONOPS generated: $ConopsFile\" -ForegroundColor Green\nWrite-Host \"[SUCCESS] PL-7 Concept of Operations complete\" -ForegroundColor Cyan",
        "ansible": "---\n# PL-7: Concept of Operations for Windows\n\n- name: PL-7 CONOPS - Windows\n  hosts: windows\n  tasks:\n    - name: Create CONOPS directory\n      ansible.windows.win_file:\n        path: C:\\Compliance\\PL-7-CONOPS\n        state: directory\n\n    - name: Gather system information for CONOPS\n      ansible.windows.win_shell: |\n        @{\n          Hostname = $env:COMPUTERNAME\n          Domain = (Get-WmiObject Win32_ComputerSystem).Domain\n          OS = (Get-WmiObject Win32_OperatingSystem).Caption\n        } | ConvertTo-Json\n      register: sys_info\n\n    - name: Generate CONOPS metadata\n      ansible.windows.win_copy:\n        dest: C:\\Compliance\\PL-7-CONOPS\\conops_metadata.json\n        content: |\n          {\n            \"control_id\": \"PL-7\",\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"system_info\": {{ sys_info.stdout }}\n          }"
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    }
  },
  {
    "control_id": "PL-8",
    "control_name": "Security and Privacy Architectures",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "a. Develop security and privacy architectures for the system that: 1. Describe the requirements and approach to be taken for protecting the confidentiality, integrity, and availability of organizational information; 2. Describe the requirements and approach to be taken for processing personally identifiable information to minimize privacy risk to individuals; 3. Describe how the architectures are integrated into and support the enterprise architecture; and 4. Describe any assumptions about, and dependencies on, external systems and services; b. Review and update the architectures [Assignment: organization-defined frequency] to reflect changes in the enterprise architecture; and c. Reflect planned architecture changes in security and privacy plans, Concept of Operations (CONOPS), criticality analysis, organizational procedures, and procurements and acquisitions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": true,
      "high": true
    },
    "intent": "This control ensures organizations develop and maintain security and privacy architectures that describe the fundamental approach to protecting organizational information and privacy. The architectures integrate with enterprise architecture and inform security planning decisions.",
    "rationale": "Security and privacy architectures provide the conceptual foundation for all security implementations. They ensure that security investments align with organizational objectives, that controls are implemented consistently, and that the overall security posture supports the enterprise mission. Without architecture guidance, security implementations may be fragmented and ineffective.",
    "plain_english_explanation": "Security and Privacy Architectures are like the blueprints for how security works across your entire organization. Just as a building architect creates plans showing how walls, plumbing, and electrical systems fit together, a security architect creates plans showing how firewalls, access controls, encryption, and other security measures work together. These architectures describe your security philosophy, identify external dependencies, and ensure your security approach aligns with your overall business technology strategy. The architecture is updated whenever your enterprise technology changes.",
    "ai_guidance": "When implementing PL-8 Security and Privacy Architectures, organizations should develop comprehensive documentation that describes the strategic approach to security and privacy. Key components include: (1) Security Architecture Framework - describing layers of defense, trust zones, and control placement rationale; (2) Privacy Architecture - describing how PII flows are minimized and protected; (3) Enterprise Integration - showing how security architecture aligns with business architecture, data architecture, and technology architecture; (4) Reference Models - providing patterns for implementing common security capabilities; (5) External Dependencies - documenting assumptions about cloud providers, third parties, and interconnected systems; (6) Technology Standards - specifying approved security technologies and configurations. Use established frameworks like SABSA, TOGAF, or NIST Cybersecurity Framework to structure the architecture. Create architecture diagrams showing trust boundaries, data flows, and control placement. Review architectures annually and update when enterprise architecture changes significantly. Ensure procurement decisions align with architecture standards. Train development teams on architecture patterns to ensure consistent implementation.",
    "is_technical": false,
    "enhancements": [
      {
        "id": "PL-8.1",
        "title": "Defense in Depth",
        "official_text": "Design the security and privacy architectures for the system using a defense-in-depth approach that allocates security safeguards based on system component criticality."
      },
      {
        "id": "PL-8.2",
        "title": "Supplier Diversity",
        "official_text": "Require that critical system components are obtained from different suppliers."
      }
    ],
    "related_controls": [
      "PL-2",
      "PL-7",
      "PL-9",
      "SA-3",
      "SA-8",
      "SA-17",
      "PM-7",
      "SC-7"
    ],
    "supplemental_guidance": "The security and privacy architectures at the system level are consistent with the organization-wide security and privacy architectures described in PM-7, which are integral to and developed as part of the enterprise architecture. Security and privacy architectures include an architectural description, the allocation of security and privacy functionality, and information protection needs to system components.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-8: Security and Privacy Architectures Documentation\n# Generates security architecture documentation template\n\nset -euo pipefail\n\nOUTPUT_DIR=\"/var/lib/compliance/pl-8-security-architecture\"\nDATE=$(date +%Y-%m-%d)\nARCH_FILE=\"${OUTPUT_DIR}/security_architecture_${DATE}.md\"\n\nmkdir -p \"${OUTPUT_DIR}\"\n\ncat > \"${ARCH_FILE}\" << 'EOF'\n# Security and Privacy Architecture\n## NIST SP 800-53 Rev 5 Control PL-8\n\n---\n\n## Document Control\n- **Control ID:** PL-8\n- **Generated:** $(date)\n- **Review Frequency:** Annually or upon enterprise architecture changes\n\n---\n\n## 1. Architecture Overview\n\n### 1.1 Security Philosophy\n[Describe the fundamental approach to security - defense in depth, zero trust, etc.]\n\n### 1.2 Privacy Philosophy\n[Describe the approach to privacy - data minimization, purpose limitation, etc.]\n\n---\n\n## 2. Security Architecture Components\n\n### 2.1 Network Security Layer\n- Perimeter defense (firewalls, IPS)\n- Network segmentation\n- Encryption in transit\n\n### 2.2 Host Security Layer\n- Endpoint protection\n- Host-based firewall\n- Patch management\n\n### 2.3 Application Security Layer\n- Input validation\n- Authentication/Authorization\n- Secure coding practices\n\n### 2.4 Data Security Layer\n- Encryption at rest\n- Data classification\n- Access controls\n\n---\n\n## 3. Enterprise Architecture Integration\n\n[Describe how security architecture aligns with business, data, and technology architectures]\n\n---\n\n## 4. External Dependencies\n\n| System/Service | Dependency Type | Security Assumption |\n|----------------|-----------------|--------------------|\n| Cloud Provider | Infrastructure | SOC 2 compliance |\n| DNS Provider | Critical Service | DNSSEC enabled |\n\n---\n\n## 5. Review Schedule\n\n- Annual comprehensive review\n- Triggered review upon significant EA changes\nEOF\n\necho \"[INFO] Security Architecture document generated: ${ARCH_FILE}\"\necho \"[SUCCESS] PL-8 Security Architecture documentation complete\"",
        "ansible": "---\n# PL-8: Security and Privacy Architectures\n# Ansible playbook for architecture documentation\n\n- name: PL-8 Security Architecture Documentation\n  hosts: all\n  become: yes\n  vars:\n    compliance_dir: /var/lib/compliance/pl-8-security-architecture\n\n  tasks:\n    - name: Create architecture compliance directory\n      ansible.builtin.file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n        mode: '0750'\n\n    - name: Generate architecture metadata\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/architecture_metadata.json\"\n        mode: '0640'\n        content: |\n          {\n            \"control_id\": \"PL-8\",\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"enhancements\": [\"PL-8(1) Defense in Depth\", \"PL-8(2) Supplier Diversity\"],\n            \"next_review\": \"Annual\"\n          }\n\n    - name: Display architecture status\n      ansible.builtin.debug:\n        msg: \"PL-8 Security Architecture documentation initialized\""
      },
      "windows": {
        "powershell": "# PL-8: Security and Privacy Architectures for Windows\n\n$ComplianceDir = \"C:\\Compliance\\PL-8-Security-Architecture\"\nif (-not (Test-Path $ComplianceDir)) {\n    New-Item -ItemType Directory -Path $ComplianceDir -Force | Out-Null\n}\n\n$ArchContent = @\"\n# Security and Privacy Architecture\n## NIST SP 800-53 Rev 5 Control PL-8\n\n## Windows Security Architecture Components\n\n### Identity and Access\n- Active Directory / Azure AD\n- Group Policy\n- Privileged Access Management\n\n### Endpoint Protection\n- Microsoft Defender for Endpoint\n- Windows Firewall\n- BitLocker Encryption\n\n### Network Security\n- Windows Firewall with Advanced Security\n- IPsec policies\n- Network isolation\n\n### Monitoring\n- Windows Event Logging\n- Security Event Forwarding\n- Microsoft Sentinel integration\n\"@\n\n$ArchFile = Join-Path $ComplianceDir \"SecurityArchitecture_$(Get-Date -Format 'yyyy-MM-dd').md\"\n$ArchContent | Out-File -FilePath $ArchFile -Encoding UTF8\n\nWrite-Host \"[INFO] Security Architecture generated: $ArchFile\" -ForegroundColor Green",
        "ansible": "---\n# PL-8: Security Architecture - Windows\n\n- name: PL-8 Security Architecture - Windows\n  hosts: windows\n  tasks:\n    - name: Create architecture directory\n      ansible.windows.win_file:\n        path: C:\\Compliance\\PL-8-Security-Architecture\n        state: directory\n\n    - name: Generate architecture metadata\n      ansible.windows.win_copy:\n        dest: C:\\Compliance\\PL-8-Security-Architecture\\metadata.json\n        content: |\n          {\n            \"control_id\": \"PL-8\",\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\"\n          }"
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    }
  },
  {
    "control_id": "PL-8.1",
    "control_name": "Defense in Depth",
    "family": "Planning",
    "family_id": "PL",
    "parent_control": "PL-8",
    "official_text": "Design the security and privacy architectures for the system using a defense-in-depth approach that: (a) Allocates [Assignment: organization-defined controls] to [Assignment: organization-defined locations and architectural layers]; and (b) Ensures that the allocated controls operate in a coordinated and mutually supportive manner.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This enhancement ensures organizations implement defense-in-depth by allocating security controls across multiple architectural layers. No single control is relied upon for protection; instead, multiple overlapping controls provide redundant protection.",
    "rationale": "Defense in depth recognizes that any single security control can fail. By layering controls, organizations ensure that failure of one control does not result in complete compromise. Attackers must bypass multiple independent controls to achieve their objectives.",
    "plain_english_explanation": "Defense in Depth is like having multiple locks, an alarm system, and security cameras at your house instead of just one lock. If a burglar picks the lock, the alarm still goes off. If they disable the alarm, the cameras still record them. In IT security, this means having network firewalls, host firewalls, application controls, and data encryption all working together. Each layer provides protection even if another layer fails.",
    "ai_guidance": "PL-8(1) Defense in Depth requires designing security architectures with multiple layers of protection. Implementation should: (1) Identify architectural layers - network perimeter, internal network, host, application, data; (2) Allocate appropriate controls to each layer - firewalls at perimeter, IPS at internal, endpoint protection at host, input validation at application, encryption at data; (3) Ensure controls are independent - failure of one layer should not cascade; (4) Design for control coordination - layers should work together but not depend on each other; (5) Document control allocation in security architecture; (6) Test each layer independently; (7) Verify no single point of failure exists. Consider zero-trust architecture principles where no layer is implicitly trusted. Use technical verification scripts to confirm controls are active at each layer.",
    "is_technical": true,
    "enhancements": [],
    "related_controls": [
      "PL-8",
      "SC-7",
      "SC-32",
      "SA-8"
    ],
    "supplemental_guidance": "Organizations strategically allocate security safeguards in the security and privacy architectures so that adversaries must overcome multiple safeguards to achieve their objectives. Defense-in-depth for privacy risk requires a similar strategy that minimizes privacy risks associated with the use or processing of PII.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-8(1): Defense in Depth Verification\n# Verifies multiple security layers are active\n\nset -euo pipefail\n\necho \"============================================\"\necho \"PL-8(1) Defense in Depth Verification\"\necho \"============================================\"\n\nLAYERS_OK=0\nLAYERS_FAIL=0\n\n# Layer 1: Network Firewall\necho -e \"\\n[Layer 1: Network Firewall]\"\nif command -v iptables &>/dev/null; then\n    RULES=$(iptables -L -n 2>/dev/null | grep -c 'Chain' || echo 0)\n    if [[ $RULES -gt 3 ]]; then\n        echo \"  [OK] iptables active with $RULES chains\"\n        ((LAYERS_OK++))\n    else\n        echo \"  [WARN] iptables may not be configured\"\n        ((LAYERS_FAIL++))\n    fi\nfi\n\nif command -v firewall-cmd &>/dev/null; then\n    if firewall-cmd --state 2>/dev/null | grep -q 'running'; then\n        echo \"  [OK] firewalld is running\"\n        ((LAYERS_OK++))\n    fi\nfi\n\n# Layer 2: Host-based IDS/IPS\necho -e \"\\n[Layer 2: Host-based IDS]\"\nif systemctl is-active --quiet auditd 2>/dev/null; then\n    echo \"  [OK] auditd is running\"\n    ((LAYERS_OK++))\nelse\n    echo \"  [WARN] auditd not running\"\n    ((LAYERS_FAIL++))\nfi\n\nif command -v aide &>/dev/null; then\n    echo \"  [OK] AIDE file integrity monitoring installed\"\n    ((LAYERS_OK++))\nelse\n    echo \"  [INFO] AIDE not installed (optional)\"\nfi\n\n# Layer 3: Application Controls\necho -e \"\\n[Layer 3: Application Security]\"\nif [ -f /etc/selinux/config ]; then\n    SELINUX_MODE=$(getenforce 2>/dev/null || echo 'Unknown')\n    if [[ \"$SELINUX_MODE\" == \"Enforcing\" ]]; then\n        echo \"  [OK] SELinux is Enforcing\"\n        ((LAYERS_OK++))\n    else\n        echo \"  [WARN] SELinux is $SELINUX_MODE (should be Enforcing)\"\n        ((LAYERS_FAIL++))\n    fi\nfi\n\n# Layer 4: Data Protection\necho -e \"\\n[Layer 4: Data Protection]\"\nif command -v cryptsetup &>/dev/null; then\n    LUKS_VOLUMES=$(lsblk -o NAME,TYPE,MOUNTPOINT | grep -c 'crypt' || echo 0)\n    if [[ $LUKS_VOLUMES -gt 0 ]]; then\n        echo \"  [OK] $LUKS_VOLUMES encrypted volumes detected\"\n        ((LAYERS_OK++))\n    else\n        echo \"  [WARN] No LUKS encrypted volumes detected\"\n        ((LAYERS_FAIL++))\n    fi\nfi\n\n# Summary\necho -e \"\\n============================================\"\necho \"Defense in Depth Summary\"\necho \"============================================\"\necho \"Layers Active: $LAYERS_OK\"\necho \"Layers Needing Attention: $LAYERS_FAIL\"\n\nif [[ $LAYERS_OK -ge 3 ]]; then\n    echo -e \"\\n[SUCCESS] Multiple defense layers confirmed\"\nelse\n    echo -e \"\\n[WARNING] Defense in depth may be insufficient\"\nfi",
        "ansible": "---\n# PL-8(1): Defense in Depth Verification\n\n- name: PL-8(1) Defense in Depth Check\n  hosts: all\n  become: yes\n  tasks:\n    - name: Check Layer 1 - Firewall status\n      ansible.builtin.command: firewall-cmd --state\n      register: firewall_status\n      ignore_errors: yes\n      changed_when: false\n\n    - name: Check Layer 2 - Auditd status\n      ansible.builtin.service_facts:\n\n    - name: Check Layer 3 - SELinux status\n      ansible.builtin.command: getenforce\n      register: selinux_status\n      changed_when: false\n      ignore_errors: yes\n\n    - name: Check Layer 4 - LUKS volumes\n      ansible.builtin.shell: lsblk -o NAME,TYPE | grep -c crypt || echo 0\n      register: luks_count\n      changed_when: false\n\n    - name: Display Defense in Depth Status\n      ansible.builtin.debug:\n        msg: |\n          === Defense in Depth Verification ===\n          Layer 1 (Firewall): {{ 'Active' if firewall_status.rc == 0 else 'Inactive' }}\n          Layer 2 (Audit): {{ 'Active' if ansible_facts.services['auditd.service'] is defined and ansible_facts.services['auditd.service'].state == 'running' else 'Inactive' }}\n          Layer 3 (SELinux): {{ selinux_status.stdout | default('Unknown') }}\n          Layer 4 (Encryption): {{ luks_count.stdout }} encrypted volumes"
      },
      "windows": {
        "powershell": "# PL-8(1): Defense in Depth Verification for Windows\n\nWrite-Host \"`n============================================\" -ForegroundColor Cyan\nWrite-Host \"PL-8(1) Defense in Depth Verification\" -ForegroundColor Cyan\nWrite-Host \"============================================`n\" -ForegroundColor Cyan\n\n$Results = @{}\n\n# Layer 1: Windows Firewall\nWrite-Host \"[Layer 1: Windows Firewall]\" -ForegroundColor Yellow\n$FirewallProfiles = Get-NetFirewallProfile\nforeach ($profile in $FirewallProfiles) {\n    if ($profile.Enabled) {\n        Write-Host \"  [OK] $($profile.Name) profile: Enabled\" -ForegroundColor Green\n    } else {\n        Write-Host \"  [WARN] $($profile.Name) profile: Disabled\" -ForegroundColor Red\n    }\n}\n$Results['Firewall'] = ($FirewallProfiles | Where-Object Enabled).Count\n\n# Layer 2: Windows Defender\nWrite-Host \"`n[Layer 2: Endpoint Protection]\" -ForegroundColor Yellow\ntry {\n    $DefenderStatus = Get-MpComputerStatus\n    if ($DefenderStatus.RealTimeProtectionEnabled) {\n        Write-Host \"  [OK] Windows Defender Real-time Protection: Enabled\" -ForegroundColor Green\n        $Results['Defender'] = 1\n    } else {\n        Write-Host \"  [WARN] Windows Defender Real-time Protection: Disabled\" -ForegroundColor Red\n        $Results['Defender'] = 0\n    }\n} catch {\n    Write-Host \"  [INFO] Could not query Windows Defender\" -ForegroundColor Yellow\n    $Results['Defender'] = 0\n}\n\n# Layer 3: Application Control\nWrite-Host \"`n[Layer 3: Application Control]\" -ForegroundColor Yellow\n$AppLockerPolicies = Get-AppLockerPolicy -Effective -ErrorAction SilentlyContinue\nif ($AppLockerPolicies -and $AppLockerPolicies.RuleCollections.Count -gt 0) {\n    Write-Host \"  [OK] AppLocker policies configured: $($AppLockerPolicies.RuleCollections.Count) collections\" -ForegroundColor Green\n    $Results['AppLocker'] = 1\n} else {\n    Write-Host \"  [INFO] AppLocker not configured (optional)\" -ForegroundColor Yellow\n    $Results['AppLocker'] = 0\n}\n\n# Layer 4: Data Protection (BitLocker)\nWrite-Host \"`n[Layer 4: Data Protection]\" -ForegroundColor Yellow\n$BitLockerVolumes = Get-BitLockerVolume -ErrorAction SilentlyContinue\nif ($BitLockerVolumes) {\n    $EncryptedCount = ($BitLockerVolumes | Where-Object VolumeStatus -eq 'FullyEncrypted').Count\n    Write-Host \"  [OK] BitLocker: $EncryptedCount volume(s) fully encrypted\" -ForegroundColor Green\n    $Results['BitLocker'] = $EncryptedCount\n} else {\n    Write-Host \"  [WARN] BitLocker not configured\" -ForegroundColor Red\n    $Results['BitLocker'] = 0\n}\n\n# Layer 5: Audit Logging\nWrite-Host \"`n[Layer 5: Audit Logging]\" -ForegroundColor Yellow\n$AuditPolicies = auditpol /get /category:* 2>$null | Select-String 'Success|Failure' | Measure-Object\nWrite-Host \"  [OK] $($AuditPolicies.Count) audit policies configured\" -ForegroundColor Green\n$Results['Audit'] = $AuditPolicies.Count\n\n# Summary\n$ActiveLayers = ($Results.Values | Where-Object { $_ -gt 0 }).Count\nWrite-Host \"`n============================================\" -ForegroundColor Cyan\nWrite-Host \"Defense in Depth Summary: $ActiveLayers/5 layers active\" -ForegroundColor White\nif ($ActiveLayers -ge 3) {\n    Write-Host \"[SUCCESS] Multiple defense layers confirmed\" -ForegroundColor Green\n} else {\n    Write-Host \"[WARNING] Defense in depth may need improvement\" -ForegroundColor Yellow\n}",
        "ansible": "---\n# PL-8(1): Defense in Depth - Windows\n\n- name: PL-8(1) Defense in Depth Check - Windows\n  hosts: windows\n  tasks:\n    - name: Check Windows Firewall\n      ansible.windows.win_shell: |\n        (Get-NetFirewallProfile | Where-Object Enabled).Count\n      register: firewall_count\n\n    - name: Check Windows Defender\n      ansible.windows.win_shell: |\n        (Get-MpComputerStatus).RealTimeProtectionEnabled\n      register: defender_status\n      ignore_errors: yes\n\n    - name: Check BitLocker\n      ansible.windows.win_shell: |\n        (Get-BitLockerVolume | Where-Object VolumeStatus -eq 'FullyEncrypted').Count\n      register: bitlocker_count\n      ignore_errors: yes\n\n    - name: Display Defense in Depth Status\n      ansible.builtin.debug:\n        msg: |\n          Defense in Depth Status:\n          - Firewall Profiles Enabled: {{ firewall_count.stdout | trim }}\n          - Defender Real-time: {{ defender_status.stdout | trim }}\n          - BitLocker Volumes: {{ bitlocker_count.stdout | default('0') | trim }}"
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "is_technical": true
    }
  },
  {
    "control_id": "PL-8.2",
    "control_name": "Supplier Diversity",
    "family": "Planning",
    "family_id": "PL",
    "parent_control": "PL-8",
    "official_text": "Require that [Assignment: organization-defined critical system components] allocated to [Assignment: organization-defined locations and architectural layers] are obtained from different suppliers.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This enhancement reduces supply chain risk by ensuring critical system components come from different suppliers. If one supplier is compromised or experiences issues, alternative suppliers can provide similar functionality.",
    "rationale": "Supply chain attacks and vendor compromises represent significant risk. If an organization relies on a single supplier for critical components, compromise of that supplier affects all systems. Supplier diversity ensures no single vendor failure can cause catastrophic impact.",
    "plain_english_explanation": "Supplier Diversity means not putting all your eggs in one basket when it comes to critical security components. If you buy all your firewalls, intrusion detection systems, and endpoint protection from the same vendor, and that vendor gets hacked or has a major bug, all your defenses could fail at once. By using different vendors for different layers of security, you reduce the risk that a single supply chain attack or vendor failure takes down all your defenses.",
    "ai_guidance": "PL-8(2) Supplier Diversity addresses supply chain risk by requiring critical components from different suppliers. Implementation should: (1) Identify critical system components - security controls that protect high-value assets or critical functions; (2) Map components to suppliers - document which vendor provides each critical component; (3) Identify single-vendor dependencies - find where the same vendor provides multiple critical controls; (4) Develop diversity requirements - specify which architectural layers must use different vendors; (5) Document approved suppliers for each layer; (6) Include diversity requirements in procurement processes; (7) Monitor supplier health and security posture; (8) Plan for supplier transitions. Consider diversity across: network security (different firewall and IPS vendors), endpoint protection (primary and backup solutions), identity management (federation with multiple IdPs), and cryptography (multiple algorithm implementations). Balance diversity benefits against operational complexity and integration challenges.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PL-8",
      "SA-12",
      "SR-3",
      "SR-5",
      "SR-6"
    ],
    "supplemental_guidance": "Requiring different suppliers for organization-defined critical system components helps to reduce the potential for a single point of failure and to mitigate supply chain risk. This requirement may not be practical in all cases.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-8(2): Supplier Diversity Documentation\n# Documents critical component suppliers for supply chain risk management\n\nset -euo pipefail\n\nOUTPUT_DIR=\"/var/lib/compliance/pl-8-2-supplier-diversity\"\nDATE=$(date +%Y-%m-%d)\nREPORT_FILE=\"${OUTPUT_DIR}/supplier_diversity_report_${DATE}.md\"\n\nmkdir -p \"${OUTPUT_DIR}\"\n\ncat > \"${REPORT_FILE}\" << 'EOF'\n# Supplier Diversity Assessment\n## NIST SP 800-53 Rev 5 Control PL-8(2)\n\n---\n\n## Purpose\nThis document assesses supplier diversity for critical system components\nto reduce supply chain risk.\n\n---\n\n## Critical Component Supplier Mapping\n\n| Architectural Layer | Component Type | Primary Supplier | Alternative Supplier | Diversity Met |\n|--------------------|----------------|------------------|---------------------|---------------|\n| Network Perimeter | Firewall | [Vendor A] | [Vendor B] | Yes/No |\n| Network Perimeter | IPS/IDS | [Vendor A] | [Vendor C] | Yes/No |\n| Endpoint | Antivirus/EDR | [Vendor D] | [Vendor E] | Yes/No |\n| Application | WAF | [Vendor F] | [Vendor G] | Yes/No |\n| Data | Encryption | [Vendor H] | [Native OS] | Yes/No |\n| Identity | Authentication | [Vendor I] | [Vendor J] | Yes/No |\n\n---\n\n## Single-Vendor Dependencies (Risk Areas)\n\n[List any critical components where same vendor provides multiple layers]\n\n---\n\n## Supplier Diversity Requirements\n\n1. Network security and endpoint security MUST use different vendors\n2. Primary and backup authentication systems MUST use different vendors\n3. Encryption implementations SHOULD use different algorithm providers\n\n---\n\n## Risk Acceptance\n\n[Document any accepted single-vendor risks with justification]\n\n---\n\n## Review Schedule\n\n- Annual supplier diversity review\n- Review upon major procurement decisions\n- Review upon supplier security incidents\nEOF\n\necho \"[INFO] Supplier Diversity report generated: ${REPORT_FILE}\"\n\n# Generate machine-readable inventory\ncat > \"${OUTPUT_DIR}/supplier_inventory.json\" << 'EOF'\n{\n  \"control_id\": \"PL-8(2)\",\n  \"generated\": \"$(date -Iseconds)\",\n  \"critical_components\": [\n    {\n      \"layer\": \"Network Perimeter\",\n      \"component\": \"Firewall\",\n      \"primary_supplier\": \"[Configure]\",\n      \"alternative_supplier\": \"[Configure]\"\n    },\n    {\n      \"layer\": \"Endpoint\",\n      \"component\": \"EDR\",\n      \"primary_supplier\": \"[Configure]\",\n      \"alternative_supplier\": \"[Configure]\"\n    }\n  ]\n}\nEOF\n\necho \"[SUCCESS] PL-8(2) Supplier Diversity documentation complete\"",
        "ansible": "---\n# PL-8(2): Supplier Diversity Documentation\n\n- name: PL-8(2) Supplier Diversity Assessment\n  hosts: all\n  become: yes\n  vars:\n    compliance_dir: /var/lib/compliance/pl-8-2-supplier-diversity\n    critical_components:\n      - layer: \"Network\"\n        component: \"Firewall\"\n        primary_supplier: \"Palo Alto\"\n        alternate_supplier: \"Cisco\"\n      - layer: \"Endpoint\"\n        component: \"EDR\"\n        primary_supplier: \"CrowdStrike\"\n        alternate_supplier: \"Microsoft Defender\"\n\n  tasks:\n    - name: Create supplier diversity directory\n      ansible.builtin.file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n        mode: '0750'\n\n    - name: Generate supplier diversity inventory\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/supplier_inventory.json\"\n        mode: '0640'\n        content: |\n          {\n            \"control_id\": \"PL-8(2)\",\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"components\": {{ critical_components | to_json }}\n          }\n\n    - name: Display supplier diversity status\n      ansible.builtin.debug:\n        msg: \"PL-8(2) Supplier Diversity documented for {{ critical_components | length }} components\""
      },
      "windows": {
        "powershell": "# PL-8(2): Supplier Diversity Documentation for Windows\n\n$ComplianceDir = \"C:\\Compliance\\PL-8-2-Supplier-Diversity\"\nif (-not (Test-Path $ComplianceDir)) {\n    New-Item -ItemType Directory -Path $ComplianceDir -Force | Out-Null\n}\n\n# Define critical components (customize for your environment)\n$CriticalComponents = @(\n    @{Layer='Network';Component='Firewall';Primary='Windows Firewall';Alternate='Third-party'}\n    @{Layer='Endpoint';Component='Antivirus';Primary='Microsoft Defender';Alternate='Third-party EDR'}\n    @{Layer='Identity';Component='Authentication';Primary='Active Directory';Alternate='Azure AD'}\n    @{Layer='Data';Component='Encryption';Primary='BitLocker';Alternate='Third-party'}\n)\n\nWrite-Host \"`n=== PL-8(2) Supplier Diversity Assessment ===`n\" -ForegroundColor Cyan\n\nforeach ($component in $CriticalComponents) {\n    Write-Host \"Layer: $($component.Layer)\" -ForegroundColor Yellow\n    Write-Host \"  Component: $($component.Component)\"\n    Write-Host \"  Primary: $($component.Primary)\"\n    Write-Host \"  Alternate: $($component.Alternate)`n\"\n}\n\n# Generate JSON inventory\n$Inventory = @{\n    control_id = 'PL-8(2)'\n    generated = Get-Date -Format 'o'\n    components = $CriticalComponents\n}\n\n$JsonFile = Join-Path $ComplianceDir \"supplier_inventory.json\"\n$Inventory | ConvertTo-Json -Depth 3 | Out-File $JsonFile -Encoding UTF8\n\nWrite-Host \"[INFO] Supplier inventory saved: $JsonFile\" -ForegroundColor Green",
        "ansible": "---\n# PL-8(2): Supplier Diversity - Windows\n\n- name: PL-8(2) Supplier Diversity - Windows\n  hosts: windows\n  tasks:\n    - name: Create supplier diversity directory\n      ansible.windows.win_file:\n        path: C:\\Compliance\\PL-8-2-Supplier-Diversity\n        state: directory\n\n    - name: Document installed security vendors\n      ansible.windows.win_shell: |\n        @{\n          Antivirus = (Get-MpComputerStatus).AMProductVersion\n          Firewall = 'Windows Firewall'\n          Encryption = 'BitLocker'\n          Identity = (Get-WmiObject Win32_ComputerSystem).Domain\n        } | ConvertTo-Json\n      register: security_vendors\n\n    - name: Save vendor inventory\n      ansible.windows.win_copy:\n        dest: C:\\Compliance\\PL-8-2-Supplier-Diversity\\vendor_inventory.json\n        content: \"{{ security_vendors.stdout }}\""
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true
    }
  },
  {
    "control_id": "PL-9",
    "control_name": "Central Management",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "Centrally manage [Assignment: organization-defined controls and related processes].",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": false,
      "moderate": false,
      "high": false
    },
    "intent": "This control ensures that security controls and related processes are managed from a central location to provide consistency, efficiency, and comprehensive oversight. Central management reduces administrative burden, eliminates inconsistencies across distributed systems, and enables rapid response to security threats across the enterprise.",
    "rationale": "Organizations with distributed systems and multiple operational units benefit significantly from central management of security controls. Without centralized oversight, security configurations can drift, policies may be applied inconsistently, and gaps in protection can emerge undetected. Central management provides authoritative control over critical security functions while enabling economies of scale in security operations.",
    "plain_english_explanation": "Central Management means your organization designates specific security controls and processes that will be managed from one central authority rather than by individual system owners. Think of it like a corporate IT department that manages antivirus software across all company computers instead of each employee installing their own. This approach ensures everyone uses the same approved tools, configurations are consistent, updates happen uniformly, and there is clear accountability for security decisions. The organization decides which controls benefit most from central management based on their environment and risk profile.",
    "ai_guidance": "When implementing PL-9 Central Management, organizations should first conduct a comprehensive inventory of all security controls currently in use across the enterprise. Identify controls that would benefit most from central management, typically those requiring consistent configuration (like vulnerability scanning, patch management, identity management), those with high compliance impact, or those where distributed management has historically led to inconsistencies. Establish a Central Security Management Office (CSMO) or equivalent function with clear authority and accountability. Deploy enterprise-grade security management platforms that provide centralized policy definition, distribution, monitoring, and reporting capabilities. Consider using Security Information and Event Management (SIEM) systems, enterprise endpoint protection platforms, centralized identity providers (IdP), and configuration management databases (CMDB). Document the scope of central management in the System Security Plan, including which controls are centrally managed, the rationale for selection, and the processes for requesting exceptions. Implement automated compliance monitoring to detect drift from centrally-defined configurations. Establish clear escalation procedures and maintain audit trails of all central management activities. Regular reviews should assess whether the scope of central management remains appropriate as the organization evolves.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PL-2",
      "PL-8",
      "PM-1",
      "PM-2",
      "PM-9",
      "CA-7",
      "CM-2",
      "CM-3",
      "CM-6",
      "CM-8",
      "SA-3"
    ],
    "supplemental_guidance": "Central management includes planning, implementing, assessing, authorizing, and monitoring the organization-defined, centrally managed controls and processes. Central management includes the development of common control baselines, the establishment of common policies and procedures, and the integration of security-relevant information from multiple sources. The set of controls and processes that are centrally managed can include those that support critical mission functions, controls allocated to common control providers, and security monitoring and response services. Organizations determine and designate which controls and processes benefit from central management based on organizational risk management strategies, available resources, and current security posture. Central management may include centralized planning, implementing, assessing, authorizing, and monitoring services provided by other organizations on behalf of the organization.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-9: Central Management Documentation Generator\n# Generates central management policy documentation and inventory\n\nset -euo pipefail\n\nOUTPUT_DIR=\"/var/lib/compliance/pl-9-central-management\"\nDATE=$(date +%Y-%m-%d)\nREPORT_FILE=\"${OUTPUT_DIR}/central_management_report_${DATE}.md\"\n\nmkdir -p \"${OUTPUT_DIR}\"\n\ncat > \"${REPORT_FILE}\" << 'POLICY_EOF'\n# Central Management Policy and Inventory\n\n## Document Control\n- **Control ID:** PL-9\n- **Generated:** $(date)\n- **Review Frequency:** Annually or upon significant change\n\n## Purpose\nThis document defines the organization's approach to centrally managing\nsecurity controls and related processes to ensure consistency, efficiency,\nand comprehensive security oversight across all information systems.\n\n## Scope of Central Management\n\n### Centrally Managed Controls\nThe following control families and specific controls are designated for\ncentral management:\n\n| Control Area | Centrally Managed | Management Authority |\n|--------------|-------------------|---------------------|\n| Access Control (AC) | AC-2, AC-3, AC-6 | Identity Management Team |\n| Audit (AU) | AU-2, AU-3, AU-6 | Security Operations Center |\n| Configuration Management (CM) | CM-2, CM-6, CM-7 | Enterprise Architecture |\n| Identification/Authentication (IA) | IA-2, IA-5, IA-8 | Identity Management Team |\n| System Protection (SC) | SC-7, SC-8, SC-13 | Network Security Team |\n\n### Central Management Functions\n1. **Planning**: Enterprise security architecture and control selection\n2. **Implementation**: Deployment of common security services\n3. **Assessment**: Continuous monitoring and compliance verification\n4. **Authorization**: Approval of security configurations and exceptions\n5. **Monitoring**: Real-time security event correlation and response\n\n## Central Management Infrastructure\n\n### Enterprise Security Platforms\n- Security Information and Event Management (SIEM)\n- Enterprise Endpoint Protection Platform\n- Centralized Identity Provider (IdP)\n- Configuration Management Database (CMDB)\n- Vulnerability Management System\n\n## Roles and Responsibilities\n\n### Chief Information Security Officer (CISO)\n- Overall accountability for central management program\n- Approval of centrally managed control scope\n- Resource allocation for central management functions\n\n### Central Security Management Office\n- Day-to-day central management operations\n- Policy development and distribution\n- Compliance monitoring and reporting\n- Exception processing and tracking\n\n### System Owners\n- Implementation of centrally-defined configurations\n- Reporting of deviations or issues\n- Participation in central management reviews\n\n## Exception Process\n1. System owner submits exception request with justification\n2. CSMO reviews technical and risk implications\n3. CISO approves/denies with compensating controls if needed\n4. Exception documented with expiration date and review schedule\n\n## Compliance Verification\n- Automated configuration compliance scanning: Daily\n- Central management effectiveness review: Quarterly\n- Full central management scope assessment: Annually\nPOLICY_EOF\n\necho \"[INFO] Central Management policy generated: ${REPORT_FILE}\"\n\n# Generate inventory of centrally managed services\nINVENTORY_FILE=\"${OUTPUT_DIR}/central_services_inventory.json\"\n\ncat > \"${INVENTORY_FILE}\" << 'INVENTORY_EOF'\n{\n  \"central_management_inventory\": {\n    \"generated\": \"$(date -Iseconds)\",\n    \"services\": [\n      {\n        \"service_name\": \"Enterprise SIEM\",\n        \"control_support\": [\"AU-2\", \"AU-3\", \"AU-6\", \"SI-4\"],\n        \"management_scope\": \"All production systems\",\n        \"status\": \"operational\"\n      },\n      {\n        \"service_name\": \"Centralized Identity Provider\",\n        \"control_support\": [\"AC-2\", \"IA-2\", \"IA-5\", \"IA-8\"],\n        \"management_scope\": \"Enterprise-wide\",\n        \"status\": \"operational\"\n      },\n      {\n        \"service_name\": \"Vulnerability Management Platform\",\n        \"control_support\": [\"CA-7\", \"RA-5\", \"SI-2\"],\n        \"management_scope\": \"All networked assets\",\n        \"status\": \"operational\"\n      },\n      {\n        \"service_name\": \"Configuration Management Database\",\n        \"control_support\": [\"CM-2\", \"CM-6\", \"CM-8\"],\n        \"management_scope\": \"All IT assets\",\n        \"status\": \"operational\"\n      }\n    ]\n  }\n}\nINVENTORY_EOF\n\necho \"[INFO] Central services inventory generated: ${INVENTORY_FILE}\"\necho \"[SUCCESS] PL-9 Central Management documentation complete\"",
        "ansible": "---\n# PL-9: Central Management Configuration\n# Ansible playbook for establishing central management infrastructure\n\n- name: PL-9 Central Management Setup\n  hosts: management_servers\n  become: yes\n  vars:\n    compliance_dir: /var/lib/compliance/pl-9-central-management\n    central_mgmt_services:\n      - name: siem\n        description: Security Information and Event Management\n        port: 514\n      - name: idp\n        description: Identity Provider\n        port: 443\n      - name: cmdb\n        description: Configuration Management Database\n        port: 8080\n\n  tasks:\n    - name: Create central management compliance directory\n      ansible.builtin.file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n        mode: '0750'\n        owner: root\n        group: security\n\n    - name: Generate central management policy document\n      ansible.builtin.template:\n        src: templates/pl9_central_management_policy.md.j2\n        dest: \"{{ compliance_dir }}/central_management_policy.md\"\n        mode: '0640'\n\n    - name: Create central management service registry\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/service_registry.yml\"\n        mode: '0640'\n        content: |\n          ---\n          central_management_services:\n          {% for svc in central_mgmt_services %}\n            - name: {{ svc.name }}\n              description: {{ svc.description }}\n              port: {{ svc.port }}\n              status: active\n              last_verified: {{ ansible_date_time.iso8601 }}\n          {% endfor %}\n\n    - name: Configure rsyslog for central log management\n      ansible.builtin.lineinfile:\n        path: /etc/rsyslog.conf\n        line: \"*.* @@{{ central_siem_server }}:514\"\n        state: present\n      notify: Restart rsyslog\n      when: central_siem_server is defined\n\n    - name: Install central management monitoring agent\n      ansible.builtin.package:\n        name:\n          - ossec-hids-agent\n          - auditd\n        state: present\n\n    - name: Configure audit rules for central management compliance\n      ansible.builtin.copy:\n        dest: /etc/audit/rules.d/pl-9-central-mgmt.rules\n        mode: '0640'\n        content: |\n          # PL-9 Central Management Audit Rules\n          -w /etc/security/ -p wa -k central_mgmt_config\n          -w /etc/pam.d/ -p wa -k central_mgmt_auth\n          -w /etc/sudoers -p wa -k central_mgmt_privilege\n          -w /etc/ssh/sshd_config -p wa -k central_mgmt_access\n      notify: Restart auditd\n\n    - name: Generate compliance evidence report\n      ansible.builtin.shell: |\n        echo \"PL-9 Central Management Compliance Evidence\" > {{ compliance_dir }}/evidence_{{ ansible_date_time.date }}.log\n        echo \"Generated: {{ ansible_date_time.iso8601 }}\" >> {{ compliance_dir }}/evidence_{{ ansible_date_time.date }}.log\n        echo \"Host: {{ inventory_hostname }}\" >> {{ compliance_dir }}/evidence_{{ ansible_date_time.date }}.log\n        systemctl list-units --type=service --state=running | grep -E '(siem|audit|ossec)' >> {{ compliance_dir }}/evidence_{{ ansible_date_time.date }}.log || true\n      changed_when: false\n\n  handlers:\n    - name: Restart rsyslog\n      ansible.builtin.service:\n        name: rsyslog\n        state: restarted\n\n    - name: Restart auditd\n      ansible.builtin.service:\n        name: auditd\n        state: restarted"
      },
      "windows": {
        "powershell": "# PL-9: Central Management Documentation Generator for Windows\n# Generates central management policy documentation and inventory\n\n#Requires -Version 5.1\n#Requires -RunAsAdministrator\n\n$ErrorActionPreference = 'Stop'\n\n$ComplianceDir = \"C:\\Compliance\\PL-9-Central-Management\"\n$Date = Get-Date -Format 'yyyy-MM-dd'\n$ReportFile = Join-Path $ComplianceDir \"CentralManagementReport_$Date.md\"\n\n# Create compliance directory\nif (-not (Test-Path $ComplianceDir)) {\n    New-Item -ItemType Directory -Path $ComplianceDir -Force | Out-Null\n}\n\n# Generate Central Management Policy Document\n$PolicyContent = @\"\n# Central Management Policy and Inventory\n\n## Document Control\n- **Control ID:** PL-9\n- **Generated:** $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\n- **Review Frequency:** Annually or upon significant change\n\n## Purpose\nThis document defines the organization's approach to centrally managing\nsecurity controls and related processes to ensure consistency, efficiency,\nand comprehensive security oversight across all information systems.\n\n## Scope of Central Management\n\n### Centrally Managed Controls - Windows Environment\n| Control Area | Centrally Managed | Management Authority |\n|--------------|-------------------|---------------------|\n| Access Control | Group Policy, Azure AD | Identity Management |\n| Audit | Windows Event Forwarding | Security Operations |\n| Configuration | SCCM/Intune, GPO | Enterprise Architecture |\n| Endpoint Protection | Microsoft Defender ATP | Security Operations |\n| Patch Management | WSUS/SCCM/Intune | IT Operations |\n\n### Enterprise Management Platforms\n- **Active Directory/Azure AD**: Centralized identity and access management\n- **Group Policy**: Centralized configuration management\n- **SCCM/Intune**: Software and patch deployment\n- **Windows Event Forwarding**: Centralized log collection\n- **Microsoft Defender for Endpoint**: Centralized threat protection\n\n## Central Management Verification\nThe following PowerShell commands verify central management configuration:\n\n``````powershell\n# Verify domain membership (centralized identity)\n(Get-WmiObject Win32_ComputerSystem).PartOfDomain\n\n# Verify Group Policy application (centralized config)\ngpresult /r\n\n# Verify Windows Event Forwarding (centralized logging)\nwecutil gs \"ForwardedEvents\"\n``````\n\n## Compliance Requirements\n- All systems must be domain-joined or Azure AD registered\n- Group Policy must be applied within 90 minutes of policy change\n- All security events must forward to central SIEM within 5 minutes\n- Endpoint protection must report to central console\n\"@\n\n$PolicyContent | Out-File -FilePath $ReportFile -Encoding UTF8\nWrite-Host \"[INFO] Central Management policy generated: $ReportFile\" -ForegroundColor Green\n\n# Collect Central Management Evidence\n$Evidence = @{\n    GeneratedDate = Get-Date -Format 'o'\n    Hostname = $env:COMPUTERNAME\n    DomainJoined = (Get-WmiObject Win32_ComputerSystem).PartOfDomain\n    DomainName = (Get-WmiObject Win32_ComputerSystem).Domain\n    CentralManagementServices = @()\n}\n\n# Check for centrally managed services\n$CentralServices = @(\n    @{Name='Windows Event Collector';Service='Wecsvc'},\n    @{Name='Windows Update';Service='wuauserv'},\n    @{Name='Group Policy Client';Service='gpsvc'},\n    @{Name='Windows Defender';Service='WinDefend'},\n    @{Name='Microsoft Monitoring Agent';Service='HealthService'}\n)\n\nforeach ($svc in $CentralServices) {\n    $serviceStatus = Get-Service -Name $svc.Service -ErrorAction SilentlyContinue\n    $Evidence.CentralManagementServices += @{\n        ServiceName = $svc.Name\n        Status = if ($serviceStatus) { $serviceStatus.Status.ToString() } else { 'Not Installed' }\n        StartType = if ($serviceStatus) { $serviceStatus.StartType.ToString() } else { 'N/A' }\n    }\n}\n\n# Export evidence as JSON\n$EvidenceFile = Join-Path $ComplianceDir \"CentralMgmtEvidence_$Date.json\"\n$Evidence | ConvertTo-Json -Depth 4 | Out-File -FilePath $EvidenceFile -Encoding UTF8\nWrite-Host \"[INFO] Central Management evidence collected: $EvidenceFile\" -ForegroundColor Green\n\n# Verify Group Policy application\n$GPOReport = Join-Path $ComplianceDir \"GPOReport_$Date.html\"\ntry {\n    gpresult /h $GPOReport /f\n    Write-Host \"[INFO] Group Policy report generated: $GPOReport\" -ForegroundColor Green\n} catch {\n    Write-Warning \"Could not generate GPO report: $_\"\n}\n\nWrite-Host \"`n[SUCCESS] PL-9 Central Management compliance documentation complete\" -ForegroundColor Cyan",
        "ansible": "---\n# PL-9: Central Management Configuration for Windows\n# Ansible playbook for Windows central management verification\n\n- name: PL-9 Central Management - Windows Configuration\n  hosts: windows\n  gather_facts: yes\n  vars:\n    compliance_dir: C:\\Compliance\\PL-9-Central-Management\n\n  tasks:\n    - name: Create central management compliance directory\n      ansible.windows.win_file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n\n    - name: Verify domain membership for centralized identity\n      ansible.windows.win_shell: |\n        $cs = Get-WmiObject Win32_ComputerSystem\n        @{\n          PartOfDomain = $cs.PartOfDomain\n          Domain = $cs.Domain\n          Hostname = $env:COMPUTERNAME\n        } | ConvertTo-Json\n      register: domain_status\n\n    - name: Display domain membership status\n      ansible.builtin.debug:\n        msg: \"{{ domain_status.stdout | from_json }}\"\n\n    - name: Ensure Windows Event Collector service is running\n      ansible.windows.win_service:\n        name: Wecsvc\n        start_mode: auto\n        state: started\n      ignore_errors: yes\n\n    - name: Ensure Group Policy Client is running\n      ansible.windows.win_service:\n        name: gpsvc\n        start_mode: auto\n        state: started\n\n    - name: Configure Windows Event Forwarding subscription\n      ansible.windows.win_shell: |\n        # Configure WEF to forward security events to central collector\n        wecutil qc /q\n      ignore_errors: yes\n\n    - name: Generate Group Policy compliance report\n      ansible.windows.win_shell: |\n        gpresult /h \"{{ compliance_dir }}\\GPOReport_$(Get-Date -Format 'yyyyMMdd').html\" /f\n        Write-Output \"GPO Report Generated\"\n      register: gpo_report\n\n    - name: Collect central management service status\n      ansible.windows.win_shell: |\n        $services = @('Wecsvc','wuauserv','gpsvc','WinDefend','HealthService')\n        $results = foreach ($svc in $services) {\n          $s = Get-Service -Name $svc -ErrorAction SilentlyContinue\n          [PSCustomObject]@{\n            Name = $svc\n            Status = if ($s) { $s.Status.ToString() } else { 'NotInstalled' }\n            StartType = if ($s) { $s.StartType.ToString() } else { 'N/A' }\n          }\n        }\n        $results | ConvertTo-Json\n      register: service_status\n\n    - name: Save central management evidence\n      ansible.windows.win_copy:\n        dest: \"{{ compliance_dir }}\\CentralMgmtEvidence_{{ ansible_date_time.date }}.json\"\n        content: |\n          {\n            \"control_id\": \"PL-9\",\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"hostname\": \"{{ ansible_hostname }}\",\n            \"domain_status\": {{ domain_status.stdout }},\n            \"services\": {{ service_status.stdout }}\n          }\n\n    - name: Verify centralized logging configuration\n      ansible.windows.win_shell: |\n        $wef = wecutil es 2>&1\n        if ($LASTEXITCODE -eq 0 -and $wef) {\n          Write-Output \"Windows Event Forwarding subscriptions found: $($wef -join ', ')\"\n        } else {\n          Write-Output \"No WEF subscriptions configured - central logging may not be active\"\n        }\n      register: wef_status\n\n    - name: Display WEF status\n      ansible.builtin.debug:\n        msg: \"{{ wef_status.stdout }}\""
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "nist_rev": "5",
      "enhancement_notes": "Comprehensive enhancement with central management policy templates and infrastructure verification scripts"
    }
  },
  {
    "control_id": "PL-10",
    "control_name": "Baseline Selection",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "Select a control baseline for the system.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "This control ensures organizations formally select an appropriate security control baseline as the foundation for their system's security posture. The baseline selection is based on the security categorization of the system (per FIPS 199/200) and provides a starting point for implementing security controls appropriate to the system's risk level.",
    "rationale": "A structured approach to baseline selection ensures that security investments are proportionate to system risk and that compliance requirements are clearly defined from project inception. Without formal baseline selection, organizations may over-engineer security for low-risk systems (wasting resources) or under-protect high-risk systems (accepting unacceptable risk). This NEW Rev 5 control formalizes what was implicit in earlier revisions.",
    "plain_english_explanation": "Baseline Selection is like choosing the right insurance package for your home. You would not buy hurricane insurance in a landlocked state, and you would not skip flood insurance in a flood zone. Similarly, your organization must choose a security control baseline that matches your system's importance and the sensitivity of its data. NIST provides three pre-defined baselines: Low, Moderate, and High. A payroll system handling sensitive employee data needs a different baseline than a public website showing office hours. This control, which is NEW in NIST SP 800-53 Rev 5, requires you to formally document which baseline applies to each system based on its security categorization.",
    "ai_guidance": "PL-10 Baseline Selection is a NEW control introduced in NIST SP 800-53 Revision 5, formalizing the critical first step in security control implementation. Organizations must complete security categorization per FIPS 199 before selecting a baseline. The categorization process evaluates potential impact to confidentiality, integrity, and availability if the system were compromised, resulting in a Low, Moderate, or High impact level. The baseline corresponding to this impact level becomes the system's starting point for security controls. Document the baseline selection in the System Security Plan (SSP), including the categorization rationale, the selected baseline, and any organizational factors that influenced the selection. Consider that organizations may have internal policies requiring higher baselines than FIPS would mandate (e.g., all systems handling customer data default to Moderate regardless of FIPS categorization). Use the NIST Cybersecurity Framework crosswalk to map baseline controls to organizational security objectives. Leverage automated tools like OSCAL (Open Security Controls Assessment Language) to formally encode baseline selections and enable automated compliance checking. Maintain an authoritative system inventory that links each system to its selected baseline. Review baseline selections annually or when system functionality, data sensitivity, or threat landscape significantly changes. Integration with Risk Management Framework (RMF) processes ensures baseline selection drives subsequent security activities including control implementation, assessment, and continuous monitoring.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PL-2",
      "PL-11",
      "RA-2",
      "RA-3",
      "PM-7",
      "SA-8",
      "CA-2",
      "CA-7"
    ],
    "supplemental_guidance": "Control baselines are predefined sets of controls that provide a starting point for the security and privacy plan for a system. Control baselines are selected based on the security categorization of systems (which in turn is based on the potential impact on organizations if there is a loss of confidentiality, integrity, or availability). The selection of control baselines is part of an organization-wide information security and privacy program and is guided by applicable laws, executive orders, directives, regulations, policies, standards, and guidelines. For federal information systems, the selection of control baselines is guided by FIPS 199, FIPS 200, and CNSSI 1253. Organizations may select different control baselines for different types of systems (e.g., national security systems). This control is new in Revision 5 of SP 800-53.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-10: Baseline Selection Documentation Generator\n# NEW IN NIST SP 800-53 Rev 5\n# Generates baseline selection documentation based on FIPS 199 categorization\n\nset -euo pipefail\n\nOUTPUT_DIR=\"/var/lib/compliance/pl-10-baseline-selection\"\nDATE=$(date +%Y-%m-%d)\nREPORT_FILE=\"${OUTPUT_DIR}/baseline_selection_report_${DATE}.md\"\n\nmkdir -p \"${OUTPUT_DIR}\"\n\n# Function to prompt for categorization (or accept parameters)\nget_categorization() {\n    local CONFIDENTIALITY=\"${1:-moderate}\"\n    local INTEGRITY=\"${2:-moderate}\"\n    local AVAILABILITY=\"${3:-moderate}\"\n    \n    # Determine high water mark (highest impact = baseline)\n    local BASELINE=\"low\"\n    for impact in \"$CONFIDENTIALITY\" \"$INTEGRITY\" \"$AVAILABILITY\"; do\n        case \"$impact\" in\n            high) BASELINE=\"high\"; break ;;\n            moderate) if [[ \"$BASELINE\" != \"high\" ]]; then BASELINE=\"moderate\"; fi ;;\n        esac\n    done\n    echo \"$BASELINE\"\n}\n\n# Get system information\nSYSTEM_NAME=\"${SYSTEM_NAME:-Production Web Application}\"\nSYSTEM_OWNER=\"${SYSTEM_OWNER:-IT Operations}\"\nCONFIDENTIALITY_IMPACT=\"${CONFIDENTIALITY_IMPACT:-moderate}\"\nINTEGRITY_IMPACT=\"${INTEGRITY_IMPACT:-moderate}\"\nAVAILABILITY_IMPACT=\"${AVAILABILITY_IMPACT:-low}\"\n\nSELECTED_BASELINE=$(get_categorization \"$CONFIDENTIALITY_IMPACT\" \"$INTEGRITY_IMPACT\" \"$AVAILABILITY_IMPACT\")\n\ncat > \"${REPORT_FILE}\" << EOF\n# Baseline Selection Documentation\n## NIST SP 800-53 Rev 5 Control PL-10\n### NEW IN REVISION 5\n\n---\n\n## Document Control\n- **Control ID:** PL-10\n- **Control Name:** Baseline Selection\n- **Generated:** $(date)\n- **System Name:** ${SYSTEM_NAME}\n- **System Owner:** ${SYSTEM_OWNER}\n\n---\n\n## Security Categorization (FIPS 199)\n\n### Impact Level Assessment\n\n| Security Objective | Impact Level | Justification |\n|--------------------|--------------|---------------|\n| **Confidentiality** | ${CONFIDENTIALITY_IMPACT^^} | Unauthorized disclosure impact assessment |\n| **Integrity** | ${INTEGRITY_IMPACT^^} | Unauthorized modification impact assessment |\n| **Availability** | ${AVAILABILITY_IMPACT^^} | Disruption of access impact assessment |\n\n### High Water Mark Calculation\nThe system security categorization is determined by the highest impact level\nacross all three security objectives (FIPS 200 methodology).\n\n**Result:** The system is categorized as **${SELECTED_BASELINE^^} IMPACT**\n\n---\n\n## Selected Control Baseline\n\n### Baseline: **${SELECTED_BASELINE^^}**\n\nBased on the security categorization results, the **${SELECTED_BASELINE^^}** control baseline\nfrom NIST SP 800-53 Rev 5 has been selected for this system.\n\n### Baseline Control Summary\nEOF\n\n# Add baseline-specific control counts\ncase \"$SELECTED_BASELINE\" in\n    low)\n        cat >> \"${REPORT_FILE}\" << 'EOF'\n| Control Family | Controls in LOW Baseline |\n|----------------|-------------------------|\n| Access Control (AC) | 12 controls |\n| Awareness & Training (AT) | 4 controls |\n| Audit & Accountability (AU) | 10 controls |\n| Assessment & Authorization (CA) | 7 controls |\n| Configuration Management (CM) | 9 controls |\n| Contingency Planning (CP) | 10 controls |\n| Identification & Authentication (IA) | 8 controls |\n| Incident Response (IR) | 8 controls |\n| Maintenance (MA) | 5 controls |\n| Media Protection (MP) | 6 controls |\n| Physical & Environmental (PE) | 10 controls |\n| Planning (PL) | 4 controls |\n| Program Management (PM) | 0 controls |\n| Personnel Security (PS) | 8 controls |\n| Risk Assessment (RA) | 5 controls |\n| System & Services Acquisition (SA) | 10 controls |\n| System & Communications Protection (SC) | 10 controls |\n| System & Information Integrity (SI) | 9 controls |\n\n**Total LOW Baseline Controls:** ~125 controls\nEOF\n        ;;\n    moderate)\n        cat >> \"${REPORT_FILE}\" << 'EOF'\n| Control Family | Controls in MODERATE Baseline |\n|----------------|------------------------------|\n| Access Control (AC) | 22 controls |\n| Awareness & Training (AT) | 5 controls |\n| Audit & Accountability (AU) | 14 controls |\n| Assessment & Authorization (CA) | 9 controls |\n| Configuration Management (CM) | 12 controls |\n| Contingency Planning (CP) | 12 controls |\n| Identification & Authentication (IA) | 12 controls |\n| Incident Response (IR) | 9 controls |\n| Maintenance (MA) | 6 controls |\n| Media Protection (MP) | 8 controls |\n| Physical & Environmental (PE) | 17 controls |\n| Planning (PL) | 5 controls |\n| Program Management (PM) | 0 controls |\n| Personnel Security (PS) | 8 controls |\n| Risk Assessment (RA) | 6 controls |\n| System & Services Acquisition (SA) | 16 controls |\n| System & Communications Protection (SC) | 22 controls |\n| System & Information Integrity (SI) | 14 controls |\n\n**Total MODERATE Baseline Controls:** ~197 controls\nEOF\n        ;;\n    high)\n        cat >> \"${REPORT_FILE}\" << 'EOF'\n| Control Family | Controls in HIGH Baseline |\n|----------------|-------------------------|\n| Access Control (AC) | 25 controls |\n| Awareness & Training (AT) | 6 controls |\n| Audit & Accountability (AU) | 16 controls |\n| Assessment & Authorization (CA) | 10 controls |\n| Configuration Management (CM) | 14 controls |\n| Contingency Planning (CP) | 13 controls |\n| Identification & Authentication (IA) | 13 controls |\n| Incident Response (IR) | 10 controls |\n| Maintenance (MA) | 7 controls |\n| Media Protection (MP) | 8 controls |\n| Physical & Environmental (PE) | 20 controls |\n| Planning (PL) | 6 controls |\n| Program Management (PM) | 0 controls |\n| Personnel Security (PS) | 8 controls |\n| Risk Assessment (RA) | 7 controls |\n| System & Services Acquisition (SA) | 21 controls |\n| System & Communications Protection (SC) | 33 controls |\n| System & Information Integrity (SI) | 17 controls |\n\n**Total HIGH Baseline Controls:** ~234 controls\nEOF\n        ;;\nesac\n\ncat >> \"${REPORT_FILE}\" << 'EOF'\n\n---\n\n## Authorization and Approval\n\n### Baseline Selection Approval\n\n| Role | Name | Date | Signature |\n|------|------|------|-----------|\n| System Owner | _________________ | _________ | _________ |\n| ISSO | _________________ | _________ | _________ |\n| Authorizing Official | _________________ | _________ | _________ |\n\n### Review Schedule\n- **Annual Review:** Baseline selection reviewed annually\n- **Trigger Events:** Re-evaluate upon significant system changes, \n  data sensitivity changes, or updated threat assessments\n\n---\n\n## References\n- NIST SP 800-53 Rev 5, Control PL-10 (NEW)\n- FIPS 199: Standards for Security Categorization\n- FIPS 200: Minimum Security Requirements\n- NIST SP 800-60: Guide for Mapping Types of Information\nEOF\n\necho \"[INFO] Baseline Selection report generated: ${REPORT_FILE}\"\n\n# Generate machine-readable baseline selection record\nBASELINE_JSON=\"${OUTPUT_DIR}/baseline_selection.json\"\ncat > \"${BASELINE_JSON}\" << EOF\n{\n  \"control_id\": \"PL-10\",\n  \"control_name\": \"Baseline Selection\",\n  \"nist_revision\": \"5\",\n  \"new_in_rev5\": true,\n  \"generated\": \"$(date -Iseconds)\",\n  \"system\": {\n    \"name\": \"${SYSTEM_NAME}\",\n    \"owner\": \"${SYSTEM_OWNER}\"\n  },\n  \"security_categorization\": {\n    \"standard\": \"FIPS 199\",\n    \"confidentiality\": \"${CONFIDENTIALITY_IMPACT}\",\n    \"integrity\": \"${INTEGRITY_IMPACT}\",\n    \"availability\": \"${AVAILABILITY_IMPACT}\",\n    \"overall_impact\": \"${SELECTED_BASELINE}\"\n  },\n  \"selected_baseline\": {\n    \"name\": \"${SELECTED_BASELINE^^}\",\n    \"source\": \"NIST SP 800-53 Rev 5\",\n    \"selection_method\": \"FIPS 200 High Water Mark\"\n  },\n  \"next_review\": \"$(date -d '+1 year' +%Y-%m-%d 2>/dev/null || date -v+1y +%Y-%m-%d 2>/dev/null || echo 'See annual review schedule')\"\n}\nEOF\n\necho \"[INFO] Baseline selection JSON generated: ${BASELINE_JSON}\"\necho \"[SUCCESS] PL-10 Baseline Selection documentation complete\"",
        "ansible": "---\n# PL-10: Baseline Selection Configuration\n# NEW IN NIST SP 800-53 Rev 5\n# Ansible playbook for baseline selection documentation\n\n- name: PL-10 Baseline Selection Documentation\n  hosts: all\n  become: yes\n  vars:\n    compliance_dir: /var/lib/compliance/pl-10-baseline-selection\n    system_name: \"{{ inventory_hostname }}\"\n    system_owner: \"IT Operations\"\n    # FIPS 199 categorization - customize per system\n    confidentiality_impact: moderate\n    integrity_impact: moderate\n    availability_impact: low\n\n  tasks:\n    - name: Create baseline selection compliance directory\n      ansible.builtin.file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n        mode: '0750'\n        owner: root\n        group: security\n\n    - name: Calculate baseline from categorization (high water mark)\n      ansible.builtin.set_fact:\n        selected_baseline: >-\n          {% if confidentiality_impact == 'high' or integrity_impact == 'high' or availability_impact == 'high' %}\n          high\n          {% elif confidentiality_impact == 'moderate' or integrity_impact == 'moderate' or availability_impact == 'moderate' %}\n          moderate\n          {% else %}\n          low\n          {% endif %}\n\n    - name: Display selected baseline\n      ansible.builtin.debug:\n        msg: |\n          PL-10 Baseline Selection (NEW in Rev 5)\n          System: {{ system_name }}\n          Categorization: C={{ confidentiality_impact }}, I={{ integrity_impact }}, A={{ availability_impact }}\n          Selected Baseline: {{ selected_baseline | trim | upper }}\n\n    - name: Generate baseline selection JSON record\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/baseline_selection.json\"\n        mode: '0640'\n        content: |\n          {\n            \"control_id\": \"PL-10\",\n            \"control_name\": \"Baseline Selection\",\n            \"new_in_rev5\": true,\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"system\": {\n              \"name\": \"{{ system_name }}\",\n              \"hostname\": \"{{ ansible_hostname }}\",\n              \"owner\": \"{{ system_owner }}\"\n            },\n            \"security_categorization\": {\n              \"standard\": \"FIPS 199\",\n              \"confidentiality\": \"{{ confidentiality_impact }}\",\n              \"integrity\": \"{{ integrity_impact }}\",\n              \"availability\": \"{{ availability_impact }}\"\n            },\n            \"selected_baseline\": {\n              \"name\": \"{{ selected_baseline | trim | upper }}\",\n              \"source\": \"NIST SP 800-53 Rev 5\"\n            }\n          }\n\n    - name: Create baseline selection summary report\n      ansible.builtin.template:\n        src: templates/pl10_baseline_selection.md.j2\n        dest: \"{{ compliance_dir }}/baseline_selection_report.md\"\n        mode: '0640'\n      vars:\n        baseline: \"{{ selected_baseline | trim }}\"\n\n    - name: Tag system with baseline in inventory metadata\n      ansible.builtin.lineinfile:\n        path: \"{{ compliance_dir }}/system_baseline.conf\"\n        line: \"NIST_BASELINE={{ selected_baseline | trim | upper }}\"\n        create: yes\n        mode: '0644'\n\n    - name: Log baseline selection for audit trail\n      ansible.builtin.lineinfile:\n        path: \"{{ compliance_dir }}/baseline_selection_audit.log\"\n        line: \"{{ ansible_date_time.iso8601 }} - Baseline {{ selected_baseline | trim | upper }} selected for {{ system_name }} (C={{ confidentiality_impact }}, I={{ integrity_impact }}, A={{ availability_impact }})\"\n        create: yes\n        mode: '0640'"
      },
      "windows": {
        "powershell": "# PL-10: Baseline Selection Documentation Generator for Windows\n# NEW IN NIST SP 800-53 Rev 5\n# Generates baseline selection documentation based on FIPS 199 categorization\n\n#Requires -Version 5.1\n\nparam(\n    [string]$SystemName = $env:COMPUTERNAME,\n    [string]$SystemOwner = \"IT Operations\",\n    [ValidateSet('low','moderate','high')]\n    [string]$ConfidentialityImpact = 'moderate',\n    [ValidateSet('low','moderate','high')]\n    [string]$IntegrityImpact = 'moderate',\n    [ValidateSet('low','moderate','high')]\n    [string]$AvailabilityImpact = 'low'\n)\n\n$ErrorActionPreference = 'Stop'\n\n$ComplianceDir = \"C:\\Compliance\\PL-10-Baseline-Selection\"\n$Date = Get-Date -Format 'yyyy-MM-dd'\n\n# Create compliance directory\nif (-not (Test-Path $ComplianceDir)) {\n    New-Item -ItemType Directory -Path $ComplianceDir -Force | Out-Null\n}\n\n# Function to determine baseline using FIPS 200 high water mark\nfunction Get-SelectedBaseline {\n    param([string]$C, [string]$I, [string]$A)\n    \n    if ($C -eq 'high' -or $I -eq 'high' -or $A -eq 'high') {\n        return 'HIGH'\n    } elseif ($C -eq 'moderate' -or $I -eq 'moderate' -or $A -eq 'moderate') {\n        return 'MODERATE'\n    } else {\n        return 'LOW'\n    }\n}\n\n$SelectedBaseline = Get-SelectedBaseline -C $ConfidentialityImpact -I $IntegrityImpact -A $AvailabilityImpact\n\nWrite-Host \"`n============================================\" -ForegroundColor Cyan\nWrite-Host \"PL-10: Baseline Selection (NEW in Rev 5)\" -ForegroundColor Cyan\nWrite-Host \"============================================`n\" -ForegroundColor Cyan\n\nWrite-Host \"System: $SystemName\" -ForegroundColor White\nWrite-Host \"Categorization: C=$($ConfidentialityImpact.ToUpper()), I=$($IntegrityImpact.ToUpper()), A=$($AvailabilityImpact.ToUpper())\" -ForegroundColor White\nWrite-Host \"Selected Baseline: $SelectedBaseline\" -ForegroundColor Green\n\n# Generate baseline selection report\n$ReportContent = @\"\n# Baseline Selection Documentation\n## NIST SP 800-53 Rev 5 Control PL-10\n### NEW IN REVISION 5\n\n---\n\n## Document Control\n- **Control ID:** PL-10\n- **Control Name:** Baseline Selection  \n- **Generated:** $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\n- **System Name:** $SystemName\n- **System Owner:** $SystemOwner\n\n---\n\n## Security Categorization (FIPS 199)\n\n### Impact Level Assessment\n\n| Security Objective | Impact Level | Justification |\n|--------------------|--------------|---------------|\n| **Confidentiality** | $($ConfidentialityImpact.ToUpper()) | Unauthorized disclosure impact assessment |\n| **Integrity** | $($IntegrityImpact.ToUpper()) | Unauthorized modification impact assessment |\n| **Availability** | $($AvailabilityImpact.ToUpper()) | Disruption of access impact assessment |\n\n### High Water Mark Calculation\nThe system security categorization is determined by the highest impact level\nacross all three security objectives (FIPS 200 methodology).\n\n**Result:** The system is categorized as **$SelectedBaseline IMPACT**\n\n---\n\n## Selected Control Baseline\n\n### Baseline: **$SelectedBaseline**\n\nBased on the security categorization results, the **$SelectedBaseline** control baseline\nfrom NIST SP 800-53 Rev 5 has been selected for this system.\n\n### Why This Matters\nPL-10 is a **NEW control in NIST SP 800-53 Revision 5**. It formalizes the requirement\nto explicitly select and document a control baseline before implementing security controls.\nThis ensures security investments are proportionate to system risk.\n\n---\n\n## Windows-Specific Baseline Implementation\n\nFor Windows systems at the **$SelectedBaseline** baseline, consider:\n\n### Recommended Security Configurations\n\"@\n\nswitch ($SelectedBaseline) {\n    'LOW' {\n        $ReportContent += @\"\n\n- Windows Defender enabled with real-time protection\n- Windows Firewall enabled for all profiles\n- Automatic Windows Updates enabled\n- Basic audit policy configured\n- Standard user accounts (non-admin) for daily use\n- BitLocker optional but recommended\n\"@\n    }\n    'MODERATE' {\n        $ReportContent += @\"\n\n- All LOW baseline requirements, plus:\n- BitLocker encryption required\n- Enhanced audit policy (detailed tracking)\n- AppLocker or WDAC for application control\n- Credential Guard enabled\n- Windows Event Forwarding to SIEM\n- LAPS for local administrator passwords\n- SMB signing required\n\"@\n    }\n    'HIGH' {\n        $ReportContent += @\"\n\n- All MODERATE baseline requirements, plus:\n- Device Guard with strict WDAC policies\n- Virtualization-based security (VBS)\n- Attack Surface Reduction rules enforced\n- Network isolation and microsegmentation\n- Hardware security module integration\n- Privileged Access Workstations (PAW) for administration\n- Enhanced monitoring with EDR solution\n\"@\n    }\n}\n\n$ReportContent += @\"\n\n---\n\n## References\n- NIST SP 800-53 Rev 5, Control PL-10 (NEW)\n- FIPS 199: Standards for Security Categorization\n- FIPS 200: Minimum Security Requirements\n- Microsoft Security Baseline for Windows\n\"@\n\n$ReportFile = Join-Path $ComplianceDir \"BaselineSelectionReport_$Date.md\"\n$ReportContent | Out-File -FilePath $ReportFile -Encoding UTF8\nWrite-Host \"`n[INFO] Baseline Selection report generated: $ReportFile\" -ForegroundColor Green\n\n# Generate JSON record\n$BaselineRecord = @{\n    control_id = 'PL-10'\n    control_name = 'Baseline Selection'\n    new_in_rev5 = $true\n    generated = (Get-Date -Format 'o')\n    system = @{\n        name = $SystemName\n        hostname = $env:COMPUTERNAME\n        owner = $SystemOwner\n    }\n    security_categorization = @{\n        standard = 'FIPS 199'\n        confidentiality = $ConfidentialityImpact\n        integrity = $IntegrityImpact\n        availability = $AvailabilityImpact\n    }\n    selected_baseline = @{\n        name = $SelectedBaseline\n        source = 'NIST SP 800-53 Rev 5'\n        selection_method = 'FIPS 200 High Water Mark'\n    }\n    next_review = (Get-Date).AddYears(1).ToString('yyyy-MM-dd')\n}\n\n$JsonFile = Join-Path $ComplianceDir \"baseline_selection.json\"\n$BaselineRecord | ConvertTo-Json -Depth 4 | Out-File -FilePath $JsonFile -Encoding UTF8\nWrite-Host \"[INFO] Baseline selection JSON generated: $JsonFile\" -ForegroundColor Green\n\nWrite-Host \"`n[SUCCESS] PL-10 Baseline Selection documentation complete\" -ForegroundColor Cyan",
        "ansible": "---\n# PL-10: Baseline Selection for Windows\n# NEW IN NIST SP 800-53 Rev 5\n# Ansible playbook for Windows baseline selection documentation\n\n- name: PL-10 Baseline Selection - Windows\n  hosts: windows\n  gather_facts: yes\n  vars:\n    compliance_dir: C:\\Compliance\\PL-10-Baseline-Selection\n    system_owner: \"IT Operations\"\n    # FIPS 199 categorization - customize per system\n    confidentiality_impact: moderate\n    integrity_impact: moderate  \n    availability_impact: low\n\n  tasks:\n    - name: Create baseline selection compliance directory\n      ansible.windows.win_file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n\n    - name: Calculate baseline using FIPS 200 high water mark\n      ansible.builtin.set_fact:\n        selected_baseline: >-\n          {% if confidentiality_impact == 'high' or integrity_impact == 'high' or availability_impact == 'high' %}\n          HIGH\n          {% elif confidentiality_impact == 'moderate' or integrity_impact == 'moderate' or availability_impact == 'moderate' %}\n          MODERATE\n          {% else %}\n          LOW\n          {% endif %}\n\n    - name: Display baseline selection result\n      ansible.builtin.debug:\n        msg: |\n          ===============================================\n          PL-10 Baseline Selection (NEW in Rev 5)\n          ===============================================\n          System: {{ ansible_hostname }}\n          Categorization: C={{ confidentiality_impact | upper }}, I={{ integrity_impact | upper }}, A={{ availability_impact | upper }}\n          Selected Baseline: {{ selected_baseline | trim }}\n          ===============================================\n\n    - name: Generate baseline selection JSON\n      ansible.windows.win_copy:\n        dest: \"{{ compliance_dir }}\\\\baseline_selection.json\"\n        content: |\n          {\n            \"control_id\": \"PL-10\",\n            \"control_name\": \"Baseline Selection\",\n            \"new_in_rev5\": true,\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"system\": {\n              \"name\": \"{{ ansible_hostname }}\",\n              \"fqdn\": \"{{ ansible_fqdn }}\",\n              \"owner\": \"{{ system_owner }}\"\n            },\n            \"security_categorization\": {\n              \"standard\": \"FIPS 199\",\n              \"confidentiality\": \"{{ confidentiality_impact }}\",\n              \"integrity\": \"{{ integrity_impact }}\",\n              \"availability\": \"{{ availability_impact }}\"\n            },\n            \"selected_baseline\": {\n              \"name\": \"{{ selected_baseline | trim }}\",\n              \"source\": \"NIST SP 800-53 Rev 5\"\n            }\n          }\n\n    - name: Set system baseline environment variable\n      ansible.windows.win_environment:\n        name: NIST_BASELINE\n        value: \"{{ selected_baseline | trim }}\"\n        level: machine\n        state: present\n\n    - name: Log baseline selection to Windows Event Log\n      ansible.windows.win_shell: |\n        $params = @{\n          LogName = 'Application'\n          Source = 'NIST-Compliance'\n          EventId = 10\n          EntryType = 'Information'\n          Message = \"PL-10 Baseline Selection: {{ selected_baseline | trim }} baseline selected for {{ ansible_hostname }}\"\n        }\n        # Create source if not exists\n        if (-not [System.Diagnostics.EventLog]::SourceExists('NIST-Compliance')) {\n          New-EventLog -LogName Application -Source 'NIST-Compliance'\n        }\n        Write-EventLog @params\n      ignore_errors: yes"
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "nist_rev": "5",
      "new_in_rev5": true,
      "enhancement_notes": "NEW IN REV 5 - Comprehensive baseline selection documentation with FIPS 199/200 categorization support"
    }
  },
  {
    "control_id": "PL-11",
    "control_name": "Baseline Tailoring",
    "family": "Planning",
    "family_id": "PL",
    "official_text": "Tailor the selected control baseline by applying specified tailoring actions.",
    "source": "NIST SP 800-53 Rev 5",
    "baselines": {
      "low": true,
      "moderate": true,
      "high": true
    },
    "intent": "This control ensures organizations systematically customize their selected security control baseline to address unique operational requirements, threats, and constraints. Tailoring transforms a generic baseline into a system-specific security control set that is both effective and efficient for the organization's particular context.",
    "rationale": "No two organizations operate identically, and no generic baseline perfectly fits every system. Tailoring allows organizations to add controls for unique threats, remove inapplicable controls with proper justification, adjust control parameters to organizational needs, and substitute equivalent controls when necessary. This NEW Rev 5 control formalizes the tailoring process to ensure modifications are documented, justified, and reviewed rather than ad hoc.",
    "plain_english_explanation": "Baseline Tailoring is like customizing a suit that comes in standard sizes. A baseline gives you a solid starting point, but every organization has unique needs. Maybe you operate in a high-threat environment and need additional controls. Perhaps some controls do not apply because you do not use certain technologies. Maybe you have a legacy system that cannot support a specific control but can implement an equivalent alternative. Tailoring lets you make these adjustments formally and with proper documentation. This is a NEW control in NIST SP 800-53 Rev 5, and it requires you to document every modification you make to the baseline, including why you made it, what risk-based rationale supports the change, and what compensating measures exist if you remove or weaken a control.",
    "ai_guidance": "PL-11 Baseline Tailoring is a NEW control in NIST SP 800-53 Revision 5 that formalizes the process of customizing security control baselines. Tailoring activities include: (1) Identifying and designating common controls provided by the organization or external providers; (2) Applying scoping considerations to eliminate controls that are not applicable to the system based on technology, infrastructure, or operational factors; (3) Selecting compensating controls when baseline controls cannot be implemented as specified; (4) Assigning organization-defined parameters to controls that have variable elements; (5) Supplementing baselines with additional controls based on threat assessments, vulnerability analyses, or mission requirements; (6) Providing specification information for control implementation. Organizations should document all tailoring decisions in the System Security Plan (SSP) or a dedicated Tailoring Appendix. Each tailoring action must include: the original baseline control, the tailoring action taken (scope out, substitute, compensate, supplement, or parameter assignment), the risk-based rationale for the decision, approval authority, and any residual risk accepted. Use OSCAL (Open Security Controls Assessment Language) to formally encode tailoring decisions for automated processing and continuous monitoring. Establish a Tailoring Review Board or equivalent governance body to review and approve significant tailoring decisions. Review tailoring decisions annually or when operational conditions, threat landscape, or organizational risk tolerance changes. Tailoring should be an ongoing activity as systems evolve, not a one-time exercise.",
    "is_technical": false,
    "enhancements": [],
    "related_controls": [
      "PL-2",
      "PL-10",
      "RA-2",
      "RA-3",
      "RA-9",
      "PM-7",
      "SA-8",
      "CA-2",
      "CA-7"
    ],
    "supplemental_guidance": "Tailoring actions include identifying and designating common controls, applying scoping considerations, selecting compensating controls, assigning values to organization-defined control parameters, supplementing baselines with additional controls, and providing additional information for control implementation. Tailoring a control baseline is accomplished by identifying and designating common controls from the control baseline that are provided by an external entity; applying scoping considerations to the control baseline; selecting compensating controls; assigning organization-defined values to control parameters; supplementing the control baseline with additional controls or control enhancements; and providing additional specification information for control implementation. This control is new in Revision 5 of SP 800-53.",
    "implementation_scripts": {
      "linux": {
        "bash": "#!/bin/bash\n# PL-11: Baseline Tailoring Documentation Generator\n# NEW IN NIST SP 800-53 Rev 5\n# Generates baseline tailoring documentation and tracking\n\nset -euo pipefail\n\nOUTPUT_DIR=\"/var/lib/compliance/pl-11-baseline-tailoring\"\nDATE=$(date +%Y-%m-%d)\nREPORT_FILE=\"${OUTPUT_DIR}/baseline_tailoring_report_${DATE}.md\"\n\nmkdir -p \"${OUTPUT_DIR}\"\n\n# System baseline (should come from PL-10)\nSYSTEM_NAME=\"${SYSTEM_NAME:-Production Web Application}\"\nSELECTED_BASELINE=\"${SELECTED_BASELINE:-MODERATE}\"\n\ncat > \"${REPORT_FILE}\" << EOF\n# Baseline Tailoring Documentation\n## NIST SP 800-53 Rev 5 Control PL-11\n### NEW IN REVISION 5\n\n---\n\n## Document Control\n- **Control ID:** PL-11\n- **Control Name:** Baseline Tailoring\n- **Generated:** $(date)\n- **System Name:** ${SYSTEM_NAME}\n- **Selected Baseline:** ${SELECTED_BASELINE}\n\n---\n\n## Purpose\n\nThis document records all tailoring actions applied to the ${SELECTED_BASELINE} control baseline\nfor ${SYSTEM_NAME}. PL-11 is a **NEW control in NIST SP 800-53 Revision 5** that formalizes\nthe requirement to document baseline customizations.\n\n---\n\n## Tailoring Actions\n\nThe following tailoring action types are used:\n\n| Action Type | Description |\n|-------------|-------------|\n| **SCOPE OUT** | Control not applicable due to technology/operational factors |\n| **COMMON CONTROL** | Control provided by external provider or inherited |\n| **COMPENSATE** | Substitute control implemented due to constraints |\n| **SUPPLEMENT** | Additional control added beyond baseline |\n| **PARAMETER** | Organization-defined parameter value assigned |\n\n---\n\n## Tailoring Register\n\n### Scoped Out Controls\n\n| Control ID | Control Name | Reason | Risk Accepted | Approver |\n|------------|--------------|--------|---------------|----------|\n| MP-4 | Media Storage | No removable media used | Low | ISSO |\n| MP-5 | Media Transport | No physical media transport | Low | ISSO |\n| PE-4 | Access Control for Transmission | Cloud-hosted, no physical access | N/A | ISSO |\n\n### Common Controls (Inherited)\n\n| Control ID | Control Name | Provider | Evidence Location |\n|------------|--------------|----------|-------------------|\n| PE-2 | Physical Access Authorizations | Datacenter Provider | SOC 2 Report |\n| PE-3 | Physical Access Control | Datacenter Provider | SOC 2 Report |\n| PE-6 | Monitoring Physical Access | Datacenter Provider | SOC 2 Report |\n| PS-1 | Personnel Security Policy | Corporate HR | HR Policy Manual |\n\n### Compensating Controls\n\n| Baseline Control | Compensating Control | Justification |\n|------------------|---------------------|---------------|\n| AC-2(5) Inactivity Logout | Session timeout + screen lock | Legacy app limitation |\n| AU-9 Protection of Audit Info | Read-only log shipping to SIEM | No local storage available |\n\n### Supplemental Controls (Beyond Baseline)\n\n| Control ID | Control Name | Justification |\n|------------|--------------|---------------|\n| SI-4(5) | System-Generated Alerts | High-value target threat model |\n| SC-7(8) | Route Traffic to Proxy | Enhanced network monitoring required |\n| AU-10 | Non-Repudiation | Regulatory requirement |\n\n### Parameter Assignments\n\n| Control ID | Parameter | Assigned Value | Rationale |\n|------------|-----------|----------------|----------|\n| AC-2.d | Time period for account inactivity | 90 days | Industry standard |\n| AC-7.a | Number of invalid logon attempts | 5 attempts | Balance security/usability |\n| AC-7.b | Time period for lockout | 30 minutes | Automated unlock |\n| AC-11.a | Inactivity period for session lock | 15 minutes | STIG alignment |\n| AU-11 | Audit record retention period | 1 year | Legal requirement |\n| SI-2.d | Flaw remediation timeframes | Critical:7d, High:30d, Med:90d | Risk-based |\n\n---\n\n## Tailoring Governance\n\n### Review and Approval Process\n\n1. System Owner proposes tailoring action with justification\n2. ISSO reviews for technical validity and risk implications\n3. Security Control Assessor validates compensating controls\n4. Authorizing Official approves with any conditions\n5. Tailoring documented in SSP and this register\n\n### Tailoring Review Schedule\n\n- **Quarterly**: Review parameter assignments for continued appropriateness\n- **Annually**: Full tailoring register review\n- **Event-Driven**: Review upon significant system changes, new threats, or audit findings\n\n---\n\n## Approval\n\n| Role | Name | Date | Signature |\n|------|------|------|-----------|\n| System Owner | _________________ | _________ | _________ |\n| ISSO | _________________ | _________ | _________ |\n| Authorizing Official | _________________ | _________ | _________ |\n\n---\n\n## References\n\n- NIST SP 800-53 Rev 5, Control PL-11 (NEW)\n- NIST SP 800-53B, Control Baselines\n- NIST SP 800-37, Risk Management Framework\n- Organization Tailoring Policy [Reference]\nEOF\n\necho \"[INFO] Baseline Tailoring report generated: ${REPORT_FILE}\"\n\n# Generate machine-readable tailoring record\nTAILORING_JSON=\"${OUTPUT_DIR}/baseline_tailoring.json\"\ncat > \"${TAILORING_JSON}\" << 'EOF'\n{\n  \"control_id\": \"PL-11\",\n  \"control_name\": \"Baseline Tailoring\",\n  \"nist_revision\": \"5\",\n  \"new_in_rev5\": true,\n  \"generated\": \"$(date -Iseconds)\",\n  \"baseline\": \"MODERATE\",\n  \"tailoring_actions\": {\n    \"scoped_out\": [\n      {\n        \"control_id\": \"MP-4\",\n        \"reason\": \"No removable media used in system\",\n        \"risk_accepted\": \"low\",\n        \"approved_by\": \"ISSO\"\n      },\n      {\n        \"control_id\": \"MP-5\", \n        \"reason\": \"No physical media transport occurs\",\n        \"risk_accepted\": \"low\",\n        \"approved_by\": \"ISSO\"\n      }\n    ],\n    \"common_controls\": [\n      {\n        \"control_id\": \"PE-2\",\n        \"provider\": \"Datacenter Provider\",\n        \"evidence\": \"SOC 2 Type II Report\"\n      },\n      {\n        \"control_id\": \"PE-3\",\n        \"provider\": \"Datacenter Provider\", \n        \"evidence\": \"SOC 2 Type II Report\"\n      }\n    ],\n    \"compensating_controls\": [\n      {\n        \"baseline_control\": \"AC-2(5)\",\n        \"compensating_control\": \"Session timeout with screen lock\",\n        \"justification\": \"Legacy application limitation\"\n      }\n    ],\n    \"supplemental_controls\": [\n      {\n        \"control_id\": \"SI-4(5)\",\n        \"justification\": \"High-value target in threat model\"\n      },\n      {\n        \"control_id\": \"AU-10\",\n        \"justification\": \"Regulatory requirement for non-repudiation\"\n      }\n    ],\n    \"parameters\": [\n      {\n        \"control_id\": \"AC-7.a\",\n        \"parameter\": \"consecutive_invalid_attempts\",\n        \"value\": \"5\",\n        \"rationale\": \"Balance security and usability\"\n      },\n      {\n        \"control_id\": \"AU-11\",\n        \"parameter\": \"retention_period\",\n        \"value\": \"1 year\",\n        \"rationale\": \"Legal retention requirement\"\n      }\n    ]\n  },\n  \"next_review\": \"$(date -d '+1 year' +%Y-%m-%d 2>/dev/null || echo 'Annual')\"\n}\nEOF\n\necho \"[INFO] Baseline tailoring JSON generated: ${TAILORING_JSON}\"\n\n# Create tailoring tracking spreadsheet (CSV)\nTAILORING_CSV=\"${OUTPUT_DIR}/tailoring_register.csv\"\ncat > \"${TAILORING_CSV}\" << 'EOF'\nControl ID,Control Name,Action Type,Details,Justification,Risk Level,Approver,Approval Date,Review Date\nMP-4,Media Storage,SCOPE_OUT,Not applicable,No removable media used,Low,ISSO,2025-01-15,2026-01-15\nMP-5,Media Transport,SCOPE_OUT,Not applicable,No physical transport,Low,ISSO,2025-01-15,2026-01-15\nPE-2,Physical Access Auth,COMMON,Datacenter Provider,Inherited from provider,N/A,ISSO,2025-01-15,2026-01-15\nPE-3,Physical Access Control,COMMON,Datacenter Provider,Inherited from provider,N/A,ISSO,2025-01-15,2026-01-15\nAC-2(5),Inactivity Logout,COMPENSATE,Session timeout + screen lock,Legacy system limitation,Medium,ISSO,2025-01-15,2025-07-15\nSI-4(5),System Alerts,SUPPLEMENT,Added control,High-value target,N/A,AO,2025-01-15,2026-01-15\nAC-7.a,Invalid Logons,PARAMETER,5 attempts,Balance security/usability,N/A,ISSO,2025-01-15,2025-07-15\nAU-11,Audit Retention,PARAMETER,1 year,Legal requirement,N/A,ISSO,2025-01-15,2026-01-15\nEOF\n\necho \"[INFO] Tailoring register CSV generated: ${TAILORING_CSV}\"\necho \"[SUCCESS] PL-11 Baseline Tailoring documentation complete\"",
        "ansible": "---\n# PL-11: Baseline Tailoring Configuration\n# NEW IN NIST SP 800-53 Rev 5\n# Ansible playbook for baseline tailoring documentation\n\n- name: PL-11 Baseline Tailoring Documentation\n  hosts: all\n  become: yes\n  vars:\n    compliance_dir: /var/lib/compliance/pl-11-baseline-tailoring\n    system_name: \"{{ inventory_hostname }}\"\n    selected_baseline: \"MODERATE\"\n    \n    # Define tailoring actions for this system\n    scoped_out_controls:\n      - control_id: MP-4\n        reason: \"No removable media used\"\n        risk: low\n      - control_id: MP-5\n        reason: \"No physical media transport\"\n        risk: low\n    \n    common_controls:\n      - control_id: PE-2\n        provider: \"Datacenter Provider\"\n      - control_id: PE-3\n        provider: \"Datacenter Provider\"\n    \n    supplemental_controls:\n      - control_id: SI-4(5)\n        justification: \"High-value target threat model\"\n      - control_id: AU-10\n        justification: \"Regulatory requirement\"\n    \n    parameter_assignments:\n      - control_id: AC-7.a\n        parameter: consecutive_invalid_attempts\n        value: \"5\"\n      - control_id: AU-11\n        parameter: retention_period\n        value: \"1 year\"\n\n  tasks:\n    - name: Create baseline tailoring compliance directory\n      ansible.builtin.file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n        mode: '0750'\n        owner: root\n        group: security\n\n    - name: Generate tailoring register JSON\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/tailoring_register.json\"\n        mode: '0640'\n        content: |\n          {\n            \"control_id\": \"PL-11\",\n            \"control_name\": \"Baseline Tailoring\",\n            \"new_in_rev5\": true,\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"system\": \"{{ system_name }}\",\n            \"baseline\": \"{{ selected_baseline }}\",\n            \"tailoring_actions\": {\n              \"scoped_out\": {{ scoped_out_controls | to_json }},\n              \"common_controls\": {{ common_controls | to_json }},\n              \"supplemental_controls\": {{ supplemental_controls | to_json }},\n              \"parameter_assignments\": {{ parameter_assignments | to_json }}\n            }\n          }\n\n    - name: Generate tailoring summary report\n      ansible.builtin.template:\n        src: templates/pl11_tailoring_report.md.j2\n        dest: \"{{ compliance_dir }}/tailoring_report_{{ ansible_date_time.date }}.md\"\n        mode: '0640'\n\n    - name: Create tailoring register CSV for tracking\n      ansible.builtin.copy:\n        dest: \"{{ compliance_dir }}/tailoring_register.csv\"\n        mode: '0640'\n        content: |\n          Control ID,Action Type,Details,Justification,Approval Date\n          {% for ctrl in scoped_out_controls %}\n          {{ ctrl.control_id }},SCOPE_OUT,Not applicable,{{ ctrl.reason }},{{ ansible_date_time.date }}\n          {% endfor %}\n          {% for ctrl in common_controls %}\n          {{ ctrl.control_id }},COMMON,{{ ctrl.provider }},Inherited from provider,{{ ansible_date_time.date }}\n          {% endfor %}\n          {% for ctrl in supplemental_controls %}\n          {{ ctrl.control_id }},SUPPLEMENT,Added control,{{ ctrl.justification }},{{ ansible_date_time.date }}\n          {% endfor %}\n          {% for param in parameter_assignments %}\n          {{ param.control_id }},PARAMETER,{{ param.value }},{{ param.parameter }},{{ ansible_date_time.date }}\n          {% endfor %}\n\n    - name: Display tailoring summary\n      ansible.builtin.debug:\n        msg: |\n          ===============================================\n          PL-11 Baseline Tailoring Summary (NEW in Rev 5)\n          ===============================================\n          System: {{ system_name }}\n          Baseline: {{ selected_baseline }}\n          \n          Tailoring Actions:\n          - Controls Scoped Out: {{ scoped_out_controls | length }}\n          - Common Controls: {{ common_controls | length }}\n          - Supplemental Controls: {{ supplemental_controls | length }}\n          - Parameters Assigned: {{ parameter_assignments | length }}\n          ===============================================\n\n    - name: Log tailoring activity for audit\n      ansible.builtin.lineinfile:\n        path: \"{{ compliance_dir }}/tailoring_audit.log\"\n        line: \"{{ ansible_date_time.iso8601 }} - PL-11 tailoring documented for {{ system_name }} ({{ selected_baseline }} baseline)\"\n        create: yes\n        mode: '0640'"
      },
      "windows": {
        "powershell": "# PL-11: Baseline Tailoring Documentation Generator for Windows\n# NEW IN NIST SP 800-53 Rev 5\n# Generates baseline tailoring documentation and tracking\n\n#Requires -Version 5.1\n\nparam(\n    [string]$SystemName = $env:COMPUTERNAME,\n    [ValidateSet('LOW','MODERATE','HIGH')]\n    [string]$SelectedBaseline = 'MODERATE'\n)\n\n$ErrorActionPreference = 'Stop'\n\n$ComplianceDir = \"C:\\Compliance\\PL-11-Baseline-Tailoring\"\n$Date = Get-Date -Format 'yyyy-MM-dd'\n\n# Create compliance directory\nif (-not (Test-Path $ComplianceDir)) {\n    New-Item -ItemType Directory -Path $ComplianceDir -Force | Out-Null\n}\n\nWrite-Host \"`n============================================\" -ForegroundColor Cyan\nWrite-Host \"PL-11: Baseline Tailoring (NEW in Rev 5)\" -ForegroundColor Cyan\nWrite-Host \"============================================`n\" -ForegroundColor Cyan\n\n# Define sample tailoring actions (customize per system)\n$TailoringActions = @{\n    ScopedOut = @(\n        @{ControlId='MP-4'; Reason='No removable media policy'; Risk='Low'}\n        @{ControlId='MP-5'; Reason='No physical media transport'; Risk='Low'}\n        @{ControlId='PE-4'; Reason='Cloud-hosted system'; Risk='N/A'}\n    )\n    CommonControls = @(\n        @{ControlId='PE-2'; Provider='Azure/AWS Datacenter'; Evidence='SOC 2 Report'}\n        @{ControlId='PE-3'; Provider='Azure/AWS Datacenter'; Evidence='SOC 2 Report'}\n        @{ControlId='PS-1'; Provider='Corporate HR'; Evidence='HR Policy'}\n    )\n    Compensating = @(\n        @{BaselineControl='AC-2(5)'; Compensating='GPO session timeout + screen lock'; Justification='Legacy app limitation'}\n    )\n    Supplemental = @(\n        @{ControlId='SI-4(5)'; Justification='High-value target threat model'}\n        @{ControlId='AU-10'; Justification='Regulatory non-repudiation requirement'}\n    )\n    Parameters = @(\n        @{ControlId='AC-7.a'; Parameter='Invalid logon attempts'; Value='5'; Rationale='Balance security/usability'}\n        @{ControlId='AC-7.b'; Parameter='Lockout duration'; Value='30 minutes'; Rationale='Automated unlock'}\n        @{ControlId='AC-11.a'; Parameter='Session lock timeout'; Value='15 minutes'; Rationale='STIG alignment'}\n        @{ControlId='AU-11'; Parameter='Audit retention'; Value='1 year'; Rationale='Legal requirement'}\n    )\n}\n\n# Generate tailoring report\n$ReportContent = @\"\n# Baseline Tailoring Documentation\n## NIST SP 800-53 Rev 5 Control PL-11\n### NEW IN REVISION 5\n\n---\n\n## Document Control\n- **Control ID:** PL-11\n- **Control Name:** Baseline Tailoring\n- **Generated:** $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')\n- **System Name:** $SystemName\n- **Selected Baseline:** $SelectedBaseline\n\n---\n\n## Purpose\n\nThis document records all tailoring actions applied to the $SelectedBaseline control baseline.\nPL-11 is a **NEW control in NIST SP 800-53 Revision 5** that formalizes baseline customization.\n\n---\n\n## Tailoring Summary\n\n| Category | Count |\n|----------|-------|\n| Controls Scoped Out | $($TailoringActions.ScopedOut.Count) |\n| Common Controls | $($TailoringActions.CommonControls.Count) |\n| Compensating Controls | $($TailoringActions.Compensating.Count) |\n| Supplemental Controls | $($TailoringActions.Supplemental.Count) |\n| Parameter Assignments | $($TailoringActions.Parameters.Count) |\n\n---\n\n## Scoped Out Controls\n\n| Control ID | Reason | Risk Accepted |\n|------------|--------|---------------|\n\"@\n\nforeach ($ctrl in $TailoringActions.ScopedOut) {\n    $ReportContent += \"| $($ctrl.ControlId) | $($ctrl.Reason) | $($ctrl.Risk) |`n\"\n}\n\n$ReportContent += @\"\n\n## Common Controls (Inherited)\n\n| Control ID | Provider | Evidence |\n|------------|----------|----------|\n\"@\n\nforeach ($ctrl in $TailoringActions.CommonControls) {\n    $ReportContent += \"| $($ctrl.ControlId) | $($ctrl.Provider) | $($ctrl.Evidence) |`n\"\n}\n\n$ReportContent += @\"\n\n## Compensating Controls\n\n| Baseline Control | Compensating Control | Justification |\n|------------------|---------------------|---------------|\n\"@\n\nforeach ($ctrl in $TailoringActions.Compensating) {\n    $ReportContent += \"| $($ctrl.BaselineControl) | $($ctrl.Compensating) | $($ctrl.Justification) |`n\"\n}\n\n$ReportContent += @\"\n\n## Supplemental Controls\n\n| Control ID | Justification |\n|------------|---------------|\n\"@\n\nforeach ($ctrl in $TailoringActions.Supplemental) {\n    $ReportContent += \"| $($ctrl.ControlId) | $($ctrl.Justification) |`n\"\n}\n\n$ReportContent += @\"\n\n## Parameter Assignments\n\n| Control ID | Parameter | Value | Rationale |\n|------------|-----------|-------|----------|\n\"@\n\nforeach ($param in $TailoringActions.Parameters) {\n    $ReportContent += \"| $($param.ControlId) | $($param.Parameter) | $($param.Value) | $($param.Rationale) |`n\"\n}\n\n$ReportContent += @\"\n\n---\n\n## Windows-Specific Tailoring Notes\n\nFor Windows systems, the following tailoring considerations apply:\n\n### Group Policy Implementations\nMany parameter assignments can be enforced via Group Policy:\n- Account lockout policies (AC-7)\n- Screen saver timeout (AC-11)\n- Audit policies (AU family)\n\n### Common Control Inheritance\nWhen using Azure AD or on-premises AD, identity controls may be inherited:\n- IA-2: Identification and Authentication\n- IA-5: Authenticator Management\n- AC-2: Account Management\n\n### Verification Commands\n``````powershell\n# Verify account lockout policy (AC-7)\nnet accounts\n\n# Verify audit policy (AU family)\nauditpol /get /category:*\n\n# Verify screen timeout via registry\nGet-ItemProperty 'HKCU:\\Control Panel\\Desktop' -Name ScreenSaveTimeOut\n``````\n\n---\n\n## References\n- NIST SP 800-53 Rev 5, Control PL-11 (NEW)\n- NIST SP 800-53B, Control Baselines\n- Microsoft Security Baseline\n\"@\n\n$ReportFile = Join-Path $ComplianceDir \"TailoringReport_$Date.md\"\n$ReportContent | Out-File -FilePath $ReportFile -Encoding UTF8\nWrite-Host \"[INFO] Tailoring report generated: $ReportFile\" -ForegroundColor Green\n\n# Generate JSON record\n$TailoringRecord = @{\n    control_id = 'PL-11'\n    control_name = 'Baseline Tailoring'\n    new_in_rev5 = $true\n    generated = (Get-Date -Format 'o')\n    system = $SystemName\n    baseline = $SelectedBaseline\n    tailoring_actions = $TailoringActions\n    next_review = (Get-Date).AddYears(1).ToString('yyyy-MM-dd')\n}\n\n$JsonFile = Join-Path $ComplianceDir \"tailoring_register.json\"\n$TailoringRecord | ConvertTo-Json -Depth 5 | Out-File -FilePath $JsonFile -Encoding UTF8\nWrite-Host \"[INFO] Tailoring register JSON generated: $JsonFile\" -ForegroundColor Green\n\n# Generate CSV for tracking\n$CsvData = @()\nforeach ($ctrl in $TailoringActions.ScopedOut) {\n    $CsvData += [PSCustomObject]@{\n        ControlId = $ctrl.ControlId\n        ActionType = 'SCOPE_OUT'\n        Details = $ctrl.Reason\n        Risk = $ctrl.Risk\n        Date = $Date\n    }\n}\nforeach ($ctrl in $TailoringActions.CommonControls) {\n    $CsvData += [PSCustomObject]@{\n        ControlId = $ctrl.ControlId\n        ActionType = 'COMMON'\n        Details = $ctrl.Provider\n        Risk = 'N/A'\n        Date = $Date\n    }\n}\nforeach ($ctrl in $TailoringActions.Supplemental) {\n    $CsvData += [PSCustomObject]@{\n        ControlId = $ctrl.ControlId\n        ActionType = 'SUPPLEMENT'\n        Details = $ctrl.Justification\n        Risk = 'N/A'\n        Date = $Date\n    }\n}\nforeach ($param in $TailoringActions.Parameters) {\n    $CsvData += [PSCustomObject]@{\n        ControlId = $param.ControlId\n        ActionType = 'PARAMETER'\n        Details = \"$($param.Parameter): $($param.Value)\"\n        Risk = 'N/A'\n        Date = $Date\n    }\n}\n\n$CsvFile = Join-Path $ComplianceDir \"tailoring_register.csv\"\n$CsvData | Export-Csv -Path $CsvFile -NoTypeInformation\nWrite-Host \"[INFO] Tailoring register CSV generated: $CsvFile\" -ForegroundColor Green\n\n# Display summary\nWrite-Host \"`n--- Tailoring Summary ---\" -ForegroundColor Yellow\nWrite-Host \"Controls Scoped Out: $($TailoringActions.ScopedOut.Count)\" -ForegroundColor White\nWrite-Host \"Common Controls: $($TailoringActions.CommonControls.Count)\" -ForegroundColor White\nWrite-Host \"Compensating Controls: $($TailoringActions.Compensating.Count)\" -ForegroundColor White\nWrite-Host \"Supplemental Controls: $($TailoringActions.Supplemental.Count)\" -ForegroundColor White\nWrite-Host \"Parameter Assignments: $($TailoringActions.Parameters.Count)\" -ForegroundColor White\n\nWrite-Host \"`n[SUCCESS] PL-11 Baseline Tailoring documentation complete\" -ForegroundColor Cyan",
        "ansible": "---\n# PL-11: Baseline Tailoring for Windows\n# NEW IN NIST SP 800-53 Rev 5\n# Ansible playbook for Windows baseline tailoring documentation\n\n- name: PL-11 Baseline Tailoring - Windows\n  hosts: windows\n  gather_facts: yes\n  vars:\n    compliance_dir: C:\\Compliance\\PL-11-Baseline-Tailoring\n    selected_baseline: MODERATE\n    \n    # Tailoring actions - customize per system\n    scoped_out_controls:\n      - control_id: MP-4\n        reason: \"No removable media policy\"\n      - control_id: MP-5\n        reason: \"No physical media transport\"\n    \n    common_controls:\n      - control_id: PE-2\n        provider: \"Cloud Provider\"\n      - control_id: PE-3\n        provider: \"Cloud Provider\"\n    \n    supplemental_controls:\n      - control_id: SI-4(5)\n        justification: \"Enhanced monitoring required\"\n    \n    parameter_assignments:\n      - control_id: AC-7.a\n        parameter: \"Invalid logon attempts\"\n        value: \"5\"\n      - control_id: AC-11.a\n        parameter: \"Session lock timeout\"\n        value: \"15 minutes\"\n\n  tasks:\n    - name: Create baseline tailoring compliance directory\n      ansible.windows.win_file:\n        path: \"{{ compliance_dir }}\"\n        state: directory\n\n    - name: Generate tailoring register JSON\n      ansible.windows.win_copy:\n        dest: \"{{ compliance_dir }}\\\\tailoring_register.json\"\n        content: |\n          {\n            \"control_id\": \"PL-11\",\n            \"control_name\": \"Baseline Tailoring\",\n            \"new_in_rev5\": true,\n            \"generated\": \"{{ ansible_date_time.iso8601 }}\",\n            \"system\": \"{{ ansible_hostname }}\",\n            \"baseline\": \"{{ selected_baseline }}\",\n            \"tailoring_actions\": {\n              \"scoped_out\": {{ scoped_out_controls | to_json }},\n              \"common_controls\": {{ common_controls | to_json }},\n              \"supplemental_controls\": {{ supplemental_controls | to_json }},\n              \"parameter_assignments\": {{ parameter_assignments | to_json }}\n            }\n          }\n\n    - name: Calculate tailoring summary\n      ansible.builtin.set_fact:\n        tailoring_summary:\n          scoped_out_count: \"{{ scoped_out_controls | length }}\"\n          common_count: \"{{ common_controls | length }}\"\n          supplemental_count: \"{{ supplemental_controls | length }}\"\n          parameter_count: \"{{ parameter_assignments | length }}\"\n\n    - name: Display tailoring summary\n      ansible.builtin.debug:\n        msg: |\n          ===============================================\n          PL-11 Baseline Tailoring (NEW in Rev 5)\n          ===============================================\n          System: {{ ansible_hostname }}\n          Baseline: {{ selected_baseline }}\n          \n          Tailoring Actions:\n          - Controls Scoped Out: {{ tailoring_summary.scoped_out_count }}\n          - Common Controls: {{ tailoring_summary.common_count }}\n          - Supplemental Controls: {{ tailoring_summary.supplemental_count }}\n          - Parameters Assigned: {{ tailoring_summary.parameter_count }}\n          ===============================================\n\n    - name: Verify Windows security parameters match tailoring\n      ansible.windows.win_shell: |\n        $results = @{}\n        # Check account lockout (AC-7)\n        $lockout = net accounts | Select-String 'Lockout threshold'\n        $results['AC-7_Lockout'] = $lockout.ToString().Trim()\n        \n        # Check screen saver timeout (AC-11)\n        $timeout = Get-ItemProperty 'HKCU:\\Control Panel\\Desktop' -Name ScreenSaveTimeOut -ErrorAction SilentlyContinue\n        $results['AC-11_ScreenTimeout'] = if ($timeout) { $timeout.ScreenSaveTimeOut } else { 'Not Set' }\n        \n        $results | ConvertTo-Json\n      register: windows_params\n\n    - name: Display current Windows parameters\n      ansible.builtin.debug:\n        msg: \"Current Windows security parameters: {{ windows_params.stdout }}\"\n\n    - name: Log tailoring activity to Windows Event Log\n      ansible.windows.win_shell: |\n        if (-not [System.Diagnostics.EventLog]::SourceExists('NIST-Compliance')) {\n          New-EventLog -LogName Application -Source 'NIST-Compliance'\n        }\n        Write-EventLog -LogName Application -Source 'NIST-Compliance' -EventId 11 -EntryType Information -Message \"PL-11 Baseline Tailoring documented for {{ ansible_hostname }} ({{ selected_baseline }} baseline)\"\n      ignore_errors: yes"
      }
    },
    "stig_id": "",
    "metadata": {
      "status": "enhanced",
      "last_updated": "2025-11-22T00:00:00Z",
      "has_scripts": true,
      "nist_rev": "5",
      "new_in_rev5": true,
      "enhancement_notes": "NEW IN REV 5 - Comprehensive baseline tailoring documentation with tracking register and governance templates"
    }
  }
]